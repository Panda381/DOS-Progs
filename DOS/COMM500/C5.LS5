
4000 F606DA8F20     TEST   Byte Ptr [8FDA],20            ;' '
4005 750A           JNZ    4011
4007 803E979000     CMP    Byte Ptr [9097],00
400C 75BB           JNZ    3FC9
400E 49             DEC    CX
400F 74B8           JZ     3FC9
4011 BAAA83         MOV    DX,83AA
4014 EB23           JMP    4039
4016 33D2           XOR    DX,DX
4018 87D1           XCHG   DX,CX
401A B80142         MOV    AX,4201
401D CD21           INT    21               ; relativn¡ posun ukazatele
401F A3A490         MOV    [90A4],AX
4022 8916A690       MOV    [90A6],DX
4026 803E8A8D00     CMP    Byte Ptr [8D8A],00
402B 749C           JZ     3FC9
402D B440           MOV    AH,40                         ;'@'
402F CD21           INT    21               ; z pis do souboru
4031 725F           JB     4092
4033 C606A8901A     MOV    Byte Ptr [90A8],1A
4038 C3             RET


4039 E8CE0F         CALL   500A
403C FE06978D       INC    Byte Ptr [8D97]
4040 803E968D00     CMP    Byte Ptr [8D96],00
4045 7448           JZ     408F
4047 8B1ED88F       MOV    BX,[8FD8]
404B 83FB00         CMP    BX,+00
404E 7E33           JLE    4083
4050 8B0EA690       MOV    CX,[90A6]
4054 8B16A490       MOV    DX,[90A4]
4058 8BC1           MOV    AX,CX
405A 0BC2           OR     AX,DX
405C 7421           JZ     407F
405E B80042         MOV    AX,4200
4061 CD21           INT    21               ; nastaven¡ ukazatele od za‡ tku
4063 33C9           XOR    CX,CX
4065 B440           MOV    AH,40                         ;'@'
4067 CD21           INT    21               ; z pis do souboru
4069 803EA89000     CMP    Byte Ptr [90A8],00
406E 7408           JZ     4078
4070 41             INC    CX
4071 BAA890         MOV    DX,90A8
4074 B440           MOV    AH,40                         ;'@'
4076 CD21           INT    21               ; z pis do souboru
4078 B43E           MOV    AH,3E                         ;'>'
407A CD21           INT    21               ; uzav©en¡ souboru
407C E96AFA         JMP    3AE9

407F B43E           MOV    AH,3E                         ;'>'
4081 CD21           INT    21               ; uzav©en¡ souboru
4083 BA818F         MOV    DX,8F81
4086 B441           MOV    AH,41                         ;'A'
4088 CD21           INT    21               ; zru¨en¡ souboru
408A C606968D00     MOV    Byte Ptr [8D96],00
408F E957FA         JMP    3AE9

4092 E9AEFE         JMP    3F43
4095 240C           AND    AL,0C
4097 7A10           JPE    40A9
4099 50             PUSH   AX
409A 2408           AND    AL,08
409C A29990         MOV    [9099],AL
409F 58             POP    AX
40A0 2404           AND    AL,04
40A2 A29D90         MOV    [909D],AL
40A5 08069790       OR     [9097],AL
40A9 A09D90         MOV    AL,[909D]
40AC 0AC0           OR     AL,AL
40AE C3             RET

40AF 803E7C8FFF     CMP    Byte Ptr [8F7C],FF
40B4 750C           JNZ    40C2
40B6 BF598C         MOV    DI,8C59
40B9 BD7C8F         MOV    BP,8F7C
40BC E8E000         CALL   419F
40BF E89BE4         CALL   255D             ; n vrat aktivn¡ho adres ©e
40C2 32C0           XOR    AL,AL
40C4 8606DB8F       XCHG   AL,[8FDB]
40C8 0AC0           OR     AL,AL
40CA 7503           JNZ    40CF
40CC E98C00         JMP    415B
40CF 8B367E8F       MOV    SI,[8F7E]
40D3 BF3B8E         MOV    DI,8E3B
40D6 B80029         MOV    AX,2900
40D9 CD21           INT    21               ; rozbor jm‚na souboru
40DB 803C00         CMP    Byte Ptr [SI],00
40DE 7406           JZ     40E6
40E0 BA2D82         MOV    DX,822D
40E3 E953FF         JMP    4039
40E6 A1818F         MOV    AX,[8F81]
40E9 80FC3A         CMP    AH,3A                         ;':'
40EC 7402           JZ     40F0
40EE B040           MOV    AL,40                         ;'@'
40F0 8A0E9D90       MOV    CL,[909D]
40F4 0C20           OR     AL,20                         ;' '
40F6 2C60           SUB    AL,60                         ;'`'
40F8 A23B8E         MOV    [8E3B],AL
40FB A0808F         MOV    AL,[8F80]
40FE 8A26E38F       MOV    AH,[8FE3]
4102 250202         AND    AX,0202
4105 0AC0           OR     AL,AL
4107 7413           JZ     411C
4109 3AC4           CMP    AL,AH
410B 750F           JNZ    411C
410D 803E9E9000     CMP    Byte Ptr [909E],00
4112 7408           JZ     411C
4114 FE06DC8F       INC    Byte Ptr [8FDC]
4118 32C0           XOR    AL,AL
411A EB06           JMP    4122
411C 3402           XOR    AL,02
411E 22C4           AND    AL,AH
4120 D0E8           SHR    AL,1
4122 0A069E90       OR     AL,[909E]
4126 A28C8D         MOV    [8D8C],AL
4129 D0E0           SHL    AL,1
412B D0E0           SHL    AL,1
412D A29790         MOV    [9097],AL
4130 803E999000     CMP    Byte Ptr [9099],00
4135 7524           JNZ    415B
4137 A29D90         MOV    [909D],AL
413A 0AC9           OR     CL,CL
413C 751D           JNZ    415B
413E 0AC0           OR     AL,AL
4140 7419           JZ     415B
4142 8B0E9A8D       MOV    CX,[8D9A]
4146 E313           JCXZ   415B
4148 B01A           MOV    AL,1A
414A 06             PUSH   ES
414B 33FF           XOR    DI,DI
414D 8E06798D       MOV    ES,[8D79]
4151 F2             REPNZ
4152 AE             SCASB
4153 07             POP    ES
4154 7505           JNZ    415B
4156 4F             DEC    DI
4157 893E9A8D       MOV    [8D9A],DI
415B BB7F8E         MOV    BX,8E7F
415E 803E8C8D00     CMP    Byte Ptr [8D8C],00
4163 7403           JZ     4168
4165 BBC58E         MOV    BX,8EC5
4168 BE3C8E         MOV    SI,8E3C
416B 8B3E7E8F       MOV    DI,[8F7E]
416F B90800         MOV    CX,0008
4172 AC             LODSB
4173 3C3F           CMP    AL,3F                         ;'?'
4175 7502           JNZ    4179
4177 8A07           MOV    AL,[BX]
4179 3C20           CMP    AL,20                         ;' '
417B 7401           JZ     417E
417D AA             STOSB
417E 43             INC    BX
417F E2F1           LOOP   4172
4181 B103           MOV    CL,03
4183 B020           MOV    AL,20                         ;' '
4185 3804           CMP    [SI],AL
4187 7412           JZ     419B
4189 B02E           MOV    AL,2E                         ;'.'
418B AA             STOSB
418C AC             LODSB
418D 3C3F           CMP    AL,3F                         ;'?'
418F 7502           JNZ    4193
4191 8A07           MOV    AL,[BX]
4193 3C20           CMP    AL,20                         ;' '
4195 7401           JZ     4198
4197 AA             STOSB
4198 43             INC    BX
4199 E2F1           LOOP   418C
419B 32C0           XOR    AL,AL
419D AA             STOSB
419E C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------

419F F6460402       TEST   Byte Ptr [BP+04],02
41A3 7543           JNZ    41E8
41A5 8BD5           MOV    DX,BP
41A7 83C205         ADD    DX,+05
41AA 57             PUSH   DI
41AB B8006C         MOV    AX,6C00
41AE BB4000         MOV    BX,0040
41B1 33C9           XOR    CX,CX
41B3 8BF2           MOV    SI,DX
41B5 BA0101         MOV    DX,0101
41B8 CD21           INT    21               ; otev©en¡/vytvo©en¡ soubou
41BA 5F             POP    DI
41BB 7315           JNB    41D2
41BD E8E0DB         CALL   1DA0             ; poskytnut¡ chybov˜ch informac¡
41C0 3D0200         CMP    AX,0002
41C3 7423           JZ     41E8
41C5 3D0300         CMP    AX,0003
41C8 741E           JZ     41E8
41CA 3D0500         CMP    AX,0005
41CD 7419           JZ     41E8
41CF E9FFD8         JMP    1AD1
41D2 8BD8           MOV    BX,AX
41D4 B80044         MOV    AX,4400
41D7 CD21           INT    21               ; poskytnut¡ informac¡ o za©¡zen¡
41D9 B43E           MOV    AH,3E                         ;'>'
41DB CD21           INT    21               ; uzav©en¡ souboru
41DD F6C280         TEST   DL,80
41E0 7553           JNZ    4235
41E2 F6460404       TEST   Byte Ptr [BP+04],04
41E6 744D           JZ     4235
41E8 8B5605         MOV    DX,[BP+05]
41EB 80FA00         CMP    DL,00
41EE 7405           JZ     41F5
41F0 80FE3A         CMP    DH,3A                         ;':'
41F3 7402           JZ     41F7
41F5 B240           MOV    DL,40                         ;'@'
41F7 80CA20         OR     DL,20                         ;' '
41FA 80EA60         SUB    DL,60                         ;'`'
41FD E894E4         CALL   2694
4200 7306           JNB    4208
4202 E89BDB         CALL   1DA0             ; poskytnut¡ chybov˜ch informac¡
4205 E9C9D8         JMP    1AD1
4208 8BD5           MOV    DX,BP
420A 83C205         ADD    DX,+05
420D 8A7E04         MOV    BH,[BP+04]
4210 80E706         AND    BH,06
4213 80FF06         CMP    BH,06
4216 7518           JNZ    4230
4218 8B7602         MOV    SI,[BP+02]
421B B33A           MOV    BL,3A                         ;':'
421D 385CFE         CMP    [SI-02],BL
4220 7506           JNZ    4228
4222 C6460002       MOV    Byte Ptr [BP+00],02
4226 EB05           JMP    422D
4228 C6460001       MOV    Byte Ptr [BP+00],01
422C 4E             DEC    SI
422D E98300         JMP    42B3
4230 80FF02         CMP    BH,02
4233 7505           JNZ    423A
4235 C6460000       MOV    Byte Ptr [BP+00],00
4239 C3             RET



423A E8BCEB         CALL   2DF9
423D B43B           MOV    AH,3B                         ;';'
423F CD21           INT    21               ; nastaven¡ adres ©e
4241 7239           JB     427C
4243 8BFA           MOV    DI,DX
4245 33C0           XOR    AX,AX
4247 8BC8           MOV    CX,AX
4249 49             DEC    CX
424A 268A05         MOV    AL,ES:[DI]
424D 47             INC    DI
424E 0AC0           OR     AL,AL
4250 740C           JZ     425E
4252 32E4           XOR    AH,AH
4254 E843E2         CALL   249A             ; test, zda je znak v tabulce LEAD
4257 74F1           JZ     424A
4259 47             INC    DI
425A FEC4           INC    AH
425C EBEC           JMP    424A
425E 4F             DEC    DI
425F A07C8D         MOV    AL,[8D7C]        ; oddˆlova‡ cesty "\"
4262 C6460002       MOV    Byte Ptr [BP+00],02
4266 0AE4           OR     AH,AH
4268 7505           JNZ    426F
426A 3A45FF         CMP    AL,[DI-01]
426D 7405           JZ     4274
426F AA             STOSB
4270 C6460001       MOV    Byte Ptr [BP+00],01
4274 804E0406       OR     Byte Ptr [BP+04],06
4278 E87400         CALL   42EF
427B C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

427C E821DB         CALL   1DA0             ; poskytnut¡ chybov˜ch informac¡
427F 3D0300         CMP    AX,0003
4282 7405           JZ     4289
4284 3D0500         CMP    AX,0005
4287 7560           JNZ    42E9
4289 C6460000       MOV    Byte Ptr [BP+00],00
428D 8A7E04         MOV    BH,[BP+04]
4290 F6C704         TEST   BH,04
4293 74E6           JZ     427B
4295 C6460002       MOV    Byte Ptr [BP+00],02
4299 8B7602         MOV    SI,[BP+02]
429C 803C00         CMP    Byte Ptr [SI],00
429F 744B           JZ     42EC
42A1 B32E           MOV    BL,2E                         ;'.'
42A3 381C           CMP    [SI],BL
42A5 7445           JZ     42EC
42A7 B33A           MOV    BL,3A                         ;':'
42A9 385CFE         CMP    [SI-02],BL
42AC 7405           JZ     42B3
42AE C6460001       MOV    Byte Ptr [BP+00],01
42B2 4E             DEC    SI
42B3 32DB           XOR    BL,BL
42B5 861C           XCHG   BL,[SI]
42B7 E83FEB         CALL   2DF9
42BA 3BD6           CMP    DX,SI
42BC 731B           JNB    42D9
42BE 56             PUSH   SI
42BF 51             PUSH   CX
42C0 8BCE           MOV    CX,SI
42C2 8BF2           MOV    SI,DX
42C4 AC             LODSB
42C5 E8D2E1         CALL   249A             ; test, zda je znak v tabulce LEAD
42C8 7409           JZ     42D3
42CA AC             LODSB
42CB 3BF1           CMP    SI,CX
42CD 72F5           JB     42C4
42CF 59             POP    CX
42D0 5E             POP    SI
42D1 EB0B           JMP    42DE
42D3 3BF1           CMP    SI,CX
42D5 72ED           JB     42C4
42D7 59             POP    CX
42D8 5E             POP    SI
42D9 3A5CFF         CMP    BL,[SI-01]
42DC 740E           JZ     42EC
42DE B43B           MOV    AH,3B                         ;';'
42E0 CD21           INT    21               ; nastaven¡ adres ©e
42E2 861C           XCHG   BL,[SI]
42E4 7395           JNB    427B
42E6 E8B7DA         CALL   1DA0             ; poskytnut¡ chybov˜ch informac¡
42E9 E9E5D7         JMP    1AD1
42EC E9DFD7         JMP    1ACE
42EF 897E02         MOV    [BP+02],DI
42F2 8046010C       ADD    Byte Ptr [BP+01],0C
42F6 B83F2E         MOV    AX,2E3F
42F9 B90800         MOV    CX,0008
42FC F3             REPZ
42FD AA             STOSB
42FE 86C4           XCHG   AL,AH
4300 AA             STOSB
4301 86C4           XCHG   AL,AH
4303 B103           MOV    CL,03
4305 F3             REPZ
4306 AA             STOSB
4307 32C0           XOR    AL,AL
4309 AA             STOSB
430A C3             RET

430B BE818F         MOV    SI,8F81
430E BFFC8A         MOV    DI,8AFC
4311 B460           MOV    AH,60                         ;'`'
4313 CD21           INT    21               ; korekce na plnou specifikaci soub.
4315 BEA58A         MOV    SI,8AA5
4318 BFFC8A         MOV    DI,8AFC
431B E8EBE3         CALL   2709             ; porovn n¡ dvou ©etˆzc– ASCIIZ
431E C3             RET

431F 33C0           XOR    AX,AX
4321 893EAB90       MOV    [90AB],DI
4325 A2AE90         MOV    [90AE],AL
4328 A2AF90         MOV    [90AF],AL
432B 8AF8           MOV    BH,AL
432D 9C             PUSHF
432E 57             PUSH   DI
432F 33C9           XOR    CX,CX
4331 880EDA8E       MOV    [8EDA],CL
4335 AC             LODSB
4336 E893E3         CALL   26CC             ; test, zda je znak oddˆlova‡
4339 751D           JNZ    4358
433B 3C20           CMP    AL,20                         ;' '
433D 74F6           JZ     4335
433F 3C09           CMP    AL,09
4341 74F2           JZ     4335
4343 8606AF90       XCHG   AL,[90AF]
4347 0AC0           OR     AL,AL
4349 74EA           JZ     4335
434B F6C780         TEST   BH,80
434E 7405           JZ     4355
4350 C606DA8E01     MOV    Byte Ptr [8EDA],01
4355 E92D01         JMP    4485
4358 3AC3           CMP    AL,BL
435A 7505           JNZ    4361
435C 80CF80         OR     BH,80
435F EBD4           JMP    4335
4361 3C0D           CMP    AL,0D
4363 7503           JNZ    4368
4365 E91801         JMP    4480
4368 3A067B8D       CMP    AL,[8D7B]        ; oddˆlova‡ parametr–
436C 7503           JNZ    4371
436E E91701         JMP    4488
4371 B23A           MOV    DL,3A                         ;':'
4373 3814           CMP    [SI],DL
4375 751D           JNZ    4394
4377 803E698F01     CMP    Byte Ptr [8F69],01
437C 7503           JNZ    4381
437E E843E1         CALL   24C4
4381 E85C01         CALL   44E0
4384 AC             LODSB
4385 E85801         CALL   44E0
4388 893EAB90       MOV    [90AB],DI
438C C606AD9000     MOV    Byte Ptr [90AD],00
4391 E9B300         JMP    4447
4394 893EAB90       MOV    [90AB],DI
4398 C606AD9000     MOV    Byte Ptr [90AD],00
439D 803E698F01     CMP    Byte Ptr [8F69],01
43A2 751D           JNZ    43C1
43A4 E8AFE3         CALL   2756             ; test, zda je stand.oddˆlova‡ param.
43A7 7518           JNZ    43C1
43A9 50             PUSH   AX
43AA A08B8D         MOV    AL,[8D8B]
43AD 0441           ADD    AL,41                         ;'A'
43AF E82E01         CALL   44E0
43B2 B03A           MOV    AL,3A                         ;':'
43B4 E82901         CALL   44E0
43B7 58             POP    AX
43B8 893EAB90       MOV    [90AB],DI
43BC C606AD9000     MOV    Byte Ptr [90AD],00
43C1 E8D6E0         CALL   249A             ; test, zda je znak v tabulce LEAD
43C4 7406           JZ     43CC
43C6 E81701         CALL   44E0
43C9 AC             LODSB
43CA EB78           JMP    4444
43CC 803E698F01     CMP    Byte Ptr [8F69],01
43D1 7503           JNZ    43D6
43D3 E8EEE0         CALL   24C4
43D6 3C2E           CMP    AL,2E                         ;'.'
43D8 7509           JNZ    43E3
43DA FE06AE90       INC    Byte Ptr [90AE]
43DE C606AD90FF     MOV    Byte Ptr [90AD],FF
43E3 3C3F           CMP    AL,3F                         ;'?'
43E5 7503           JNZ    43EA
43E7 80CF02         OR     BH,02
43EA 3C2A           CMP    AL,2A                         ;'*'
43EC 7530           JNZ    441E
43EE 80CF02         OR     BH,02
43F1 803EE79000     CMP    Byte Ptr [90E7],00
43F6 7504           JNZ    43FC
43F8 EB24           JMP    441E
43FA EB78           JMP    4474
43FC B407           MOV    AH,07
43FE 803EAE9000     CMP    Byte Ptr [90AE],00
4403 7402           JZ     4407
4405 B402           MOV    AH,02
4407 B03F           MOV    AL,3F                         ;'?'
4409 2A26AD90       SUB    AH,[90AD]
440D 72EB           JB     43FA
440F 86E1           XCHG   AH,CL
4411 E309           JCXZ   441C
4413 86E1           XCHG   AH,CL
4415 E8C800         CALL   44E0
4418 86E1           XCHG   AH,CL
441A E2F7           LOOP   4413
441C 86E1           XCHG   AH,CL
441E E835E3         CALL   2756             ; test, zda je stand.oddˆlova‡ param.
4421 7521           JNZ    4444
4423 80CF04         OR     BH,04
4426 803EE79000     CMP    Byte Ptr [90E7],00
442B 7405           JZ     4432
442D F6C702         TEST   BH,02
4430 7548           JNZ    447A
4432 893EAB90       MOV    [90AB],DI
4436 FF06AB90       INC    Word Ptr [90AB]
443A C606AD90FF     MOV    Byte Ptr [90AD],FF
443F C606AE9000     MOV    Byte Ptr [90AE],00
4444 E89900         CALL   44E0
4447 AC             LODSB
4448 E881E2         CALL   26CC             ; test, zda je znak oddˆlova‡
444B 7438           JZ     4485
444D 3C0D           CMP    AL,0D
444F 7434           JZ     4485
4451 3A067B8D       CMP    AL,[8D7B]        ; oddˆlova‡ parametr–
4455 742E           JZ     4485
4457 3AC3           CMP    AL,BL
4459 742A           JZ     4485
445B 3C3A           CMP    AL,3A                         ;':'
445D 7403           JZ     4462
445F E95FFF         JMP    43C1
4462 803E698F02     CMP    Byte Ptr [8F69],02
4467 7505           JNZ    446E
4469 E87400         CALL   44E0
446C EBD9           JMP    4447
446E 46             INC    SI
446F EB14           JMP    4485
4471 E94DFF         JMP    43C1
4474 BA2482         MOV    DX,8224
4477 E9D1E5         JMP    2A4B
447A BA4E83         MOV    DX,834E
447D E9CBE5         JMP    2A4B
4480 4E             DEC    SI
4481 5F             POP    DI
4482 9D             POPF
4483 F9             STC
4484 C3             RET

4485 4E             DEC    SI
4486 EB51           JMP    44D9
4488 80CF01         OR     BH,01
448B 81CD0080       OR     BP,8000
448F E832E2         CALL   26C4             ; vypustˆn¡ oddˆlova‡– z textu
4492 46             INC    SI
4493 E804E0         CALL   249A             ; test, zda je znak v tabulce LEAD
4496 740D           JZ     44A5
4498 E84500         CALL   44E0
449B AC             LODSB
449C E84100         CALL   44E0
449F 81CD0040       OR     BP,4000
44A3 EB34           JMP    44D9
44A5 3C0D           CMP    AL,0D
44A7 7509           JNZ    44B2
44A9 B000           MOV    AL,00
44AB AA             STOSB
44AC 81CD0040       OR     BP,4000
44B0 EBCE           JMP    4480
44B2 E82B00         CALL   44E0
44B5 E80CE0         CALL   24C4
44B8 06             PUSH   ES
44B9 57             PUSH   DI
44BA 51             PUSH   CX
44BB 0E             PUSH   CS
44BC 07             POP    ES
44BD BF4287         MOV    DI,8742
44C0 B90600         MOV    CX,0006
44C3 81CD0040       OR     BP,4000
44C7 F2             REPNZ
44C8 AE             SCASB
44C9 750B           JNZ    44D6
44CB 81E5FFBF       AND    BP,BFFF
44CF B80100         MOV    AX,0001
44D2 D3E0           SHL    AX,CL
44D4 0BE8           OR     BP,AX
44D6 59             POP    CX
44D7 5F             POP    DI
44D8 07             POP    ES
44D9 B000           MOV    AL,00
44DB AA             STOSB
44DC 5F             POP    DI
44DD 9D             POPF
44DE F8             CLC
44DF C3             RET

44E0 AA             STOSB
44E1 41             INC    CX
44E2 FE06AD90       INC    Byte Ptr [90AD]
44E6 C3             RET

; -----------------------------------------------------------------------------
;    Rozbor parametr–
; -----------------------------------------------------------------------------

44E7 2EC706CF880000 MOV    Word Ptr CS:[88CF],0000
44EE 2E890E5989     MOV    CS:[8959],CX
44F3 2E89265B89     MOV    CS:[895B],SP
44F8 2E89365D89     MOV    CS:[895D],SI
44FD FC             CLD
44FE 2E890EC288     MOV    CS:[88C2],CX
4503 2EC706C4880000 MOV    Word Ptr CS:[88C4],0000
450A 2EC706D7880000 MOV    Word Ptr CS:[88D7],0000
4511 2EC706C8880000 MOV    Word Ptr CS:[88C8],0000
4518 2EC70694895B5D MOV    Word Ptr CS:[8994],5D5B ; "[]"
451F 2EC70696897C3C MOV    Word Ptr CS:[8996],3C7C ; "<|"
4526 2EC70698893E2B MOV    Word Ptr CS:[8998],2B3E ; "+>"
452D 2EC7069A893D3B MOV    Word Ptr CS:[899A],3B3D ; ";="
4534 E88309         CALL   4EBA             ; test, zda je oddˆlovac¡ znak
4537 7313           JNB    454C             ; nen¡ oddˆlovac¡ znak
4539 B8FFFF         MOV    AX,FFFF
453C 53             PUSH   BX
453D 268B1D         MOV    BX,ES:[DI]
4540 263A0F         CMP    CL,ES:[BX]
4543 7303           JNB    4548
4545 B80200         MOV    AX,0002
4548 5B           * POP    BX
4549 E92301         JMP    466F

454C 2E8936D188   * MOV    CS:[88D1],SI
4551 53             PUSH   BX
4552 57             PUSH   DI
4553 55             PUSH   BP
4554 8D1ED988       LEA    BX,[88D9]
4558 2EF606D08820   TEST   Byte Ptr CS:[88D0],20         ;' '
455E 7543           JNZ    45A3
4560 AC             LODSB
4561 E80F0A         CALL   4F73
4564 723C           JB     45A2
4566 E87709         CALL   4EE0
4569 7437           JZ     45A2
456B E8A409         CALL   4F12
456E 7518           JNZ    4588
4570 2EF606D08820   TEST   Byte Ptr CS:[88D0],20         ;' '
4576 7505           JNZ    457D
4578 E83F09         CALL   4EBA
457B EB26           JMP    45A3
457D 2EF606D08841   TEST   Byte Ptr CS:[88D0],41         ;'A'
4583 741E           JZ     45A3
4585 4E             DEC    SI
4586 EB1B           JMP    45A3
4588 2E8807         MOV    CS:[BX],AL
458B 3C3D           CMP    AL,3D                         ;'='
458D 7506           JNZ    4595
458F 2E800ED08801   OR     Byte Ptr CS:[88D0],01
4595 43             INC    BX
4596 E8080A         CALL   4FA1
4599 73C5           JNB    4560
459B AC             LODSB
459C 2E8807         MOV    CS:[BX],AL
459F 43             INC    BX
45A0 EBBE           JMP    4560
45A2 4E             DEC    SI
45A3 2E8936C688   * MOV    CS:[88C6],SI
45A8 2EC60700       MOV    Byte Ptr CS:[BX],00
45AC 2E891ED588     MOV    CS:[88D5],BX
45B1 268B1D         MOV    BX,ES:[DI]
45B4 8D36D988       LEA    SI,[88D9]
45B8 2E803C2F       CMP    Byte Ptr CS:[SI],2F           ;'/'
45BC 7436           JZ     45F4
45BE 2E803C22       CMP    Byte Ptr CS:[SI],22           ;'"'
45C2 7408           JZ     45CC
45C4 2EF606D08801   TEST   Byte Ptr CS:[88D0],01
45CA 7554           JNZ    4620
45CC 268A4701       MOV    AL,ES:[BX+01]
45D0 32E4           XOR    AH,AH
45D2 2E3906C288     CMP    CS:[88C2],AX
45D7 7312           JNB    45EB
45D9 2EA1C288       MOV    AX,CS:[88C2]
45DD D1E0           SHL    AX,1
45DF 43             INC    BX
45E0 43             INC    BX
45E1 03D8           ADD    BX,AX
45E3 268B1F         MOV    BX,ES:[BX]
45E6 E88800         CALL   4671
45E9 EB69           JMP    4654
45EB 2EC706C4880100 MOV    Word Ptr CS:[88C4],0001
45F2 EB60           JMP    4654
45F4 268A4701       MOV    AL,ES:[BX+01]
45F8 32E4           XOR    AH,AH
45FA 40             INC    AX
45FB D1E0           SHL    AX,1
45FD 03D8           ADD    BX,AX
45FF 268A0F         MOV    CL,ES:[BX]
4602 32ED           XOR    CH,CH
4604 0BC9           OR     CX,CX
4606 740F           JZ     4617
4608 43             INC    BX
4609 53             PUSH   BX
460A 268B1F         MOV    BX,ES:[BX]
460D E8C600         CALL   46D6
4610 5B             POP    BX
4611 7341           JNB    4654
4613 43             INC    BX
4614 43             INC    BX
4615 E2F2           LOOP   4609
4617 2EC706C4880300 MOV    Word Ptr CS:[88C4],0003
461E EB34           JMP    4654
4620 268A4701       MOV    AL,ES:[BX+01]
4624 32E4           XOR    AH,AH
4626 40             INC    AX
4627 D1E0           SHL    AX,1
4629 03D8           ADD    BX,AX
462B 268A07         MOV    AL,ES:[BX]
462E 32E4           XOR    AH,AH
4630 D1E0           SHL    AX,1
4632 40             INC    AX
4633 03D8           ADD    BX,AX
4635 268A0F         MOV    CL,ES:[BX]
4638 32ED           XOR    CH,CH
463A 0BC9           OR     CX,CX
463C 740F           JZ     464D
463E 43             INC    BX
463F 53             PUSH   BX
4640 268B1F         MOV    BX,ES:[BX]
4643 E85D00         CALL   46A3
4646 5B             POP    BX
4647 730B           JNB    4654
4649 43             INC    BX
464A 43             INC    BX
464B E2F2           LOOP   463F
464D 2EC706C4880400 MOV    Word Ptr CS:[88C4],0004
4654 5D             POP    BP
4655 5F             POP    DI
4656 5B             POP    BX
4657 2E8B0EC288     MOV    CX,CS:[88C2]
465C 2EA1C488       MOV    AX,CS:[88C4]
4660 2E8B36C688     MOV    SI,CS:[88C6]
4665 2E8B16C888     MOV    DX,CS:[88C8]
466A 2E8A1ECA88     MOV    BL,CS:[88CA]
466F F8           * CLC
4670 C3             RET

; -----------------------------------------------------------------------------


4671 50             PUSH   AX
4672 268B07         MOV    AX,ES:[BX]
4675 A90200         TEST   AX,0002
4678 7505           JNZ    467F
467A 2EFF06C288     INC    Word Ptr CS:[88C2]
467F 2E803C00       CMP    Byte Ptr CS:[SI],00
4683 7519           JNZ    469E
4685 A90100         TEST   AX,0001
4688 7509           JNZ    4693
468A 2EC706C4880200 MOV    Word Ptr CS:[88C4],0002
4691 EB0E           JMP    46A1
4693 50             PUSH   AX
4694 B003           MOV    AL,03
4696 B4FF           MOV    AH,FF
4698 E89E00         CALL   4739
469B 58             POP    AX
469C EB03           JMP    46A1
469E E81D01         CALL   47BE
46A1 58             POP    AX
46A2 C3             RET

46A3 F9             STC
46A4 C3             RET

46A5 55             PUSH   BP
46A6 51             PUSH   CX
46A7 268A4F08       MOV    CL,ES:[BX+08]
46AB 32ED           XOR    CH,CH
46AD 0BC9           OR     CX,CX
46AF 740D           JZ     46BE
46B1 8D6F09         LEA    BP,[BX+09]
46B4 E81904         CALL   4AD0
46B7 7308           JNB    46C1
46B9 E80E00         CALL   46CA
46BC E2F6           LOOP   46B4
46BE F9             STC
46BF EB06           JMP    46C7
46C1 2E892ED788     MOV    CS:[88D7],BP
46C6 F8             CLC
46C7 59             POP    CX
46C8 5D             POP    BP
46C9 C3             RET

46CA 26807E0000     CMP    Byte Ptr ES:[BP+00],00
46CF 7403           JZ     46D4
46D1 45             INC    BP
46D2 EBF6           JMP    46CA
46D4 45             INC    BP
46D5 C3             RET

46D6 2E800ED08810   OR     Byte Ptr CS:[88D0],10
46DC E8C6FF         CALL   46A5
46DF 724A           JB     472B
46E1 2E8026D088EF   AND    Byte Ptr CS:[88D0],EF
46E7 50             PUSH   AX
46E8 2EA1D388       MOV    AX,CS:[88D3]
46EC 2BC6           SUB    AX,SI
46EE 2E0106D188     ADD    CS:[88D1],AX
46F3 58             POP    AX
46F4 2E8B36D388     MOV    SI,CS:[88D3]
46F9 2E803C00       CMP    Byte Ptr CS:[SI],00
46FD 7526           JNZ    4725
46FF 2E807CFF3A     CMP    Byte Ptr CS:[SI-01],3A        ;':'
4704 7509           JNZ    470F
4706 2EC706C4880900 MOV    Word Ptr CS:[88C4],0009
470D EB1F           JMP    472E
470F 26833F00       CMP    Word Ptr ES:[BX],+00
4713 7419           JZ     472E
4715 26F7070100     TEST   Word Ptr ES:[BX],0001
471A 7512           JNZ    472E
471C 2EC706C4880200 MOV    Word Ptr CS:[88C4],0002
4723 EB09           JMP    472E
4725 E89600         CALL   47BE
4728 F8             CLC
4729 EB0D           JMP    4738
472B F9             STC
472C EB0A           JMP    4738
472E 50             PUSH   AX
472F B003           MOV    AL,03
4731 B4FF           MOV    AH,FF
4733 E80300         CALL   4739
4736 58             POP    AX
4737 F8             CLC
4738 C3             RET

4739 57             PUSH   DI
473A 268B7F04       MOV    DI,ES:[BX+04]
473E 2E893EC888     MOV    CS:[88C8],DI
4743 268805         MOV    ES:[DI],AL
4746 26886501       MOV    ES:[DI+01],AH
474A 50             PUSH   AX
474B 2EA1D788       MOV    AX,CS:[88D7]
474F 26894502       MOV    ES:[DI+02],AX
4753 58             POP    AX
4754 3C01           CMP    AL,01
4756 750A           JNZ    4762
4758 26895504       MOV    ES:[DI+04],DX
475C 26894D06       MOV    ES:[DI+06],CX
4760 EB5A           JMP    47BC
4762 3C02           CMP    AL,02
4764 7506           JNZ    476C
4766 26895504       MOV    ES:[DI+04],DX
476A EB50           JMP    47BC
476C 3C07           CMP    AL,07
476E 74E8           JZ     4758
4770 3C08           CMP    AL,08
4772 74E4           JZ     4758
4774 3C06           CMP    AL,06
4776 7506           JNZ    477E
4778 26885504       MOV    ES:[DI+04],DL
477C EB3E           JMP    47BC
477E 3C04           CMP    AL,04
4780 750F           JNZ    4791
4782 2EA1D188       MOV    AX,CS:[88D1]
4786 40             INC    AX
4787 26894504       MOV    ES:[DI+04],AX
478B 268C5D06       MOV    ES:[DI+06],DS
478F EB2B           JMP    47BC
4791 26897504       MOV    ES:[DI+04],SI
4795 268C4D06       MOV    ES:[DI+06],CS
4799 50             PUSH   AX
479A 26F6470201     TEST   Byte Ptr ES:[BX+02],01
479F 7404           JZ     47A5
47A1 B004           MOV    AL,04
47A3 EB09           JMP    47AE
47A5 26F6470202     TEST   Byte Ptr ES:[BX+02],02
47AA 7405           JZ     47B1
47AC B002           MOV    AL,02
47AE E81301         CALL   48C4             ; p©evod textu na velk  p¡smena
47B1 58             POP    AX
47B2 26F6470210     TEST   Byte Ptr ES:[BX+02],10
47B7 7403           JZ     47BC
47B9 E8E200         CALL   489E
47BC 5F             POP    DI
47BD C3             RET

47BE 2EC6069D8900   MOV    Byte Ptr CS:[899D],00
47C4 50             PUSH   AX
47C5 268B07         MOV    AX,ES:[BX]
47C8 0BC0           OR     AX,AX
47CA 7518           JNZ    47E4
47CC 50             PUSH   AX
47CD 53             PUSH   BX
47CE 52             PUSH   DX
47CF 57             PUSH   DI
47D0 2EC706C4880900 MOV    Word Ptr CS:[88C4],0009
47D7 B4FF           MOV    AH,FF
47D9 B003           MOV    AL,03
47DB E85BFF         CALL   4739
47DE 5F             POP    DI
47DF 5A             POP    DX
47E0 5B             POP    BX
47E1 58             POP    AX
47E2 EB30           JMP    4814
47E4 A90010         TEST   AX,1000
47E7 7412           JZ     47FB
47E9 2EC706C4880000 MOV    Word Ptr CS:[88C4],0000
47F0 E88003         CALL   4B73
47F3 2E833EC48809   CMP    Word Ptr CS:[88C4],+09
47F9 7519           JNZ    4814
47FB A90008         TEST   AX,0800
47FE 7417           JZ     4817
4800 2EC706C4880000 MOV    Word Ptr CS:[88C4],0000
4807 E88E04         CALL   4C98
480A 2E833EC48809   CMP    Word Ptr CS:[88C4],+09
4810 7502           JNZ    4814
4812 EB03           JMP    4817
4814 EB6F           JMP    4885
4816 90             NOP
4817 A90080         TEST   AX,8000
481A 7412           JZ     482E
481C 2EC706C4880000 MOV    Word Ptr CS:[88C4],0000
4823 E82F01         CALL   4955
4826 2E833EC48809   CMP    Word Ptr CS:[88C4],+09
482C 7557           JNZ    4885
482E A90040         TEST   AX,4000
4831 7412           JZ     4845
4833 2EC706C4880000 MOV    Word Ptr CS:[88C4],0000
483A E8F400         CALL   4931
483D 2E833EC48809   CMP    Word Ptr CS:[88C4],+09
4843 7540           JNZ    4885
4845 A90001         TEST   AX,0100
4848 7415           JZ     485F
484A 2EC706C4880000 MOV    Word Ptr CS:[88C4],0000
4851 E89C05         CALL   4DF0
4854 E81F06         CALL   4E76
4857 2E833EC48809   CMP    Word Ptr CS:[88C4],+09
485D 7526           JNZ    4885
485F A90002         TEST   AX,0200
4862 7412           JZ     4876
4864 2EC706C4880000 MOV    Word Ptr CS:[88C4],0000
486B E88205         CALL   4DF0
486E 2E833EC48809   CMP    Word Ptr CS:[88C4],+09
4874 750F           JNZ    4885
4876 A90020         TEST   AX,2000
4879 740A           JZ     4885
487B 2EC706C4880000 MOV    Word Ptr CS:[88C4],0000
4882 E8E201         CALL   4A67
4885 2E803E9D8901   CMP    Byte Ptr CS:[899D],01
488B 750F           JNZ    489C
488D 2E833EC48800   CMP    Word Ptr CS:[88C4],+00
4893 7507           JNZ    489C
4895 2EC706C4880900 MOV    Word Ptr CS:[88C4],0009
489C 58             POP    AX
489D C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

489E 50             PUSH   AX
489F 56             PUSH   SI
48A0 2E8A04         MOV    AL,CS:[SI]
48A3 0AC0           OR     AL,AL
48A5 741A           JZ     48C1
48A7 3C3A           CMP    AL,3A                         ;':'
48A9 750D           JNZ    48B8
48AB 2E807C0100     CMP    Byte Ptr CS:[SI+01],00
48B0 7506           JNZ    48B8
48B2 2EC60400       MOV    Byte Ptr CS:[SI],00
48B6 EB09           JMP    48C1
48B8 E8E606         CALL   4FA1
48BB 7301           JNB    48BE
48BD 46             INC    SI
48BE 46             INC    SI
48BF EBDF           JMP    48A0
48C1 5E             POP    SI
48C2 58             POP    AX
48C3 C3             RET

; -----------------------------------------------------------------------------
;    P©evod textu ASCIIZ na velk  p¡smena
; -----------------------------------------------------------------------------

48C4 56             PUSH   SI
48C5 52             PUSH   DX
48C6 8AD0           MOV    DL,AL
48C8 2E8A04       * MOV    AL,CS:[SI]
48CB E8D306         CALL   4FA1
48CE 720C           JB     48DC
48D0 0AC0           OR     AL,AL
48D2 740C           JZ     48E0
48D4 E80C00         CALL   48E3             ; p©evod p¡smene na velk‚
48D7 2E8804         MOV    CS:[SI],AL
48DA EB01           JMP    48DD
48DC 46           * INC    SI
48DD 46           * INC    SI
48DE EBE8           JMP    48C8
48E0 5A             POP    DX
48E1 5E             POP    SI
48E2 C3             RET

; -----------------------------------------------------------------------------
;    P©evod p¡smene na velk‚
; -----------------------------------------------------------------------------

48E3 3C80           CMP    AL,80
48E5 730C           JNB    48F3             ; je znak > 80h
48E7 3C61           CMP    AL,61                         ;'a'
48E9 7245           JB     4930
48EB 3C7A           CMP    AL,7A                         ;'z'
48ED 7741           JA     4930
48EF 24DF           AND    AL,DF
48F1 EB3D           JMP    4930
48F3 53           * PUSH   BX
48F4 06             PUSH   ES
48F5 57             PUSH   DI
48F6 8D3E8F89       LEA    DI,[898F]
48FA 80FA04         CMP    DL,04
48FD 7404           JZ     4903
48FF 8D3E8A89       LEA    DI,[898A]
4903 2E3815         CMP    CS:[DI],DL
4906 7417           JZ     491F
4908 50             PUSH   AX
4909 51             PUSH   CX
490A 52             PUSH   DX
490B 0E             PUSH   CS
490C 07             POP    ES
490D B465           MOV    AH,65                         ;'e'
490F 8AC2           MOV    AL,DL
4911 BBFFFF         MOV    BX,FFFF
4914 B90500         MOV    CX,0005
4917 BAFFFF         MOV    DX,FFFF
491A CD21           INT    21               ; poskytnut¡ informac¡ COUNTRY
491C 5A             POP    DX
491D 59             POP    CX
491E 58             POP    AX
491F 2E8B5D01       MOV    BX,CS:[DI+01]
4923 2E8E4503       MOV    ES,CS:[DI+03]
4927 43             INC    BX
4928 43             INC    BX
4929 2C80           SUB    AL,80            ; offset v p©evodn¡ tabulce
492B 26D7           XLAT   ES:              ; p©evod p¡smene na velk‚
492D 5F             POP    DI
492E 07             POP    ES
492F 5B             POP    BX
4930 C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------

4931 50             PUSH   AX
4932 2E800ED08880   OR     Byte Ptr CS:[88D0],80
4938 2E8026D088FD   AND    Byte Ptr CS:[88D0],FD
493E 2E8A04         MOV    AL,CS:[SI]
4941 3C2B           CMP    AL,2B                         ;'+'
4943 740A           JZ     494F
4945 3C2D           CMP    AL,2D                         ;'-'
4947 7507           JNZ    4950
4949 2E800ED08802   OR     Byte Ptr CS:[88D0],02
494F 46             INC    SI
4950 E80200         CALL   4955
4953 58             POP    AX
4954 C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------


4955 50             PUSH   AX
4956 51             PUSH   CX
4957 52             PUSH   DX
4958 56             PUSH   SI
4959 33C9           XOR    CX,CX
495B 33D2           XOR    DX,DX
495D 53             PUSH   BX
495E 2E8A04         MOV    AL,CS:[SI]
4961 0AC0           OR     AL,AL
4963 7442           JZ     49A7
4965 E8F100         CALL   4A59             ; p©evod ‡¡slice ASCII na ‡¡slo
4968 7239           JB     49A3
496A 32E4           XOR    AH,AH
496C 8BE8           MOV    BP,AX
496E D1E2           SHL    DX,1
4970 D1D1           RCL    CX,1
4972 E8D200         CALL   4A47
4975 722C           JB     49A3
4977 8BDA           MOV    BX,DX
4979 8BC1           MOV    AX,CX
497B D1E2           SHL    DX,1
497D D1D1           RCL    CX,1
497F E8C500         CALL   4A47
4982 721F           JB     49A3
4984 D1E2           SHL    DX,1
4986 D1D1           RCL    CX,1
4988 E8BC00         CALL   4A47
498B 7216           JB     49A3
498D 03D3           ADD    DX,BX
498F 13C8           ADC    CX,AX
4991 E8B300         CALL   4A47
4994 720D           JB     49A3
4996 03D5           ADD    DX,BP
4998 83D100         ADC    CX,+00
499B E8A900         CALL   4A47
499E 7203           JB     49A3
49A0 46             INC    SI
49A1 EBBB           JMP    495E
49A3 5B             POP    BX
49A4 E98D00         JMP    4A34
49A7 5B             POP    BX
49A8 2EF606D08802   TEST   Byte Ptr CS:[88D0],02
49AE 740A           JZ     49BA
49B0 F7D1           NOT    CX
49B2 F7D2           NOT    DX
49B4 83C201         ADD    DX,+01
49B7 83D100         ADC    CX,+00
49BA 268B7706       MOV    SI,ES:[BX+06]
49BE 268A04         MOV    AL,ES:[SI]
49C1 3C00           CMP    AL,00
49C3 7507           JNZ    49CC
49C5 B001           MOV    AL,01
49C7 B4FF           MOV    AH,FF
49C9 EB74           JMP    4A3F
49CB 90             NOP
49CC 46             INC    SI
49CD 268A04         MOV    AL,ES:[SI]
49D0 3C00           CMP    AL,00
49D2 7460           JZ     4A34
49D4 46             INC    SI
49D5 2EF606D08880   TEST   Byte Ptr CS:[88D0],80
49DB 751E           JNZ    49FB
49DD 263B4C03       CMP    CX,ES:[SI+03]
49E1 7236           JB     4A19
49E3 7706           JA     49EB
49E5 263B5401       CMP    DX,ES:[SI+01]
49E9 722E           JB     4A19
49EB 263B4C07       CMP    CX,ES:[SI+07]
49EF 7728           JA     4A19
49F1 723A           JB     4A2D
49F3 263B5405       CMP    DX,ES:[SI+05]
49F7 7720           JA     4A19
49F9 EB32           JMP    4A2D
49FB 263B4C03       CMP    CX,ES:[SI+03]
49FF 7C18           JL     4A19
4A01 7F06           JG     4A09
4A03 263B5401       CMP    DX,ES:[SI+01]
4A07 7C10           JL     4A19
4A09 263B4C07       CMP    CX,ES:[SI+07]
4A0D 7F0A           JG     4A19
4A0F 7C1C           JL     4A2D
4A11 263B5405       CMP    DX,ES:[SI+05]
4A15 7F02           JG     4A19
4A17 EB14           JMP    4A2D
4A19 83C609         ADD    SI,+09
4A1C FEC8           DEC    AL
4A1E 75B5           JNZ    49D5
4A20 2EC706C4880600 MOV    Word Ptr CS:[88C4],0006
4A27 B001           MOV    AL,01
4A29 B4FF           MOV    AH,FF
4A2B EB12           JMP    4A3F
4A2D B001           MOV    AL,01
4A2F 268A24         MOV    AH,ES:[SI]
4A32 EB0B           JMP    4A3F
4A34 2EC706C4880900 MOV    Word Ptr CS:[88C4],0009
4A3B B003           MOV    AL,03
4A3D B4FF           MOV    AH,FF
4A3F E8F7FC         CALL   4739
4A42 5E             POP    SI
4A43 5A             POP    DX
4A44 59             POP    CX
4A45 58             POP    AX
4A46 C3             RET

4A47 9C             PUSHF
4A48 2EF606D08802   TEST   Byte Ptr CS:[88D0],02
4A4E 7502           JNZ    4A52
4A50 9D             POPF
4A51 C3             RET
4A52 9D             POPF
4A53 7002           JO     4A57
4A55 F8             CLC
4A56 C3             RET
4A57 F9             STC
4A58 C3             RET

; -----------------------------------------------------------------------------
;    p©evod ‡¡slice ASCII na ‡¡slo
; -----------------------------------------------------------------------------

4A59 3C30           CMP    AL,30                         ;'0'
4A5B 7208           JB     4A65
4A5D 3C39           CMP    AL,39                         ;'9'
4A5F 7704           JA     4A65
4A61 2C30           SUB    AL,30                         ;'0'
4A63 F8             CLC
4A64 C3             RET
4A65 F9             STC
4A66 C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------

4A67 50             PUSH   AX
4A68 53             PUSH   BX
4A69 52             PUSH   DX
4A6A 57             PUSH   DI
4A6B 268B7F06       MOV    DI,ES:[BX+06]
4A6F 268A05         MOV    AL,ES:[DI]
4A72 0AC0           OR     AL,AL
4A74 7504           JNZ    4A7A
4A76 B4FF           MOV    AH,FF
4A78 EB4C           JMP    4AC6
4A7A 3C03           CMP    AL,03
4A7C 753F           JNZ    4ABD
4A7E 47             INC    DI
4A7F 268A05         MOV    AL,ES:[DI]
4A82 B409           MOV    AH,09
4A84 F6E4           MUL    AH
4A86 40             INC    AX
4A87 03F8           ADD    DI,AX
4A89 268A05         MOV    AL,ES:[DI]
4A8C B405           MOV    AH,05
4A8E F6E4           MUL    AH
4A90 40             INC    AX
4A91 03F8           ADD    DI,AX
4A93 268A05         MOV    AL,ES:[DI]
4A96 47             INC    DI
4A97 47             INC    DI
4A98 268B2D         MOV    BP,ES:[DI]
4A9B E83200         CALL   4AD0
4A9E 7312           JNB    4AB2
4AA0 83C703         ADD    DI,+03
4AA3 FEC8           DEC    AL
4AA5 75F1           JNZ    4A98
4AA7 2EC706C4880800 MOV    Word Ptr CS:[88C4],0008
4AAE B4FF           MOV    AH,FF
4AB0 EB14           JMP    4AC6
4AB2 268A65FF       MOV    AH,ES:[DI-01]
4AB6 B002           MOV    AL,02
4AB8 268B15         MOV    DX,ES:[DI]
4ABB EB0B           JMP    4AC8
4ABD 2EC706C4880900 MOV    Word Ptr CS:[88C4],0009
4AC4 B4FF           MOV    AH,FF
4AC6 B003           MOV    AL,03
4AC8 E86EFC         CALL   4739
4ACB 5F             POP    DI
4ACC 5A             POP    DX
4ACD 5B             POP    BX
4ACE 58             POP    AX
4ACF C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------

4AD0 50             PUSH   AX
4AD1 55             PUSH   BP
4AD2 52             PUSH   DX
4AD3 56             PUSH   SI
4AD4 B202           MOV    DL,02
4AD6 2E8A04         MOV    AL,CS:[SI]
4AD9 E8C504         CALL   4FA1
4ADC 723C           JB     4B1A
4ADE E802FE         CALL   48E3             ; p©evod p¡smene na velk‚
4AE1 2EF606D08808   TEST   Byte Ptr CS:[88D0],08
4AE7 740D           JZ     4AF6
4AE9 3C3D           CMP    AL,3D                         ;'='
4AEB 751F           JNZ    4B0C
4AED 26807E0100     CMP    Byte Ptr ES:[BP+01],00
4AF2 7571           JNZ    4B65
4AF4 EB13           JMP    4B09
4AF6 2EF606D08810   TEST   Byte Ptr CS:[88D0],10
4AFC 740E           JZ     4B0C
4AFE 3C3A           CMP    AL,3A                         ;':'
4B00 750A           JNZ    4B0C
4B02 26807E0000     CMP    Byte Ptr ES:[BP+00],00
4B07 755C           JNZ    4B65
4B09 46             INC    SI
4B0A EB5C           JMP    4B68
4B0C 263A4600       CMP    AL,ES:[BP+00]
4B10 751D           JNZ    4B2F
4B12 0AC0           OR     AL,AL
4B14 7452           JZ     4B68
4B16 46             INC    SI
4B17 45             INC    BP
4B18 EB13           JMP    4B2D
4B1A 263A4600       CMP    AL,ES:[BP+00]
4B1E 7545           JNZ    4B65
4B20 46             INC    SI
4B21 2E8A04         MOV    AL,CS:[SI]
4B24 45             INC    BP
4B25 263A4600       CMP    AL,ES:[BP+00]
4B29 753A           JNZ    4B65
4B2B 46             INC    SI
4B2C 45             INC    BP
4B2D EBA7           JMP    4AD6
4B2F 2EF606D08840   TEST   Byte Ptr CS:[88D0],40         ;'@'
4B35 740F           JZ     4B46
4B37 26F747022000   TEST   Word Ptr ES:[BX+02],0020
4B3D 7407           JZ     4B46
4B3F 26807E0000     CMP    Byte Ptr ES:[BP+00],00
4B44 7422           JZ     4B68
4B46 26F7071000     TEST   Word Ptr ES:[BX],0010
4B4B 7418           JZ     4B65
4B4D 3C3A           CMP    AL,3A                         ;':'
4B4F 7509           JNZ    4B5A
4B51 26807E0000     CMP    Byte Ptr ES:[BP+00],00
4B56 750D           JNZ    4B65
4B58 EB0E           JMP    4B68
4B5A 3C00           CMP    AL,00
4B5C 7507           JNZ    4B65
4B5E 26807E003A     CMP    Byte Ptr ES:[BP+00],3A        ;':'
4B63 7403           JZ     4B68
4B65 F9             STC
4B66 EB06           JMP    4B6E
4B68 2E8936D388     MOV    CS:[88D3],SI
4B6D F8             CLC
4B6E 5E             POP    SI
4B6F 5A             POP    DX
4B70 5D             POP    BP
4B71 58             POP    AX
4B72 C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------


4B73 50             PUSH   AX
4B74 51             PUSH   CX
4B75 52             PUSH   DX
4B76 56             PUSH   SI
4B77 53             PUSH   BX
4B78 56             PUSH   SI
4B79 E8AA00         CALL   4C26
4B7C 5E             POP    SI
4B7D 2EC70682890000 MOV    Word Ptr CS:[8982],0000
4B84 2EC70684890000 MOV    Word Ptr CS:[8984],0000
4B8B 2EC70686890000 MOV    Word Ptr CS:[8986],0000
4B92 E8AD00         CALL   4C42
4B95 7218           JB     4BAF
4B97 2EA38289       MOV    CS:[8982],AX
4B9B 0ADB           OR     BL,BL
4B9D 741A           JZ     4BB9
4B9F E8A000         CALL   4C42
4BA2 726E           JB     4C12
4BA4 2EA38489       MOV    CS:[8984],AX
4BA8 0ADB           OR     BL,BL
4BAA 740D           JZ     4BB9
4BAC E89300         CALL   4C42
4BAF 7261           JB     4C12
4BB1 2EA38689       MOV    CS:[8986],AX
4BB5 0ADB           OR     BL,BL
4BB7 7559           JNZ    4C12
4BB9 2E8B1E6089     MOV    BX,CS:[8960]
4BBE 83FB02         CMP    BX,+02
4BC1 7422           JZ     4BE5
4BC3 2EA18289       MOV    AX,CS:[8982]
4BC7 0AE4           OR     AH,AH
4BC9 7547           JNZ    4C12
4BCB 8AC8           MOV    CL,AL
4BCD 2EA18489       MOV    AX,CS:[8984]
4BD1 0AE4           OR     AH,AH
4BD3 753D           JNZ    4C12
4BD5 8AE8           MOV    CH,AL
4BD7 2E8B168689     MOV    DX,CS:[8986]
4BDC 83FB01         CMP    BX,+01
4BDF 7502           JNZ    4BE3
4BE1 86E9           XCHG   CH,CL
4BE3 EB19           JMP    4BFE
4BE5 2E8B168289     MOV    DX,CS:[8982]
4BEA 2EA18489       MOV    AX,CS:[8984]
4BEE 0AE4           OR     AH,AH
4BF0 7520           JNZ    4C12
4BF2 8AC8           MOV    CL,AL
4BF4 2EA18689       MOV    AX,CS:[8986]
4BF8 0AE4           OR     AH,AH
4BFA 7516           JNZ    4C12
4BFC 8AE8           MOV    CH,AL
4BFE 83FA64         CMP    DX,+64
4C01 7304           JNB    4C07
4C03 81C26C07       ADD    DX,076C
4C07 5B             POP    BX
4C08 5E             POP    SI
4C09 B4FF           MOV    AH,FF
4C0B B007           MOV    AL,07
4C0D E829FB         CALL   4739
4C10 EB10           JMP    4C22

4C12 5B             POP    BX
4C13 5E             POP    SI
4C14 B4FF           MOV    AH,FF
4C16 B003           MOV    AL,03
4C18 E81EFB         CALL   4739
4C1B 2EC706C4880900 MOV    Word Ptr CS:[88C4],0009
4C22 5A             POP    DX
4C23 59             POP    CX
4C24 58             POP    AX
4C25 C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------

4C26 8D366089       LEA    SI,[8960]
4C2A 2E833CFF       CMP    Word Ptr CS:[SI],-01
4C2E 7402           JZ     4C32
4C30 EB0F           JMP    4C41

4C32 1E             PUSH   DS
4C33 52             PUSH   DX
4C34 50             PUSH   AX
4C35 0E             PUSH   CS
4C36 1F             POP    DS
4C37 B80038         MOV    AX,3800
4C3A 8BD6           MOV    DX,SI
4C3C CD21           INT    21               ; poskytnut¡ informac¡ COUNTRY
4C3E 58             POP    AX
4C3F 5A             POP    DX
4C40 1F             POP    DS
4C41 C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------

4C42 51             PUSH   CX
4C43 52             PUSH   DX
4C44 33C9           XOR    CX,CX
4C46 2E8A04         MOV    AL,CS:[SI]
4C49 0AC0           OR     AL,AL
4C4B 743C           JZ     4C89
4C4D 2E803E5F8900   CMP    Byte Ptr CS:[895F],00
4C53 740F           JZ     4C64
4C55 80FB01         CMP    BL,01
4C58 7504           JNZ    4C5E
4C5A 3C3A           CMP    AL,3A                         ;':'
4C5C 7430           JZ     4C8E
4C5E 3C2E           CMP    AL,2E                         ;'.'
4C60 742C           JZ     4C8E
4C62 EB0C           JMP    4C70
4C64 3C2D           CMP    AL,2D                         ;'-'
4C66 7426           JZ     4C8E
4C68 3C2F           CMP    AL,2F                         ;'/'
4C6A 7422           JZ     4C8E
4C6C 3C2E           CMP    AL,2E                         ;'.'
4C6E 741E           JZ     4C8E
4C70 E8E6FD         CALL   4A59             ; p©evod ‡¡slice ASCII na ‡¡slo
4C73 721E           JB     4C93
4C75 B400           MOV    AH,00
4C77 91             XCHG   AX,CX
4C78 BA0A00         MOV    DX,000A
4C7B F7E2           MUL    DX
4C7D 0BD2           OR     DX,DX
4C7F 7511           JNZ    4C92
4C81 03C1           ADD    AX,CX
4C83 720E           JB     4C93
4C85 91             XCHG   AX,CX
4C86 46             INC    SI
4C87 EBBD           JMP    4C46
4C89 8AD8           MOV    BL,AL
4C8B F8             CLC
4C8C EB05           JMP    4C93
4C8E 46             INC    SI
4C8F F8             CLC
4C90 EB01           JMP    4C93
4C92 F9             STC
4C93 8BC1           MOV    AX,CX
4C95 5A             POP    DX
4C96 59             POP    CX
4C97 C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------

4C98 50             PUSH   AX
4C99 51             PUSH   CX
4C9A 52             PUSH   DX
4C9B 56             PUSH   SI
4C9C 53             PUSH   BX
4C9D 56             PUSH   SI
4C9E E885FF         CALL   4C26
4CA1 2EF6441101     TEST   Byte Ptr CS:[SI+11],01
4CA6 5E             POP    SI
4CA7 7503           JNZ    4CAC
4CA9 E80101         CALL   4DAD
4CAC 2EC70682890000 MOV    Word Ptr CS:[8982],0000
4CB3 2EC70684890000 MOV    Word Ptr CS:[8984],0000
4CBA 2EC70686890000 MOV    Word Ptr CS:[8986],0000
4CC1 2EC70688890000 MOV    Word Ptr CS:[8988],0000
4CC8 2EC6065F8901   MOV    Byte Ptr CS:[895F],01
4CCE B301           MOV    BL,01
4CD0 E86FFF         CALL   4C42
4CD3 725D           JB     4D32
4CD5 2EA38289       MOV    CS:[8982],AX
4CD9 0ADB           OR     BL,BL
4CDB 745F           JZ     4D3C
4CDD E862FF         CALL   4C42
4CE0 7250           JB     4D32
4CE2 2EA38489       MOV    CS:[8984],AX
4CE6 0ADB           OR     BL,BL
4CE8 7452           JZ     4D3C
4CEA B302           MOV    BL,02
4CEC E853FF         CALL   4C42
4CEF 7241           JB     4D32
4CF1 2EA38689       MOV    CS:[8986],AX
4CF5 0ADB           OR     BL,BL
4CF7 7536           JNZ    4D2F
4CF9 2EF606CF8802   TEST   Byte Ptr CS:[88CF],02
4CFF 753B           JNZ    4D3C
4D01 2E8B36C688     MOV    SI,CS:[88C6]
4D06 807CFF2C       CMP    Byte Ptr [SI-01],2C           ;','
4D0A 7530           JNZ    4D3C
4D0C C644FF2E       MOV    Byte Ptr [SI-01],2E           ;'.'
4D10 2EC706CF880000 MOV    Word Ptr CS:[88CF],0000
4D17 2E800ECF8802   OR     Byte Ptr CS:[88CF],02
4D1D 2E8B0E5989     MOV    CX,CS:[8959]
4D22 2E8B265B89     MOV    SP,CS:[895B]
4D27 2E8B365D89     MOV    SI,CS:[895D]
4D2C E9CEF7         JMP    44FD
4D2F E810FF         CALL   4C42
4D32 725F           JB     4D93
4D34 2EA38889       MOV    CS:[8988],AX
4D38 0ADB           OR     BL,BL
4D3A 7557           JNZ    4D93
4D3C 2EA18289       MOV    AX,CS:[8982]
4D40 0AE4           OR     AH,AH
4D42 754F           JNZ    4D93
4D44 2EF606CF8801   TEST   Byte Ptr CS:[88CF],01
4D4A 7408           JZ     4D54
4D4C 3C0C           CMP    AL,0C
4D4E 7743           JA     4D93
4D50 7502           JNZ    4D54
4D52 32C0           XOR    AL,AL
4D54 2EF606D08804   TEST   Byte Ptr CS:[88D0],04
4D5A 740C           JZ     4D68
4D5C 3C0C           CMP    AL,0C
4D5E 7408           JZ     4D68
4D60 040C           ADD    AL,0C
4D62 722F           JB     4D93
4D64 3C18           CMP    AL,18
4D66 772B           JA     4D93
4D68 8AD0           MOV    DL,AL
4D6A 2EA18489       MOV    AX,CS:[8984]
4D6E 0AE4           OR     AH,AH
4D70 7521           JNZ    4D93
4D72 8AF0           MOV    DH,AL
4D74 2EA18689       MOV    AX,CS:[8986]
4D78 0AE4           OR     AH,AH
4D7A 7517           JNZ    4D93
4D7C 8AC8           MOV    CL,AL
4D7E 2EA18889       MOV    AX,CS:[8988]
4D82 0AE4           OR     AH,AH
4D84 750D           JNZ    4D93
4D86 8AE8           MOV    CH,AL
4D88 5B             POP    BX
4D89 5E             POP    SI
4D8A B4FF           MOV    AH,FF
4D8C B008           MOV    AL,08
4D8E E8A8F9         CALL   4739
4D91 EB10           JMP    4DA3
4D93 5B             POP    BX
4D94 5E             POP    SI
4D95 B4FF           MOV    AH,FF
4D97 B003           MOV    AL,03
4D99 E89DF9         CALL   4739
4D9C 2EC706C4880900 MOV    Word Ptr CS:[88C4],0009
4DA3 2EC6065F8900   MOV    Byte Ptr CS:[895F],00
4DA9 5A             POP    DX
4DAA 59             POP    CX
4DAB 58             POP    AX
4DAC C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------


4DAD 50             PUSH   AX
4DAE 56             PUSH   SI
4DAF 2E8A04         MOV    AL,CS:[SI]
4DB2 46             INC    SI
4DB3 0AC0           OR     AL,AL
4DB5 75F8           JNZ    4DAF
4DB7 2E8A44FE       MOV    AL,CS:[SI-02]
4DBB 0C20           OR     AL,20                         ;' '
4DBD 3C70           CMP    AL,70                         ;'p'
4DBF 7419           JZ     4DDA
4DC1 3C61           CMP    AL,61                         ;'a'
4DC3 741D           JZ     4DE2
4DC5 3C6D           CMP    AL,6D                         ;'m'
4DC7 7524           JNZ    4DED
4DC9 4E             DEC    SI
4DCA 2E8A44FE       MOV    AL,CS:[SI-02]
4DCE 0C20           OR     AL,20                         ;' '
4DD0 3C70           CMP    AL,70                         ;'p'
4DD2 7406           JZ     4DDA
4DD4 3C61           CMP    AL,61                         ;'a'
4DD6 740A           JZ     4DE2
4DD8 EB13           JMP    4DED
4DDA 2E800ED08804   OR     Byte Ptr CS:[88D0],04
4DE0 EB06           JMP    4DE8
4DE2 2E800ECF8801   OR     Byte Ptr CS:[88CF],01
4DE8 2EC644FE00     MOV    Byte Ptr CS:[SI-02],00
4DED 5E             POP    SI
4DEE 58             POP    AX
4DEF C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------


4DF0 50             PUSH   AX
4DF1 57             PUSH   DI
4DF2 56             PUSH   SI
4DF3 2E8B3ED188     MOV    DI,CS:[88D1]
4DF8 2E8A04         MOV    AL,CS:[SI]
4DFB 0AC0           OR     AL,AL
4DFD 7413           JZ     4E12
4DFF E85F00         CALL   4E61
4E02 7524           JNZ    4E28
4E04 2EC6069D8901   MOV    Byte Ptr CS:[899D],01
4E0A 5E             POP    SI
4E0B 2EC60400       MOV    Byte Ptr CS:[SI],00
4E0F 5F             POP    DI
4E10 EB3F           JMP    4E51
4E12 5E             POP    SI
4E13 2EC60400       MOV    Byte Ptr CS:[SI],00
4E17 5F             POP    DI
4E18 26F7070100     TEST   Word Ptr ES:[BX],0001
4E1D 7532           JNZ    4E51
4E1F 2EC706C4880200 MOV    Word Ptr CS:[88C4],0002
4E26 EB29           JMP    4E51
4E28 58             POP    AX
4E29 56             PUSH   SI
4E2A 2E8A04         MOV    AL,CS:[SI]
4E2D 0AC0           OR     AL,AL
4E2F 741E           JZ     4E4F
4E31 E82D00         CALL   4E61
4E34 740B           JZ     4E41
4E36 E86801         CALL   4FA1
4E39 7302           JNB    4E3D
4E3B 47             INC    DI
4E3C 46             INC    SI
4E3D 47             INC    DI
4E3E 46             INC    SI
4E3F EBE9           JMP    4E2A
4E41 2EA2CA88       MOV    CS:[88CA],AL
4E45 2EC60400       MOV    Byte Ptr CS:[SI],00
4E49 47             INC    DI
4E4A 2E893EC688     MOV    CS:[88C6],DI
4E4F 5E             POP    SI
4E50 5F             POP    DI
4E51 58             POP    AX
4E52 A90002         TEST   AX,0200
4E55 7409           JZ     4E60
4E57 50             PUSH   AX
4E58 B4FF           MOV    AH,FF
4E5A B005           MOV    AL,05
4E5C E8DAF8         CALL   4739
4E5F 58             POP    AX
4E60 C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------


4E61 53             PUSH   BX
4E62 51             PUSH   CX
4E63 8D1E9489       LEA    BX,[8994]
4E67 B90900         MOV    CX,0009
4E6A 2E3A07         CMP    AL,CS:[BX]
4E6D 7404           JZ     4E73
4E6F 43             INC    BX
4E70 E2F8           LOOP   4E6A
4E72 41             INC    CX
4E73 59             POP    CX
4E74 5B             POP    BX
4E75 C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------

4E76 50             PUSH   AX
4E77 52             PUSH   DX
4E78 2E8A04         MOV    AL,CS:[SI]
4E7B 0AC0           OR     AL,AL
4E7D 7438           JZ     4EB7
4E7F E81F01         CALL   4FA1
4E82 722C           JB     4EB0
4E84 2E837C013A     CMP    Word Ptr CS:[SI+01],+3A
4E89 740E           JZ     4E99
4E8B 26F7071000     TEST   Word Ptr ES:[BX],0010
4E90 741E           JZ     4EB0
4E92 2E807C0100     CMP    Byte Ptr CS:[SI+01],00
4E97 7517           JNZ    4EB0
4E99 0C20           OR     AL,20                         ;' '
4E9B 3C61           CMP    AL,61                         ;'a'
4E9D 7211           JB     4EB0
4E9F 3C7A           CMP    AL,7A                         ;'z'
4EA1 770D           JA     4EB0
4EA3 2C60           SUB    AL,60                         ;'`'
4EA5 8AD0           MOV    DL,AL
4EA7 B4FF           MOV    AH,FF
4EA9 B006           MOV    AL,06
4EAB E88BF8         CALL   4739
4EAE EB07           JMP    4EB7
4EB0 2EC706C4880900 MOV    Word Ptr CS:[88C4],0009
4EB7 5A             POP    DX
4EB8 58             POP    AX
4EB9 C3             RET

; -----------------------------------------------------------------------------
;    Test znaku
; -----------------------------------------------------------------------------

4EBA AC             LODSB                   ; znak z textu
4EBB E82200         CALL   4EE0             ; porovn n¡ textu s tabulkou
4EBE 7418           JZ     4ED8
4EC0 E84F00         CALL   4F12
4EC3 7516           JNZ    4EDB
4EC5 2EF606D08820   TEST   Byte Ptr CS:[88D0],20         ;' '
4ECB 74ED           JZ     4EBA
4ECD 2EF606D08841   TEST   Byte Ptr CS:[88D0],41         ;'A'
4ED3 7409           JZ     4EDE
4ED5 4E             DEC    SI
4ED6 EB06           JMP    4EDE

4ED8 F9           * STC
4ED9 EB01           JMP    4EDC

4EDB F8           * CLC
4EDC 4E           * DEC    SI
4EDD C3             RET

4EDE F8           * CLC
4EDF C3             RET

; -----------------------------------------------------------------------------
;    Porovn n¡ textu
; -----------------------------------------------------------------------------

4EE0 53             PUSH   BX
4EE1 51             PUSH   CX
4EE2 3C0D           CMP    AL,0D            ; je konec © dku ?
4EE4 7429           JE     4F0F             ; je konec © dku
4EE6 3C00           CMP    AL,00            ; je konec textu ?
4EE8 7425           JE     4F0F             ; je konec textu
4EEA 26807D0202     CMP    Byte Ptr ES:[DI+02],02 ;
4EEF 721E           JB     4F0F
4EF1 33DB           XOR    BX,BX            ; BX <- 0
4EF3 268A5D03       MOV    BL,ES:[DI+03]
4EF7 83C304         ADD    BX,+04
4EFA 26803900       CMP    Byte Ptr ES:[BX+DI],00
4EFE 740D           JZ     4F0D
4F00 33C9           XOR    CX,CX
4F02 268A09         MOV    CL,ES:[BX+DI]

4F05 43           * INC    BX
4F06 263A01         CMP    AL,ES:[BX+DI]
4F09 7404           JZ     4F0F
4F0B E2F8           LOOP   4F05
4F0D 3C0D         * CMP    AL,0D

4F0F 59           * POP    CX
4F10 5B             POP    BX
4F11 C3             RET

; -----------------------------------------------------------------------------


4F12 53             PUSH   BX
4F13 51             PUSH   CX
4F14 2EC606CA8820   MOV    Byte Ptr CS:[88CA],20         ;' '
4F1A 2E8026D088DF   AND    Byte Ptr CS:[88D0],DF
4F20 3C20           CMP    AL,20            ; je mezera ?
4F22 7436           JZ     4F5A             ; je mezera
4F24 3C09           CMP    AL,09            ; je tabel tor ?
4F26 7432           JZ     4F5A             ; je tabel tor
4F28 3C2C           CMP    AL,","           ; je ‡ rka ?
4F2A 7431           JZ     4F5D             ; je ‡ rka
4F2C 3C20           CMP    AL,20                         ;' '
4F2E 750C           JNZ    4F3C
4F30 803C20         CMP    Byte Ptr [SI],20              ;' '
4F33 7507           JNZ    4F3C
4F35 B020           MOV    AL,20                         ;' '
4F37 46             INC    SI
4F38 3AC0           CMP    AL,AL
4F3A EB1E           JMP    4F5A
4F3C 26807D0201     CMP    Byte Ptr ES:[DI+02],01
4F41 7217           JB     4F5A
4F43 33C9           XOR    CX,CX
4F45 268A4D03       MOV    CL,ES:[DI+03]
4F49 0BC9           OR     CX,CX
4F4B 740B           JZ     4F58
4F4D BB0300         MOV    BX,0003
4F50 43           * INC    BX
4F51 263A01         CMP    AL,ES:[BX+DI]
4F54 7407           JZ     4F5D
4F56 E2F8           LOOP   4F50
4F58 3C20           CMP    AL,20                         ;' '
4F5A 59           * POP    CX
4F5B 5B             POP    BX
4F5C C3             RET

; -----------------------------------------------------------------------------

4F5D 2EA2CA88       MOV    CS:[88CA],AL
4F61 2EF606D08801   TEST   Byte Ptr CS:[88D0],01
4F67 7506           JNZ    4F6F
4F69 2E800ED08820   OR     Byte Ptr CS:[88D0],20         ;' '
4F6F 3AC0           CMP    AL,AL
4F71 EBE7           JMP    4F5A

4F73 8D2ED988       LEA    BP,[88D9]
4F77 3BDD           CMP    BX,BP
4F79 741A           JZ     4F95
4F7B 3C2F           CMP    AL,2F                         ;'/'
4F7D 7513           JNZ    4F92
4F7F F9             STC
4F80 50             PUSH   AX
4F81 2E8A47FF       MOV    AL,CS:[BX-01]
4F85 E8D1FA         CALL   4A59             ; p©evod ‡¡slice ASCII na ‡¡slo
4F88 7205           JB     4F8F
4F8A 8A04           MOV    AL,[SI]
4F8C E8CAFA         CALL   4A59             ; p©evod ‡¡slice ASCII na ‡¡slo
4F8F 58             POP    AX
4F90 EB0E           JMP    4FA0
4F92 F8             CLC
4F93 EB0B           JMP    4FA0
4F95 3C2F           CMP    AL,2F                         ;'/'
4F97 7506           JNZ    4F9F
4F99 2E800ED08840   OR     Byte Ptr CS:[88D0],40         ;'@'
4F9F F8             CLC
4FA0 C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------

4FA1 1E             PUSH   DS
4FA2 56             PUSH   SI
4FA3 53             PUSH   BX
4FA4 2E833ECD8800   CMP    Word Ptr CS:[88CD],+00
4FAA 7527           JNZ    4FD3
4FAC 50             PUSH   AX
4FAD 1E             PUSH   DS
4FAE 51             PUSH   CX
4FAF 52             PUSH   DX
4FB0 57             PUSH   DI
4FB1 55             PUSH   BP
4FB2 06             PUSH   ES
4FB3 33F6           XOR    SI,SI
4FB5 8EDE           MOV    DS,SI
4FB7 B80063         MOV    AX,6300
4FBA CD21           INT    21               ; poskytnut¡ ukazatele LEAD tabulky
4FBC 8CDB           MOV    BX,DS
4FBE 0BDB           OR     BX,BX
4FC0 07             POP    ES
4FC1 5D             POP    BP
4FC2 5F             POP    DI
4FC3 5A             POP    DX
4FC4 59             POP    CX
4FC5 1F             POP    DS
4FC6 58             POP    AX
4FC7 7429           JZ     4FF2
4FC9 2E8936CB88     MOV    CS:[88CB],SI
4FCE 2E891ECD88     MOV    CS:[88CD],BX
4FD3 2E8B36CB88     MOV    SI,CS:[88CB]
4FD8 2E8E1ECD88     MOV    DS,CS:[88CD]
4FDD 833C00         CMP    Word Ptr [SI],+00
4FE0 7410           JZ     4FF2
4FE2 3A04           CMP    AL,[SI]
4FE4 7208           JB     4FEE
4FE6 3A4401         CMP    AL,[SI+01]
4FE9 7703           JA     4FEE
4FEB F9             STC
4FEC EB05           JMP    4FF3
4FEE 46             INC    SI
4FEF 46             INC    SI
4FF0 EBEB           JMP    4FDD

4FF2 F8             CLC
4FF3 5B             POP    BX
4FF4 5E             POP    SI
4FF5 1F             POP    DS
4FF6 C3             RET

; -----------------------------------------------------------------------------
;    Rozbor p©¡kazov‚ho © dku
; -----------------------------------------------------------------------------

4FF7 E8EDF4         CALL   44E7
4FFA C3             RET

; -----------------------------------------------------------------------------
;    Vnˆj¨¡ vol n¡ - rozbor parametr–
; -----------------------------------------------------------------------------

4FFB E8E9F4         CALL   44E7
4FFE CB             RETF

4FFF E81000         CALL   5012
5002 CB             RETF

5003 E80C00         CALL   5012
5006 E8AED6         CALL   26B7
5009 C3             RET

500A C706A38A0200   MOV    Word Ptr [8AA3],0002
5010 EB06           JMP    5018

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

5012 C706A38A0100   MOV    Word Ptr [8AA3],0001

5018 50           * PUSH   AX
5019 53             PUSH   BX
501A 51             PUSH   CX
501B 06             PUSH   ES
501C 1E             PUSH   DS
501D 07             POP    ES               ; ES <- DS
501E 57             PUSH   DI
501F 56             PUSH   SI
5020 52             PUSH   DX
5021 C706EC900000   MOV    Word Ptr [90EC],0000
5027 8BF2           MOV    SI,DX            ; tabulka popisu chyby
5029 AD             LODSW                   ; k¢d chyby
502A 50             PUSH   AX
502B AC             LODSB                   ; ‡¡slo parametru hl ¨en¡
502C 8AC8           MOV    CL,AL            ; ‡¡slo parametru
502E 32ED           XOR    CH,CH
5030 58             POP    AX
5031 83F900         CMP    CX,+00
5034 7461           JZ     5097
5036 BFEE90         MOV    DI,90EE
5039 57             PUSH   DI
503A 51             PUSH   CX
503B 51             PUSH   CX
503C 8BDE           MOV    BX,SI
503E B90B00         MOV    CX,000B
5041 F3             REPZ
5042 A4             MOVSB
5043 F6470704       TEST   Byte Ptr [BX+07],04
5047 740A           JZ     5053
5049 C747020000     MOV    Word Ptr [BX+02],0000
504E C747040000     MOV    Word Ptr [BX+04],0000
5053 59             POP    CX
5054 E2E5           LOOP   503B
5056 59             POP    CX
5057 50             PUSH   AX
5058 803E1182FF     CMP    Byte Ptr [8211],FF
505D 740C           JZ     506B
505F C606E89001     MOV    Byte Ptr [90E8],01
5064 BF1382         MOV    DI,8213          ; adresa tabulky popisu chyby
5067 33C0           XOR    AX,AX
5069 AB             STOSW
506A AA             STOSB
506B 58             POP    AX
506C 5F             POP    DI
506D 8BF7           MOV    SI,DI
506F 8BDE           MOV    BX,SI
5071 51             PUSH   CX
5072 837F0400     * CMP    Word Ptr [BX+04],+00
5076 7509           JNZ    5081
5078 F6470704       TEST   Byte Ptr [BX+07],04
507C 7503           JNZ    5081
507E 8C4F04         MOV    [BX+04],CS
5081 83C30B         ADD    BX,+0B
5084 E2EC           LOOP   5072
5086 59             POP    CX
5087 8BDE           MOV    BX,SI
5089 817F02658F     CMP    Word Ptr [BX+02],8F65 ; adresa jm‚na souboru p©i chybˆ
508E 7507           JNZ    5097
5090 8B16658F       MOV    DX,[8F65]        ; adresa jm‚na souboru p©i chybˆ
5094 895702         MOV    [BX+02],DX
5097 8B1EA38A       MOV    BX,[8AA3]
509B 8A161282       MOV    DL,[8212]
509F 8A361182       MOV    DH,[8211]
50A3 C606128200     MOV    Byte Ptr [8212],00
50A8 C6061182FF     MOV    Byte Ptr [8211],FF
50AD 1E             PUSH   DS
50AE 06             PUSH   ES
50AF E85502         CALL   5307
50B2 07             POP    ES
50B3 1F             POP    DS
50B4 7303           JNB    50B9
50B6 A3EC90         MOV    [90EC],AX
50B9 5A             POP    DX
50BA 5E             POP    SI
50BB 5F             POP    DI
50BC 07             POP    ES
50BD 59             POP    CX
50BE 5B             POP    BX
50BF 58             POP    AX
50C0 833EEC9000     CMP    Word Ptr [90EC],+00
50C5 7501           JNZ    50C8
50C7 C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------


50C8 0E             PUSH   CS
50C9 07             POP    ES
50CA 833EA38A02     CMP    Word Ptr [8AA3],+02
50CF 7503           JNZ    50D4
50D1 E930B0         JMP    0104
50D4 A1EC90         MOV    AX,[90EC]
50D7 8E06778D       MOV    ES,[8D77]        ; segment 1. ‡ sti COMMAND.COM
50DB 26F6061E03FF   TEST   Byte Ptr ES:[031E],FF
50E1 7408           JZ     50EB
50E3 E8C7DF         CALL   30AD
50E6 BA7483         MOV    DX,8374
50E9 EB0B           JMP    50F6

50EB C606118201     MOV    Byte Ptr [8211],01
50F0 BA1382         MOV    DX,8213          ; adresa tabulky popisu chyby
50F3 A31382         MOV    [8213],AX        ; k¢d chyby
50F6 0E             PUSH   CS
50F7 07             POP    ES
50F8 E950D9         JMP    2A4B

; -----------------------------------------------------------------------------
;    Inicializace syst‚mov˜ch tabulek
; -----------------------------------------------------------------------------

50FB 53             PUSH   BX
50FC E80800         CALL   5107             ; instalace syst‚mov˜ch tabulek
50FF 5B             POP    BX
5100 C3             RET

; -----------------------------------------------------------------------------

5101 51             PUSH   CX
5102 E8BE00         CALL   51C3
5105 59             POP    CX
5106 C3             RET

; -----------------------------------------------------------------------------
;    Instalace tabulek syst‚mov˜ch hl ¨en¡
; -----------------------------------------------------------------------------

5107 50             PUSH   AX
5108 53             PUSH   BX
5109 52             PUSH   DX
510A 06             PUSH   ES
510B 57             PUSH   DI

510C 33C9           XOR    CX,CX
510E 8EC1           MOV    ES,CX
5110 33FF           XOR    DI,DI

5112 B82E12         MOV    AX,122E
5115 B200           MOV    DL,00
5117 CD2F           INT    2F               ; tabulka syst. hl ¨en¡ 0
5119 8C06A889       MOV    [89A8],ES
511D 893EA689       MOV    [89A6],DI

5121 B82E12         MOV    AX,122E
5124 B202           MOV    DL,02
5126 CD2F           INT    2F               ; tabulka syst. hl ¨en¡ 2
5128 8C06B089       MOV    [89B0],ES
512C 893EAE89       MOV    [89AE],DI

5130 B82E12         MOV    AX,122E
5133 B204           MOV    DL,04
5135 CD2F           INT    2F               ; tabulka syst. hl ¨en¡ 4
5137 8C06C089       MOV    [89C0],ES
513B 893EBE89       MOV    [89BE],DI

513F B82E12         MOV    AX,122E
5142 B206           MOV    DL,06
5144 CD2F           INT    2F               ; tabulka syst. hl ¨en¡ 6
5146 8C06A489       MOV    [89A4],ES
514A 893EA289       MOV    [89A2],DI

514E E89530         CALL   81E6
5151 8C06A089       MOV    [89A0],ES
5155 893E9E89       MOV    [899E],DI
5159 8C06BC89       MOV    [89BC],ES
515D 893EBA89       MOV    [89BA],DI

5161 E8A330         CALL   8207
5164 8C06B489       MOV    [89B4],ES
5168 893EB289       MOV    [89B2],DI

516C B82E12         MOV    AX,122E
516F B208           MOV    DL,08
5171 CD2F           INT    2F               ; tabulka syst. hl ¨en¡ 8
5173 8C06C889       MOV    [89C8],ES
5177 893EC689       MOV    [89C6],DI

517B C706E1890D0A   MOV    Word Ptr [89E1],0A0D
5181 C6062A8A24     MOV    Byte Ptr [8A2A],24            ;'$'
5186 C706E6890000   MOV    Word Ptr [89E6],0000
518C C706E8890A00   MOV    Word Ptr [89E8],000A ; dekadick  soustava
5192 E8EE2F         CALL   8183
5195 893ECA89       MOV    [89CA],DI
5199 E80F00         CALL   51AB             ; instalace tabulky LEAD
519C F8             CLC
519D 7207           JB     51A6
519F 5F             POP    DI
51A0 07             POP    ES
51A1 5A             POP    DX
51A2 5B             POP    BX
51A3 58             POP    AX
51A4 EB04           JMP    51AA
51A6 83C40A       * ADD    SP,+0A
51A9 F9             STC
51AA C3             RET

; -----------------------------------------------------------------------------
;    Instalace tabulky LEAD
; -----------------------------------------------------------------------------

51AB 50             PUSH   AX
51AC 56             PUSH   SI
51AD 1E             PUSH   DS
51AE B80063         MOV    AX,6300
51B1 CD21           INT    21               ; poskytnut¡ tabulky LEAD
51B3 1E             PUSH   DS
51B4 07             POP    ES
51B5 1F             POP    DS
51B6 7208           JB     51C0
51B8 8936DA89       MOV    [89DA],SI        ; adresa tabulky LEAD
51BC 8C06DC89       MOV    [89DC],ES
51C0 5E             POP    SI
51C1 58             POP    AX
51C2 C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

51C3 50             PUSH   AX
51C4 06             PUSH   ES
51C5 57             PUSH   DI
51C6 55             PUSH   BP
51C7 E81500         CALL   51DF
51CA 720E           JB     51DA
51CC 80FEFF         CMP    DH,FF
51CF F8             CLC
51D0 7404           JZ     51D6
51D2 06             PUSH   ES
51D3 1F             POP    DS
51D4 EB02           JMP    51D8
51D6 0E             PUSH   CS
51D7 1F             POP    DS
51D8 8BF7           MOV    SI,DI
51DA 5D             POP    BP
51DB 5F             POP    DI
51DC 07             POP    ES
51DD 58             POP    AX
51DE C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------

51DF 56             PUSH   SI
51E0 53             PUSH   BX
51E1 33F6           XOR    SI,SI
51E3 33C9           XOR    CX,CX
51E5 80FEFF         CMP    DH,FF
51E8 7508           JNZ    51F2
51EA 8BBCCA89       MOV    DI,[SI+89CA]
51EE 8BDF           MOV    BX,DI
51F0 EB25           JMP    5217
51F2 F6C602         TEST   DH,02
51F5 7408           JZ     51FF
51F7 C4BCAE89       LES    DI,[SI+89AE]
51FB 8CC3           MOV    BX,ES
51FD EB18           JMP    5217
51FF 3D1300         CMP    AX,0013
5202 720D           JB     5211
5204 3D2700         CMP    AX,0027
5207 7708           JA     5211
5209 C4BCBA89       LES    DI,[SI+89BA]
520D 8CC3           MOV    BX,ES
520F EB06           JMP    5217
5211 C4BC9E89       LES    DI,[SI+899E]
5215 8CC3           MOV    BX,ES
5217 83FBFF         CMP    BX,-01
521A 7516           JNZ    5232
521C 80FEFF         CMP    DH,FF
521F 7503           JNZ    5224
5221 F9             STC
5222 EB0C           JMP    5230
5224 A3E689         MOV    [89E6],AX
5227 B8FFFF         MOV    AX,FFFF
522A BD0100         MOV    BP,0001
522D 33F6           XOR    SI,SI
522F F8             CLC
5230 EB0C           JMP    523E
5232 83FB00         CMP    BX,+00
5235 7403           JZ     523A
5237 E85400         CALL   528E
523A 83C604         ADD    SI,+04
523D F8             CLC
523E 7206           JB     5246
5240 0BC9           OR     CX,CX
5242 7502           JNZ    5246
5244 EB9F           JMP    51E5
5246 9C             PUSHF
5247 80FE01         CMP    DH,01
524A 7529           JNZ    5275

524C 52             PUSH   DX
524D 55             PUSH   BP
524E 51             PUSH   CX
524F 06             PUSH   ES
5250 57             PUSH   DI
5251 50             PUSH   AX
5252 B80005         MOV    AX,0500
5255 CD2F           INT    2F               ; test instalace ovlada‡e INT 24h
5257 3CFF           CMP    AL,FF            ; je ovlada‡ INT 24h nainstalov n ?
5259 58             POP    AX
525A 7509           JNZ    5265             ; ovlada‡ INT 24h nen¡ nainstalov n
525C 8BD8           MOV    BX,AX
525E B80205         MOV    AX,0502          ; obsluha chyby - soubor nenalezen
5261 CD2F           INT    2F               ; chyba - soubor nenalezen
5263 EB01           JMP    5266

5265 F9           * STC
5266 7305         * JNB    526D
5268 5F             POP    DI
5269 07             POP    ES
526A 59             POP    CX
526B EB06           JMP    5273

526D 83C406       * ADD    SP,+06
5270 E80C00         CALL   527F             ; zji¨tˆn¡ d‚lky textu ASCIIZ
5273 5D             POP    BP
5274 5A             POP    DX
5275 EB01           JMP    5278
5277 CF             IRET


5278 0E           * PUSH   CS
5279 E8FBFF         CALL   5277
527C 5B             POP    BX
527D 5E             POP    SI
527E C3             RET

; -----------------------------------------------------------------------------
;    Zji¨tˆn¡ d‚lky textu ASCIIZ
; -----------------------------------------------------------------------------

527F 57             PUSH   DI
5280 50             PUSH   AX
5281 B9FFFF         MOV    CX,FFFF
5284 32C0           XOR    AL,AL
5286 F2             REPNZ
5287 AE             SCASB
5288 F7D1           NOT    CX
528A 49             DEC    CX
528B 58             POP    AX
528C 5F             POP    DI
528D C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------


528E 83FB01         CMP    BX,+01
5291 751D           JNZ    52B0
5293 833EC689FF     CMP    Word Ptr [89C6],-01
5298 7416           JZ     52B0
529A 3DFFFF         CMP    AX,FFFF
529D 750B           JNZ    52AA
529F 50             PUSH   AX
52A0 A1E689         MOV    AX,[89E6]
52A3 FF1EC689       CALL   FAR [89C6]
52A7 58             POP    AX
52A8 EB04           JMP    52AE
52AA FF1EC689       CALL   FAR [89C6]
52AE EB1A           JMP    52CA
52B0 33C9           XOR    CX,CX
52B2 80FEFF         CMP    DH,FF
52B5 7406           JZ     52BD
52B7 268A4D03       MOV    CL,ES:[DI+03]
52BB EB09           JMP    52C6
52BD 2E3835         CMP    CS:[DI],DH
52C0 7504           JNZ    52C6
52C2 2E8A4D03       MOV    CL,CS:[DI+03]
52C6 83C704         ADD    DI,+04
52C9 F9             STC
52CA 732D           JNB    52F9
52CC F8             CLC
52CD 0BC9           OR     CX,CX
52CF 7419           JZ     52EA
52D1 80FEFF         CMP    DH,FF
52D4 7405           JZ     52DB
52D6 263B05         CMP    AX,ES:[DI]
52D9 EB03           JMP    52DE
52DB 2E3B05         CMP    AX,CS:[DI]
52DE 7502           JNZ    52E2
52E0 EB09           JMP    52EB
52E2 49             DEC    CX
52E3 7405           JZ     52EA
52E5 83C704         ADD    DI,+04
52E8 EBE3           JMP    52CD

52EA F9             STC
52EB 720C           JB     52F9
52ED 80FEFF         CMP    DH,FF
52F0 F8             CLC
52F1 7502           JNZ    52F5
52F3 0E             PUSH   CS
52F4 07             POP    ES
52F5 26037D02       ADD    DI,ES:[DI+02]
52F9 7206           JB     5301
52FB 32ED           XOR    CH,CH
52FD 268A0D         MOV    CL,ES:[DI]
5300 47             INC    DI
5301 C606E08900     MOV    Byte Ptr [89E0],00
5306 C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

5307 50             PUSH   AX
5308 53             PUSH   BX
5309 51             PUSH   CX
530A 55             PUSH   BP
530B 57             PUSH   DI
530C 06             PUSH   ES
530D 52             PUSH   DX
530E 8BE9           MOV    BP,CX
5310 891EDE89       MOV    [89DE],BX
5314 8836E389       MOV    [89E3],DH
5318 E8C4FE         CALL   51DF
531B 0BC9           OR     CX,CX
531D 741C           JZ     533B
531F 0BED           OR     BP,BP
5321 7505           JNZ    5328
5323 E82600         CALL   534C
5326 EB03           JMP    532B

5328 E8B001         CALL   54DB
532B 7208           JB     5335
532D 5A             POP    DX
532E E80501         CALL   5436
5331 07             POP    ES
5332 5F             POP    DI
5333 EB04           JMP    5339

5335 83C406         ADD    SP,+06
5338 F9             STC
5339 EB04           JMP    533F

533B 07             POP    ES
533C 5F             POP    DI
533D 5A             POP    DX
533E F9             STC
533F 7206           JB     5347
5341 5D             POP    BP
5342 59             POP    CX
5343 5B             POP    BX
5344 58             POP    AX
5345 EB04           JMP    534B

5347 83C408         ADD    SP,+08
534A F9             STC
534B C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

534C 50             PUSH   AX
534D 53             PUSH   BX
534E 52             PUSH   DX
534F 8B1EDE89       MOV    BX,[89DE]
5353 83FBFF         CMP    BX,-01
5356 7505           JNZ    535D
5358 E82C00         CALL   5387
535B EB03           JMP    5360

535D E87700       * CALL   53D7
5360 730F           JNB    5371

                                          ;* zji¨tˆn¡ k¢du chyby
5362 B459           MOV    AH,59            ; funkce poskytnut¡ k¢du
5364 BB0000         MOV    BX,0000          ; verze k¢du 0
5367 CD21           INT    21               ; poskytnut¡ chybov‚ho k¢du
5369 32E4           XOR    AH,AH            ; AX = chybov˜ k¢d
536B 83C406         ADD    SP,+06
536E F9             STC
536F EB10           JMP    5381

5371 83FBFF       * CMP    BX,-01
5374 740B           JZ     5381
5376 3BC1           CMP    AX,CX
5378 7407           JZ     5381
537A E8B000         CALL   542D
537D 83C406         ADD    SP,+06
5380 F9             STC
5381 7203         * JB     5386
5383 5A             POP    DX
5384 5B             POP    BX
5385 58             POP    AX
5386 C3           * RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

5387 1E             PUSH   DS
5388 06             PUSH   ES
5389 1F             POP    DS
538A 83F901         CMP    CX,+01
538D 751B           JNZ    53AA             ; je
538F B402           MOV    AH,02
5391 268A15         MOV    DL,ES:[DI]
5394 CD21           INT    21               ; zobrazen¡ znaku
5396 1F             POP    DS
5397 8AC2           MOV    AL,DL
5399 E8B100         CALL   544D             ; test, zda je znak v tabulce LEAD
539C 1E             PUSH   DS
539D 06             PUSH   ES
539E 1F             POP    DS
539F 7307           JNB    53A8
53A1 268A5501       MOV    DL,ES:[DI+01]
53A5 CD21           INT    21               ; zobrazen¡ znaku
53A7 F8             CLC
53A8 EB0F           JMP    53B9


53AA B402           MOV    AH,02            ; funkce zobrazen¡ znaku
53AC 0BC9         * OR     CX,CX            ; je nˆjak˜ znak k zobrazen¡ ?
53AE 7409           JZ     53B9             ; nen¡ ‘ dn˜ znak k zobrazen¡
53B0 268A15         MOV    DL,ES:[DI]       ; znak k zobrazen¡
53B3 CD21           INT    21               ; zobrazen¡ znaku
53B5 47             INC    DI               ; zv˜¨en¡ ukazatele znak–
53B6 49             DEC    CX               ; sn¡‘en¡ ‡¡ta‡e znak–
53B7 75F3           JNZ    53AC             ; nen¡ je¨tˆ konec - dal¨¡ znak
53B9 F8           * CLC
53BA 1F             POP    DS
53BB C3             RET

; -----------------------------------------------------------------------------
;    Zji¨tˆn¡ d‚lky textu po znak ^Z
; -----------------------------------------------------------------------------

53BC 57             PUSH   DI
53BD 50             PUSH   AX
53BE 06             PUSH   ES
53BF 53             PUSH   BX
53C0 8BFA           MOV    DI,DX
53C2 1E             PUSH   DS
53C3 07             POP    ES
53C4 8BD9           MOV    BX,CX
53C6 B01A           MOV    AL,1A            ; znak konce souboru ^Z
53C8 FC             CLD
53C9 F2             REPNZ
53CA AE             SCASB                   ; nalezen¡ znaku ^Z
53CB 7503           JNZ    53D0             ; znak nenalezen
53CD 2BD9           SUB    BX,CX
53CF 4B             DEC    BX
53D0 8BCB         * MOV    CX,BX
53D2 5B             POP    BX
53D3 07             POP    ES
53D4 58             POP    AX
53D5 5F             POP    DI
53D6 C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

53D7 33C0           XOR    AX,AX
53D9 0BC9           OR     CX,CX            ; je nˆjak˜ znak k z pisu ?
53DB 744F           JZ     542C             ; nen¡ ‘ dn˜ znak k z pisu

53DD 1E             PUSH   DS
53DE 06             PUSH   ES
53DF 1F             POP    DS
53E0 B440           MOV    AH,40            ; funkce z pisu do souboru
53E2 8BD7           MOV    DX,DI            ; adresa znaku k z pisu
53E4 83F901         CMP    CX,+01           ; je 1 znak k z pisu ?
53E7 7528           JNZ    5411             ; nen¡ 1 znak k z pisu
53E9 CD21           INT    21               ; z pis 1 znaku do souboru
53EB 1F             POP    DS

53EC 50             PUSH   AX
53ED 268A05         MOV    AL,ES:[DI]       ; znak k z pisu
53F0 E85A00         CALL   544D             ; test, zda je znak v tabulce LEAD
53F3 58             POP    AX
53F4 1E             PUSH   DS
53F5 06             PUSH   ES
53F6 1F             POP    DS
53F7 7306           JNB    53FF
53F9 F8             CLC
53FA B440           MOV    AH,40                         ;'@'
53FC 42             INC    DX
53FD CD21           INT    21               ; z pis znak– do souboru
53FF 9C             PUSHF
5400 26803D1A       CMP    Byte Ptr ES:[DI],1A
5404 7502           JNZ    5408
5406 8BC1           MOV    AX,CX
5408 EB01         * JMP    540B
540A CF             IRET


540B 0E             PUSH   CS
540C E8FBFF         CALL   540A             ; IRET
540F EB1A           JMP    542B

5411 55           * PUSH   BP
5412 51             PUSH   CX
5413 E8A6FF         CALL   53BC             ; zji¨tˆn¡ d‚lky textu po znak ^Z
5416 8BE9           MOV    BP,CX
5418 59             POP    CX
5419 CD21           INT    21               ; z pis znaku
541B 7302           JNB    541F
541D EB0B           JMP    542A
541F 3BC8           CMP    CX,AX
5421 7407           JZ     542A
5423 3BE8           CMP    BP,AX
5425 F8             CLC
5426 7502           JNZ    542A
5428 8BC1           MOV    AX,CX
542A 5D             POP    BP
542B 1F             POP    DS
542C C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

542D B82700         MOV    AX,0027
5430 BB0400         MOV    BX,0004
5433 B501           MOV    CH,01
5435 C3             RET

5436 80FEFF         CMP    DH,FF
5439 7411           JZ     544C
543B F6C680         TEST   DH,80
543E 750C           JNZ    544C
5440 1E             PUSH   DS
5441 07             POP    ES
5442 8D3EE189       LEA    DI,[89E1]
5446 B90200         MOV    CX,0002
5449 E800FF         CALL   534C
544C C3             RET

; -----------------------------------------------------------------------------
;    Test, zda je znak v tabulce LEAD
; -----------------------------------------------------------------------------

544D 06             PUSH   ES
544E 57             PUSH   DI
544F C43EDA89       LES    DI,[89DA]        ; adresa tabulky LEAD
5453 0BFF           OR     DI,DI
5455 7417           JZ     546E
5457 26833D00     * CMP    Word Ptr ES:[DI],+00
545B F8             CLC
545C 7410           JZ     546E
545E 263A05         CMP    AL,ES:[DI]
5461 7207           JB     546A
5463 263A4501       CMP    AL,ES:[DI+01]
5467 7701         * JA     546A
5469 F9             STC
546A 47           * INC    DI
546B 47             INC    DI
546C EBE9           JMP    5457

546E 5F             POP    DI
546F 07             POP    ES
5470 C3             RET

; -----------------------------------------------------------------------------
;    P©evod ‡¡sla na ASCII ©etˆzec (do z sobn¡ku)
; -----------------------------------------------------------------------------
;    [SI+0ah] oddˆlova‡ tis¡c– (mus¡ b˜t ‡ rka ",")
; -----------------------------------------------------------------------------

5471 8F06E489       POP    [89E4]            ; £schova n vratov‚ adresy

                                          ;* vydˆlen¡ slova z kladem soustavy
5475 33DB           XOR    BX,BX            ; BX <- 0
5477 93             XCHG   AX,BX            ; £schova ni‘¨¡ho slova ‡¡sla
5478 92             XCHG   AX,DX            ; DX:AX <- vy¨¨¡ slovo ‡¡sla
5479 F736E889     * DIV    Word Ptr [89E8]  ; vydˆlen¡ vy¨¨¡ho slova
547D 93             XCHG   AX,BX            ; BX<-£schova vy¨¨¡ho slova
547E F736E889       DIV    Word Ptr [89E8]  ; vydˆlen¡ ni‘¨¡ho slova

                                          ;* korekce na ASCIIH znak -> z sobn¡k
5482 83FA09         CMP    DX,+09           ; je ‡¡slo > 9 ?
5485 7605           JBE    548C             ; je ‡¡slo <= 9
5487 80C237         ADD    DL,37            ; korekce na ASCII p¡smeno
548A EB03           JMP    548F
548C 80C230       * ADD    DL,30            ; korekce na ASCII ‡¡slici
548F 52           * PUSH   DX               ; ‡¡slice do z sobn¡ku
5490 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e znak– v z sobn¡ku

                                          ;* test, zda je ji‘ konec p©evodu
5491 0BC0           OR     AX,AX            ; je ji‘ ‡¡slo = 0 ?
5493 7504           JNZ    5499             ; je¨tˆ nen¡ = 0
5495 0BDB           OR     BX,BX
5497 7439           JZ     54D2             ; ‡¡slo je ji‘ = 0

                                          ;* oddˆlen¡ tis¡c–
5499 83F903       * CMP    CX,+03           ; jsou to tis¡ce ?
549C 750D           JNZ    54AB             ; nejsou to tis¡ce
549E 807C0A2C       CMP    Byte Ptr [SI+0A],2C           ;','
54A2 7505           JNZ    54A9             ; nepo‘aduje se oddˆlova‡ tis¡c–
54A4 FF36F189       PUSH   [89F1]           ; ulo‘en¡ znaku oddˆlova‡e tis¡c–
54A8 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e znak–
54A9 EB22         * JMP    54CD

                                          ;* oddˆlen¡ milon–
54AB 83F906       * CMP    CX,+06           ; je © d miliony ?
54AE 750D           JNZ    54BD             ; nejsou miliony
54B0 807C0A2C       CMP    Byte Ptr [SI+0A],2C           ;','
54B4 7505           JNZ    54BB             ; nepo‘aduje se oddˆlovac¡ ‡ rka
54B6 FF36F189       PUSH   [89F1]           ; ulo‘en¡ znaku oddˆlova‡e tis¡c–
54BA 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e znak–
54BB EB10         * JMP    54CD

                                          ;* oddˆlen¡ © du 10^9
54BD 83F909         CMP    CX,+09           ; je © d miliard ?
54C0 750B           JNZ    54CD             ; nejsou miliardy
54C2 807C0A2C       CMP    Byte Ptr [SI+0A],2C           ;','
54C6 7505           JNZ    54CD             ; nepo‘aduje se oddˆlova‡ tis¡c–
54C8 FF36F189       PUSH   [89F1]           ; ulo‘en¡ znaku oddˆlova‡e tis¡c–
54CC 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e znak–

54CD 93           * XCHG   AX,BX            ; n vrat AX
54CE 33D2           XOR    DX,DX            ; DX <- 0
54D0 EBA7           JMP    5479             ; dek¢dov n¡ dal¨¡ ‡¡slice

54D2 33D2         * XOR    DX,DX            ; DX <- 0
54D4 33C0           XOR    AX,AX            ; AX <- 0 (zbytek ‡¡sla)
54D6 FF36E489       PUSH   [89E4]           ; n vrat n vratov‚ adresy
54DA C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

54DB 33D2           XOR    DX,DX
54DD 0BC9           OR     CX,CX
54DF 7421           JZ     5502
54E1 B425           MOV    AH,25                         ;'%'
54E3 B000           MOV    AL,00
54E5 263825         CMP    ES:[DI],AH
54E8 750A           JNZ    54F4
54EA 26386501       CMP    ES:[DI+01],AH
54EE 7404           JZ     54F4
54F0 3AC4           CMP    AL,AH
54F2 750E           JNZ    5502
54F4 268A05       * MOV    AL,ES:[DI]
54F7 E853FF         CALL   544D             ; test, zda je znak v tabulce LEAD
54FA 7301           JNB    54FD
54FC 47             INC    DI
54FD 47             INC    DI
54FE 42             INC    DX
54FF 49             DEC    CX
5500 75E3           JNZ    54E5
5502 56             PUSH   SI
5503 87CA           XCHG   CX,DX
5505 0BED           OR     BP,BP
5507 7433           JZ     553C
5509 4D             DEC    BP
550A 833EE68900     CMP    Word Ptr [89E6],+00
550F 752B           JNZ    553C
5511 8A4406         MOV    AL,[SI+06]
5514 0430           ADD    AL,30                         ;'0'
5516 263A4501       CMP    AL,ES:[DI+01]
551A 7502           JNZ    551E
551C EB1E           JMP    553C
551E 3C30           CMP    AL,30                         ;'0'
5520 7504           JNZ    5526
5522 0BD2           OR     DX,DX
5524 7404           JZ     552A
5526 0334           ADD    SI,[SI]
5528 EBE7           JMP    5511

552A 803EE389FF     CMP    Byte Ptr [89E3],FF
552F 7508           JNZ    5539
5531 42             INC    DX
5532 42             INC    DX
5533 49             DEC    CX
5534 49             DEC    CX
5535 4F             DEC    DI
5536 4F             DEC    DI
5537 EB03           JMP    553C
5539 BAFFFF         MOV    DX,FFFF
553C 57             PUSH   DI
553D 2BF9           SUB    DI,CX
553F E80AFE         CALL   534C
5542 5F             POP    DI
5543 59             POP    CX
5544 7303           JNB    5549
5546 E98C00         JMP    55D5
5549 51             PUSH   CX
554A 8BCA           MOV    CX,DX
554C 807C0600       CMP    Byte Ptr [SI+06],00
5550 740D           JZ     555F
5552 0BC9           OR     CX,CX
5554 7406           JZ     555C
5556 49             DEC    CX
5557 49             DEC    CX
5558 47             INC    DI
5559 47             INC    DI
555A EB01           JMP    555D
555C 5E             POP    SI
555D EB10           JMP    556F
555F 0BC9           OR     CX,CX
5561 7503           JNZ    5566
5563 5E             POP    SI
5564 EB09           JMP    556F
5566 83F9FF         CMP    CX,-01
5569 7502           JNZ    556D
556B 33C9           XOR    CX,CX
556D 0BFF           OR     DI,DI
556F 7464           JZ     55D5
5571 55             PUSH   BP
5572 57             PUSH   DI
5573 06             PUSH   ES
5574 51             PUSH   CX
5575 33C9           XOR    CX,CX
5577 833EE68900     CMP    Word Ptr [89E6],+00
557C 753B           JNZ    55B9
557E F644070F       TEST   Byte Ptr [SI+07],0F
5582 7508           JNZ    558C
5584 C47C02         LES    DI,[SI+02]
5587 E85A01         CALL   56E4
558A EB28           JMP    55B4
558C F644070D       TEST   Byte Ptr [SI+07],0D
5590 740C           JZ     559E
5592 F644070E       TEST   Byte Ptr [SI+07],0E
5596 7406           JZ     559E
5598 F644070C       TEST   Byte Ptr [SI+07],0C
559C 7508           JNZ    55A6
559E C47C02         LES    DI,[SI+02]
55A1 E86801         CALL   570C
55A4 EB0E           JMP    55B4
55A6 F644070B       TEST   Byte Ptr [SI+07],0B
55AA 7505           JNZ    55B1
55AC E8F601         CALL   57A5
55AF EB03           JMP    55B4
55B1 E8B502         CALL   5869             ; dek¢dov n¡ £daje ‡asu
55B4 E85200         CALL   5609
55B7 EB03           JMP    55BC
55B9 E82000         CALL   55DC
55BC 7207           JB     55C5
55BE 59             POP    CX
55BF 07             POP    ES
55C0 5F             POP    DI
55C1 5D             POP    BP
55C2 5E             POP    SI
55C3 EB04           JMP    55C9

55C5 83C40A         ADD    SP,+0A
55C8 F9             STC
55C9 833EE68900     CMP    Word Ptr [89E6],+00
55CE 7505           JNZ    55D5
55D0 7203           JB     55D5
55D2 E906FF         JMP    54DB
55D5 C706E6890000   MOV    Word Ptr [89E6],0000
55DB C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

55DC 33D2           XOR    DX,DX
55DE A1E689         MOV    AX,[89E6]
55E1 C706E8890A00   MOV    Word Ptr [89E8],000A ; dekadick  soustava
55E7 E887FE         CALL   5471             ; dek¢dov n¡ ‡¡sla
55EA 58             POP    AX
55EB 8887EA89       MOV    [BX+89EA],AL
55EF 43             INC    BX
55F0 83FB40         CMP    BX,+40
55F3 7503           JNZ    55F8
55F5 E8D000         CALL   56C8
55F8 FEC9           DEC    CL
55FA 75EE           JNZ    55EA
55FC B80D0A         MOV    AX,0A0D
55FF 8987EA89       MOV    [BX+89EA],AX
5603 43             INC    BX
5604 43             INC    BX
5605 E8C000         CALL   56C8
5608 C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

5609 33DB           XOR    BX,BX
560B 807C0600       CMP    Byte Ptr [SI+06],00
560F 7511           JNZ    5622
5611 C787EA89202D   MOV    Word Ptr [BX+89EA],2D20
5617 43             INC    BX
5618 43             INC    BX
5619 C687EA8920     MOV    Byte Ptr [BX+89EA],20         ;' '
561E 43             INC    BX
561F E8A600         CALL   56C8


5622 5D             POP    BP
5623 33DB           XOR    BX,BX
5625 33D2           XOR    DX,DX
5627 880EE089       MOV    [89E0],CL
562B 8A4409         MOV    AL,[SI+09]
562E 3AC1           CMP    AL,CL
5630 761E           JBE    5650
5632 2AC1           SUB    AL,CL
5634 8AF0           MOV    DH,AL
5636 F6440780       TEST   Byte Ptr [SI+07],80
563A 7414           JZ     5650
563C 8A440A         MOV    AL,[SI+0A]
563F 8887EA89       MOV    [BX+89EA],AL
5643 43             INC    BX
5644 83FB40         CMP    BX,+40
5647 7503           JNZ    564C
5649 E87C00         CALL   56C8
564C FECE           DEC    DH
564E 75EC           JNZ    563C
5650 807C0800       CMP    Byte Ptr [SI+08],00
5654 740D           JZ     5663
5656 384C08         CMP    [SI+08],CL
5659 7308           JNB    5663
565B 2A4C08         SUB    CL,[SI+08]
565E 8AD1           MOV    DL,CL
5660 8A4C08         MOV    CL,[SI+08]
5663 0BC9           OR     CX,CX
5665 7424           JZ     568B
5667 F644070F       TEST   Byte Ptr [SI+07],0F
566B 750C           JNZ    5679
566D F6440710       TEST   Byte Ptr [SI+07],10
5671 7406           JZ     5679
5673 268A05         MOV    AL,ES:[DI]
5676 47             INC    DI
5677 EB01           JMP    567A
5679 58             POP    AX
567A 8887EA89       MOV    [BX+89EA],AL
567E 43             INC    BX
567F 83FB40         CMP    BX,+40
5682 7503           JNZ    5687
5684 E84100         CALL   56C8
5687 FEC9           DEC    CL
5689 75DC           JNZ    5667
568B F6440780       TEST   Byte Ptr [SI+07],80
568F 7518           JNZ    56A9
5691 0AF6           OR     DH,DH
5693 7414           JZ     56A9
5695 8A440A         MOV    AL,[SI+0A]
5698 8887EA89       MOV    [BX+89EA],AL
569C 43             INC    BX
569D 83FB40         CMP    BX,+40
56A0 7503           JNZ    56A5
56A2 E82300         CALL   56C8
56A5 FECE           DEC    DH
56A7 75EC           JNZ    5695
56A9 F644070F       TEST   Byte Ptr [SI+07],0F
56AD 7508           JNZ    56B7
56AF F6440710       TEST   Byte Ptr [SI+07],10
56B3 7402           JZ     56B7
56B5 EB0C           JMP    56C3
56B7 0AD2           OR     DL,DL
56B9 7408           JZ     56C3
56BB 8F06E489       POP    [89E4]           ; n vrat n vratov‚ adresy
56BF FECA           DEC    DL
56C1 75F8           JNZ    56BB
56C3 E80200         CALL   56C8
56C6 55             PUSH   BP
56C7 C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

56C8 51             PUSH   CX
56C9 06             PUSH   ES
56CA 57             PUSH   DI
56CB 1E             PUSH   DS
56CC 07             POP    ES
56CD 8BCB           MOV    CX,BX
56CF 33DB           XOR    BX,BX
56D1 8D3EEA89       LEA    DI,[89EA]
56D5 E874FC         CALL   534C
56D8 7205           JB     56DF
56DA 5F             POP    DI
56DB 07             POP    ES
56DC 59             POP    CX
56DD EB04           JMP    56E3
56DF 83C406       * ADD    SP,+06
56E2 F9             STC
56E3 C3             RET

; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------

56E4 5D             POP    BP
56E5 F6440730       TEST   Byte Ptr [SI+07],30           ;'0'
56E9 7512           JNZ    56FD
56EB 268A05         MOV    AL,ES:[DI]
56EE 50             PUSH   AX
56EF 41             INC    CX
56F0 E85AFD         CALL   544D             ; test, zda je znak v tabulce LEAD
56F3 7306           JNB    56FB
56F5 268A4501       MOV    AL,ES:[DI+01]
56F9 50             PUSH   AX
56FA F8             CLC
56FB EB0D         * JMP    570A

                                          ;* zji¨tˆn¡ d‚lky textu
56FD 268A05       * MOV    AL,ES:[DI]
5700 0AC0           OR     AL,AL
5702 7404           JZ     5708
5704 47             INC    DI
5705 41             INC    CX
5706 EBF5           JMP    56FD

5708 2BF9         * SUB    DI,CX
570A 55             PUSH   BP
570B C3             RET

; -----------------------------------------------------------------------------
;    Dek¢dov n¡ ‡¡sla (slovo nebo bajt)
; -----------------------------------------------------------------------------
;    VSTUP: ES:[DI]=‡¡slo k dek¢dov n¡
;              [SI+7] bit 3,2 = je 16-kov  soustava
;                     bit 5: 1=dek¢duje se slovo
; -----------------------------------------------------------------------------

570C 5D             POP    BP
570D 33D2           XOR    DX,DX
570F 33C0           XOR    AX,AX
5711 C706E8891000   MOV    Word Ptr [89E8],0010  ; 16-kov  soustava
5717 33DB           XOR    BX,BX            ; p©¡znak nez porn‚ho ‡¡sla
5719 F6440720       TEST   Byte Ptr [SI+07],20 ; je slovo ?
571D 7524           JNZ    5743             ; je slovo

                                          ;* dek¢dov n¡ bajtu
571F 268A05         MOV    AL,ES:[DI]       ; bajt k dek¢dov n¡
5722 F644070D       TEST   Byte Ptr [SI+07],0D
5726 750D           JNZ    5735
5728 A880           TEST   AL,80            ; je to z porn‚ ‡¡slo ?
572A 7403           JZ     572F             ; nen¡ to z porn‚ ‡¡slo
572C 43             INC    BX               ; p©¡znak z porn‚ho ‡¡sla
572D 247F           AND    AL,7F            ; zru¨¡ se znam‚nkov˜ bit

572F C706E8890A00 * MOV    Word Ptr [89E8],000A ; dekadick  soustava
5735 F644070E     * TEST   Byte Ptr [SI+07],0E
5739 7506           JNZ    5741
573B C706E8890A00   MOV    Word Ptr [89E8],000A ; dekadick  soustava
5741 EB54         * JMP    5797             ; dek¢dov n¡ ‡¡sla

5743 F6440710     * TEST   Byte Ptr [SI+07],10
5747 7526           JNZ    576F
5749 268B05         MOV    AX,ES:[DI]

574C F644070D       TEST   Byte Ptr [SI+07],0D
5750 750F           JNZ    5761
5752 F6C480         TEST   AH,80
5755 7404           JZ     575B
5757 43             INC    BX               ; p©¡znak z porn‚ho ‡¡sla
5758 80E47F         AND    AH,7F

575B C706E8890A00   MOV    Word Ptr [89E8],000A ; dekadick  soustava
5761 F644070E       TEST   Byte Ptr [SI+07],0E
5765 7506           JNZ    576D
5767 C706E8890A00   MOV    Word Ptr [89E8],000A ; dekadick  soustava
576D EB28           JMP    5797

576F 268B05       * MOV    AX,ES:[DI]
5772 268B5502       MOV    DX,ES:[DI+02]
5776 F644070D       TEST   Byte Ptr [SI+07],0D
577A 750F           JNZ    578B
577C F6C680         TEST   DH,80
577F 7404           JZ     5785
5781 43             INC    BX
5782 80E67F         AND    DH,7F
5785 C706E8890A00   MOV    Word Ptr [89E8],000A ; dekadick  soustava
578B F644070E       TEST   Byte Ptr [SI+07],0E
578F 7506           JNZ    5797
5791 C706E8890A00   MOV    Word Ptr [89E8],000A ; dekadick  soustava

5797 E8D7FC         CALL   5471             ; dek¢dov n¡ ‡¡sla
579A 0BDB           OR     BX,BX
579C 7405           JZ     57A3
579E 33D2           XOR    DX,DX
57A0 B22D           MOV    DL,2D            ; znam‚nko "-"
57A2 52             PUSH   DX
57A3 55           * PUSH   BP
57A4 C3             RET

; -----------------------------------------------------------------------------
;    Dek¢dov n¡ data
; -----------------------------------------------------------------------------
;    VSTUP: DS:SI £daj ‡asu
;                  [SI+2] (slovo) rok
;                  [SI+4]  mˆs¡c
;                  [SI+5]  den
;                  [SI+7]  bit 4: 1=omezen¡ roku na 99
; -----------------------------------------------------------------------------


57A5 5D             POP    BP
57A6 C706E8890A00   MOV    Word Ptr [89E8],000A ; ‡¡seln  soustava 10
57AC E87300         CALL   5822             ; poskytnut¡ n rod. inform. o datu
57AF 33D2           XOR    DX,DX
57B1 33C0           XOR    AX,AX

                                          ;* dek¢dov n¡ data USA
57B3 833EEA8900     CMP    Word Ptr [89EA],+00 ; je form t USA ?
57B8 751E           JNZ    57D8             ; nen¡ form t USA
57BA E87D00         CALL   583A             ; omezen¡ roku
57BD E88C00         CALL   584C             ; dek¢dov n¡ roku
57C0 FF36F589       PUSH   [89F5]           ; £daj roku
57C4 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e slov v z sobn¡ku
57C5 33C0           XOR    AX,AX            ; AX <- 0
57C7 8A4405         MOV    AL,[SI+05]       ; den
57CA E87F00         CALL   584C             ; dek¢dov n¡ dne
57CD FF36F589       PUSH   [89F5]           ; £daj dne
57D1 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e slov v z sobn¡ku
57D2 8A4404         MOV    AL,[SI+04]       ; mˆs¡c
57D5 E87400         CALL   584C             ; dek¢dov n¡ mˆs¡ce

                                          ;* dek¢dov n¡ evropsk‚ho data
57D8 833EEA8901   * CMP    Word Ptr [89EA],+01 ; je form t Evropy ?
57DD 751E           JNZ    57FD             ; nen¡ evropsk˜ form t
57DF E85800         CALL   583A             ; omezen¡ roku
57E2 E86700         CALL   584C             ; dek¢dov n¡ roku
57E5 FF36F589       PUSH   [89F5]           ; £daj roku
57E9 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e slov v z sobn¡ku
57EA 33C0           XOR    AX,AX            ; AX <- 0
57EC 8A4404         MOV    AL,[SI+04]       ; mˆs¡c
57EF E85A00         CALL   584C             ; dek¢dov n¡ mˆs¡ce
57F2 FF36F589       PUSH   [89F5]           ; £daj mˆs¡ce
57F6 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e slov v z sobn¡ku
57F7 8A4405         MOV    AL,[SI+05]       ; den
57FA E84F00         CALL   584C             ; dek¢dov n¡ dne

                                          ;* dek¢dov n¡ japonsk‚ho data
57FD 833EEA8902     CMP    Word Ptr [89EA],+02 ; je form t Japonska ?
5802 751C           JNZ    5820             ; nen¡ form t Japonska
5804 8A4405         MOV    AL,[SI+05]       ; den
5807 E84200         CALL   584C             ; dek¢dov n¡ dne
580A FF36F589       PUSH   [89F5]           ; £daj dne
580E 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e slov v z sobn¡ku
580F 8A4404         MOV    AL,[SI+04]       ; mˆs¡c
5812 E83700         CALL   584C             ; dek¢dov n¡ mˆs¡ce
5815 FF36F589       PUSH   [89F5]           ; £daj mˆs¡ce
5819 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e slov v z sobn¡ku
581A E81D00         CALL   583A             ; omezen¡ roku
581D E82C00         CALL   584C             ; dek¢dov n¡ roku

5820 55             PUSH   BP
5821 C3             RET

; -----------------------------------------------------------------------------
;    Poskytnut¡ n rodnostn¡ch informac¡ o datu
; -----------------------------------------------------------------------------

5822 B438           MOV    AH,38            ; funkce n rodnostn¡ch informac¡
5824 B000           MOV    AL,00            ; implicitn¡ zemˆ
5826 8D16EA89       LEA    DX,[89EA]        ; buffer k poskytnut¡ inforamc¡
582A CD21           INT    21               ; poskytnut¡ informac¡
582C 730B           JNB    5839             ; informace OK
582E C706EA890000   MOV    Word Ptr [89EA],0000 ; jinak form t data USA
5834 C606F5892D     MOV    Byte Ptr [89F5],2D   ; oddˆlova‡ data '-'
5839 C3           * RET

; -----------------------------------------------------------------------------
;    Omezen¡ roku na 99
; -----------------------------------------------------------------------------

583A 8B4402         MOV    AX,[SI+02]
583D F6440710       TEST   Byte Ptr [SI+07],10
5841 7508           JNZ    584B
5843 3D6300         CMP    AX,0063          ; 99
5846 7603           JBE    584B
5848 B86300         MOV    AX,0063          ; omezen¡ na 99
584B C3           * RET

; -----------------------------------------------------------------------------
;    Dek¢dov n¡ dvoj‡¡sl¡ data (doplnˆn¡ 0)
; -----------------------------------------------------------------------------

584C 8F06EA89       POP    [89EA]
5850 880EE089       MOV    [89E0],CL        ; £schova ‡¡ta‡e ‡¡slic
5854 E81AFC         CALL   5471             ; dek¢dov n¡ ‡¡sla
5857 49             DEC    CX
5858 3A0EE089       CMP    CL,[89E0]        ; byly 2 ‡¡slice ?
585C 7505           JNZ    5863             ; byly 2 ‡¡slice
585E B83000         MOV    AX,0030          ; dopl¤uj¡c¡ "0"
5861 50             PUSH   AX
5862 41             INC    CX
5863 41           * INC    CX
5864 FF36EA89       PUSH   [89EA]
5868 C3             RET

; -----------------------------------------------------------------------------
;    Dek¢dov n¡ £daje ‡asu (do z sobn¡ku)
; -----------------------------------------------------------------------------
;    VSTUP: DS:SI £daj ‡asu
;                  [SI+2]  hodina
;                  [SI+3]  minuta
;                  [SI+4]  sekunda
;                  [SI+5]  setiny sekundy
;                  [SI+7] bit 0: 1=mo‘n‚ zobrazen¡ USA (AM/PM)
;                         bit 4: 1=dek¢duj¡ se sekundy
;                         bit 5: 1=dek¢duj¡ se setiny sekundy (a sekundy)
; -----------------------------------------------------------------------------

5869 5D             POP    BP               ; £schova n vratov‚ adresy
586A C706E8890A00   MOV    Word Ptr [89E8],000A ; des¡tkov  soustava
5870 E87A00         CALL   58ED             ; poskytnut¡ n rod. inform. ‡asu
5873 F6440701       TEST   Byte Ptr [SI+07],01 ; mo‘n‚ zobrazen¡ USA ?
5877 741C           JZ     5895

                                          ;* zobrazen¡ znaku "a" nebo "p"
5879 803EFB8900     CMP    Byte Ptr [89FB],00 ; je form t ‡asu USA ?
587E 7515           JNZ    5895             ; nen¡ form t ‡asu USA

5880 8A4402         MOV    AL,[SI+02]       ; hodina
5883 3C0C           CMP    AL,0C            ; je po 12 hodinˆ ?
5885 7C04           JL     588B             ; je dopoledne
5887 3C17           CMP    AL,17            ; je maxim lnˆ hodina 23 ?
5889 7E06           JLE    5891             ; ano, je je¨tˆ odpoledne
588B B061         * MOV    AL,61            ; je dopoledne "a"
588D 50             PUSH   AX               ; ulo‘en¡ znaku "a" do z sobn¡ku
588E 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e znak– v z sobn¡ku
588F EB04           JMP    5895
5891 B070         * MOV    AL,70            ; je odpoledne "p"
5893 50             PUSH   AX               ; ulo‘en¡ znaku "p" do z sobn¡ku
5894 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e znak– v z sobn¡ku

5895 33C0         * XOR    AX,AX
5897 33D2           XOR    DX,DX
5899 F6440720       TEST   Byte Ptr [SI+07],20 ; dek¢duj¡ se setiny sekundy
589D 740B           JZ     58AA

                                          ;* dek¢dov n¡ setin sekundy
589F 8A4405         MOV    AL,[SI+05]       ; setiny sekundy
58A2 E86500         CALL   590A             ; dek¢dov n¡ setin sekundy
58A5 FF36F389       PUSH   [89F3]           ; £daj setin sekund
58A9 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e slov v z sobn¡ku


58AA F6440720     * TEST   Byte Ptr [SI+07],20           ;' '
58AE 7506           JNZ    58B6             ; dek¢dov n¡ £daje sekund
58B0 F6440710       TEST   Byte Ptr [SI+07],10 ; dek¢duj¡ se sekundy ?
58B4 740B           JZ     58C1             ; sekundy se nedek¢duj¡

                                          ;* dek¢dov n¡ £daje sekund
58B6 8A4404       * MOV    AL,[SI+04]       ; sekundy
58B9 E84E00         CALL   590A             ; dek¢dov n¡ £daje sekund
58BC FF36F789       PUSH   [89F7]           ; £daj sekund
58C0 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e slov v z sobn¡ku

                                          ;* dek¢dov n¡ £daje minut
58C1 8A4403         MOV    AL,[SI+03]       ; minuty
58C4 E84300         CALL   590A             ; dek¢dov n¡ £daje minut
58C7 FF36F789       PUSH   [89F7]           ; £daj minut do z sobn¡ku
58CB 41             INC    CX               ; zv˜¨en¡ ‡¡ta‡e slov v z sobn¡ku

                                          ;* dek¢dov n¡ £daje hodin
58CC 8A4402         MOV    AL,[SI+02]       ; hodina
58CF F6440701       TEST   Byte Ptr [SI+07],01 ;
58D3 7413           JZ     58E8
                                          ;* omezen¡ hodin na 12 pro USA
58D5 803EFB8900     CMP    Byte Ptr [89FB],00 ; je zobrazen¡ ‡asu USA ?
58DA 750C           JNZ    58E8             ; nen¡ zobrazen¡ ‡asu USA
58DC 3C0D           CMP    AL,0D            ; je hodina max. 12 ?
58DE 7C02           JL     58E2             ; je max. hodina 12
58E0 2C0C           SUB    AL,0C            ; p©epo‡et na odpoledn¡ hodinu
58E2 3C00         * CMP    AL,00            ; byla by hodina 0 ?
58E4 7502           JNZ    58E8             ; nen¡ hodina 0
58E6 B00C           MOV    AL,0C            ; oprava na hodinu 12

58E8 E886FB       * CALL   5471             ; dek¢dov n¡ £daje hodin
58EB 55             PUSH   BP               ; n vratov  adresa z podprogramu
58EC C3             RET

; -----------------------------------------------------------------------------
;    Poskytnut¡ n rodnostn¡ch informac¡ pro hodiny
; -----------------------------------------------------------------------------

58ED B438           MOV    AH,38            ; funkce n rodnostn¡ch informac¡
58EF B000           MOV    AL,00            ; implicitn¡ zemˆ
58F1 8D16EA89       LEA    DX,[89EA]        ; buffer k poskytnut¡ inforamc¡
58F5 CD21           INT    21               ; poskytnut¡ informac¡ COUNTRY
58F7 7310           JNB    5909             ; informace OK
58F9 C706FB890100   MOV    Word Ptr [89FB],0001 ; form t ‡asu - Evropa
58FF C606F7893A     MOV    Byte Ptr [89F7],3A   ; oddˆlova‡ ‡asu ":"
5904 C606F3892E     MOV    Byte Ptr [89F3],2E   ; oddˆlova‡ desetinn˜ch m¡st "."
5909 C3           * RET

; -----------------------------------------------------------------------------
;    Dek¢dov n¡ dvoj‡¡sl¡ ‡asu
; -----------------------------------------------------------------------------

590A 8F06EA89       POP    [89EA]           ; £schova n vratov‚ adresy
590E 880EE089       MOV    [89E0],CL        ; £schova ‡¡ta‡e ‡¡slic
5912 E85CFB         CALL   5471             ; dek¢dov n¡ ‡¡sla
5915 49             DEC    CX               
5916 3A0EE089       CMP    CL,[89E0]        ; byly 2 ‡¡slice ?
591A 7505           JNZ    5921             ; byly 2 ‡¡slice
591C B83000         MOV    AX,0030          ; dopl¤uj¡c¡ "0"
591F 50             PUSH   AX
5920 41             INC    CX
5921 41           * INC    CX
5922 FF36EA89       PUSH   [89EA]           ; n vrat n vratov‚ adresy
5926 C3             RET

; -----------------------------------------------------------------------------
;    Inten¡ p©¡kaz LOADHIGH, LH
; -----------------------------------------------------------------------------

5927 1E             PUSH   DS
5928 07             POP    ES
5929 E87A00         CALL   59A6             ; nalezen¡ prvn¡ho parametru p©¡kazu
592C 56             PUSH   SI               ; £schova adresy parametru
592D E81400         CALL   5944             ; rozbor p©¡kazov‚ho © dku
5930 5E             POP    SI               ; n vrat adresy parametru
5931 720E           JB     5941             ; chyba zad n¡ p©¡kazu

5933 E88800         CALL   59BE             ; ulo‘en¡ p©¡kazu do p©¡kaz. © dku
5936 E8D600         CALL   5A0F
5939 7206           JB     5941
593B E8B900         CALL   59F7             ; nastaven¡ strategie pamˆti
593E E9B6D0         JMP    29F7
5941 E907D1       * JMP    2A4B

; -----------------------------------------------------------------------------
;    Rozbor jm‚na souboru se z kazem * a ?
; -----------------------------------------------------------------------------

5944 BE8100         MOV    SI,0081          ; zadan‚ jm‚no souboru
5947 C7068E8D0000   MOV    Word Ptr [8D8E],0000 ;
594D BFB388         MOV    DI,88B3          ; buffer k ulo‘en¡ jm‚na souboru
5950 33C9           XOR    CX,CX            ; CX <- 0
5952 E832C9         CALL   2287             ; rozbor p©¡kazov‚ho © dku
5955 3DFFFF         CMP    AX,FFFF          ;
5958 740F           JZ     5969
595A 3D0000         CMP    AX,0000          ; bylo zad n¡ OK ?
595D 7509           JNZ    5968             ; byla chyba zad n¡

595F 8BDA           MOV    BX,DX
5961 E82000         CALL   5984             ; ulo‘.jm‚na souboru se z kazem *, ?
5964 7203           JB     5969             ; chyba - byl zad n znak * nebo ?
5966 EB01           JMP    5969             ; jm‚no souboru OK
5968 F9           * STC
5969 C3           * RET

; -----------------------------------------------------------------------------
;    Nastaven¡ strategie pamˆti
; -----------------------------------------------------------------------------

596A B80058         MOV    AX,5800
596D CD21           INT    21               ; poskytnut¡ strategie pamˆti
596F 8BD8           MOV    BX,AX
5971 81CB8000       OR     BX,0080          ;
5975 B80158         MOV    AX,5801
5978 CD21           INT    21               ; nastaven¡ strategie pamˆti
597A C3             RET

; -----------------------------------------------------------------------------
;    Nastaven¡ strategie pamˆti
; -----------------------------------------------------------------------------

597B B80358         MOV    AX,5803
597E BB0100         MOV    BX,0001
5981 CD21           INT    21               ; strateie pamˆti
5983 C3             RET

; -----------------------------------------------------------------------------
;    Ulo‘en¡ jm‚na souboru se z kazem * a ?
; -----------------------------------------------------------------------------

5984 1E             PUSH   DS
5985 56             PUSH   SI
5986 57             PUSH   DI

5987 C57704         LDS    SI,[BX+04]       ; adresa textu p©¡kazu
598A BF9F8C         MOV    DI,8C9F          ; buffer k ulo‘en¡ jm‚na programu
598D AC           * LODSB                   ; na‡ten¡ znaku
598E 3C2A           CMP    AL,2A            ; je to konven‡n¡ znak "*" ?
5990 740E           JZ     59A0             ; je to konven‡n¡ znak "*" - chyba
5992 3C3F           CMP    AL,3F            ; je to konven‡n¡ znak "?" ?
5994 740A           JZ     59A0             ; je to konven‡n¡ znak "?" - chyba
5996 AA             STOSB                   ; ulo‘en¡ znaku
5997 0AC0           OR     AL,AL            ; je konec textu ?
5999 75F2           JNZ    598D             ; nen¡ konec - dal¨¡ znak
599B F8             CLC                     ; p©¡znak - zad n¡ OK

599C 5F           * POP    DI
599D 5E             POP    SI
599E 1F             POP    DS
599F C3             RET

59A0 BA7D84       * MOV    DX,847D          ; adresa chyby
59A3 F9             STC                     ; p©¡znak chyby zad n¡
59A4 EBF6           JMP    599C

; -----------------------------------------------------------------------------
;    Nalezen¡ prvn¡ho parametru v p©¡kazu
; -----------------------------------------------------------------------------

59A6 BE8100         MOV    SI,0081          ; za‡ tek textu
59A9 E818CD         CALL   26C4             ; vypustˆn¡ oddˆlova‡– z textu
59AC AC           * LODSB                   ; na‡ten¡ dal¨¡ho znaku z textu
59AD E81CCD         CALL   26CC             ; test, zda je znak oddˆlova‡
59B0 740A           JZ     59BC             ; je oddˆlova‡
59B2 3C0D           CMP    AL,0D            ; je konec © dku CR ?
59B4 7406           JZ     59BC             ; je konec © dku CR
59B6 3A067B8D       CMP    AL,[8D7B]        ; je hledan˜ znak parametru ?
59BA 75F0           JNZ    59AC             ; nen¡ hledan˜ znak parametru
59BC 4E           * DEC    SI
59BD C3             RET

; -----------------------------------------------------------------------------
;    Ulo‘en¡ p©¡kazu s CR do p©¡kazov‚ho © dku v PSP
; -----------------------------------------------------------------------------

59BE BF8100         MOV    DI,0081          ; za‡ tek nov‚ho p©¡kazov‚ho © dku
59C1 32C9           XOR    CL,CL            ; ‡¡ta‡ znak– CL <- 0
59C3 FEC9           DEC    CL               ; p©ednastaven¡ CL na -1
59C5 AC           * LODSB                   ; na‡ten¡ znaku k p©enesen¡
59C6 AA             STOSB                   ; ulo‘en¡ znaku
59C7 FEC1           INC    CL               ; zv˜¨en¡ ‡¡ta‡e znak–
59C9 3C0D           CMP    AL,0D            ; je to konec textu ?
59CB 75F8           JNZ    59C5             ; nen¡ konec - dal¨¡ znak
59CD 26880E8000     MOV    ES:[0080],CL     ; nastaven¡ po‡tu znak–
59D2 C3             RET

; -----------------------------------------------------------------------------
;    Nastaven¡ ukazatele na tabulku chyby
; -----------------------------------------------------------------------------

59D3 C606118201     MOV    Byte Ptr [8211],01
59D8 BA1382         MOV    DX,8213          ; adresa tabulky popisu chyby
59DB A31382         MOV    [8213],AX        ; k¢d chyby
59DE C3             RET

; -----------------------------------------------------------------------------
;    Poskytnut¡ strategie pamˆti
; -----------------------------------------------------------------------------

59DF B80058         MOV    AX,5800
59E2 CD21           INT    21               ; poskytnut¡ strategie pamˆti
59E4 8AD8           MOV    BL,AL            ;
59E6 B80258         MOV    AX,5802
59E9 CD21           INT    21               ; nastaven¡ strategie pamˆti
59EB 8AF8           MOV    BH,AL
59ED 93             XCHG   AX,BX
59EE D0C0           ROL    AL,1
59F0 2401           AND    AL,01
59F2 D0E4           SHL    AH,1
59F4 0AC4           OR     AL,AH
59F6 C3             RET

; -----------------------------------------------------------------------------

59F7 1E             PUSH   DS
59F8 E8E4FF         CALL   59DF             ; poskytnut¡ strategie pamˆti
59FB 8E1E778D       MOV    DS,[8D77]        ; segment 1. ‡ sti COMMAND.COM
59FF A24005         MOV    [0540],AL
5A02 800E400580     OR     Byte Ptr [0540],80
5A07 1F             POP    DS
5A08 E85FFF         CALL   596A             ; nastaven¡ strategie pamˆti
5A0B E86DFF         CALL   597B             ; nastaven¡ strategie pamˆti
5A0E C3             RET

; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------

5A0F A1C593         MOV    AX,[93C5]
5A12 48             DEC    AX
5A13 BB0B00         MOV    BX,000B
5A16 F7E3           MUL    BX
5A18 BF0591         MOV    DI,9105
5A1B 8BF7           MOV    SI,DI
5A1D 83C60B         ADD    SI,+0B
5A20 8BC8           MOV    CX,AX
5A22 FC             CLD
5A23 F3             REPZ
5A24 A4             MOVSB
5A25 FF0EC593       DEC    Word Ptr [93C5]
5A29 E8A5D8         CALL   32D1
5A2C 0BC0           OR     AX,AX
5A2E 740C           JZ     5A3C
5A30 3D0400         CMP    AX,0004
5A33 7C02           JL     5A37
5A35 F8             CLC
5A36 C3             RET

5A37 BA7A84       * MOV    DX,847A
5A3A EB06           JMP    5A42


5A3C B80200         MOV    AX,0002
5A3F E891FF         CALL   59D3
5A42 F9           * STC
5A43 C3             RET
