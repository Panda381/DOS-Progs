CONTEXT   0  71   6   6  72
Sn¡ma‡ ‡ rov‚ho k¢du             - # -

ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ



















               4ÿSÿnÿ¡ÿmÿaÿ‡ÿ ÿ‡ÿ ÿrÿoÿvÿ‚ÿhÿoÿ ÿkÿ¢ÿdÿu5









     Obsah:

                                                       Str.

1.  Popis ............................................. 2

2.  Popis zapojen¡ adaptoru ........................... 2

3.  Konstruk‡n¡ ©e¨en¡ adaptoru ....................... 4

4.  Program - popis ................................... 7

5.  € rov˜ k¢d CKN .................................... 9

6.  Popis ‡innosti sn¡ma‡e ‡arov‚ho k¢du ............. 14







P©¡lohy:



1.  Sch‚ma adaptoru

2.  Plo¨n˜ spoj - strana 1 (strana sou‡ stek)

3.  Plo¨n˜ spoj - strana 2 (strana spoj–)

4.  Rozm¡stˆn¡ sou‡ stek na plo¨n‚m spoji







1.- Popis

   Adaptor  pro sn¡m n¡ ‡ rov‚ho k¢du CK-001 roz¨i©uje mo‘nosti vstup–
d¡lensk‚ho  termin lu BDT K8901 o vstup ‡ rov‚ho  k¢du.  Jako  vstupn¡
za©¡zen¡  se pou‘¡v  ru‡n¡ sn¡mac¡ sonda pracuj¡c¡ na principu  odrazu
infra‡erven‚ho  paprsku od sn¡man‚ho k¢du.  Data ze sn¡mac¡ sondy jsou
p©ek¢dov na  adaptorem um¡stˆn˜m v termin lu jako dopl¤uj¡c¡  deska  a
p©i  bezchybn‚m p©ek¢dov n¡ jsou vysl na na termin l.  Z d–vodu  neza-
sahov n¡ do hardware ‡i software termin lu je pou‘ita jako komunika‡n¡
br na  port  pro  vstup z kl vesnice.  V˜stup z adaptoru  je  p©ipojen
paralelnˆ  ke  kl vesnici termin lu a data z  adaptoru  jsou  vys¡l na
stejn˜m zp–sobem, jakoby byla zad v na z kl vesnice. To p©in ¨¡ v˜hodu
v tom, ‘e nen¡ pot©eba prov dˆt ‘ dn‚ z sahy do termin lu - adaptor se
jednodu¨e  p©ipoj¡ do termin lu mezi konektory pro kl vesnici.  Funkce
kl vesnice z–st v  i nad le zachov na beze zmˆny.  Vstupy z kl vesnice
nebo ze sn¡ma‡e lze kombinovat - nap©. p©i poru¨e sn¡ma‡e lze pokra‡o-
vat ve vkl d n¡ dat pomoc¡ kl vesnice.  Nev˜hodou tohoto ©e¨en¡ je, ‘e
nen¡ mo‘n  zpˆtn  vazba z termin lu k adaptoru, tak‘e je nutn  kontro-
la  termin lu obsluhou (zda je p©ipraven p©ij¡mat ‡ten  data a  pod.).
Jist˜m omezen¡m je tak‚ to,  ‘e soubor vstupn¡ch znak– je omezen pouze
na znaky,  kter‚ je mo‘no zad vat z kl vesnice - tedy je mo‘no zad vat
v podstatˆ jen ‡¡slice pop©. ©¡d¡c¡ kl vesy.





2.- Popis zapojen¡ adaptoru



                       Nap jen¡ desky,
                    sign ly TAKT a RESET
vstup ze                       º
sondy-data                    \º/
ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿     ÉÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍ»     v˜stup na sondu
vstup ze        ³     º                º  - nap jen¡ a indikace
sondy-aktivace  ÀÄÄ>ÄÄ¶    Paraleln¡   ÇÄÄÄ>ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ>ÄÄ¶                º
                      ºvstupnˆ/v˜stupn¡ºsloupec znaku ÉÍÍÍÍÍÍÍ» v˜stup
          vstup ÄÄÄ>ÄÄ¶                ÌÍÍÍ>ÍÍÍÍÍÍÍÍÍÍ¹       º  znaku
        p©edvolby     º      port      º              º dek¢d.º
          k¢du  ÄÄÄ>ÄÄ¶                º © dek znaku  º obvod ÌÍÍÍÍÍÍÍ
                      º                ÌÍÍÍ>ÍÍÍÍÍÍÍÍÍÍ¹       º
                      º                º        ÉÍÍÍÍÍ¹       º
vstup © dku znaku     ÈÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍ¼        º     ÈÍÍÍÍÍÍÍ¼
ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ>ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ>ÍÍÍÍ¼
               vnit©n¡ sbˆrnice º
      ÉÍÍÍÍÍÍÍÍÍÍÍ<ÍÍ>ÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍ<ÍÍ>ÍÍÍÍÍÍÍÍÍÍÍ»
ÉÍÍÍÍÍÊÍÍÍÍÍ»             ÉÍÍÍÍÍÊÍÍÍÍÍ»             ÉÍÍÍÍÍÊÍÍÍÍÍ»
º procesor  º             º   pamˆŸ   º             º   pamˆŸ   º
º           º             º           º             º           º
º    CPU    º             º    ROM    º             º    RAM    º
º           º             º           º             º           º
ÈÍÍÍÍÍÍÍÍÍÍÍ¼             ÈÍÍÍÍÍÍÍÍÍÍÍ¼             ÈÍÍÍÍÍÍÍÍÍÍÍ¼


Obr.1.: Blokov‚ zapojen¡ adaptoru


     Blokov‚ zapojen¡ adaptoru je na obr. 1. ¡d¡c¡ jednotkou adaptoru
je  mikroprocesor  U880D  (ekvivalent  Z80-CPU).  Ovl dac¡  program je
ulo‘en  v  pamˆti  EPROM,  jako  pracovn¡ pamˆŸ pro vstupn¡ a v˜stupn¡
buffery  slou‘¡  pamˆŸ RAM. Komunikace procesoru s okol¡m prob¡h  p©es
paraleln¡  vstupnˆ/v˜stupn¡ port. Na tento port jsou p©ipojeny sign ly
ze  sn¡mac¡  sondy  -  sn¡man˜  sign l  a sign l tla‡¡tka pro aktivaci
sondy.   Jako  dal¨¡  vstupn¡  sign ly  vstupuje  do  portu  informace
zúp©ep¡na‡–  DIL slou‘¡c¡ k p©ednastaven¡ pou‘it‚ho sn¡man‚ho k¢du. Je
mo‘no navolit jeden ze ‡ty© k¢d–, z rove¤ je mo‘n  i p©edvolba zp–sobu
v˜stupu  dat z adaptoru, pokud je adaptor p©izp–soben k v¡ce v˜stupn¡m
za©¡zen¡m.  Jako  standardn¡  v˜stup  je pou‘it v˜stup na kl vesnicov˜
vstup  termin lu. Na v˜stupu paraleln¡ho portu je nastaven k¢d kl vesy
termin lu  (5  bit–  sloupec  v  k¢du  1 z 5 a 3 bity © dek v bin rn¡m
k¢du).  Tento  v˜stupn¡  k¢d  jde spolu se sign lem multiplexeru © dku
kl vesnice   z   desky  ATS  do  dek¢dovac¡ho  obvodu,  kter˜  porovn 
po‘adovan˜   © dek   kl vesy   z   obvodu   PIO  se  skute‡n˜m  © dkem
zúmultiplexeru. P©i shodˆ © dk– aktivuje v˜stupn¡ budi‡e sloupc–, ‡¡m‘
dojde  k  vybuzen¡ sloupc– p©¡slu¨ej¡c¡ch po‘adovan‚ kl vese. K obvodu
paraleln¡ho  portu  jsou  d le  napojeny  pomocn‚  sing ly, jako nap©.
sp¡n n¡  nap jen¡  sondy,  co‘  je  pou‘ito  k indikaci stavu adaptoru
pomoc¡ diody LED, um¡stˆn‚ uvnit© sondy.

     Podrobn‚ zapojen¡ adaptoru je v p©¡loze 1. Centr ln¡ jednotkou je
mikroprocesor  U880D  (IO1  -  ekvivalent  Z80-CPU). Program je zaps n
vúpamˆtech  EPROM  MHB  2716 (IO3 a‘ IO5). Po‡et pamˆt¡ m–‘e b˜t podle
rozsahu  programu  1 a‘ 3 (kapacita 2 KB, 4 KB nebo 6 KB) . Jednotliv‚
pamˆti  EPROM  tvo©¡  souvisl˜  adresov˜  prostor za‡¡naj¡c¡ na adrese
0000H.  Pro  z pis  dat jsou pou‘ity pamˆti RAM MHB 2114 (IO6 a‘ IO9).
Lze  pou‘¡t  buƒ 2 pamˆti nebo 4 (kapacita 1 KB nebo 2 KB). Pamˆti RAM
IO6  a  IO7  jsou  adresov ny  od  adresy 1800H a zrcadl¡ se od adrese
1C00H.  Pamˆti RAM IO8 a IO9 jsou adresov ny od adresy 2000H a zrcadl¡
se od adresy 2400H. Toto adresov n¡ pamˆt¡ je pou‘ito z d–vod– napodo-
ben¡ zapojen¡ desku STE termin lu BDT, aby bylo mo‘no pou‘¡t k servisu
testovac¡ho a servisn¡ho za©¡zen¡ BPE. K tomuto £‡elu slou‘¡ i propoj-
ky X1 a‘ X3, obvody IO18A a‘ IO18C hradluj¡c¡ sign ly /CS pamˆt¡ EPROM
a  p©ep¡na‡  SW1  a  SW2  slou‘¡c¡ k p©ipojov n¡ programovac¡ho napˆt¡
pamˆt¡  EPROM.  T¡mto  je umo‘nˆn prov dˆt servis adaptoru pomoc¡ BPE,
jako  je testov n¡ a programov n¡ pamˆt¡ a ostatn¡ch obvod– bez jejich
vyj¡m n¡ z desky adaptoru, krokov n¡ programu a pod.

     Jako  paraleln¡  vstupnˆ/v˜stupn¡ obvod slou‘¡ obvod U855D (IO2 -
ekvivalent  Z80-PIO).  Obvod  m   adresy  7Ch a‘ 7Fh (data A,B, ©¡zen¡
A,B),  kter‚ se zrcadl¡ do cel‚ oblasti 00h a‘ 7Fh. Vstupn¡ sign ly ze
sondy  jsou  p©ivedeny  do  PIO p©es integra‡n¡ a p©izp–sobovac¡ ‡leny
C2/R9  a  C3/R10  na  vstupy  PA0 a PA1. V˜stupn¡ adresa © dku kl vesy
zúv˜stup–  PIO PB0 a‘ PB2 je p©ivedena v negovan‚ formˆ na porovn vac¡
obvody  IO16A  a‘  IO16C.  P©i  shodˆ  po‘adovan‚  adresy se skute‡nou
(sign ly  ZL1  a‘  ZL3) je z obvodu NAND IO17A vysl n impuls £rovnˆ L,
kter˜ po negaci hradlem IO16D aktivuje v˜stupn¡ budi‡e IO14A a‘ IO15A.
Tyto  budi‡e  p©ivedou  na  kl vesnicov‚  vstupy sloupc– BDT aktiva‡n¡
sign ly  p©iveden‚  z  obvodu  PIO - PB3 a‘ PB7 (sloupec, kter˜ m  b˜t
aktivov n,  m   £rove¤  H, ostatn¡ L). V˜stupy budi‡– jsou s otev©en˜m
kolektorem,  ‡¡m‘  je  umo‘nˆna paraleln¡ funkce kl vesnice a adaptoru
(kl vesnici  je  ov¨em  mo‘no  pou‘¡t  pouze kdy‘ neprob¡h  v˜stup dat
zúadaptoru,  jinak se budou data navz jem blokovat). Nap jen¡ sondy je
sp¡n no tranzistorem T1 ovl dan˜m bud¡c¡m hradlem IO15B pomoc¡ v˜stupu
PA5  z  PIO.  Vstupy  PA6  a  PA7  obvodu  PIO  jsou pou‘ity pro vstup
nastaven¡ p©edvolby k¢du z p©ep¡na‡– DIL SW3 a SW4. Obvody IO12 a IO13
slou‘¡ k p©¡padn‚mu pou‘it¡ v˜stupu na vstup ze sn¡ma‡e dˆrn˜ch ¨t¡tk–
(nap©.  p©i  po‘adavku rychlej¨¡ho vstupu dat nebo pou‘it¡ pro form ty
pou‘¡vaj¡c¡  tento  vstup),  v  z kladn¡ verzi proto nejsou osazov ny.
Tyto  obvody  jsou za©azeny do cesty sign l– p©ich zej¡c¡ch od sn¡ma‡e
dˆrn˜ch ¨t¡tk– a slou‘¡ k p©ep¡n n¡ vstupu do termin lu boƒ ze sn¡ma‡e
dˆrn˜ch  ¨t¡tk– nebo z adaptoru. Je-li p©ipraven v adaptoru znak k v˜-
stupu,  je  ohled v n  klopn˜  obvod IO11B zaznamen vaj¡c¡ sign l /RES
(nulov n¡  registr–  sn¡ma‡e)  p©ich zej¡c¡  od termin lu. Pokud tento
sign l p©i¨el, je tento stav identifikov n jako p©ipravenost termin lu
ke  vstupu  ze  sn¡ma‡e  ¨t¡tk–  a  multiplexery p©epoj¡ vstup sn¡ma‡e
¨t¡tk–  ze  sn¡ma‡e  na  adaptor  a v˜stup znaku probˆhne na vstup pro
sn¡ma‡ ¨t¡tk–.

     Z  termin lu  BDT  jsou d le odeb¡r ny sign ly  /RESET  a  TAKT1.
Sign l  /RESET  slou‘¡ k resetov n¡ adaptoru p©i resetov n¡  termin lu
(v˜padek  nap jen¡  a pod.) a je slou‡en se  sign lem  z  resetovac¡ho
obvodu  adaptoru  C1/D1/R2,  kter˜ prov d¡ funkci RESET p©i  p©ipojen¡
adaptoru na nap jen¡ nap©.  p©i instalaci adaptoru do zapnut‚ho termi-
n lu.  Sign l TAKT1 je hodinov˜ takt pro procesor a PIO.  Na rozd¡l od
desky STE je syst‚mov˜ takt vydˆlen dˆli‡kou dvˆma IO11A,  ‡¡m‘ odpad 
nutnost  korekce ‡asov n¡ p©¡stup– do pamˆti p©i  pou‘it¡  pomalej¨¡ch
pamˆt¡ (tedy vydˆl¡ 2,4578 MHz na 1,2289 MHz).



3.- Konstruk‡n¡ ©e¨en¡ adaptoru


     Adaptor  je nainstalov n do termin lu BDT jako t©et¡  nadstavbov 
deska  EEL.  Je  na¨roubov na nad desku ZEL.  Desky plo¨n˜ch  spoj–  a
rozm¡stˆn¡ sou‡ stek jsou v p©¡loh ch 2, 3 a 4.

     Rozpis sou‡ stek:

IO1            U 880 D .................. 1 ks
IO2            U 855 D .................. 1 ks
IO3...IO5      MHB 2716 ................. 2 ks (a‘ 3 ks)
IO6...IO9      MHB 2114 ................. 2 ks (nebo 4 ks)
IO10           MH 3205 .................. 1 ks
IO11           MH 74ALS74 ............... 1 ks
IO12, IO13     UCY 74LS157 .............. 0 ks (nebo 2 ks)
IO14, IO15     MH 74ALS38 ............... 2 ks
IO16           MH 74ALS86 ............... 1 ks
IO17           MH 74ALS20 ............... 1 ks
IO18           MH 74ALS08 ............... 1 ks
IO19           MH 74ALS00 ............... 1 ks

T1             KD 140 ................... 1 ks

D1, D2         KA 501 ................... 2 ks

C1             1æ0/6,3V ................. 1 ks
C2             680p ..................... 1 ks
C3             2n2 ...................... 1 ks
C4,C5          2æ2/6,3V ................. 2 ks
C6...C11       68n ...................... 6 ks

R1, R4, R5
R6, R7, R9
R10,R12,R13
R14,R15,R16
R17,R18,R19    2K2 ...................... 15 ks
R2             33K ...................... 1 ks
R3, R21        120 ...................... 2 ks
R8, R20        3K3 ...................... 2 ks
R11            680 ...................... 1 ks

SW1, SW2       p©ep¡na‡ DIL 2x2 p¢l– .... 1 ks
SW3, SW4       dvojit˜ sp¡na‡ DIL 2x2 p.. 1 ks

X2, X3         konektor 2x13 p¢l– ....... 1 ks (1 nebo 2)
X4             konektor 2x5 p¢l– ........ 1 ks

sonda          3WN16601 ................. 1 ks


     Zapojen¡  adaptoru  do  termin lu  je na obr.2. Vstup adaptoru je
napojen  na vsuvku zapojenou mezi kabel pro strojov˜ interface a desku
ZEL  resp.  STE.  V˜stup  adaptoru je napojen pomoc¡ vsuvky mezi desku
displeje  ATS  a  desku  STE-vstup  z  kl vesnice a v˜stup na displej.
Zútohoto  konektoru  se  t‚‘  odeb¡r  nap jec¡ napˆt¡, sign l /RESET a
sign l TAKT1.


          sonda                                         ATS (kabel)
            × X3                                           º
z kladna BDT× X1                  ÚÄÄÄÄÄÄÄÄÄ¿              ×
kabel k ZEL º                     ³         ³              º
          Ú ×                     ³         ³              º
          ³ º                     ³ adaptor ³              º
   vsuvka ´ ÌÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍØµ         ÆØÍÍÍÍÍÍÍÍÍÍÍÍÍ¹ vsuvka
          ³ º                   X4³         ³ X3           º
          À × X4                  ³         ³              º
       ZEL nebo STE               ³         ³              × X8
   (strojn¡ interface)            ÀÄÄÄÄÄÄÄÄÄÙ   STE-vstup kl vesnice
                                       .
                                   X2 ...
                                       .             sn¡ma‡ ¨t¡tk–
                                       .                   .
                                       .                   .
                                       .                   .
                                       .....................
                                                           .
                                                           . X6
                                                 STE-vstup ze sn¡ma‡e

Obr. 2.: Zapojen¡ adaptoru do termin lu


    V¨echny  sign ly  konektoru  X3 jsou p©ipojeny paralelnˆ ke stejnˆ
pojmenovan˜m  sign l–m konektoru X6 (vsuvka je pr–choz¡ a slou‘¡ pouze
k odbo‡en¡ sign l– na desku sn¡ma‡e).

    Sign ly  sondy  jsou  p©ivedeny  p©es  vsuvku  a  kabel  strojn¡ho
interface  na  v˜stup  BDT  a  na  desku strojn¡ho interface, kter  je
um¡stˆna  v  konzole  BDT. P©¡slu¨n‚ sign ly na desku ZEL jsou vsuvkou
odpojeny.

    Sign ly  p©ich zej¡c¡  od  sn¡ma‡e  dˆrn˜ch ¨t¡tk– proch zej¡ p©es
desku  adaptoru.  V  tabulce  zapojen¡  sign l– jsou s ‡ rkou ozna‡eny
sign ly  vystupuj¡c¡  z adaptoru a jdouc¡ na desku STE, bez ‡ rek jsou
ozna‡en‚ sign ly p©ich zej¡c¡ od sn¡ma‡e dˆrn˜ch ¨t¡tk–.
Konektory:

Program tor BPE:                    Sn¡ma‡ dˆrn˜ch ¨t¡tk–
 ÉÍÍÍÍËÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍ»          ÉÍÍÍÍËÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍ»
 º X1 º    A    ³    B    º          º X2 º    A    ³    B    º
 ÌÍÍÍÍÎÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍ¹          ÌÍÍÍÍÎÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍ¹
 º  1 º   0 0   ³   0 0   º          º  1 º    -    ³    -    º
 º  2 º   0 0   ³   0 0   º          º  2 º    -    ³    -    º
 º  3 º   5 P   ³  25 PP  º          º  3 º   RES   ³    -    º
 º  4 º   DB7   ³   DB6   º          º  4 º  /TOR'  ³  /TOR   º
 º  5 º   DB5   ³   DB4   º          º  5 º /START' ³ /START  º
 º  6 º   DB3   ³   DB2   º          º  6 º /ODAT5' ³ /ODAT5  º
 º  7 º   DB1   ³   DB0   º          º  7 º /ODAT4' ³ /ODAT4  º
 º  8 º   /WR   ³   /RD   º          º  8 º /ODAT3' ³ /ODAT3  º
 º  9 º  /MREQ  ³ /MEMDI  º          º  9 º /ODAT2' ³ /ODAT2  º
 º 10 º K2/PCE4 ³ K1/PCE3 º          º 10 º /ODAT1' ³ /ODAT1  º
 º 11 º   AB14  ³   AB15  º          º 11 º    -    ³    -    º
 º 12 º   AB12  ³   AB13  º          º 12 º    -    ³    -    º
 º 13 º   AB10  ³   AB11  º          º 13 º    -    ³    -    º
 º 14 º   AB8   ³   AB9   º          ÈÍÍÍÍÊÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍ¼
 º 15 º   5 P   ³   5 P   º
 º 16 º   AB6   ³   AB7   º          ATS (kl vesnice/displej)
 º 17 º   AB4   ³   AB5   º          ÉÍÍÍÍËÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍ»
 º 18 º   AB2   ³   AB3   º          º X3 º    A    ³    B    º
 º 19 º   AB0   ³   AB1   º          ÌÍÍÍÍÎÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍ¹
 º 20 º  /RESET ³ /BUSRQ  º          º  1 º  TAKT1  ³    -    º
 º 21 º   TAKT  ³  /PCE1  º          º  2 º    -    ³ /RESET  º
 º 22 º  /PCE0  ³  /PCE2  º          º  3 º  /ZL3   ³    -    º
 º 23 º  /NMI   ³  /INT   º          º  4 º    -    ³  /ZL2   º
 º 24 º  /WAIT  ³  /IORQ  º          º  5 º  /ZL1   ³    -    º
 º 25 º  /RFSH  ³ K3/PCE5 º          º  6 º    -    ³  TAA4   º
 º 26 º   /M1   ³/HLT/PCE6º          º  7 º  TAA3   ³    -    º
 º 27 º /BUSAK  ³   POE   º          º  8 º    -    ³  TAA2   º
 º 28 º   0 0   ³   0 0   º          º  9 º  TAA1   ³    -    º
 º 29 º   0 0   ³   0 0   º          º 10 º    -    ³  TAA0   º
 ÈÍÍÍÍÊÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍ¼          º 11 º   5 P   ³    -    º
                                     º 12 º    -    ³   0 0   º
                                     º 13 º   0 0   ³    -    º
                                     ÈÍÍÍÍÊÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍ¼
 Sonda:                              Konektor sondy:
 ÉÍÍÍÍËÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍ»          ÉÍÍÍÍËÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍ»
 º X4 º    A    ³    B    º          º ‡. º  vodi‡  ³ sign l  º
 ÌÍÍÍÍÎÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍ¹          ÌÍÍÍÍÎÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍ¹
 º  1 º   5 P   ³    -    º          º  1 º  ‘lut   ³  + Ucc  º
 º  2 º    -    ³  /DATA  º          º  2 º  zelen  ³   GND   º
 º  3 º   0 0   ³    -    º          º  3 º  hnˆd   ³   OUT   º
 º  4 º    -    ³  /AKT   º          º  4 º st¡nˆn¡ ³    S    º
 º  5 º st¡nˆn¡ ³    -    º          º  5 º   b¡l   ³  /INT   º
 ÈÍÍÍÍÊÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍ¼          ÈÍÍÍÍÊÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍ¼

 Sign ly sondy:
 ÉÍÍÍËÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍ»
 º ‡.º  sign l ³  sonda  ³ konzola ³ konz.X1 ³  ZEL X4 º
 ÌÍÍÍÎÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍ¹
 º 1 º  + Ucc  ³    1    ³    76   ³   B05   ³   A09   º
 º 2 º   GND   ³    2    ³    74   ³   B01   ³   A13   º
 º 3 º   OUT   ³    3    ³    75   ³   B03   ³   A11   º
 º 4 º    S    ³    4    ³    60   ³   A01   ³   B13   º
 º 5 º   /INT  ³    5    ³    61   ³   A03   ³   B11   º
 ÈÍÍÍÊÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍ¼
4. Program - popis

                           ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                           ³               ³
                           ³   R E S E T   ³
                           ³               ³
                           ÀÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÙ
            (RST0)                 ³
           ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
           ³                                              ³
           ³            inicializace adaptoru             ³
           ³                                              ³
           ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
                                   ³  p©eru¨en¡ tla‡¡tkem aktivace
                                   ³<ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
           (AKTIV)                 ³   p©i vypnut‚ sondˆ (INTERA)   ³
           ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿         ³
           ³                zapnut¡ sondy                 ³(AKTIV1) ³
           ³      nastaven¡ ‡¡ta‡e pro vypnut¡ sondy      ³<ÄÄÄ¿    ³
           ³           nastaven¡ p©eru¨en¡ daty           ³    ³    ³
           ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ    ³    ³
                                   ³                           ³    ³
                                   ³<ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿ ³    ³
           (TSTROM)                ³                         ³ ³    ³
           ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿  ³ ³ \  ³
 chyba ROM ³                                              ³  ³ ³ /  ³
  ÚÄÄÄÄÄÄ<Ä´                   test ROM                   ³  ³ ³ \ÄÄÙ
  ³ (-.)   ³                                              ³  ³ ³ /
  ³        ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ  ³ ³ \
  ³        (TSTRAM)                ³                         ³ ³ /
  ³  chyba ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿  ³ ³ \
  ³   RAM  ³                                              ³  ³ ³ /
  ³  ÚÄÄÄ<Ä´                   test RAM                   ³  ³ ³ \
  ³  ³ (.-)³                                              ³  ³ ³ /
  ³  ³     ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ  ³ ³ \
  ³  ³     (TSTPIO)                ³                         ³ ³ /
  ³  ³chybaÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿  ³ ³ \ÄÄ¿
  ³  ³ PIO ³                                              ³  ³ ³ /  ³
  ³  ³  Ú<Ä´                   test PIO                   ³  ³ ³ \  ³
  ³  ³  ³  ³                                              ³  ³ ³ /  ³
  ³  ³  ³  ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ  ³ ³    ³
  ³  ³  ³(--)                      ³                         ³ ³    ³
  ³  ³  ³  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿  ³ ³    ³
  ³  ³  ³  ³         sni‘en¡ ‡¡ta‡e prodlevy pro          ³- ³ ³    ³
  ³  ³  ³  ³                vypnut¡ sondy                 ÃÄ>³ ³    ³
  ³  ³  ³  ³          (je ‡¡ta‡ prodlevy = 0 ?)           ³  ³ ³    ³
  ³  ³  ³  ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ  ³ ³    ³
  ³  ³  ³                         +³ (‡¡ta‡ prodlevy = 0)    ³ ³    ³
  ³  ³  ³  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿  ³ ³    ³
  ³  ³  ³  ³                                              ³  ³ ³    ³
  ³  ³  ³  ³                vypnut¡ sondy                 ³  ³ ³    ³
  ³  ³  ³  ³          nastaven¡ p©eru¨en¡ aktivac¡        ³  ³ ³    ³
  ³  ³  ³  ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ  ³ ³    ³
  ³  ³  ³                          ³                         ³ ³    ³
  ³  ³  ³                          ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ>Ù ³    ³
  ³  ³  ³ (ERROR)                                              ³    ³
ÚÄÁÄÄÁÄÄÁÄÄÄÄÄÄÄÄÄ¿             p©eru¨en¡ datov˜m vstupem p©i  ³    ³
³ indikace  chyby ÃÄ<ÄÄÄ¿       zapnut‚ sondˆ (obsluha ‡ten¡)  ³    ³
ÀÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÙ     ³          ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÙ
         ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ          ³(INTERD)                   ³
                                   ³                    n vrat ³
        (p©eru¨en¡ datov˜m vstupem)³     (n vrat ze vstupu dat)³
                                   ³                           ³
           (DATINI)                ³                           ³
           ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿    ³
           ³                                              ³    ³
      ÉÍÍÍ>³      inicializace dat p©i prvn¡m vstupu      ³    ³
      º    ³          - nastaven¡ ukazatele textu         ³    ³
      º    ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ    ³
      º    (OUTPUT)                ³                           ³
      º    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿    ³
      º    ³                                              ³    ³ \
      º    ³         v˜stup textu na v˜stupn¡ port        ÃÄÄÄÄÙ /
      º    ³                                              ³      \
      º    ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ      /
      º                           /º\                            \<Í»
      º                            º                             /  º
      º    (OUTZNK)               \º/                            \  º
      º    ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»      /  º
      º    º                                              º      \  º
      º    º     podprogram pro v˜stup jednoho znaku      º      /  º
      º    º           (podle nastaven‚ volby)            º         º
      º    ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼         º
      º                              p©eru¨en¡ datov˜m vstupem p©i  º
      º                            ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼
      º    (ZZNAM)               \º/ v˜stupu dat (INTERZ)
      º    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
      º    ³                                              ³
      º    ³          vstup nov˜ch dat ze sondy           ³
      º    ³                                              ³
      º    ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
      º                           /º\
      º                            º
      ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»    º
                              º    º
  (ZAZN0)                    \º/  \º/
  ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
  º                 podprogram vstupu dat ze sondy                 º
  ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶
  º        ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿        º
  º        ³  nastaven¡ ukazatele pro ukl d n¡ do bufferu ³        º
  º        ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ        º
  º                                ³<ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿  º
  º        ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿     ³  º
  º        ³ ‡¡tac¡ smy‡ka (mˆ©en¡ prodlevy mezi hranami) ³     ³  º
  º        ÀÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ     ³  º
  º             ³p©ete‡en¡        /\/\/\/\/\/\/\/\/\/\/\/\      ³  º
  º             ³ impulsu         ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿     ³  º
  º             ³                 ³ ulo‘en¡ d‚lky impulsu ³dal¨¡³  º
  º             ³         ÚÄÄ<ÄÄÄÄ´     do bufferu p©i    ÃÄÄÄ>ÄÙ  º
  º             ³         ³ max.  ³   p©eru¨en¡ (INTERV)  ³impuls  º
  º             ³         ³po‡et  ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ        º
  º             ³         ³impuls–                                 º
  º       ÚÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿        º
  º       ³ - p©evod absolut. impuls– na relativn¡ (TRANS)³        º
  º       ³ - dek¢dov n¡ z znamu a ulo‘en¡ do buff.(DEKOD)³        º
  º       ³    (podprogram pro dek¢dov n¡ jednoho znaku   ³        º
  º       ³       ZNAK vyvol v  podprogram podle k¢du     ³        º
  º       ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ        º
  ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼

P©i©azen¡ k¢d– kl ves termin lu BDT jednotliv˜m znak–m ‡ rov˜ch k¢d–:

    K¢dy jsou voleny vzhledem na mno‘inu znak– k¢d– CKn (k¢dy 48 a‘ 54
nejsou  v tabulce uvedeny, nahrazuj¡ se mezerami), 39 a 2 z 5. Zkratka
mez.   znamen ,  ‘e  do  posloupnosti  v˜stupn¡ch  k¢d–  bude  vlo‘ena
oddˆlovac¡ mezera mezi k¢dy (odpov¡daj¡c¡ dobˆ v˜stupu jednoho znaku).
V˜jimku  tvo©¡  nˆkter‚  speci ln¡ znaky, slou‘¡c¡ k ovl d n¡ adaptoru
pro  ‡ten¡  k¢du.  K¢d  0FFh  m  speci ln¡ v˜znam, ukl d  jej na konec
‡ten‚ho   textu   dek¢duj¡c¡   podprogram   automaticky,  pokud  vlo‘¡
automaticky  znak  odesl n¡  \/  (k¢d  16) a znamen  vlo‘en¡ mezery do
v˜stupu  na  kl vesnici v dobˆ trv n¡ 8 znak–. Znak odesl n¡ se vkl d 
automaticky  na  konec textu p©i p©e‡ten¡ z znamu v k¢du CK5 (tedy k¢d
‡¡slic 0 a‘ 9). Ozna‡en¡ P1 a‘ P8 p©edstavuj¡ rezervn¡ k¢dy BDT, kter‚
nejsou  vyvedeny  na  kl vesnici,  ale  je mo‘n‚ je generovat vyu‘it¡m
© dku ‡¡slo 8 dekod‚ru kl vesnice.

    ÉÍÍÍÍÑÍÍÍÍËÍÍÍÍÑÍÍÍÍËÍÍÍÍÑÍÍÍÍËÍÍÍÍÑÍÍÍÍËÍÍÍÍÑÍÍÍÍËÍÍÍÍÑÍÍÍÍ»
    º  0 ³  0 º  8 ³  8 º 16 ³ \/ º 24 ³ M7 º 32 ³ P1 º 40 ³mez.º
    º  1 ³  1 º  9 ³  9 º 17 ³  < º 25 ³ M8 º 33 ³ P2 º 41 ³mez.º
    º  2 ³  2 º 10 ³  A º 18 ³ M1 º 26 ³  > º 34 ³ P3 º 42 ³mez.º
    º  3 ³  3 º 11 ³  B º 19 ³ M2 º 27 ³  * º 35 ³ P4 º 43 ³mez.º
    º  4 ³  4 º 12 ³  C º 20 ³ M3 º 28 ³  - º 36 ³ P5 º 44 ³ P7 º
    º  5 ³  5 º 13 ³  D º 21 ³ M4 º 29 ³  . º 37 ³ P6 º 45 ³ P8 º
    º  6 ³  6 º 14 ³  E º 22 ³ M5 º 30 ³  X º 38 ³mez.º 46 ³mez.º
    º  7 ³  7 º 15 ³  F º 23 ³ M6 º 31 ³  Y º 39 ³mez.º 47 ³mez.º
    ÈÍÍÍÍÏÍÍÍÍÊÍÍÍÍÏÍÍÍÍÊÍÍÍÍÏÍÍÍÍÊÍÍÍÍÏÍÍÍÍÊÍÍÍÍÏÍÍÍÍÊÍÍÍÍÏÍÍÍÍ¼


5.- € rov˜ k¢d CKn

    K¢dov˜  syst‚m CKn je syst‚m pro z znam dat pomoc¡ ‡ rov‚ho k¢du a
jejich  ‡ten¡  pomoc¡  ru‡n¡ho  sn¡ma‡e.  Umo‘¤uje minimalizovat d‚lku
z znamu  p©i zachov n¡ dostate‡n‚ spolehlivosti ‡ten¡. K¢d CKn vych z¡
z nˆkolika z sad:

    1.-D‚lka  k¢du  jednoho znaku je v jednom z znamu konstantn¡ a je
        voliteln   v rozmez¡ 2 a‘ 8 jednotek (tj. nejmen¨¡ mo‘n  ¨¡©ka
        ‡ ry nebo mezery).

    2.-Po‡et ‡ar ani mezer v jednom znaku nen¡ konstantn¡, jednotliv‚
        znaky,  jako‘  i cel˜ z znam mohou m¡t r–znou polaritu (tedy i
        b¡l˜  tisk  na  ‡ern‚m  podkladˆ).  K¢dov n¡  se prov d¡ pouze
        pomoc¡   hran  p©echodu  mezi  ‡arami  a  mezerami,  je  proto
        libovoln‚, zda jde o ‡ ry nebo mezery.

    3.-Pomˆry  mezi  impulsy  jsou v pomˆru 1:2, co‘ umo‘¤uje snadnou
        synchronizaci  p©i  ‡ten¡  k¢du.  Jednotliv‚  relativn¡  d‚lky
        impuls– jsou 1, 2 a 4.

    4.-Jednotliv˜m  znak–m  p©isuzuje  v˜znam  a‘  dodate‡nˆ u‘ivatel
        podle  oblasti  aplikace  k¢du,  mohou  tedy  m¡t v˜znam znak–
        ASCII,  jako‘  i  ©¡d¡c¡ch  a ovl dac¡ch k¢d– za©¡zen¡. Hlavn¡
        aplikac¡  k¢du CKn je tedy vkl d n¡ dat do za©¡zen¡ a ovl d n¡
        za©¡zen¡.

        Pozn.: Je  vhodn‚, aby u‘ivatel p©i©azoval sv‚ znaky v po©ad¡
               od  znak–  s  nej‡etnˆj¨¡m  v˜skytem,  neboŸ znaky jsou
               ©azeny  podle snadnosti zasynchronizov n¡ p©i ‡ten¡. To
               umo‘¤uje d le zv˜¨it spolehlivost ‡ten¡.

    5.-Jeden  z znam  k¢du  CKn  m  konstantn¡ strukturu. Po‡et znak–
        vújednom  z znamu  m–‘e  b˜t  0  a‘ 17. Z znam lze ‡¡st z obou
        stran a obsahuje kromˆ datov˜ch znak– synchroniza‡n¡ znaky pro
        synchronizaci  ‡ten¡  a  rozpozn n¡  smˆru  ‡ten¡, informaci o
        pou‘it‚m  k¢du v z znamu CK3 a‘ CK8 (d‚lka znak– 3 a‘ 8újedno-
        tek  podle  mno‘iny znak–), informaci o d‚lce z znamu (0 a‘ 17
        znak–)  a kontroln¡ sou‡et pro zabezpe‡en¡ spolehlivosti ‡ten¡
        k¢du.


Struktura z znamu k¢du CKn:


prvk–:     x   2  4    7                        8     4   x
         ÚÄÄÄÄÂÄÂÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄ/   /ÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÂÄÄÄÄ¿
         ³    ³S³   ³      ³                ³       ³ S ³    ³
         ³SYN0³Y³KOD³DELKA ³   D  A  T  A   ³CHKSUM ³ Y ³SYN0³
         ³    ³N³   ³      ³                ³       ³ N ³    ³
         ³    ³1³   ³      ³                ³       ³ 2 ³    ³
         ÀÄÄÄÄÁÄÁÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄ/    /ÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÁÄÄÄÄÙ
k¢d:             CK4  CK7        KOD          CK8


SYN0  -Synchroniza‡n¡  znak  -  slou‘¡  k  synchronizaci referen‡n¡ch
        hodin  p©i  ‡ten¡  (a  to  z  jedn‚  i druh‚ strany). Obsahuje
        libovoln‚  mno‘stv¡  prvk–  o  relativn¡ d‚lce 1. Tyto impulsy
        mus¡ b˜t alespo¤ dva (tedy jedna ‡ ra a jedna mezera).

SYN1  -Synchroniza‡n¡  znak  -  ozna‡uje  za‡ tek  z znamu.  Zahrnuje
        1úprvek o relativn¡ d‚lce 2 jednotky.

SYN2  -Synchroniza‡n¡  znak  -  ozna‡uje  konec  z znamu.  Tvo©¡  jej
        1úprvek  o  relativn¡ d‚lce 4 jednotky. Spolu se SYN1 umo‘¤uje
        rozpozn n¡ smˆru ‡ten¡ z znamu.

KOD   -Informace  o  pou‘it‚m  k¢du  z  mno‘iny  k¢d–.  Tento znak je
        zaznamen n  v  k¢du  CK4  (d‚lka 4 jednotky), jednotliv˜m jeho
        znak–m odpov¡daj¡ d‚lky ozna‡en¡ k¢d– CK3 a‘ CK8 (celkem mo‘no
        volit  6  k¢d–).  Volba  k¢du m–‘e z rove¤ slou‘it jako ©¡d¡c¡
        informace   pro  ‡tec¡  dekod‚r.  Nap©.  lze  nastaven¡m  k¢du
        rozli¨it,  na kter‚ za©¡zen¡ m  prob¡hat v˜stup, zda m  b˜t za
        vysl n¡m  znak–  z znamu  vysl n  automaticky znak odes¡laj¡c¡
        vyslan‚ znaky do za©¡zen¡ apod.

DELKA -Informace  o  d‚lce  z znamu  (po‡tu znak– v z znamu). Znak je
        zaznamen n  v  k¢du  CK7  (d‚lka 7 jednotek), jednotliv˜m jeho
        znak–m  odpov¡d   po‡et  znak–  v  z znamu  0  a‘  30  (z znam
        súnulovou  d‚lkou  m–‘e  b˜t pou‘it k testov n¡ ‡ten¡ sondou a
        kúvyvol n¡ speci ln¡ch akc¡ - nap©. ovl d n¡ dekod‚ru sn¡ma‡e,
        ovl d n¡ sign l–, p©ep¡n n¡ k¢d– pro ‡ten¡).

DATA  -Vlastn¡  z znam  - datov‚ znaky jsou zaznamen ny v k¢du udan‚m
        znakem KOD, jejich po‡et je ud n znakem DELKA.

CHKSUM-Kontroln¡  sou‡et  z znamu.  Kontroln¡ sou‡et je zaps n v k¢du
        CK8.  Prov d¡ se v˜po‡tem ze znak– KOD, DELKA a z jednotliv˜ch
        datov˜ch  znak–  (v uveden‚m po©ad¡). V˜po‡et se prov d¡ podle
        n sleduj¡c¡ho v˜pisu ‡ sti programu:

                   LD   B,DELKA+2 ; po‡et znak– z znamu + 2
                   LD   HL,buff   ; adresa bufferu dat se strukturou:
                                  ;    buff  :   KOD
                                  ;    buff+1:   DELKA
                                  ;    buff+2:   DATA - 1.znak
                                  ;     ....     DATA - dal¨¡ znaky
                   LD   A,28      ; v˜choz¡ konstanta
         CHKSM1:   RLCA           ; rotace A o 1 bit doleva
                   XOR  (HL)      ; operace XOR s datov˜m znakem
                   INC  HL        ; zv˜¨en¡ ukazatele na dal¨¡ znak
                   DJNZ CHKSM1    ; dal¨¡ znak
         CHKSM2:   SUB  55        ; operace MOD 55
                   JR   NC,CHKSM2
                   ADD  A,55      ; v˜sledn˜ kontroln¡ sou‡et CHKSUM

Tabulky k¢d– CKn:

    Tabulky  jsou  ps ny  ve  tvaru  vhodn‚m  ke  vlo‘en¡  do programu
slou‘¡c¡ho ke k¢dov n¡ ‡i dek¢dov n¡ k¢du CKn. Je pou‘ita forma z pisu
pro makroassembler M80 (pro 8-mi bitov‚ po‡¡ta‡e), po men¨¡ £pravˆ t‚‘
pro  assembler  16-ti  bitov‚ho  po‡¡ta‡e. Ka‘d  tabulka za‡¡n  bajtem
ud vaj¡c¡m po‡et znak– v p©¡slu¨n‚m k¢du. N sleduj¡ posloupnosti bajt–
definuj¡c¡ch  ka‘d˜  znak.  Jednotliv‚  bajty  ud vaj¡ relativn¡ d‚lky
prvk–,  z  kter˜ch  se  p©¡slu¨n˜  znak skl d . Posledn¡ bajt znaku m 
nastaven  7.  bit  na 1 (je tedy o 80h vˆt¨¡), co‘ slou‘¡ k rozpozn n¡
konce  znaku.  Nap©.  znak  s  k¢dem  "6" z k¢du CK5 m  v tabulce £daj
2,1,82h,  co‘  znamen ,  ‘e  v z znamu bude vyti¨tˆna ‡ ra o relativn¡
¨¡©ce  2,  mezera o relativn¡ ¨¡©ce 1 a ‡ ra o relativn¡ ¨¡©ce 2. Nebo
mohou b˜t prvky znaku negovan‚ (tedy mezera, ‡ ra, mezera).

kodck3:  db        3                        ; po‡et k¢d– CK3
         db        1,1,81h                  ; "0"
         db        1,82h                    ; "1"
         db        2,81h                    ; "2"

kodck4:  db        6                        ; po‡et k¢d– CK4
         db        1,1,1,81h                ; "0"  (CK3)
         db        1,1,82h                  ; "1"  (CK4)
         db        1,2,81h                  ; "2"  (CK5)
         db        2,1,81h                  ; "3"  (CK6)
         db        2,82h                    ; "4"  (CK7)
         db        84h                      ; "5"  (CK8)

kodck5:  db        10                       ; po‡et k¢d– CK5
         db        1,1,1,1,81h              ; "0"
         db        1,1,1,82h                ; "1"
         db        1,1,2,81h                ; "2"
         db        1,2,1,81h                ; "3"
         db        2,1,1,81h                ; "4"
         db        1,2,82h                  ; "5"
         db        2,1,82h                  ; "6"
         db        2,2,81h                  ; "7"
         db        1,84h                    ; "8"
         db        4,81h                    ; "9"

kodck6:  db        18                       ; po‡et k¢d– CK6
         db        1,1,1,1,1,81h            ; "0"
         db        1,1,1,1,82h              ; "1"
         db        1,1,1,2,81h              ; "2"
         db        1,1,2,1,81h              ; "3"
         db        1,2,1,1,81h              ; "4"
         db        2,1,1,1,81h              ; "5"
         db        1,1,2,82h                ; "6"
         db        1,2,1,82h                ; "7"
         db        2,1,1,82h                ; "8"
         db        1,2,2,81h                ; "9"
         db        2,1,2,81h                ; "10"
         db        2,2,1,81h                ; "11"
         db        2,2,82h                  ; "12"
         db        1,1,84h                  ; "13"
         db        1,4,81h                  ; "14"
         db        4,1,81h                  ; "15"
         db        2,84h                    ; "16"
         db        4,82h                    ; "17"

kodck7:  db        31                       ; po‡et k¢d– CK7
         db        1,1,1,1,1,1,81h          ; "0"
         db        1,1,1,1,1,82h            ; "1"
         db        1,1,1,1,2,81h            ; "2"
         db        1,1,1,2,1,81h            ; "3"
         db        1,1,2,1,1,81h            ; "4"
         db        1,2,1,1,1,81h            ; "5"
         db        2,1,1,1,1,81h            ; "6"
         db        1,1,1,2,82h              ; "7"
         db        1,1,2,1,82h              ; "8"
         db        1,2,1,1,82h              ; "9"
         db        2,1,1,1,82h              ; "10"
         db        1,1,2,2,81h              ; "11"
         db        1,2,1,2,81h              ; "12"
         db        2,1,1,2,81h              ; "13"
         db        1,2,2,1,81h              ; "14"
         db        2,1,2,1,81h              ; "15"
         db        2,2,1,1,81h              ; "16"
         db        1,2,2,82h                ; "17"
         db        2,1,2,82h                ; "18"
         db        2,2,1,82h                ; "19"
         db        2,2,2,81h                ; "20"
         db        1,1,1,84h                ; "21"
         db        1,1,4,81h                ; "22"
         db        1,4,1,81h                ; "23"
         db        4,1,1,81h                ; "24"
         db        1,2,84h                  ; "25"
         db        2,1,84h                  ; "26"
         db        1,4,82h                  ; "27"
         db        2,4,81h                  ; "28"
         db        4,1,82h                  ; "29"
         db        4,2,81h                  ; "30"


kodck8:  db        55                       ; po‡et k¢d– CK8
         db        1,1,1,1,1,1,1,81h        ; "0"
         db        1,1,1,1,1,1,82h          ; "1"
         db        1,1,1,1,1,2,81h          ; "2"
         db        1,1,1,1,2,1,81h          ; "3"
         db        1,1,1,2,1,1,81h          ; "4"
         db        1,1,2,1,1,1,81h          ; "5"
         db        1,2,1,1,1,1,81h          ; "6"
         db        2,1,1,1,1,1,81h          ; "7"
         db        1,1,1,1,2,82h            ; "8"
         db        1,1,1,2,1,82h            ; "9"
         db        1,1,2,1,1,82h            ; "10"
         db        1,2,1,1,1,82h            ; "11"
         db        2,1,1,1,1,82h            ; "12"
         db        1,1,1,2,2,81h            ; "13"
         db        1,1,2,1,2,81h            ; "14"
         db        1,2,1,1,2,81h            ; "15"
         db        2,1,1,1,2,81h            ; "16"
         db        1,1,2,2,1,81h            ; "17"
         db        1,2,1,2,1,81h            ; "18"
         db        2,1,1,2,1,81h            ; "19"
         db        1,2,2,1,1,81h            ; "20"
         db        2,1,2,1,1,81h            ; "21"
         db        2,2,1,1,1,81h            ; "22"
         db        1,1,2,2,82h              ; "23"
         db        1,2,1,2,82h              ; "24"
         db        2,1,1,2,82h              ; "25"
         db        1,2,2,1,82h              ; "26"
         db        2,1,2,1,82h              ; "27"
         db        2,2,1,1,82h              ; "28"
         db        1,2,2,2,81h              ; "29"
         db        2,1,2,2,81h              ; "30"
         db        2,2,1,2,81h              ; "31"
         db        2,2,2,1,81h              ; "32"
         db        1,1,1,1,84h              ; "33"
         db        1,1,1,4,81h              ; "34"
         db        1,1,4,1,81h              ; "35"
         db        1,4,1,1,81h              ; "36"
         db        4,1,1,1,81h              ; "37"
         db        2,2,2,82h                ; "38"
         db        1,1,2,84h                ; "39"
         db        1,2,1,84h                ; "40"
         db        2,1,1,84h                ; "41"
         db        1,1,4,82h                ; "42"
         db        1,2,4,81h                ; "43"
         db        2,1,4,81h                ; "44"
         db        1,4,1,82h                ; "45"
         db        1,4,2,81h                ; "46"
         db        2,4,1,81h                ; "47"
         db        4,1,1,82h                ; "48"
         db        4,1,2,81h                ; "49"
         db        4,2,1,81h                ; "50"
         db        2,2,84h                  ; "51"
         db        2,4,82h                  ; "52"
         db        4,2,82h                  ; "53"
         db        4,84h                    ; "54"


P©iklad - ‡¡slo 714976 v k¢du CK5:

       CK5  6 zn.   7    1    4    9    7    6     41
®   ¯®¯®  ¯®     ¯®   ¯®   ¯®   ¯®   ¯®   ¯®   ¯®      ¯®  ¯®    ¯
Û Û Û  Û  Û  Û Û Û  ÛÛ Û Û  ÛÛ Û ÛÛÛÛ ÛÛ  Û  Û  ÛÛ Û    ÛÛÛÛ Û Û Û
Û Û Û  Û  Û  Û Û Û  ÛÛ Û Û  ÛÛ Û ÛÛÛÛ ÛÛ  Û  Û  ÛÛ Û    ÛÛÛÛ Û Û Û
Û Û Û  Û  Û  Û Û Û  ÛÛ Û Û  ÛÛ Û ÛÛÛÛ ÛÛ  Û  Û  ÛÛ Û    ÛÛÛÛ Û Û Û
Û Û Û  Û  Û  Û Û Û  ÛÛ Û Û  ÛÛ Û ÛÛÛÛ ÛÛ  Û  Û  ÛÛ Û    ÛÛÛÛ Û Û Û
Û Û Û  Û  Û  Û Û Û  ÛÛ Û Û  ÛÛ Û ÛÛÛÛ ÛÛ  Û  Û  ÛÛ Û    ÛÛÛÛ Û Û Û
Û Û Û  Û  Û  Û Û Û  ÛÛ Û Û  ÛÛ Û ÛÛÛÛ ÛÛ  Û  Û  ÛÛ Û    ÛÛÛÛ Û Û Û

SYN0   KOD        ************ DATA ************        SYN2
    SYN1   DELKA                                 CHKSUM      SYN0

6.- Popis ‡innosti sn¡ma‡e ‡ rov˜ch k¢d–

    K¢d,  kter˜  bude  ‡ten  pomoc¡  sondy,  je  mo‘no nastavit pomoc¡
p©ep¡na‡–  DIL  na  adaptoru.  Jako  standardn¡  k¢d  pro  adaptor  se
doporu‡uje  k¢d  CKn, kter˜ je speci lnˆ vyvinut˜ pro pou‘it¡ s ru‡n¡m
sn¡ma‡em ‡ rov‚ho k¢du.

Nastaven¡ p©ep¡na‡– na adaptoru:

 ÉÍÍÍÍÍÑÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
 º SW3 ³ SW4 ³           k¢d           º
 ÌÍÍÍÍÍØÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
 º  ON ³  ON ³           CKn           º
 º OFF ³  ON ³     2/5  prokl dan˜     º
 º  ON ³ OFF ³            39           º
 º OFF ³ OFF ³   2/5 prokl dan˜, 39    º
 ÈÍÍÍÍÍÏÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼

 ÉÍÍÍÍÍÑÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
 º SW1 ³ SW2 ³      re‘im provozu      º
 ÌÍÍÍÍÍØÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
 º  ON ³ OFF ³    programov n¡ EPROM   º
 º OFF ³  ON ³       bˆ‘n˜ provoz      º
 ÈÍÍÍÍÍÏÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼

ostatn¡ kombinace p©ep¡na‡– nejsou povoleny


    Na  sondˆ  je  um¡stˆna  indika‡n¡ sv¡tiv  dioda LED, kter  slou‘¡
kúindikaci  chybov˜ch  stav–  adaptoru a k indikaci spr vn‚ho p©e‡ten¡
z znamu  ‡ rov‚ho k¢du. Tato dioda je v sondˆ p©ipojena p©¡mo k jej¡mu
nap jec¡mu napˆt¡, indikuje tedy z rove¤ to, ‘e je sonda v provozu. Po
zapnut¡  adaptoru  je  sonda zapnuta, tj. je v aktivn¡m stavu, kdy lze
sn¡mat  data.  Pokud  je sonda del¨¡ dobu v klidu (tj. nen¡ ‡ten ‘ dn˜
k¢d),  je  automaticky  vypnuta.  Doba  pro  vypnut¡  je 5 minut. Toto
automatick‚  vypnut¡  slou‘¡  k  sn¡‘en¡ opot©eben¡ sondy a ke zv˜¨en¡
jej¡  spolehlivosti. Nov‚ uveden¡ do provozu je mo‘n‚ stiskem tla‡¡tka
pro aktivaci sondy.

    Pokud je adaptor v klidu (tj. neprob¡h  ani vstup dat ze sondy ani
v˜stup  dat  na za©¡zen¡), prov d¡ adaptor cyklicky testy pamˆt¡ ROM a
RAM a obvodu PIO. Pokud naraz¡ na chybu pamˆt¡ nebo portu, rozblik  se
sonda  v  intervalech  dan˜ch  chybov˜m  k¢dem.  Tyto  testy slou‘¡ ke
kontrole   vlastn¡   ‡innosti   adaptoru   a   t¡m   ke  zv˜¨en¡  jeho
spolehlivosti. Chybov‚ k¢dy jsou:

         - .       chyba pamˆti ROM (EPROM)
         . -       chyba pamˆti RAM
         - -       chyba obvodu PIO

         kde: .  p©edstavuje svit sondy s kr tk˜m intervalem,
              -  znamen  svit sondy s dlouh˜m intervalem.

        Mezi  chybov˜mi  k¢dy  je  z©etelnˆ  del¨¡  interval ne‘ mezi
         jednotliv˜mi elementy jednoho k¢du.

    Indika‡n¡  dioda  LED  slou‘¡  t‚‘  k  indikaci spr vn‚ho p©e‡ten¡
‡ rov‚ho  k¢du  a to t¡m zp–sobem, ‘e po spr vn‚m p©e‡ten¡ k¢du kr tce
zablik . P©i chybn‚m ‡ten¡ k¢du sv¡t¡ LED beze zmˆny intenzity d le.

    €ten‚  k¢dy  se  po  p©ek¢dov n¡ ukl daj¡ do vyrovn vac¡ho bufferu
textu,  co‘  umo‘¤uje  vstup a v˜stup textu nez visle na sobˆ. Je tedy
mo‘no  ‡¡st  sondou  dal¨¡  k¢dy  bez ohledu na to, zda zrovna prob¡h 
v˜stup  p©e‡ten˜ch  k¢d– na za©¡zen¡. €ten¡ dal¨¡ch k¢d– bˆhem v˜stupu
p©e‡ten˜ch  k¢d–  na  za©¡zen¡  je  mo‘n‚  a‘  do zaplnˆn¡ vyrovn vac¡
pamˆti,  co‘  se  projev¡  t¡m,  ‘e  adaptor  ji‘ dal¨¡ k¢dy nep©ij¡m 
(projev¡  se  to tak, jakoby k¢d byl chybnˆ p©e‡ten, sonda nezablik ).
Kapacita vyrovn vac¡ho bufferu je asi 500 znak–.

    P©i  ‡ten¡  k¢du  sondou  je vhodn‚ dodr‘ovat spr vn˜ sklon sondy,
kter˜  ‡in¡  asi  30ø  od  osy  kolm‚ k podkladu s ‡ rov˜m k¢dem, smˆr
odklonu  sondy  je  kolm˜  k pod‚ln‚mu smˆru k¢du (tedy kolm˜ ke smˆru
posuvu  sondou).  Sondou  je  t©eba  pohybovat pokud mo‘no rovnomˆrnou
rychlost¡ a v p©¡m‚m smˆru a v‚st ji po podkladˆ lehce, av¨ak tak, aby
nedo¨lo ke ztr tˆ kontaktu sondy s podkladem. Sondu je t‚‘ nutno dr‘et
lehce a to zp–sobem, jak˜m se dr‘¡ pero.
