CONTEXT   0 241   0   3  72



                                            ; obsluha komunikace p©es SIO/ATS
; ......................................................
2000:18 2f              jr      2031h
; ....................................................
2002:12                 ld      (de),a
2003:c3 56 20           jp      2056h
; ......................................................
2006:c3 5e 20           jp      205eh       ; p©eru¨en¡ - vys¡lac¡ kan l SIO/ATS pr zdn˜
; ......................................................
2009:c3 66 20           jp      2066h       ; p©eru¨en¡ - zmˆna extern¡ho stavu SIO/ATS
; ......................................................
200c:c3 6e 20           jp      206eh       ; p©eru¨en¡ - p©¡jem znaku SIO/ATS
; ......................................................
200f:c3 76 20           jp      2076h       ; p©eru¨en¡ - zvl ¨tn¡ podm¡nky p©¡jmu SIO/ATS
; ......................................................
2012:                   db      0,0,0,20h,21h,20h,3bh,33h,0,0,0,0,0
201f:                   db      30h

2020:                   db      10h         ; vektor p©eru¨en¡ pro SIO/ATS

2021:3e 00              ld      a,0
2023:32 0c 33           ld      (330ch),a
2026:3e 00              ld      a,0
2028:32 4c 33           ld      (334ch),a   ; 1=prob¡h  vys¡l n¡
202b:3e 00              ld      a,0
202d:32 01 33           ld      (3301h),a
2030:c9                 ret     
; ......................................................
2031:f3                 di      
2032:01 09 00           ld      bc,9
2035:11 02 33           ld      de,3302h
2038:21 3b 33           ld      hl,333bh
203b:ed b0              ldir    
203d:cd 0e 23           call    230eh
2040:dd 21 12 20        ld      ix,2012h
2044:fd 21 3b 33        ld      iy,333bh
2048:38 03              jr      c,204dh
204a:c3 64 03           jp      364h
; ......................................................
204d:3a 0b 33           ld      a,(330bh)
2050:32 45 33           ld      (3345h),a
2053:c3 a5 03           jp      3a5h
; ......................................................
2056:cd bf 0c           call    0cbfh       ; £schova registr–
2059:cd 46 21           call    2146h
205c:18 1e              jr      207ch
; ......................................................
                                            ; p©eru¨en¡ - vys¡lac¡ kan l SIO/ATS pr zdn˜
205e:cd bf 0c           call    0cbfh       ; £schova registr–
2061:cd 5c 2b           call    2b5ch       ; vysl n¡ znaku na SIO/ATS
2064:18 16              jr      207ch
; ......................................................
                                            ; p©eru¨en¡ - zmˆna extern¡ho stavu SIO/ATS
2066:cd bf 0c           call    0cbfh       ; £schova registr–
2069:cd 40 2b           call    2b40h       ; vysl n¡ dal¨¡ho znaku p©i p©eru¨en¡ od SIO
206c:18 0e              jr      207ch
; ......................................................
                                            ; p©eru¨en¡ - p©¡jem znaku SIO/ATS
206e:cd bf 0c           call    0cbfh       ; £schova registr–
2071:cd 68 2b           call    2b68h       ; p©¡jem znaku z SIO/ATS
2074:18 06              jr      207ch
; ......................................................
2076:cd bf 0c           call    0cbfh       ; £schova registr–
2079:cd 74 2b           call    2b74h
207c:30 06            * jr      nc,2084h
207e:3a 0b 33           ld      a,(330bh)
2081:32 45 33           ld      (3345h),a
2084:dd 21 12 20        ld      ix,2012h
2088:fd 21 3b 33        ld      iy,333bh
208c:f3                 di      
208d:c3 ad 03           jp      3adh
; ......................................................
2090:                   db      13h
2091:                   db      58h,4,10h,16h,16h,17h,16h,11h,1fh

209a:                   db      1,16h
                                            ; inicializace obvodu SIO/ATS
209c:21 9a 20           ld      hl,209ah
209f:0e f3              ld      c,0f3h
20a1:06 02              ld      b,2
20a3:ed b3              otir                ; nastaven¡ kan lu B-SIO/ATS
20a5:3e 02              ld      a,2
20a7:d3 f3              out     (0f3h),a    ; registr 2
20a9:3a 20 20           ld      a,(2020h)   ; vektor p©eru¨en¡ pro SIO/ATS
20ac:d3 f3              out     (0f3h),a    ; nastaven¡ registru p©eru¨en¡ SIO
20ae:21 91 20           ld      hl,2091h
20b1:06 09              ld      b,9
20b3:c3 26 21           jp      2126h       ; nastaven¡ kan lu A-SIO/ATS
                                            ; (synchronn¡ provoz bez parity,
                                            ; 2 synchroniza‡n¡ znaky 16h)
; ......................................................
20b6:                   db      13h,0c0h,11h,1eh,5,0e0h,6,16h,7,16h
20c0:                   db      0,0,0,0
                                            ; inicializace kan lu A-SIO/ATS pro vys¡l n¡
20c4:21 b6 20           ld      hl,20b6h
20c7:06 0e              ld      b,0eh
20c9:18 5b              jr      2126h
; ......................................................
20cb:                   db      11h,1fh,5,0eah
                                            ; p©epnut¡ kan lu A-SIO/ATS na vys¡l n¡
20cf:21 cb 20           ld      hl,20cbh
20d2:06 04              ld      b,4
20d4:18 50              jr      2126h
; ......................................................
                                            ; resetov n¡ kan lu A-SIO/ATS
20d6:3e 18              ld      a,18h
20d8:d3 f1              out     (0f1h),a    ; ©¡zen¡ kan lu A-SIO/ATS
20da:c9                 ret     
; ......................................................
20db:                   db      3,0c3h
                                            ; uvolnˆn¡ p©ij¡ma‡e s blokov n¡m SYN
20dd:21 db 20           ld      hl,20dbh
20e0:18 42              jr      2124h       ; nastaven¡ registru kan lu SIO-A/ATS
; ......................................................
20e2:                   db      6,16h,7,16h,11h,1dh,5,0e0h,73h,0d3h
                                            ; inicializace kan lu A-SIO/ATS pro p©¡jem
                                            ; (znaky SYN, p©eru¨en¡ p©i ka‘d‚m znaku,
                                            ; znaky 8-bit–, zah jen¡ hledac¡ f ze)
20ec:21 e2 20           ld      hl,20e2h
20ef:06 0a              ld      b,0ah       ; po‡et znak– k vysl n¡
20f1:18 33              jr      2126h
; ......................................................
                                            ; vysl n¡ znaku na kan l A-SIO/ATS
20f3:d3 f0              out     (0f0h),a
20f5:c9                 ret     
; ......................................................
                                            ; p©¡jem znaku z kan lu A-SIO/ATS
20f6:db f0              in      a,(0f0h)    ; kan lu A-SIO/ATS
20f8:c9                 ret     
; ......................................................
                                            ; statut p©ij¡ma‡e kan lu A-SIO/ATS
20f9:3e 01              ld      a,1         ; nastaven¡ registru 1
20fb:d3 f1              out     (0f1h),a    ; ©¡zen¡ kan lu A-SIO/ATS
20fd:db f1              in      a,(0f1h)    ; stav p©ij¡ma‡e kan lu A-SIO/ATS
20ff:c9                 ret     
; ......................................................
                                            ; reset stavov‚ho registru CRC A-SIO/ATS
2100:3e c0              ld      a,0c0h
2102:d3 f1              out     (0f1h),a    ; ©¡zen¡ kan lu A-SIO/ATS
2104:c9                 ret     
; ......................................................
                                            ; uvolnˆn¡ p©eru¨en¡ vys¡la‡e
2105:3e 28              ld      a,28h
2107:d3 f1              out     (0f1h),a    ; ©¡zen¡ kan lu A-SIO/ATS
2109:c9                 ret     
; ......................................................
                                            ; ‡ten¡ stavov‚ho registru A-SIO/ATS
210a:db f1              in      a,(0f1h)    ; ‡ten¡ registru 0 SIO-A/ATS
210c:47                 ld      b,a
210d:3e 10              ld      a,10h
210f:d3 f1              out     (0f1h),a    ; reset extern¡ho stavu SIO-A/ATS
2111:78                 ld      a,b
2112:c9                 ret     
; ......................................................
                                            ; ‡ten¡ stavov‚ho registru A-SIO/ATS
2113:db f1              in      a,(0f1h)
2115:c9                 ret     
; ......................................................
                                            ; nastaven¡ synchroniza‡n¡ho slova A-SIO/ATS
2116:0e f1              ld      c,0f1h      ; ©¡zen¡ kan lu A-SIO/ATS
2118:3e 06              ld      a,6
211a:ed 79              out     (c),a       ; nastaven¡ registru 6
211c:ed 69              out     (c),l       ; nastaven¡ synchroniza‡n¡ho znaku 1
211e:3c                 inc     a
211f:ed 79              out     (c),a       ; nastaven¡ registru 7
2121:ed 61              out     (c),h       ; nastaven¡ synchroniza‡n¡ho znaku 2
2123:c9                 ret     
; ......................................................
                                            ; nastaven¡ registru kan lu SIO-A/ATS
2124:06 02              ld      b,2         ; po‡et bajt– k vysl n¡
2126:0e f1              ld      c,0f1h      ; ©¡zen¡ kan lu A-SIO/ATS
2128:ed b3              otir                ; vysl n¡ k¢du registru a parametru
212a:c9                 ret     
; ......................................................
212b:                   db   3,0c1h
                                            ; p©epnut¡ kan lu A-SIO/ATS na p©¡jem
212d:21 2b 21           ld      hl,212bh
2130:cd 24 21           call    2124h       ; nastaven¡ registru kan lu SIO-A/ATS
2133:c3 6d 31           jp      316dh
; ......................................................
2136:                   db      0,0,0,0,0,0,0,0,0,0,11h
2141:                   dw      3332h
2143:                   dw      3302h
2145:                   db      14h

2146:3a 33 33           ld      a,(3333h)
2149:cb 47              bit     0,a
214b:ca a3 21           jp      z,21a3h     ; stop kan lu 3-CTC/ATS
214e:21 37 33           ld      hl,3337h
2151:06 1c              ld      b,1ch
2153:cd aa 21           call    21aah
2156:21 38 33           ld      hl,3338h
2159:06 1d              ld      b,1dh
215b:cd aa 21           call    21aah
215e:21 39 33           ld      hl,3339h
2161:06 1f              ld      b,1fh
2163:7e                 ld      a,(hl)
2164:a7                 and     a
2165:28 28              jr      z,218fh
2167:35                 dec     (hl)
2168:20 25              jr      nz,218fh
216a:3a 36 33           ld      a,(3336h)
216d:3c                 inc     a
216e:32 36 33           ld      (3336h),a
2171:21 34 33           ld      hl,3334h
2174:be                 cp      (hl)
2175:30 08              jr      nc,217fh
2177:3a 35 33           ld      a,(3335h)
217a:32 39 33           ld      (3339h),a
217d:18 10              jr      218fh
; ......................................................
217f:3a 01 33           ld      a,(3301h)
2182:fe 00              cp      0
2184:cc bb 21           call    z,21bbh
2187:3e 01              ld      a,1
2189:32 36 33           ld      (3336h),a
218c:32 39 33           ld      (3339h),a
218f:21 3a 33           ld      hl,333ah
2192:7e                 ld      a,(hl)
2193:a7                 and     a
2194:28 0b              jr      z,21a1h
2196:3d                 dec     a
2197:77                 ld      (hl),a
2198:20 07              jr      nz,21a1h
219a:21 33 33           ld      hl,3333h
219d:7e                 ld      a,(hl)
219e:cb cf              set     1,a
21a0:77                 ld      (hl),a
21a1:a7                 and     a
21a2:c9                 ret     
; ......................................................
                                            ; stop kan lu 3-CTC/ATS
21a3:0e fb              ld      c,0fbh      ; adresa kan lu 3-CTC/ATS
21a5:3e 03              ld      a,3
21a7:ed 79              out     (c),a
21a9:c9                 ret     
; ......................................................
21aa:7e                 ld      a,(hl)
21ab:a7                 and     a
21ac:c8                 ret     z
21ad:3d                 dec     a
21ae:77                 ld      (hl),a
21af:c0                 ret     nz
21b0:3a 01 33           ld      a,(3301h)
21b3:fe 00              cp      0
21b5:28 04              jr      z,21bbh
21b7:3e 01              ld      a,1
21b9:77                 ld      (hl),a
21ba:c9                 ret     
; ......................................................
21bb:2a 43 21           ld      hl,(2143h)
21be:70                 ld      (hl),b
21bf:cd 0e 23           call    230eh
21c2:e1                 pop     hl
21c3:c9                 ret     
; ......................................................
21c4:af                 xor     a
21c5:32 37 33           ld      (3337h),a
21c8:32 38 33           ld      (3338h),a
21cb:32 39 33           ld      (3339h),a
21ce:32 3a 33           ld      (333ah),a
21d1:3e 01              ld      a,1
21d3:32 33 33           ld      (3333h),a
21d6:0e f8              ld      c,0f8h      ; kan lu 0-CTC/ATS
21d8:3a 1f 20           ld      a,(201fh)
21db:ed 79              out     (c),a
21dd:3e 37              ld      a,37h
21df:ed 79              out     (c),a       ; ‡asovac¡ konstanta pro kan lu 0-CTC/ATS
21e1:2a 41 21           ld      hl,(2141h)
21e4:7e                 ld      a,(hl)
21e5:ed 79              out     (c),a
21e7:0e fb              ld      c,0fbh
21e9:3e b7              ld      a,0b7h
21eb:ed 79              out     (c),a
21ed:3e f0              ld      a,0f0h
21ef:ed 79              out     (c),a
21f1:c9                 ret     
; ......................................................
21f2:06 50              ld      b,50h
21f4:21 37 33           ld      hl,3337h
21f7:18 07              jr      2200h
; ......................................................
21f9:06 50              ld      b,50h
21fb:21 38 33           ld      hl,3338h
21fe:18 00              jr      2200h
; ......................................................
2200:7e                 ld      a,(hl)
2201:a7                 and     a
2202:c0                 ret     nz
2203:70                 ld      (hl),b
2204:c9                 ret     
; ......................................................
2205:3e 5a              ld      a,5ah
2207:18 02              jr      220bh
; ......................................................
2209:3e 82              ld      a,82h
220b:32 35 33           ld      (3335h),a
220e:32 39 33           ld      (3339h),a
2211:c9                 ret     
; ......................................................
2212:3e 1e              ld      a,1eh
2214:18 02              jr      2218h
; ......................................................
2216:3e 50              ld      a,50h
2218:32 3a 33           ld      (333ah),a
221b:3a 33 33           ld      a,(3333h)
221e:cb 8f              res     1,a
2220:32 33 33           ld      (3333h),a
2223:c9                 ret     
; ......................................................
2224:af                 xor     a
2225:32 37 33           ld      (3337h),a
2228:32 38 33           ld      (3338h),a
222b:c9                 ret     
; ......................................................
                                            ; 0 -> (3339h)
222c:af                 xor     a
222d:32 39 33           ld      (3339h),a
2230:c9                 ret     
; ......................................................
                                            ; BIT 1,(3333h)
2231:3a 33 33           ld      a,(3333h)
2234:cb 4f              bit     1,a
2236:c9                 ret     
; ......................................................
2237:3e 00              ld      a,0
2239:32 33 33           ld      (3333h),a
223c:c9                 ret     
; ......................................................
223d:3a 39 33           ld      a,(3339h)
2240:a7                 and     a
2241:c8                 ret     z
2242:3a 35 33           ld      a,(3335h)
2245:32 39 33           ld      (3339h),a
2248:c9                 ret     
; ......................................................
2249:                   db   0,0,0
224c:32 18 33           ld      (3318h),a
224f:32 34 33           ld      (3334h),a
2252:c9                 ret     
; ......................................................
2253:27                 daa     
2254:7e                 ld      a,(hl)
2255:23                 inc     hl
2256:77                 ld      (hl),a
2257:cb 72              bit     6,d
2259:20 05              jr      nz,2260h
225b:cd 69 27           call    2769h
225e:00                 nop     
225f:c9                 ret     
; ......................................................
2260:23                 inc     hl
2261:23                 inc     hl
2262:be                 cp      (hl)
2263:38 05              jr      c,226ah
2265:28 03              jr      z,226ah
2267:23                 inc     hl
2268:18 f6              jr      2260h
; ......................................................
226a:2b                 dec     hl
226b:46                 ld      b,(hl)
226c:2b                 dec     hl
226d:6e                 ld      l,(hl)
226e:60                 ld      h,b
226f:eb                 ex      de,hl
2270:4f                 ld      c,a
2271:af                 xor     a
2272:47                 ld      b,a
2273:09                 add     hl,bc
2274:7e                 ld      a,(hl)
2275:eb                 ex      de,hl
2276:4f                 ld      c,a
2277:af                 xor     a
2278:47                 ld      b,a
2279:09                 add     hl,bc
227a:c9                 ret     
; ......................................................
227b:85                 add     a,l
227c:6f                 ld      l,a
227d:30 01              jr      nc,2280h
227f:24                 inc     h
2280:e5                 push    hl
2281:e1                 pop     hl
2282:7e                 ld      a,(hl)
2283:23                 inc     hl
2284:e5                 push    hl
2285:d5                 push    de
2286:c5                 push    bc
2287:60                 ld      h,b
2288:69                 ld      l,c
2289:cd 60 22           call    2260h
228c:11 91 22           ld      de,2291h
228f:d5                 push    de
2290:e9                 jp      (hl)
; ......................................................
2291:c1                 pop     bc
2292:d1                 pop     de
2293:18 ec              jr      2281h
; ......................................................
2295:dd 7e 00           ld      a,(ix+0)
2298:bc                 cp      h
2299:20 03              jr      nz,229eh
229b:37                 scf     
229c:18 0a              jr      22a8h
; ......................................................
229e:bd                 cp      l
229f:30 07              jr      nc,22a8h
22a1:01 03 00           ld      bc,3
22a4:dd 09              add     ix,bc
22a6:18 ed              jr      2295h
; ......................................................
22a8:c9                 ret     
; ......................................................
22a9:63                 ld      h,e
22aa:25                 dec     h
22ab:cd 01 26           call    2601h
22ae:21 ac 27           ld      hl,27ach
22b1:36 10              ld      (hl),10h
22b3:cb da              set     3,d
22b5:cb c2              set     0,d
22b7:cb f2              set     6,d
22b9:c9                 ret     
; ......................................................
22ba:cd c8 25           call    25c8h
22bd:d0                 ret     nc
22be:fe 04              cp      4
22c0:c8                 ret     z
22c1:21 ae 27           ld      hl,27aeh
22c4:be                 cp      (hl)
22c5:20 07              jr      nz,22ceh
22c7:21 d2 22           ld      hl,22d2h
22ca:22 c3 27           ld      (27c3h),hl
22cd:c9                 ret     
; ......................................................
22ce:cd 56 26           call    2656h
22d1:c9                 ret     
; ......................................................
22d2:cd c8 25           call    25c8h
22d5:d0                 ret     nc
22d6:cb e3              set     4,e
22d8:cb 4a              bit     1,d
22da:20 14              jr      nz,22f0h
22dc:cd e0 26           call    26e0h
22df:cd 76 26           call    2676h
22e2:28 0a              jr      z,22eeh
22e4:cd 86 26           call    2686h
22e7:21 f5 22           ld      hl,22f5h
22ea:22 c3 27           ld      (27c3h),hl
22ed:c9                 ret     
; ......................................................
22ee:cb a3              res     4,e
22f0:21 22 23           ld      hl,2322h
22f3:18 f5              jr      22eah
; ......................................................
22f5:cd b9 25           call    25b9h
22f8:d0                 ret     nc
22f9:cd 76 26           call    2676h
22fc:28 1d              jr      z,231bh
22fe:cd 86 12           call    1286h
2301:05                 dec     b
2302:15                 dec     d
2303:04                 inc     b
2304:10 30              djnz    2336h
2306:10 31              djnz    2339h
2308:10 3b              djnz    2345h
230a:10 3c              djnz    2348h
230c:02                 ld      (bc),a
230d:05                 dec     b
230e:ed 73 16 33        ld      (3316h),sp
2312:3e 01              ld      a,1
2314:32 01 33           ld      (3301h),a
2317:fb                 ei      
2318:cd dc 23           call    23dch
231b:3a 02 33           ld      a,(3302h)
231e:fe 01              cp      1
2320:20 23              jr      nz,2345h
2322:3a 0c 33           ld      a,(330ch)
2325:fe 00              cp      0
2327:28 1c              jr      z,2345h
2329:cd bd 26           call    26bdh
232c:36 01              ld      (hl),1
232e:fe 65              cp      65h
2330:28 13              jr      z,2345h
2332:fe 66              cp      66h
2334:28 0f              jr      z,2345h
2336:fe 68              cp      68h
2338:28 0b              jr      z,2345h
233a:3e 11              ld      a,11h
233c:32 0c 33           ld      (330ch),a
233f:cd ef 25           call    25efh
2342:c3 c4 24           jp      24c4h
; ......................................................
2345:3a 0c 33           ld      a,(330ch)
2348:06 9d              ld      b,9dh
234a:fe c8              cp      0c8h
234c:30 08              jr      nc,2356h
234e:06 52              ld      b,52h
2350:fe 64              cp      64h
2352:30 02              jr      nc,2356h
2354:06 00              ld      b,0
2356:90                 sub     b
2357:11 70 2a           ld      de,2a70h
235a:21 67 2a           ld      hl,2a67h
235d:cd 60 22           call    2260h
2360:cd 78 23           call    2378h
2363:dd 7e 01           ld      a,(ix+1)
2366:32 0c 33           ld      (330ch),a
2369:dd 7e 02           ld      a,(ix+2)
236c:21 01 27           ld      hl,2701h
236f:11 73 26           ld      de,2673h
2372:01 6a 26           ld      bc,266ah
2375:c3 7b 22           jp      227bh
; ......................................................
2378:e5                 push    hl
2379:dd e1              pop     ix
237b:3a 02 33           ld      a,(3302h)
237e:67                 ld      h,a
237f:2e 07              ld      l,7
2381:cd 95 22           call    2295h
2384:38 1b              jr      c,23a1h
2386:20 03              jr      nz,238bh
2388:bc                 cp      h
2389:30 16              jr      nc,23a1h
238b:2e 1b              ld      l,1bh
238d:cd 95 22           call    2295h
2390:38 0f              jr      c,23a1h
2392:20 08              jr      nz,239ch
2394:bc                 cp      h
2395:38 05              jr      c,239ch
2397:3e 07              ld      a,7
2399:bc                 cp      h
239a:38 05              jr      c,23a1h
239c:2e 20              ld      l,20h
239e:cd 95 22           call    2295h
23a1:c9                 ret     
; ......................................................
23a2:3e 00              ld      a,0
23a4:18 07              jr      23adh
; ......................................................
23a6:3e 01              ld      a,1
23a8:18 03              jr      23adh
; ......................................................
23aa:3a 0d 33           ld      a,(330dh)
23ad:32 0f 33           ld      (330fh),a
23b0:c9                 ret     
; ......................................................
23b1:3e 00              ld      a,0
23b3:18 09              jr      23beh
; ......................................................
23b5:3e 01              ld      a,1
23b7:18 05              jr      23beh
; ......................................................
23b9:3a 0d 33           ld      a,(330dh)
23bc:ee 01              xor     1
23be:32 0d 33           ld      (330dh),a
23c1:c9                 ret     
; ......................................................
23c2:3e 01              ld      a,1
23c4:18 02              jr      23c8h
; ......................................................
23c6:3e 00              ld      a,0
23c8:32 0e 33           ld      (330eh),a
23cb:c9                 ret     
; ......................................................
23cc:3e 02              ld      a,2
23ce:18 1d              jr      23edh
; ......................................................
23d0:3e 11              ld      a,11h
23d2:18 19              jr      23edh
; ......................................................
23d4:3e 04              ld      a,4
23d6:18 15              jr      23edh
; ......................................................
23d8:3e 0c              ld      a,0ch
23da:18 11              jr      23edh
; ......................................................
23dc:2a 09 33           ld      hl,(3309h)
23df:2b                 dec     hl
23e0:3e 00              ld      a,0
23e2:77                 ld      (hl),a
23e3:3e 00              ld      a,0
23e5:18 06              jr      23edh
; ......................................................
23e7:3e 12              ld      a,12h
23e9:18 02              jr      23edh
; ......................................................
23eb:3e 14              ld      a,14h
23ed:32 0b 33           ld      (330bh),a
23f0:c9                 ret     
; ......................................................
23f1:cd 37 22           call    2237h
23f4:c9                 ret     
; ......................................................
23f5:cd 1b 24           call    241bh
23f8:21 19 33           ld      hl,3319h
23fb:be                 cp      (hl)
23fc:d8                 ret     c
23fd:cd 2c 22           call    222ch       ; 0 -> (3339h)
2400:cd d0 23           call    23d0h
2403:18 21              jr      2426h
; ......................................................
2405:cd 1b 24           call    241bh
2408:21 19 33           ld      hl,3319h
240b:be                 cp      (hl)
240c:d8                 ret     c
240d:cd d0 23           call    23d0h
2410:3e 11              ld      a,11h
2412:32 0c 33           ld      (330ch),a
2415:cd ef 25           call    25efh
2418:c3 c4 24           jp      24c4h
; ......................................................
241b:3a 10 33           ld      a,(3310h)
241e:3c                 inc     a
241f:32 10 33           ld      (3310h),a
2422:c9                 ret     
; ......................................................
2423:cd d4 23           call    23d4h
2426:cd 8c 24           call    248ch
2429:cd da 24           call    24dah
242c:c3 4e 24           jp      244eh
; ......................................................
242f:21 11 33           ld      hl,3311h
2432:ed 5b 03 33        ld      de,(3303h)
2436:ed 4b 05 33        ld      bc,(3305h)
243a:ed b0              ldir    
243c:c9                 ret     
; ......................................................
243d:3a 0d 33           ld      a,(330dh)
2440:fe 00              cp      0
2442:18 05              jr      2449h
; ......................................................
2444:3a 0d 33           ld      a,(330dh)
2447:fe 01              cp      1
2449:20 09              jr      nz,2454h
244b:cd b6 25           call    25b6h
244e:cd ff 24           call    24ffh
2451:c3 59 26           jp      2659h
; ......................................................
2454:3e c8              ld      a,0c8h
2456:32 0c 33           ld      (330ch),a
2459:c9                 ret     
; ......................................................
245a:3a 0e 33           ld      a,(330eh)
245d:fe 00              cp      0
245f:28 05              jr      z,2466h
2461:cd 09 25           call    2509h
2464:18 08              jr      246eh
; ......................................................
2466:cd 5a 25           call    255ah
2469:3e c8              ld      a,0c8h
246b:32 0c 33           ld      (330ch),a
246e:c9                 ret     
; ......................................................
246f:3a 0d 33           ld      a,(330dh)
2472:fe 00              cp      0
2474:18 05              jr      247bh
; ......................................................
2476:3a 0d 33           ld      a,(330dh)
2479:fe 01              cp      1
247b:28 06              jr      z,2483h
247d:3e c8              ld      a,0c8h
247f:32 0c 33           ld      (330ch),a
2482:c9                 ret     
; ......................................................
2483:cd f9 21           call    21f9h
2486:cd b6 25           call    25b6h
2489:c3 bc 24           jp      24bch
; ......................................................
248c:3e 01              ld      a,1
248e:32 0c 33           ld      (330ch),a
2491:c9                 ret     
; ......................................................
2492:3a 03 33           ld      a,(3303h)
2495:32 19 33           ld      (3319h),a
2498:32 18 33           ld      (3318h),a
249b:3a 04 33           ld      a,(3304h)
249e:32 34 33           ld      (3334h),a
24a1:3a 05 33           ld      a,(3305h)
24a4:32 27 33           ld      (3327h),a
24a7:3a 06 33           ld      a,(3306h)
24aa:32 28 33           ld      (3328h),a
24ad:3a 08 33           ld      a,(3308h)
24b0:32 32 33           ld      (3332h),a
24b3:cd c4 21           call    21c4h
24b6:f3                 di      
24b7:cd 09 22           call    2209h
24ba:fb                 ei      
24bb:c9                 ret     
; ......................................................
24bc:f3                 di      
24bd:ed 7b 16 33        ld      sp,(3316h)
24c1:37                 scf     
24c2:18 10              jr      24d4h
; ......................................................
24c4:cd 63 26           call    2663h
24c7:ed 7b 16 33        ld      sp,(3316h)
24cb:c3 26 2b           jp      2b26h
; ......................................................
24ce:f3                 di      
24cf:ed 7b 16 33        ld      sp,(3316h)
24d3:a7                 and     a
24d4:3e 00              ld      a,0
24d6:32 01 33           ld      (3301h),a
24d9:c9                 ret     
; ......................................................
24da:f3                 di      
24db:21 00 00           ld      hl,0
24de:7c                 ld      a,h
24df:a7                 and     a
24e0:20 08              jr      nz,24eah
24e2:3e 05              ld      a,5
24e4:bd                 cp      l
24e5:38 03              jr      c,24eah
24e7:21 05 00           ld      hl,5
24ea:22 2e 33           ld      (332eh),hl
24ed:3e 01              ld      a,1
24ef:32 1a 33           ld      (331ah),a
24f2:fb                 ei      
24f3:c9                 ret     
; ......................................................
24f4:3a 34 33           ld      a,(3334h)
24f7:3d                 dec     a
24f8:32 36 33           ld      (3336h),a
24fb:c9                 ret     
; ......................................................
24fc:c9                 ret     
; ......................................................
24fd:c9                 ret     
; ......................................................
24fe:c9                 ret     
; ......................................................
24ff:21 03 23           ld      hl,2303h
2502:18 08              jr      250ch
; ......................................................
2504:21 02 23           ld      hl,2302h
2507:18 03              jr      250ch
; ......................................................
2509:21 01 23           ld      hl,2301h
250c:cd 81 25           call    2581h
250f:c9                 ret     
; ......................................................
2510:3a 18 33           ld      a,(3318h)
2513:32 34 33           ld      (3334h),a
2516:c9                 ret     
; ......................................................
2517:21 04 23           ld      hl,2304h
251a:18 2b              jr      2547h
; ......................................................
251c:21 06 23           ld      hl,2306h
251f:18 26              jr      2547h
; ......................................................
2521:21 0a 23           ld      hl,230ah
2524:18 21              jr      2547h
; ......................................................
2526:3a 0f 33           ld      a,(330fh)
2529:fe 01              cp      1
252b:28 09              jr      z,2536h
252d:fe 49              cp      49h
252f:28 0a              jr      z,253bh
2531:cd 17 25           call    2517h
2534:18 08              jr      253eh
; ......................................................
2536:cd 1c 25           call    251ch
2539:18 03              jr      253eh
; ......................................................
253b:cd 21 25           call    2521h
253e:c9                 ret     
; ......................................................
253f:21 08 23           ld      hl,2308h
2542:18 03              jr      2547h
; ......................................................
2544:21 0c 23           ld      hl,230ch
2547:cd 8a 25           call    258ah
254a:c9                 ret     
; ......................................................
254b:3a 0d 33           ld      a,(330dh)
254e:fe 01              cp      1
2550:28 04              jr      z,2556h
2552:cd 17 25           call    2517h
2555:c9                 ret     
; ......................................................
2556:cd 1c 25           call    251ch
2559:c9                 ret     
; ......................................................
255a:2a 03 33           ld      hl,(3303h)
255d:cd 81 25           call    2581h
2560:2a 05 33           ld      hl,(3305h)
2563:22 23 33           ld      (3323h),hl
2566:2a 07 33           ld      hl,(3307h)
2569:22 25 33           ld      (3325h),hl
256c:c9                 ret     
; ......................................................
256d:af                 xor     a
256e:32 36 33           ld      (3336h),a
2571:32 10 33           ld      (3310h),a
2574:c9                 ret     
; ......................................................
2575:cd 09 22           call    2209h
2578:18 03              jr      257dh
; ......................................................
257a:cd 05 22           call    2205h
257d:cd 6d 25           call    256dh
2580:c9                 ret     
; ......................................................
2581:22 21 33           ld      (3321h),hl
2584:a7                 and     a
2585:ed 62              sbc     hl,hl
2587:23                 inc     hl
2588:18 08              jr      2592h
; ......................................................
258a:22 21 33           ld      (3321h),hl
258d:a7                 and     a
258e:ed 62              sbc     hl,hl
2590:23                 inc     hl
2591:23                 inc     hl
2592:22 23 33           ld      (3323h),hl
2595:21 25 33           ld      hl,3325h
2598:22 25 33           ld      (3325h),hl
259b:c9                 ret     
; ......................................................
259c:f3                 di      
259d:2a 03 33           ld      hl,(3303h)
25a0:22 1b 33           ld      (331bh),hl
25a3:2a 05 33           ld      hl,(3305h)
25a6:22 1d 33           ld      (331dh),hl
25a9:3e 00              ld      a,0
25ab:32 1a 33           ld      (331ah),a
25ae:2a 07 33           ld      hl,(3307h)
25b1:22 1f 33           ld      (331fh),hl
25b4:fb                 ei      
25b5:c9                 ret     
; ......................................................
25b6:2a 07 33           ld      hl,(3307h)
25b9:5e                 ld      e,(hl)
25ba:23                 inc     hl
25bb:56                 ld      d,(hl)
25bc:eb                 ex      de,hl
25bd:7e                 ld      a,(hl)
25be:06 06              ld      b,6
25c0:fe 03              cp      3
25c2:28 06              jr      z,25cah
25c4:06 04              ld      b,4
25c6:fe 17              cp      17h
25c8:20 07              jr      nz,25d1h
25ca:2a 09 33           ld      hl,(3309h)
25cd:2b                 dec     hl
25ce:7e                 ld      a,(hl)
25cf:b0                 or      b
25d0:77                 ld      (hl),a
25d1:c9                 ret     
; ......................................................
25d2:2a 09 33           ld      hl,(3309h)
25d5:2b                 dec     hl
25d6:7e                 ld      a,(hl)
25d7:f6 08              or      8
25d9:77                 ld      (hl),a
25da:c9                 ret     
; ......................................................
25db:cd 1b 24           call    241bh
25de:21 19 33           ld      hl,3319h
25e1:be                 cp      (hl)
25e2:d8                 ret     c
25e3:cd 10 25           call    2510h
25e6:cd d0 23           call    23d0h
25e9:cd 8c 24           call    248ch
25ec:c3 bc 24           jp      24bch
; ......................................................
25ef:cd ff 24           call    24ffh
25f2:18 0e              jr      2602h
; ......................................................
25f4:cd 6d 25           call    256dh
25f7:cd 5a 25           call    255ah
25fa:18 06              jr      2602h
; ......................................................
25fc:cd 6d 25           call    256dh
25ff:cd 24 22           call    2224h
2602:cd 05 22           call    2205h
2605:c9                 ret     
; ......................................................
2606:2a 05 33           ld      hl,(3305h)
2609:7c                 ld      a,h
260a:b5                 or      l
260b:c0                 ret     nz
260c:cd d2 25           call    25d2h
260f:cd 04 25           call    2504h
2612:cd 8c 24           call    248ch
2615:c3 59 26           jp      2659h
; ......................................................
2618:cd f9 21           call    21f9h
261b:c9                 ret     
; ......................................................
261c:cd f2 21           call    21f2h
261f:c9                 ret     
; ......................................................
2620:af                 xor     a
2621:32 36 33           ld      (3336h),a
2624:c3 f5 23           jp      23f5h
; ......................................................
2627:cd 24 22           call    2224h
262a:c9                 ret     
; ......................................................
262b:cd 09 22           call    2209h
262e:c9                 ret     
; ......................................................
262f:cd 2c 22           call    222ch       ; 0 -> (3339h)
2632:c9                 ret     
; ......................................................
2633:cd 05 22           call    2205h
2636:c9                 ret     
; ......................................................
2637:cd f5 23           call    23f5h
263a:cd 33 26           call    2633h
263d:c3 c4 24           jp      24c4h
; ......................................................
2640:cd 63 26           call    2663h
2643:ed 7b 16 33        ld      sp,(3316h)
2647:3e 00              ld      a,0
2649:32 4c 33           ld      (334ch),a   ; 1=prob¡h  vys¡l n¡
264c:c3 02 2b           jp      2b02h
; ......................................................
264f:cd 63 26           call    2663h
2652:ed 7b 16 33        ld      sp,(3316h)
2656:c3 14 2b           jp      2b14h
; ......................................................
2659:cd 63 26           call    2663h
265c:ed 7b 16 33        ld      sp,(3316h)
2660:c3 33 2b           jp      2b33h
; ......................................................
2663:f3                 di      
2664:3e 00              ld      a,0
2666:32 01 33           ld      (3301h),a
2669:c9                 ret     
; ......................................................
266a:                   db   0a2h,23h,1fh,0a2h,24h,36h,0a2h,25h,0ffh
2673:                   db   0,0,4,8,8,0fh,13h,17h,20h,24h
267d:                   db   2ah,2eh,32h,36h,3ah,45h,45h,49h,4fh
2686:                   db   53h,63h,79h,81h,8dh,0,9bh,0a2h
268e:                   db   0b8h,0cdh,0d4h,0eah,0f0h,1ah,22h,2ch,38h,52h
2698:                   db   5dh,62h,67h,6eh,75h,7ah,7fh,84h,9dh,0a2h,0a9h
26a3:                   db   0b8h,0cbh,0d3h,0d8h,0dfh,0e8h,0fah,14h,14h
26ac:                   db   30h,39h,4dh,52h,5ah,64h,76h,7ah

26b4:7e                 ld      a,(hl)
26b5:85                 add     a,l
26b6:89                 adc     a,c
26b7:8d                 adc     a,l
26b8:91                 sub     c
26b9:95                 sub     l
26ba:9e                 sbc     a,(hl)
26bb:ad                 xor     l
26bc:b7                 or      a
26bd:cd 6d 25           call    256dh
26c0:21 34 33           ld      hl,3334h
26c3:c9                 ret     
; ......................................................
26c4:                   db   0,0,0,0,0,0,0,0,0,0,0,0

26d0:56                 ld      d,(hl)
26d1:26 3e              ld      h,3eh
26d3:04                 inc     b
26d4:cd 91 26           call    2691h
26d7:cd b6 26           call    26b6h
26da:21 ac 27           ld      hl,27ach
26dd:36 08              ld      (hl),8
26df:c9                 ret     
; ......................................................
26e0:21 00 00           ld      hl,0
26e3:22 a5 27           ld      (27a5h),hl
26e6:c9                 ret     
; ......................................................
26e7:cd f9 26           call    26f9h
26ea:3e 06              ld      a,6
26ec:cd 91 26           call    2691h
26ef:c9                 ret     
; ......................................................
26f0:21 c6 27           ld      hl,27c6h
26f3:35                 dec     (hl)
26f4:c0                 ret     nz
26f5:cd be 26           call    26beh
26f8:c9                 ret     
; ......................................................
26f9:                   db   21h,83h,22h,22h,0bfh,27h,21h,13h,22h,23h,1fh
2704:                   db   31h,47h,0ah,20h,3bh,21h,36h,1,32h,22h,32h,22h
2710:                   db   3fh,22h,40h,22h,39h,25h,49h,17h,23h,0dh,20h
271b:                   db   23h,0dh,20h,3eh,0ah,20h,3eh,0ah,40h,20h,1,5
2727:                   db   36h,3dh,29h,21h,3,5,36h,3dh,2bh,21h,33h,2dh
2733:                   db   21h,28h,0ch,20h,33h,2eh,21h,36h,3dh,2fh,21h
273e:                   db   43h,22h,24h,43h,22h,36h,4,31h,22h,23h,25h,0ah
274a:                   db   49h,2ch,5,33h,36h,21h,2dh,0ah,49h,42h,22h,42h
2756:                   db   2fh,33h,21h,31h,22h,40h,23h,7,38h,20h,23h,10h
2762:                   db   20h,36h,4,32h,22h,33h,2ch,36h,21h,26h,21h,33h
276e:                   db   2ch,21h,6,8,3ch,21h,6,9,3ch,21h,0dh,20h,3ah
277b:                   db   43h,22h,33h,2dh,21h,28h,44h,20h,42h,22h,11h
2786:                   db   25h,49h,7,8,3ch,21h,12h,48h,0bh,20h,13h,43h
2792:                   db   22h,36h,2fh,46h,36h,26h,46h,14h,43h,22h,16h
279d:                   db   38h,23h,10h,20h,2fh,46h,2fh,14h,45h,21h,26h
27a8:                   db   46h,19h,30h,41h,45h,21h,1ah,30h,41h,45h,21h
27b3:                   db   1bh,41h,45h,21h,30h,41h,45h,21h,27h,41h,45h
27be:                   db   21h,1ch,30h,41h,45h,21h,1dh,30h,41h,45h,21h
27c9:                   db   0ch,23h,20h,25h,21h,2dh,21h,0,0,0,0,0,0,0,10h
27d8:                   db   1,7,0,5,20h,0,0,3,0eh,9,6,0fh,0dh,7,1,5,8,3
27ea:                   db   0fh,9,4,11h,20h,1,0,3,7,16h,6,0c8h,6fh,7,3
27f9:                   db   5,1bh,1,0,1dh,1,36h,20h,3,0,3,6,16h,6,4,1dh
2809:                   db   7,4,5,1bh,1,0,1ch,1,30h,20h,4,0,3,64h,24h,6
2819:                   db   6,1dh,7,6,5,1ch,1,30h,0bh,1,0,20h,6,0,3,1,13h
282a:                   db   6,0c8h,6fh,7,2,0fh,0bh,1,0,1dh,1,36h,20h,7
2838:                   db   0,8,7,1ah,9,6,1ah,1bh,0eh,8fh,1fh,1,9bh,20h
2846:                   db   0eh,0,8,0c8h,6fh,9,4,20h,1bh,0fh,8fh,1fh,1
2853:                   db   9bh,20h,0fh,0,0bh,1,7fh,1bh,10h,79h,1fh,1,33h
2860:                   db   20h,10h,0,20h,0,8bh,1bh,67h,3dh,1fh,1,9bh,20h
286d:                   db   64h,0,1,69h,54h,3,6fh,39h,6,71h,54h,7,65h,5
287b:                   db   0bh,0dch,52h,1bh,65h,11h,1ch,66h,30h,20h,65h
2886:                   db   0,1,73h,58h,3,6dh,42h,6,75h,58h,7,66h,5,1bh
2894:                   db   68h,0,1fh,0dah,0,20h,66h,0,0bh,1,5fh,14h,65h
28a1:                   db   5ah,15h,78h,5ah,0ch,64h,92h,1bh,64h,95h,1fh
28ac:                   db   1,9bh,20h,67h,0,1,74h,0dh,3,6ah,62h,6,76h,0dh
28ba:                   db   7,68h,5,0bh,0dch,0,1bh,65h,11h,20h,68h,0,1bh
28c7:                   db   6bh,3dh,1fh,11h,7,20h,69h,0,0bh,1,5fh,0ch,6fh
28d4:                   db   6ch,1bh,6ah,8fh,1fh,1,9bh,20h,6ah,0,0ch,69h
28e0:                   db   0a2h,1bh,11h,7,1fh,11h,7,20h,6bh,0,1bh,6ah
28ec:                   db   0dh,1fh,1,9bh,20h,6dh,0,1bh,70h,3dh,1fh,1,9bh
28f9:                   db   20h,6fh,0,0bh,0eh,9,0ch,6fh,0a0h,1bh,6fh,0a6h
2905:                   db   1fh,1,9bh,20h,70h,0,1bh,72h,3dh,1fh,1,9bh,20h
2912:                   db   71h,0,0bh,0fh,0dh,0ch,71h,0a0h,1bh,71h,0a6h
291d:                   db   1fh,1,9bh,20h,72h,0,1bh,74h,0dh,1fh,11h,7,20h
292a:                   db   73h,0,0bh,11h,7,0ch,69h,54h,1bh,74h,98h,1fh
2936:                   db   11h,7,20h,74h,0,1bh,76h,0dh,1fh,1,9bh,20h,75h
2943:                   db   0,0bh,1,5fh,0ch,71h,54h,1bh,76h,8fh,1fh,1,9bh
2950:                   db   20h,76h,0,3,64h,39h,7,78h,5,0bh,0dch,52h,1bh
295d:                   db   78h,11h,1ch,79h,30h,20h,78h,0,3,7ah,42h,7,79h
296a:                   db   5,1bh,7ch,0,1fh,0dah,0,20h,79h,0,1bh,7bh,0dh
2977:                   db   1fh,1,9bh,20h,7ah,0,0bh,1,5fh,0ch,64h,66h,1bh
2984:                   db   7bh,8fh,1fh,1,9bh,20h,7bh,0,3,7bh,62h,7,7ch
2991:                   db   5,0bh,0dch,0,1bh,78h,11h,20h,7ch,0,17h,0c9h
299d:                   db   3fh,18h,0cah,3fh,19h,0cbh,3dh,1bh,0d5h,3dh
29a7:                   db   1fh,1,9bh,20h,0c8h,0,0bh,1,9ch,0ch,0d1h,0b2h
29b3:                   db   0dh,0c8h,0b6h,11h,1,0a8h,12h,1,0adh,1bh,0d1h
29be:                   db   0bah,1fh,0d1h,0bah,20h,0c9h,0,0bh,1,9ch,0ch
29c9:                   db   0d2h,0b2h,0dh,0c8h,0b6h,11h,0cfh,0beh,12h,0cfh
29d3:                   db   0c3h,1bh,0d2h,0bah,1fh,0d2h,0bah,20h,0cah,0
29dd:                   db   1bh,1,84h,1fh,1,9bh,20h,0cbh,0,0bh,1,5fh,0dh
29ea:                   db   0c8h,87h,1bh,0cdh,8fh,1fh,1,9bh,20h,0cdh,0
29f5:                   db   6,0c8h,87h,7,0cfh,5,0bh,0dch,82h,1dh,0d3h,36h
2a01:                   db   20h,0cfh,0,1bh,0c9h,3fh,1fh,1,9bh,20h,0d1h
2a0c:                   db   0,1bh,0cah,3fh,1fh,1,9bh,20h,0d2h,0,6,0d7h
2a18:                   db   58h,7,0d3h,5,1bh,0d4h,0,1fh,0dah,0,20h,0d3h
2a24:                   db   0,6,0cdh,0dh,7,0d4h,5,0bh,0dch,0,1bh,0cfh,0fh
2a31:                   db   20h,0d4h,0,0bh,1,5fh,0dh,0c8h,0b6h,1bh,0d5h
2a3c:                   db   8fh,1fh,1,9bh,20h,0d5h,0,7,1,5fh,8,0dch,0cbh
2a49:                   db   9,0dch,0cdh,20h,0dch,0,20h,0d6h,0,1bh,0cdh
2a54:                   db   0dh,1fh,1,9bh,20h,0d7h,0,7,1,0c8h,20h,0dah
2a60:                   db   0,7,1,5fh,20h,0dch,0,0d6h,27h,18h,0d6h,28h
2a6c:                   db   2dh,0d6h,29h,0ffh,0,9,0,1bh,2dh,0,3fh,51h,0
2a79:                   db   0,0,0,0,0,63h,72h,81h,8dh,90h,99h,0b1h,0c6h
2a86:                   db   0dbh,0f0h,0f9h,8,14h,14h,1dh,1dh,26h,35h,3eh
2a91:                   db   4dh,56h,65h,6eh,0,7dh,8fh,9eh,0a7h,0b6h,0c5h
2a9c:                   db   0d7h,0efh,7,0,10h,1fh,1fh,2eh,2eh,37h,40h,4fh
2aa8:                   db   5eh,6dh,7ch,0,0,85h,0,6dh,27h,36h,10h,0cbh
2ab4:                   db   0dah,0cbh,0c2h,0cbh,0f2h,0c9h,0cdh,0c8h,25h
2abd:                   db   0d0h,0feh,4,0c8h,21h,0a8h,27h,0beh,20h,7,21h
2ac8:                   db   0d2h,22h,22h,0bdh,27h,0c9h,0cdh,50h,26h,0c9h
2ad2:                   db   0cdh,0c8h,25h,0d0h,0cbh,0e3h,0cbh,4ah,20h,14h
2adc:                   db   0cdh,0dah,26h,0cdh,70h,26h,28h,0ah
2ae4:cd 80 26           call    2680h
2ae7:21 f5 22           ld      hl,22f5h
2aea:22 bd 27           ld      (27bdh),hl
2aed:c9                 ret     
; ......................................................
2aee:cb a3              res     4,e
2af0:21 22 23           ld      hl,2322h
2af3:18 f5              jr      2aeah
; ......................................................
2af5:cd b9 25           call    25b9h
2af8:d0                 ret     nc
2af9:cd 70 26           call    2670h
2afc:28 1d              jr      z,2b1bh
2afe:cd 80 14           call    1480h
2b01:02                 ld      (bc),a
2b02:ed 73 5f 33        ld      (335fh),sp  ; £schova SP p©i p©eru¨en¡ od SIO-A/ATS
2b06:cd 80 2b           call    2b80h       ; je vys¡l n¡ ?
2b09:ca 70 31           jp      z,3170h     ; vys¡l n¡ - n vrat z obsluhy SIO/ATS
2b0c:3e 01              ld      a,1
2b0e:32 4c 33           ld      (334ch),a   ; 1=prob¡h  vys¡l n¡
2b11:c3 86 2b           jp      2b86h
; ......................................................
2b14:ed 73 5f 33        ld      (335fh),sp  ; £schova SP p©i p©eru¨en¡ od SIO-A/ATS
2b18:cd 80 2b           call    2b80h       ; je vys¡l n¡ ?
2b1b:c2 70 31           jp      nz,3170h    ; nen¡ - n vrat z obsluhy SIO/ATS
2b1e:3e 00              ld      a,0
2b20:32 4c 33           ld      (334ch),a   ; 1=prob¡h  vys¡l n¡
2b23:c3 8f 2b           jp      2b8fh
; ......................................................
2b26:ed 73 5f 33        ld      (335fh),sp  ; £schova SP p©i p©eru¨en¡ od SIO-A/ATS
2b2a:cd 80 2b           call    2b80h       ; je vys¡l n¡ ?
2b2d:ca a4 2b           jp      z,2ba4h     ; je vys¡l n¡
2b30:c3 70 31           jp      3170h       ; n vrat z obsluhy SIO/ATS
; ......................................................
2b33:ed 73 5f 33        ld      (335fh),sp  ; £schova SP p©i p©eru¨en¡ od SIO-A/ATS
2b37:cd 80 2b           call    2b80h       ; je vys¡l n¡ ?
2b3a:ca c2 2b           jp      z,2bc2h     ; je vys¡l n¡
2b3d:c3 70 31           jp      3170h       ; n vrat z obsluhy SIO/ATS
; ......................................................
                                            ; vysl n¡ dal¨¡ho znaku p©i p©eru¨en¡ od SIO
2b40:ed 73 5f 33        ld      (335fh),sp  ; £schova SP p©i p©eru¨en¡ od SIO-A/ATS
2b44:cd 80 2b           call    2b80h       ; je vys¡l n¡ ?
2b47:c2 70 31           jp      nz,3170h    ; nen¡ - n vrat z obsluhy SIO/ATS
2b4a:cd 0a 21           call    210ah       ; ‡ten¡ stavov‚ho registru A-SIO/ATS
2b4d:32 61 33           ld      (3361h),a   ; stavov˜ registr SIO-A/ATS
2b50:cb 7f              bit     7,a         ; bylo chybov‚ p©eru¨en¡ ?
2b52:ca dd 2b           jp      z,2bddh     ; nebylo p©eru¨en¡ chybou
2b55:3e 00              ld      a,0
2b57:32 4c 33           ld      (334ch),a   ; 0=neprob¡h  vys¡l n¡
2b5a:18 39              jr      2b95h       ; resetov n¡ kan lu A-SIO/ATS
; ......................................................
                                            ; vysl n¡ znaku na SIO/ATS
2b5c:ed 73 5f 33        ld      (335fh),sp  ; £schova SP p©i p©eru¨en¡ od SIO-A/ATS
2b60:cd 80 2b           call    2b80h       ; je vys¡l n¡ ?
2b63:ca fc 2b           jp      z,2bfch     ; je vys¡l n¡ - vysl n¡ znaku
2b66:18 24              jr      2b8ch       ; n vrat z obsluhy SIO/ATS
; ......................................................
                                            ; p©¡jem znaku z SIO/ATS
2b68:ed 73 5f 33        ld      (335fh),sp  ; £schova SP p©i p©eru¨en¡ od SIO-A/ATS
2b6c:cd 80 2b           call    2b80h       ; je vys¡l n¡ ?
2b6f:ca f2 2b           jp      z,2bf2h     ; je vys¡l n¡
2b72:18 18              jr      2b8ch       ; n vrat z obsluhy SIO/ATS
; ......................................................
2b74:ed 73 5f 33        ld      (335fh),sp  ; £schova SP p©i p©eru¨en¡ od SIO-A/ATS
2b78:cd 80 2b           call    2b80h       ; je vys¡l n¡ ?
2b7b:ca e8 2b           jp      z,2be8h     ; je vys¡l n¡
2b7e:18 0c              jr      2b8ch       ; n vrat z obsluhy SIO/ATS
; ......................................................
                                            ; test vys¡l n¡
2b80:3a 4c 33           ld      a,(334ch)   ; 1=prob¡h  vys¡l n¡
2b83:fe 01              cp      1
2b85:c9                 ret     
; ......................................................
2b86:cd 9c 20           call    209ch       ; inicializace obvodu SIO/ATS
2b89:cd 9b 2b           call    2b9bh       ; p©epnut¡ na p©¡jem
2b8c:c3 70 31           jp      3170h       ; n vrat z obsluhy SIO/ATS
; ......................................................
2b8f:cd d6 20           call    20d6h       ; resetov n¡ kan lu A-SIO/ATS
2b92:c3 8f 31           jp      318fh       ; n vrat
; ......................................................
2b95:cd d6 20           call    20d6h       ; resetov n¡ kan lu A-SIO/ATS
2b98:c3 08 32           jp      3208h
; ......................................................
                                            ; p©epnut¡ na p©¡jem
2b9b:3e 00              ld      a,0
2b9d:32 4d 33           ld      (334dh),a   ; 0=p©¡jem
2ba0:cd 70 2c           call    2c70h       ; p©epnut¡ na p©¡jem
2ba3:c9                 ret     
; ......................................................
2ba4:cd 18 2c           call    2c18h
2ba7:cb 6f              bit     5,a
2ba9:20 09              jr      nz,2bb4h
2bab:cd 9b 2b           call    2b9bh       ; p©epnut¡ na p©¡jem
2bae:cd 02 32           call    3202h
2bb1:c3 72 31           jp      3172h
; ......................................................

2bb4:3e 01              ld      a,1         ; vypnut¡ p©¡znaku p©¡jmu
2bb6:32 4d 33           ld      (334dh),a   ; 0=p©¡jem
2bb9:cd 2d 2c           call    2c2dh       ; 0 -> 334eh
2bbc:cd cf 20           call    20cfh       ; p©epnut¡ kan lu A-SIO/ATS na vys¡l n¡
2bbf:c3 70 31           jp      3170h       ; n vrat z obsluhy SIO/ATS
; ......................................................
2bc2:cd 18 2c           call    2c18h
2bc5:cb 6f              bit     5,a
2bc7:20 06              jr      nz,2bcfh    ; p©epnut¡ z p©¡jmu na vys¡l n¡
2bc9:cd 9b 2b           call    2b9bh       ; p©epnut¡ na p©¡jem
2bcc:c3 8f 31           jp      318fh       ; n vrat
; ......................................................
                                            ; p©epnut¡ z p©¡jmu na vys¡l n¡
2bcf:3e 01              ld      a,1
2bd1:32 4d 33           ld      (334dh),a   ; 0=p©¡jem
2bd4:cd 2d 2c           call    2c2dh       ; 0 -> 334eh
2bd7:cd cf 20           call    20cfh       ; p©epnut¡ kan lu A-SIO/ATS na vys¡l n¡
2bda:c3 8f 31           jp      318fh       ; n vrat
; ......................................................

2bdd:3a 4d 33           ld      a,(334dh)   ; 0=p©¡jem
2be0:fe 00              cp      0
2be2:ca 79 2c           jp      z,2c79h
2be5:c2 41 2c           jp      nz,2c41h

; ......................................................
2be8:3a 4d 33           ld      a,(334dh)   ; 0=p©¡jem
2beb:fe 00              cp      0
2bed:ca b7 2c           jp      z,2cb7h
2bf0:18 20              jr      2c12h
; ......................................................
2bf2:3a 4d 33           ld      a,(334dh)   ; 1=p©¡jem
2bf5:fe 00              cp      0
2bf7:ca 94 2c           jp      z,2c94h     ; nen¡ p©¡jem
2bfa:18 16              jr      2c12h       ; p©¡jem znaku z SIO/ATS
; ......................................................
2bfc:3a 4d 33           ld      a,(334dh)   ; 0=p©¡jem
2bff:fe 00              cp      0
2c01:c2 33 2c           jp      nz,2c33h
2c04:18 00              jr      2c06h
; ......................................................
2c06:cd 05 21           call    2105h       ; uvolnˆn¡ p©eru¨en¡ vys¡la‡e
2c09:cd f6 20           call    20f6h       ; p©¡jem znaku z kan lu A-SIO/ATS
2c0c:cd 9b 2b           call    2b9bh       ; p©epnut¡ na p©¡jem
2c0f:c3 08 32           jp      3208h
; ......................................................
2c12:cd f6 20           call    20f6h       ; p©¡jem znaku z kan lu A-SIO/ATS
2c15:c3 70 31           jp      3170h       ; n vrat z obsluhy SIO/ATS
; ......................................................
2c18:cd c4 20           call    20c4h       ; inicializace kan lu A-SIO/ATS pro vys¡l n¡
2c1b:c5                 push    bc
2c1c:c1                 pop     bc
2c1d:2a 21 33           ld      hl,(3321h)
2c20:22 67 33           ld      (3367h),hl  ; adresa pro ‡ten¡ znaku z vys¡lac¡ho bufferu
2c23:2a 23 33           ld      hl,(3323h)
2c26:22 69 33           ld      (3369h),hl  ; ‡¡ta‡ znak– k vysl n¡
2c29:cd 0a 21           call    210ah       ; ‡ten¡ stavov‚ho registru A-SIO/ATS
2c2c:c9                 ret     
; ......................................................
                                            ; 0 -> 334eh
2c2d:3e 00              ld      a,0
2c2f:32 4e 33           ld      (334eh),a
2c32:c9                 ret     
; ......................................................
2c33:3a 4e 33           ld      a,(334eh)
2c36:fe 00              cp      0
2c38:c2 1d 2d           jp      nz,2d1dh
2c3b:cd 05 21           call    2105h       ; uvolnˆn¡ p©eru¨en¡ vys¡la‡e
2c3e:c3 70 31           jp      3170h       ; n vrat z obsluhy SIO/ATS
; ......................................................

2c41:3a 4e 33           ld      a,(334eh)
2c44:fe 00              cp      0
2c46:20 1a              jr      nz,2c62h
2c48:3a 61 33           ld      a,(3361h)   ; stavov˜ registr SIO-A/ATS
2c4b:cb 6f              bit     5,a
2c4d:cd bf 32           call    32bfh
2c50:3e 01              ld      a,1
2c52:32 4e 33           ld      (334eh),a
2c55:cd 08 2d           call    2d08h
2c58:af                 xor     a
2c59:32 5e 33           ld      (335eh),a
2c5c:cd 02 32           call    3202h
2c5f:c3 c8 31           jp      31c8h
; ......................................................
2c62:3a 61 33           ld      a,(3361h)   ; stavov˜ registr SIO-A/ATS
2c65:cb 6f              bit     5,a         ; je sign l CTS ?
2c67:c2 12 2d           jp      nz,2d12h    ; je sign l CTS
2c6a:cd 9b 2b           call    2b9bh       ; p©epnut¡ na p©¡jem
2c6d:c3 08 32           jp      3208h
; ......................................................
                                            ; p©epnut¡ na p©¡jem
2c70:3e 00              ld      a,0
2c72:32 4f 33           ld      (334fh),a   ; 0 = je p©¡jem
2c75:cd ec 20           call    20ech       ; inicializace kan lu A-SIO/ATS pro p©¡jem
2c78:c9                 ret     
; ......................................................

2c79:3a 4f 33           ld      a,(334fh)   ; 0 = je p©¡jem
2c7c:fe 00              cp      0
2c7e:3a 61 33           ld      a,(3361h)   ; stavov˜ registr SIO-A/ATS
2c81:20 0a              jr      nz,2c8dh
2c83:cb 67              bit     4,a
2c85:20 78              jr      nz,2cffh
2c87:cd c6 2c           call    2cc6h
2c8a:ca 70 31           jp      z,3170h     ; n vrat z obsluhy SIO/ATS
2c8d:cb 5f              bit     3,a
2c8f:c2 70 31           jp      nz,3170h    ; n vrat z obsluhy SIO/ATS
2c92:28 2c              jr      z,2cc0h

2c94:3a 4f 33           ld      a,(334fh)   ; 0 = je p©¡jem
2c97:fe 00              cp      0
2c99:cc c6 2c           call    z,2cc6h
2c9c:cd f6 20           call    20f6h       ; p©¡jem znaku z kan lu A-SIO/ATS
2c9f:32 62 33           ld      (3362h),a   ; p©ijat˜ znak
2ca2:47                 ld      b,a         ; p©ijat˜ znak
2ca3:3a 5c 33           ld      a,(335ch)
2ca6:fe 00              cp      0
2ca8:20 05              jr      nz,2cafh
2caa:78                 ld      a,b         ; p©ijat˜ znak
2cab:a7                 and     a           ; kontrola parity
2cac:ea c0 2c           jp      pe,2cc0h    ; parita sud  - chyba
2caf:cd 31 22           call    2231h       ; BIT 1,(3333h)
2cb2:ca 68 2f           jp      z,2f68h
2cb5:18 09              jr      2cc0h       ; chyba
; ......................................................
2cb7:3a 4f 33           ld      a,(334fh)   ; 0 = je p©¡jem
2cba:fe 00              cp      0
2cbc:28 41              jr      z,2cffh
2cbe:18 00              jr      2cc0h
; ......................................................
                                            ; chyba parity p©i p©¡jmu
2cc0:cd 70 2c           call    2c70h       ; p©epnut¡ na p©¡jem
2cc3:c3 08 32           jp      3208h
; ......................................................
2cc6:3e 01              ld      a,1
2cc8:32 4f 33           ld      (334fh),a   ; 0 = je p©¡jem
2ccb:cd 5f 2f           call    2f5fh
2cce:cd 16 22           call    2216h
2cd1:3a 1a 33           ld      a,(331ah)
2cd4:fe 00              cp      0
2cd6:28 0e              jr      z,2ce6h
2cd8:21 29 33           ld      hl,3329h
2cdb:22 63 33           ld      (3363h),hl
2cde:2a 2e 33           ld      hl,(332eh)
2ce1:22 65 33           ld      (3365h),hl
2ce4:18 0c              jr      2cf2h
; ......................................................
2ce6:2a 1b 33           ld      hl,(331bh)
2ce9:22 63 33           ld      (3363h),hl
2cec:2a 1d 33           ld      hl,(331dh)
2cef:22 65 33           ld      (3365h),hl
2cf2:af                 xor     a
2cf3:32 58 33           ld      (3358h),a
2cf6:cd dd 20           call    20ddh
2cf9:3e 00              ld      a,0
2cfb:32 5c 33           ld      (335ch),a
2cfe:c9                 ret     
; ......................................................
2cff:cd f6 20           call    20f6h       ; p©¡jem znaku z kan lu A-SIO/ATS
2d02:cd 70 2c           call    2c70h       ; p©epnut¡ na p©¡jem
2d05:ca 70 31           jp      z,3170h     ; n vrat z obsluhy SIO/ATS
2d08:3e 00              ld      a,0
2d0a:18 02              jr      2d0eh
; ......................................................
2d0c:3e 05              ld      a,5
2d0e:32 50 33           ld      (3350h),a
2d11:c9                 ret     
; ......................................................
2d12:3a 50 33           ld      a,(3350h)
2d15:fe 07              cp      7
2d17:ca 70 31           jp      z,3170h     ; n vrat z obsluhy SIO/ATS
2d1a:c3 41 2e           jp      2e41h
; ......................................................
2d1d:3a 50 33           ld      a,(3350h)
2d20:fe 07              cp      7
2d22:ca 44 2e           jp      z,2e44h
2d25:fe 08              cp      8
2d27:ca 08 2e           jp      z,2e08h
2d2a:fe 06              cp      6
2d2c:28 2a              jr      z,2d58h
2d2e:fe 00              cp      0
2d30:ca d1 2d           jp      z,2dd1h
2d33:fe 01              cp      1
2d35:28 2f              jr      z,2d66h
2d37:fe 04              cp      4
2d39:28 33              jr      z,2d6eh
2d3b:fe 05              cp      5
2d3d:28 0d              jr      z,2d4ch
2d3f:fe 09              cp      9
2d41:28 0d              jr      z,2d50h
2d43:cd 05 21           call    2105h       ; uvolnˆn¡ p©eru¨en¡ vys¡la‡e
2d46:cd 9b 2b           call    2b9bh       ; p©epnut¡ na p©¡jem
2d49:c3 72 31           jp      3172h
; ......................................................
2d4c:3e 09              ld      a,9
2d4e:18 02              jr      2d52h
; ......................................................
2d50:3e 0a              ld      a,0ah
2d52:32 50 33           ld      (3350h),a
2d55:c3 cf 31           jp      31cfh
; ......................................................
2d58:cd 02 2e           call    2e02h
2d5b:3e 08              ld      a,8
2d5d:32 50 33           ld      (3350h),a
2d60:cd 3d 32           call    323dh       ; vysl n¡ znaku 7 bit– na kan l A-SIO/ATS
2d63:c3 fa 2d           jp      2dfah
; ......................................................
2d66:3e 04              ld      a,4
2d68:32 50 33           ld      (3350h),a
2d6b:c3 c5 31           jp      31c5h
; ......................................................
2d6e:cd 31 22           call    2231h       ; BIT 1,(3333h)
2d71:20 74              jr      nz,2de7h
2d73:2a 69 33           ld      hl,(3369h)  ; ‡¡ta‡ znak– k vysl n¡
2d76:7c                 ld      a,h
2d77:b5                 or      l
2d78:28 4f              jr      z,2dc9h     ; nen¡ ‘ dn˜ znak k vysl n¡
2d7a:cd 37 32           call    3237h       ; vysl n¡ znaku 8 bit– na kan l A-SIO/ATS
2d7d:fe 01              cp      1           ; byl znak SOH (za‡ tek hlavi‡ky) ?
2d7f:28 20              jr      z,2da1h     ; vysl n¡ znaku na kan lu A-SIO/ATS
2d81:fe 10              cp      10h         ; byl znak DLE (roz¨¡©. dat. linky) ?
2d83:28 39              jr      z,2dbeh
2d85:fe 02              cp      2           ; byl znak STX (za‡ tek textu) ?
2d87:20 25              jr      nz,2daeh
2d89:cd f3 20           call    20f3h       ; opakovan‚ vysl n¡ znaku na kan l A-SIO/ATS
2d8c:2a 69 33           ld      hl,(3369h)  ; ‡¡ta‡ znak– k vysl n¡
2d8f:7c                 ld      a,h
2d90:b5                 or      l
2d91:28 11              jr      z,2da4h     ; byl ji‘ posledn¡ znak
2d93:2a 67 33           ld      hl,(3367h)  ; adresa pro ‡ten¡ znaku z vys¡lac¡ho bufferu
2d96:7e                 ld      a,(hl)      ; znak k vysl n¡ na ATS
2d97:fe 04              cp      4           ; je znak EOT (konec p©enosu) ?
2d99:28 26              jr      z,2dc1h
2d9b:fe 05              cp      5           ; je znak ENQ (dotaz) ?
2d9d:28 22              jr      z,2dc1h
2d9f:18 03              jr      2da4h
; ......................................................
2da1:cd f3 20         * call    20f3h       ; vysl n¡ znaku na kan l A-SIO/ATS
2da4:cd 3b 2e         * call    2e3bh
2da7:3e 07              ld      a,7
2da9:32 50 33           ld      (3350h),a
2dac:18 41              jr      2defh
; ......................................................
2dae:cd 61 32           call    3261h
2db1:cd f3 20           call    20f3h       ; vysl n¡ znaku na kan l A-SIO/ATS
2db4:cd 02 2e           call    2e02h
2db7:3e 08              ld      a,8
2db9:32 50 33           ld      (3350h),a
2dbc:18 3c              jr      2dfah
; ......................................................
2dbe:cd f3 20           call    20f3h       ; vysl n¡ znaku na kan l A-SIO/ATS
2dc1:3e 06              ld      a,6
2dc3:32 50 33           ld      (3350h),a
2dc6:c3 ad 32           jp      32adh
; ......................................................
2dc9:3e 05              ld      a,5
2dcb:32 50 33           ld      (3350h),a
2dce:c3 cf 31           jp      31cfh
; ......................................................
2dd1:3a 5e 33           ld      a,(335eh)
2dd4:21 01 2b           ld      hl,2b01h
2dd7:be                 cp      (hl)
2dd8:30 0d              jr      nc,2de7h
2dda:3c                 inc     a
2ddb:32 5e 33           ld      (335eh),a
2dde:c3 c8 31           jp      31c8h
; ......................................................
2de1:cd 9b 2b           call    2b9bh       ; p©epnut¡ na p©¡jem
2de4:c3 08 32           jp      3208h
; ......................................................
2de7:3e 01              ld      a,1
2de9:32 50 33           ld      (3350h),a
2dec:c3 c8 31           jp      31c8h
; ......................................................
2def:3e 01              ld      a,1
2df1:32 5a 33           ld      (335ah),a
2df4:cd 02 32           call    3202h
2df7:c3 6d 31           jp      316dh
; ......................................................
2dfa:3e 16              ld      a,16h
2dfc:32 59 33           ld      (3359h),a
2dff:c3 b5 32           jp      32b5h
; ......................................................
2e02:3e 00              ld      a,0
2e04:32 51 33           ld      (3351h),a
2e07:c9                 ret     
; ......................................................
2e08:3a 51 33           ld      a,(3351h)
2e0b:fe 00              cp      0
2e0d:20 1b              jr      nz,2e2ah
2e0f:cd 31 22           call    2231h       ; BIT 1,(3333h)
2e12:20 0e              jr      nz,2e22h
2e14:2a 69 33           ld      hl,(3369h)  ; ‡¡ta‡ znak– k vysl n¡
2e17:7c                 ld      a,h
2e18:b5                 or      l
2e19:c2 32 2e           jp      nz,2e32h
2e1c:cd 0c 2d           call    2d0ch
2e1f:c3 cf 31           jp      31cfh
; ......................................................
2e22:3e 01              ld      a,1
2e24:32 51 33           ld      (3351h),a
2e27:c3 c8 31           jp      31c8h
; ......................................................
2e2a:3e 00              ld      a,0
2e2c:32 51 33           ld      (3351h),a
2e2f:c3 c5 31           jp      31c5h
; ......................................................
2e32:cd 02 32           call    3202h
2e35:cd 3d 32           call    323dh       ; vysl n¡ znaku 7 bit– na kan l A-SIO/ATS
2e38:c3 6d 31           jp      316dh
; ......................................................
2e3b:3e 00              ld      a,0
2e3d:32 52 33           ld      (3352h),a
2e40:c9                 ret     
; ......................................................
2e41:c3 70 31           jp      3170h       ; n vrat z obsluhy SIO/ATS
; ......................................................
2e44:3a 52 33           ld      a,(3352h)
2e47:fe 00              cp      0
2e49:28 1b              jr      z,2e66h
2e4b:fe 02              cp      2
2e4d:28 71              jr      z,2ec0h
2e4f:fe 04              cp      4
2e51:28 65              jr      z,2eb8h
2e53:fe 05              cp      5
2e55:28 70              jr      z,2ec7h
2e57:fe 06              cp      6
2e59:28 55              jr      z,2eb0h
2e5b:fe 07              cp      7
2e5d:28 51              jr      z,2eb0h
2e5f:fe 08              cp      8
2e61:28 64              jr      z,2ec7h
2e63:c3 70 31           jp      3170h       ; n vrat z obsluhy SIO/ATS
; ......................................................
2e66:cd 31 22           call    2231h       ; BIT 1,(3333h)
2e69:20 3d              jr      nz,2ea8h
2e6b:2a 69 33           ld      hl,(3369h)  ; ‡¡ta‡ znak– k vysl n¡
2e6e:7c                 ld      a,h
2e6f:b5                 or      l
2e70:28 55              jr      z,2ec7h
2e72:cd 37 32           call    3237h       ; vysl n¡ znaku 8 bit– na kan l A-SIO/ATS
2e75:fe 03              cp      3
2e77:28 27              jr      z,2ea0h
2e79:fe 17              cp      17h
2e7b:28 1b              jr      z,2e98h
2e7d:fe 05              cp      5
2e7f:28 0f              jr      z,2e90h
2e81:fe 1f              cp      1fh
2e83:28 03              jr      z,2e88h
2e85:c3 d3 2e           jp      2ed3h
; ......................................................
2e88:3e 02              ld      a,2
2e8a:32 52 33           ld      (3352h),a
2e8d:c3 df 2e           jp      2edfh
; ......................................................
2e90:3e 05              ld      a,5
2e92:32 52 33           ld      (3352h),a
2e95:c3 f3 2e           jp      2ef3h
; ......................................................
2e98:3e 06              ld      a,6
2e9a:32 52 33           ld      (3352h),a
2e9d:c3 fc 2e           jp      2efch
; ......................................................
2ea0:3e 07              ld      a,7
2ea2:32 52 33           ld      (3352h),a
2ea5:c3 14 2f           jp      2f14h
; ......................................................
2ea8:3e 04              ld      a,4
2eaa:32 52 33           ld      (3352h),a
2ead:c3 f0 2e           jp      2ef0h
; ......................................................
2eb0:3e 08              ld      a,8
2eb2:32 52 33           ld      (3352h),a
2eb5:c3 38 2f           jp      2f38h
; ......................................................
2eb8:3e 00              ld      a,0
2eba:32 52 33           ld      (3352h),a
2ebd:c3 c5 31           jp      31c5h
; ......................................................
2ec0:3e 00              ld      a,0
2ec2:32 52 33           ld      (3352h),a
2ec5:18 7a              jr      2f41h
; ......................................................
2ec7:cd 0c 2d           call    2d0ch
2eca:c3 cf 31           jp      31cfh
; ......................................................
2ecd:fe 7f              cp      7fh
2ecf:20 02              jr      nz,2ed3h
2ed1:3e 11              ld      a,11h
2ed3:cd 4e 2f           call    2f4eh
2ed6:cd 61 32           call    3261h
2ed9:cd f3 20           call    20f3h       ; vysl n¡ znaku na kan l A-SIO/ATS
2edc:c3 6d 31           jp      316dh
; ......................................................
2edf:3e 1f              ld      a,1fh
2ee1:cd 4e 2f           call    2f4eh
2ee4:cd f3 20           call    20f3h       ; vysl n¡ znaku na kan l A-SIO/ATS
2ee7:cd e3 31           call    31e3h
2eea:6f                 ld      l,a
2eeb:26 ff              ld      h,0ffh
2eed:c3 b9 32           jp      32b9h
; ......................................................
2ef0:c3 c8 31           jp      31c8h
; ......................................................
2ef3:3e 19              ld      a,19h
2ef5:32 59 33           ld      (3359h),a
2ef8:3e 05              ld      a,5
2efa:18 5b              jr      2f57h
; ......................................................
2efc:3e 18              ld      a,18h
2efe:32 59 33           ld      (3359h),a
2f01:2a 67 33           ld      hl,(3367h)  ; adresa pro ‡ten¡ znaku z vys¡lac¡ho bufferu
2f04:2b                 dec     hl          ; sn¡‘en¡ adresy
2f05:ed 5b 25 33        ld      de,(3325h)
2f09:eb                 ex      de,hl
2f0a:73                 ld      (hl),e
2f0b:23                 inc     hl
2f0c:72                 ld      (hl),d
2f0d:3e 17              ld      a,17h
2f0f:cd 4e 2f           call    2f4eh
2f12:18 16              jr      2f2ah
; ......................................................
2f14:3e 17              ld      a,17h
2f16:32 59 33           ld      (3359h),a
2f19:2a 67 33           ld      hl,(3367h)  ; adresa pro ‡ten¡ znaku z vys¡lac¡ho bufferu
2f1c:2b                 dec     hl
2f1d:ed 5b 25 33        ld      de,(3325h)
2f21:eb                 ex      de,hl
2f22:73                 ld      (hl),e
2f23:23                 inc     hl
2f24:72                 ld      (hl),d
2f25:3e 03              ld      a,3
2f27:cd 4e 2f           call    2f4eh
2f2a:cb ff              set     7,a
2f2c:cd f3 20           call    20f3h       ; vysl n¡ znaku na kan l A-SIO/ATS
2f2f:cd e3 31           call    31e3h
2f32:6f                 ld      l,a
2f33:26 ff              ld      h,0ffh
2f35:c3 b9 32           jp      32b9h
; ......................................................
2f38:cd de 31           call    31deh
2f3b:cd f3 20           call    20f3h       ; vysl n¡ znaku na kan l A-SIO/ATS
2f3e:c3 b5 32           jp      32b5h
; ......................................................
2f41:cd de 31           call    31deh
2f44:cd f3 20           call    20f3h       ; vysl n¡ znaku na kan l A-SIO/ATS
2f47:2e 16              ld      l,16h
2f49:26 16              ld      h,16h
2f4b:c3 b9 32           jp      32b9h
; ......................................................
2f4e:f5                 push    af
2f4f:cd a5 31           call    31a5h
2f52:f1                 pop     af
2f53:cd d6 31           call    31d6h       ; kontroln¡ sou‡et 1 bajtu dat
2f56:c9                 ret     
; ......................................................
2f57:cb ff              set     7,a
2f59:cd f3 20           call    20f3h       ; vysl n¡ znaku na kan l A-SIO/ATS
2f5c:c3 6d 31           jp      316dh
; ......................................................
2f5f:3e 00              ld      a,0
2f61:32 53 33           ld      (3353h),a
2f64:cd 76 2f           call    2f76h
2f67:c9                 ret     
; ......................................................
2f68:2a 65 33           ld      hl,(3365h)
2f6b:7c                 ld      a,h
2f6c:b5                 or      l
2f6d:c2 7c 2f           jp      nz,2f7ch
2f70:cd 70 2c           call    2c70h       ; p©epnut¡ na p©¡jem
2f73:c3 08 32           jp      3208h
; ......................................................
2f76:3e 00              ld      a,0
2f78:32 55 33           ld      (3355h),a   ; 0 = p©enos ukon‡en
2f7b:c9                 ret     
; ......................................................
2f7c:3a 55 33           ld      a,(3355h)
2f7f:fe 02              cp      2
2f81:ca 21 30           jp      z,3021h
2f84:fe 03              cp      3
2f86:ca 21 30           jp      z,3021h
2f89:fe 01              cp      1
2f8b:ca 0d 31           jp      z,310dh
2f8e:fe 04              cp      4
2f90:20 1b              jr      nz,2fadh
2f92:3a 62 33           ld      a,(3362h)
2f95:cb bf              res     7,a
2f97:fe 16              cp      16h
2f99:ca b2 31           jp      z,31b2h
2f9c:fe 05              cp      5
2f9e:c2 f9 2f           jp      nz,2ff9h
2fa1:cd 1d 32           call    321dh
2fa4:cd 68 32           call    3268h
2fa7:cd 70 2c           call    2c70h       ; p©epnut¡ na p©¡jem
2faa:c3 72 31           jp      3172h
; ......................................................
2fad:3a 62 33           ld      a,(3362h)
2fb0:cb bf              res     7,a
2fb2:fe 02              cp      2
2fb4:28 3b              jr      z,2ff1h
2fb6:fe 10              cp      10h
2fb8:28 30              jr      z,2feah
2fba:fe 01              cp      1
2fbc:28 25              jr      z,2fe3h
2fbe:fe 04              cp      4
2fc0:28 1d              jr      z,2fdfh
2fc2:fe 15              cp      15h
2fc4:28 15              jr      z,2fdbh
2fc6:fe 05              cp      5
2fc8:28 0d              jr      z,2fd7h
2fca:fe 16              cp      16h
2fcc:ca 70 31           jp      z,3170h     ; n vrat z obsluhy SIO/ATS
2fcf:3e 04              ld      a,4
2fd1:32 55 33           ld      (3355h),a
2fd4:c3 f9 2f           jp      2ff9h
; ......................................................
2fd7:3e 0c              ld      a,0ch
2fd9:18 2e              jr      3009h
; ......................................................
2fdb:3e 0d              ld      a,0dh
2fdd:18 2a              jr      3009h
; ......................................................
2fdf:3e 0b              ld      a,0bh
2fe1:18 26              jr      3009h
; ......................................................
2fe3:cd 1b 30           call    301bh
2fe6:3e 03              ld      a,3
2fe8:18 0c              jr      2ff6h
; ......................................................
2fea:cd 07 31           call    3107h
2fed:3e 01              ld      a,1
2fef:18 05              jr      2ff6h
; ......................................................
2ff1:cd 15 30           call    3015h
2ff4:3e 02              ld      a,2
2ff6:32 55 33           ld      (3355h),a
2ff9:cd 1d 32           call    321dh
2ffc:3e 01              ld      a,1
2ffe:32 5a 33           ld      (335ah),a
3001:3e 00              ld      a,0
3003:32 5d 33           ld      (335dh),a
3006:c3 2d 21           jp      212dh       ; p©epnut¡ kan lu A-SIO/ATS na p©¡jem
