CONTEXT   0 241   0   3  72



; syst‚m SSE - za‡¡n  na stopˆ 4 - sektor 4

0000: start
0070:

0008:  RST 8


                                                      ; start opera‡n¡ho syst‚mu
0000:f3                 di
0001:ed 5e              im      2           ; m¢d p©eru¨en¡ 2
0003:3e 01              ld      a,1         ; tabulka vektor– p©eru¨en¡
0005:c3 70 00           jp      70h         ; pokra‡ov n¡ v inicializaci
; ............................................
0008:f3                 di                  ; funkce RST 8 - bez uschov n¡ registr–
                                            ; vyvol n¡ funkce
0009:21 36 0d           ld      hl,0d36h    ; adresa pro ukon‡en¡ podprogramu
000c:e5                 push    hl          ; n vratov  adresa
000d:c3 38 0d           jp      0d38h
; ............................................
0010:f3                 di                  ; funkce RST 10
                                            ; vyvol n¡ funkce
0011:c3 3d 0d           jp      0d3dh
0014:                   db   4bh,0f7h,0,0
; ............................................
0018:f3                 di                  ; funkce RST 18
                                            ; vyvol n¡ funkce
0019:c3 3d 0d           jp      0d3dh
001c:                   db   0,0,0,0
; ............................................
0020:f3                 di                  ; funkce RST 20
0021:c3 9f 05           jp      59fh
0024:                   db   0,0,0,0
; ............................................
0028:f3                 di                  ; funkce RST 28
0029:c3 e8 05           jp      5e8h
; ......................................................
002c:                   db   77h,0dbh,0e0h,0cdh
0030:00                 nop                 ; funkce RST 30
0031:c3 b6 cc           jp      0ccb6h
; ......................................................
0034:                   db   69h

0035:11 c0 13           ld      de,13c0h
0038:01 40 00           ld      bc,0040h    ; instrukce RST 38
003b:ed b0              ldir
003d:01 b8 03           ld      bc,03b8h

0040:                   db   8dh,0eh,12h,1,0,1fh,6,0eah,0b3h,29h,0dh,2,0b3h
004d:                   db   15h,0ah,80h,0c0h,0fh,0dh,1,77h,0eh,1,8ch,0eh
0059:                   db   2,37h,0dh,3,20h,0,0,28h,0,0,0bh,6,0,21h,0,20h
0069:                   db   22h,81h,3ch,21h,49h,9fh,36h
; ......................................................
                                            ; inicializace opera‡n¡ho syst‚mu
                                            ; (z adresy 0005)
0070:ed 47              ld      i,a         ; vektor p©eru¨en¡ (0100h)
0072:31 e5 b3           ld      sp,0b3e5h   ; pracovn¡ z sobn¡k
0075:21 00 b3           ld      hl,0b300h   ; za‡ tek dat
0078:af                 xor     a           
0079:77                 ld      (hl),a      ; nulovac¡ bajt
007a:11 01 b3           ld      de,0b301h   ; za‡ tek dat + 1
007d:01 c0 04           ld      bc,4c0h     ; d‚lka datov‚ oblasti
0080:0b                 dec     bc          
0081:ed b0              ldir                ; vymaz n¡ datov‚ oblasti
0083:21 ca 0e           ld      hl,0ecah    ; instrukce RLC B, RET
0086:11 e7 b3           ld      de,0b3e7h   
0089:0e 03              ld      c,3         ; po‡et bajt– k p©enosu
008b:ed b0              ldir                ; p©enos dat
008d:3e 01              ld      a,1         
008f:32 02 b3           ld      (0b302h),a  
0092:32 ea b3           ld      (0b3eah),a  
0095:3e 12              ld      a,12h       ; posledn¡ bit v mapˆ (18)
0097:06 c6              ld      b,0c6h      ; nastaven¡ bitu
0099:cd a9 0e           call    0ea9h       ; nastaven¡ posledn¡ho bitu
009c:32 eb b3           ld      (0b3ebh),a  ; ‡¡slo bitu v bitov‚ mapˆ
009f:cd 53 0c           call    0c53h       ; inicializace tabulek
00a2:21 30 b5           ld      hl,0b530h   ;
00a5:22 9c b7           ld      (0b79ch),hl
00a8:3e 00              ld      a,0
00aa:d3 80              out     (80h),a     ; vektor p©eru¨en¡ ‡¡ta‡e ZRE
00ac:3e 03              ld      a,3         ; z kaz p©eru¨en¡ ‡¡ta‡–
00ae:d3 80              out     (80h),a     ; CTC-0/ZRE
00b0:d3 81              out     (81h),a     ; CTC-1/ZRE
00b2:d3 82              out     (82h),a     ; CTC-2/ZRE
00b4:d3 83              out     (83h),a     ; CTC-3/ZRE
00b6:21 03 b4           ld      hl,0b403h   
00b9:36 ff              ld      (hl),0ffh   
00bb:3e a5              ld      a,0a5h      ; p©eddˆli‡ /256
00bd:d3 80              out     (80h),a     ; kan l CTC-0/ZRE
00bf:3e c0              ld      a,0c0h      ; ‡asovac¡ konstanta /192
00c1:d3 80              out     (80h),a     ; p©eru¨en¡ po 20 ms
00c3:cd f7 0b           call    0bf7h       ; instrukce RET
00c6:21 7d b4           ld      hl,0b47dh   ;
00c9:36 cf              ld      (hl),0cfh   ; instrukce RST 08
00cb:11 66 c8           ld      de,0c866h   
00ce:21 92 b4           ld      hl,0b492h   
00d1:36 c3              ld      (hl),0c3h   ; instrukce JP 0C866h
00d3:23                 inc     hl          
00d4:73                 ld      (hl),e
00d5:23                 inc     hl
00d6:72                 ld      (hl),d
00d7:c3 34 0b           jp      0b34h       ; pokra‡ov n¡ inic.
; ......................................................
00da:fb                 ei
00db:ed 4d              reti    
; ......................................................
00dd:c5                 push    bc
00de:ed b0              ldir    
00e0:eb                 ex      de,hl
00e1:c1                 pop     bc
00e2:d1                 pop     de
00e3:ed b0              ldir    
00e5:21 ee 3b           ld      hl,3beeh
00e8:7e                 ld      a,(hl)
00e9:32 2f 3c           ld      (3c2fh),a
00ec:36 00              ld      (hl),0
00ee:3a 97 3c           ld      a,(3c97h)
00f1:47                 ld      b,a
00f2:e6 c0              db   0e6h
00f3:c0                 ret     nz
00f4:ca f3 00           jp      z,0f3h
00f7:21 9b 3c           ld      hl,3c9bh
00fa:3a b0 4b           ld      a,(4bb0h)
                                            ; n vrat z neobslou‘en‚ho p©eru¨en¡
00fd:fb                 ei
00fe:ed 4d              reti    
; ......................................................
                                            ; tabulka vektor– p©eru¨en¡
                                            ; p©eru¨en¡ od CTC/ZRE
0100:                   dw      0a15h       ; ‡asova‡ CTC-0/ZRE (hodiny)
0102:                   dw      1548h       ; ‡asova‡ CTC-1/ZRE (p©ete‡en¡ disk. operace)
0104:                   dw      1aefh       ; ‡asova‡ CTC-2/ZRE
0106:                   dw      0c967h      ; ‡asova‡ CTC-3/ZRE

0108:                   dw      1519h       
010a:                   dw      00fdh       ; n vrat z ne‡ekan‚ho p©eru¨en¡
010c:                   dw      00fdh       ; n vrat z ne‡ekan‚ho p©eru¨en¡
010e:                   dw      00fdh       ; n vrat z ne‡ekan‚ho p©eru¨en¡
                                            ; p©eru¨en¡ od SIO/ATS
0110:                   dw      2006h       ; vys¡lac¡ kan l SIO-A/ATS pr zdn˜
0112:                   dw      2009h       ; zmˆna extern¡ho stavu SIO-A/ATS
0114:                   dw      200ch       ; p©¡jem znaku SIO-A/ATS
0116:                   dw      200fh       ; zvl ¨tn¡ podm¡nky p©¡jmu SIO-A/ATS
0118:                   dw      2006h       ; vys¡lac¡ kan l SIO-B/ATS pr zdn˜
011a:                   dw      2009h       ; zmˆna extern¡ho stavu SIO-B/ATS
011c:                   dw      200ch       ; p©¡jem znaku SIO-B/ATS
011e:                   dw      200fh       ; zvl ¨tn¡ podm¡nky p©¡jmu SIO-B/ATS

0120:                   dw      1addh
0122:                   dw      1ae0h       
0124:                   dw      1ae3h       
0126:                   dw      1ae6h       
0128:                   dw      1ae9h       
012a:                   dw      1aech       
012c:                   dw      00fdh       ; n vrat z ne‡ekan‚ho p©eru¨en¡
012e:                   dw      00fdh       ; n vrat z ne‡ekan‚ho p©eru¨en¡
0130:                   dw      00fdh       ; n vrat z ne‡ekan‚ho p©eru¨en¡
0132:                   dw      00fdh       ; n vrat z ne‡ekan‚ho p©eru¨en¡
0134:                   dw      00fdh       ; n vrat z ne‡ekan‚ho p©eru¨en¡
0136:                   dw      2003h       

0138:                   db   0fdh,0,0fdh
013b:                   db   0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0
0148:                   db   0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh
0155:                   db   0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0
0162:                   db   0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh
016f:                   db   0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0
017c:                   db   0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh
0189:                   db   0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0
0196:                   db   0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh
01a3:                   db   0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0
01b0:                   db   0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh
01bd:                   db   0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0
01ca:                   db   0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh
01d7:                   db   0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0
01e4:                   db   0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh
01f1:                   db   0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0,0fdh,0
01fe:                   db   0fdh,0
                                            ; funkce 08
0200:fb                 ei
0201:d5                 push    de
0202:fd e1              pop     iy
0204:21 ba b4           ld      hl,0b4bah
0207:5e                 ld      e,(hl)
0208:23                 inc     hl
0209:56                 ld      d,(hl)
020a:fd 7e 02           ld      a,(iy+2)
020d:92                 sub     d
020e:fa 3e 03           jp      m,33eh
0211:4f                 ld      c,a
0212:93                 sub     e
0213:f2 3e 03           jp      p,33eh
0216:79                 ld      a,c
0217:cb 21              sla     c
0219:81                 add     a,c
021a:4f                 ld      c,a
021b:06 00              ld      b,0
021d:23                 inc     hl
021e:09                 add     hl,bc
021f:5e                 ld      e,(hl)
0220:23                 inc     hl
0221:56                 ld      d,(hl)
0222:dd e5              push    ix
0224:d5                 push    de
0225:dd e1              pop     ix
0227:f3                 di      
0228:dd cb 01 56        bit     2,(ix+1)
022c:28 27              jr      z,255h
022e:21 ad b4           ld      hl,0b4adh
0231:cb 4e              bit     1,(hl)
0233:28 07              jr      z,23ch
0235:dd 2a 9c b7        ld      ix,(0b79ch)
0239:c3 fe 02           jp      2feh
; ......................................................
023c:af                 xor     a
023d:2a 9c b7           ld      hl,(0b79ch)
0240:eb                 ex      de,hl
0241:ed 52              sbc     hl,de
0243:28 10              jr      z,255h
0245:21 0c 00           ld      hl,0ch
0248:19                 add     hl,de
0249:be                 cp      (hl)
024a:28 05              jr      z,251h
024c:56                 ld      d,(hl)
024d:77                 ld      (hl),a
024e:dd 72 0c           ld      (ix+0ch),d
0251:dd 22 9c b7        ld      (0b79ch),ix
0255:dd cb 00 46        bit     0,(ix+0)
0259:20 10              jr      nz,26bh
025b:21 72 02           ld      hl,272h
025e:e5                 push    hl
025f:dd 6e 04           ld      l,(ix+4)
0262:dd 66 05           ld      h,(ix+5)
0265:f3                 di      
0266:dd cb 00 c6        set     0,(ix+0)
026a:e9                 jp      (hl)
; ......................................................
026b:dd cb 00 56        bit     2,(ix+0)
026f:c2 fe 02           jp      nz,2feh
0272:dd cb 00 d6        set     2,(ix+0)
0276:dd 7e 01           ld      a,(ix+1)
0279:cb 4f              bit     1,a
027b:28 08              jr      z,285h
027d:fd 7e 02           ld      a,(iy+2)
0280:32 2f b5           ld      (0b52fh),a
0283:18 0f              jr      294h
; ......................................................
0285:cb 57              bit     2,a
0287:28 0b              jr      z,294h
0289:21 ad b4           ld      hl,0b4adh
028c:cb ce              set     1,(hl)
028e:fd 7e 02           ld      a,(iy+2)
0291:32 57 b5           ld      (0b557h),a
0294:3a ea b3           ld      a,(0b3eah)
0297:dd 77 0b           ld      (ix+0bh),a
029a:e1                 pop     hl
029b:dd 75 09           ld      (ix+9),l
029e:dd 74 0a           ld      (ix+0ah),h
02a1:dd 6e 06           ld      l,(ix+6)
02a4:dd 66 07           ld      h,(ix+7)
02a7:fd 7e 01           ld      a,(iy+1)
02aa:fd 5e 03           ld      e,(iy+3)
02ad:73                 ld      (hl),e
02ae:fd e5              push    iy
02b0:d1                 pop     de
02b1:01 04 00           ld      bc,4
02b4:eb                 ex      de,hl
02b5:09                 add     hl,bc
02b6:eb                 ex      de,hl
02b7:e5                 push    hl
02b8:fd e1              pop     iy
02ba:23                 inc     hl
02bb:eb                 ex      de,hl
02bc:a7                 and     a
02bd:0f                 rrca    
02be:30 04              jr      nc,2c4h
02c0:ed b0              ldir    
02c2:18 03              jr      2c7h
; ......................................................
02c4:eb                 ex      de,hl
02c5:09                 add     hl,bc
02c6:eb                 ex      de,hl
02c7:0e 02              ld      c,2
02c9:0f                 rrca    
02ca:30 04              jr      nc,2d0h
02cc:ed b0              ldir    
02ce:18 02              jr      2d2h
; ......................................................
02d0:13                 inc     de
02d1:13                 inc     de
02d2:0e 02              ld      c,2
02d4:0f                 rrca    
02d5:30 04              jr      nc,2dbh
02d7:ed b0              ldir    
02d9:18 06              jr      2e1h
; ......................................................
02db:eb                 ex      de,hl
02dc:70                 ld      (hl),b
02dd:23                 inc     hl
02de:70                 ld      (hl),b
02df:23                 inc     hl
02e0:eb                 ex      de,hl
02e1:0f                 rrca    
02e2:30 05              jr      nc,2e9h
02e4:ed a0              ldi     
02e6:eb                 ex      de,hl
02e7:18 04              jr      2edh
; ......................................................
02e9:eb                 ex      de,hl
02ea:36 00              ld      (hl),0
02ec:23                 inc     hl
02ed:36 00              ld      (hl),0
02ef:0f                 rrca    
02f0:30 04              jr      nc,2f6h
02f2:dd cb 00 ee        set     5,(ix+0)
02f6:0f                 rrca    
02f7:dd 6e 02           ld      l,(ix+2)
02fa:dd 66 03           ld      h,(ix+3)
02fd:e9                 jp      (hl)
; ......................................................
02fe:2a ec b3           ld      hl,(0b3ech)
0301:cb ee              set     5,(hl)
0303:06 86              ld      b,86h
0305:cd a6 0e           call    0ea6h
0308:dd 6e 06           ld      l,(ix+6)
030b:dd 66 07           ld      h,(ix+7)
030e:11 0b 00           ld      de,0bh
0311:19                 add     hl,de
0312:5e                 ld      e,(hl)
0313:23                 inc     hl
0314:56                 ld      d,(hl)
0315:eb                 ex      de,hl
0316:06 00              ld      b,0
0318:09                 add     hl,bc
0319:3a e8 b3           ld      a,(0b3e8h)
031c:e6 3f              and     3fh
031e:f6 40              or      40h
0320:32 e8 b3           ld      (0b3e8h),a
0323:cd e7 b3           call    0b3e7h
0326:20 0b              jr      nz,333h
0328:f6 80              or      80h
032a:32 e8 b3           ld      (0b3e8h),a
032d:cd e7 b3           call    0b3e7h
0330:dd 34 0c           inc     (ix+0ch)
0333:dd e1              pop     ix
0335:cd 27 0f           call    0f27h
0338:21 02 b3           ld      hl,0b302h
033b:c3 a4 0d           jp      0da4h
; ......................................................
033e:fd 7e 01           ld      a,(iy+1)
0341:cb 57              bit     2,a
0343:28 1c              jr      z,361h
0345:0e 04              ld      c,4
0347:1f                 rra     
0348:30 02              jr      nc,34ch
034a:cb 21              sla     c
034c:1f                 rra     
034d:30 02              jr      nc,351h
034f:0c                 inc     c
0350:0c                 inc     c
0351:06 00              ld      b,0
0353:fd 09              add     iy,bc
0355:fd 6e 00           ld      l,(iy+0)
0358:fd 66 01           ld      h,(iy+1)
035b:3b                 dec     sp
035c:3b                 dec     sp
035d:fd e1              pop     iy
035f:36 11              ld      (hl),11h
0361:c3 98 0d           jp      0d98h
; ......................................................
0364:f3                 di      
0365:21 ad b4           ld      hl,0b4adh
0368:cb 6e              bit     5,(hl)
036a:cb ae              res     5,(hl)
036c:c2 98 0d           jp      nz,0d98h
036f:dd cb 00 6e        bit     5,(ix+0)
0373:ca 98 0d           jp      z,0d98h
0376:2a ec b3           ld      hl,(0b3ech)
0379:cb ee              set     5,(hl)
037b:06 86              ld      b,86h
037d:cd a6 0e           call    0ea6h
0380:21 01 b3           ld      hl,0b301h
0383:cb ce              set     1,(hl)
0385:c3 a3 0d           jp      0da3h
; ......................................................
0388:                   db   0ddh,0cbh,1,4eh,28h,0dh,0ddh,0cbh,0,96h,0ddh
0393:                   db   22h,0aeh,0b4h,21h,0adh,0b4h,0cbh,0d6h,0ddh
039c:                   db   6eh,9,0ddh,66h,0ah,0e5h,0c3h,0feh,2
03a5:f3                 di      
03a6:21 b0 b4           ld      hl,0b4b0h
03a9:cb c6              set     0,(hl)
03ab:18 06              jr      3b3h
; ......................................................
03ad:f3                 di      
03ae:38 03              jr      c,3b3h
03b0:c3 ef 0c           jp      0cefh
; ......................................................
03b3:fd 7e 07           ld      a,(iy+7)
03b6:6f                 ld      l,a
03b7:fd b6 08           or      (iy+8)
03ba:28 07              jr      z,3c3h
03bc:fd 66 08           ld      h,(iy+8)
03bf:fd 7e 0a           ld      a,(iy+0ah)
03c2:77                 ld      (hl),a
03c3:21 ad b4           ld      hl,0b4adh
03c6:dd 7e 01           ld      a,(ix+1)
03c9:cb 6f              bit     5,a
03cb:28 05              jr      z,3d2h
03cd:cb 56              bit     2,(hl)
03cf:c2 91 04           jp      nz,491h
03d2:cb 57              bit     2,a
03d4:28 02              jr      z,3d8h
03d6:cb 8e              res     1,(hl)
03d8:cb 4f              bit     1,a
03da:28 03              jr      z,3dfh
03dc:af                 xor     a
03dd:18 1a              jr      3f9h
; ......................................................
03df:c3 38 04           jp      438h
; ......................................................
03e2:08                 ex      af,af'
03e3:21 ad b4           ld      hl,0b4adh
03e6:cb 56              bit     2,(hl)
03e8:28 10              jr      z,3fah
03ea:cb 96              res     2,(hl)
03ec:f1                 pop     af
03ed:28 0b              jr      z,3fah
03ef:08                 ex      af,af'
03f0:28 08              jr      z,3fah
03f2:47                 ld      b,a
03f3:08                 ex      af,af'
03f4:b8                 cp      b
03f5:38 02              jr      c,3f9h
03f7:78                 ld      a,b
03f8:b7                 or      a
03f9:08                 ex      af,af'
03fa:dd 7e 0b           ld      a,(ix+0bh)
03fd:cd 5b 0f           call    0f5bh
0400:28 28              jr      z,42ah
0402:08                 ex      af,af'
0403:28 2d              jr      z,432h
0405:bb                 cp      e
0406:38 01              jr      c,409h
0408:7b                 ld      a,e
0409:08                 ex      af,af'
040a:af                 xor     a
040b:21 eb b3           ld      hl,0b3ebh
040e:be                 cp      (hl)
040f:20 10              jr      nz,421h
0411:08                 ex      af,af'
0412:2b                 dec     hl
0413:be                 cp      (hl)
0414:d2 c3 04           jp      nc,4c3h
0417:23                 inc     hl
0418:77                 ld      (hl),a
0419:21 01 b3           ld      hl,0b301h
041c:cb ce              set     1,(hl)
041e:c3 c3 04           jp      4c3h
; ......................................................
0421:08                 ex      af,af'
0422:be                 cp      (hl)
0423:d2 c3 04           jp      nc,4c3h
0426:77                 ld      (hl),a
0427:c3 c3 04           jp      4c3h
; ......................................................
042a:06 46              ld      b,46h       ; test bitu v bitov‚ mapˆ
042c:cd a9 0e           call    0ea9h       ; operace v bitov‚ mapˆ
042f:c2 c3 04           jp      nz,4c3h     ; bit je nastaven
0432:08                 ex      af,af'
0433:ca c3 04           jp      z,4c3h
0436:18 d1              jr      409h
; ......................................................
0438:dd 7e 0c           ld      a,(ix+0ch)
043b:b7                 or      a
043c:ca e2 03           jp      z,3e2h
043f:fd 6e 0b           ld      l,(iy+0bh)
0442:fd 66 0c           ld      h,(iy+0ch)
0445:af                 xor     a
0446:4f                 ld      c,a
0447:86                 add     a,(hl)
0448:20 08              jr      nz,452h
044a:23                 inc     hl
044b:3e 08              ld      a,8
044d:81                 add     a,c
044e:4f                 ld      c,a
044f:af                 xor     a
0450:18 f5              jr      447h
; ......................................................
0452:0c                 inc     c
0453:1f                 rra     
0454:30 fc              jr      nc,452h
0456:08                 ex      af,af'
0457:79                 ld      a,c
0458:5f                 ld      e,a
0459:3d                 dec     a
045a:e6 07              and     7
045c:06 86              ld      b,86h
045e:cd be 0e           call    0ebeh
0461:d9                 exx     
0462:cd 5b 0f           call    0f5bh
0465:dd 35 0c           dec     (ix+0ch)
0468:28 10              jr      z,47ah
046a:7b                 ld      a,e
046b:b7                 or      a
046c:20 3e              jr      nz,4ach
046e:08                 ex      af,af'
046f:d9                 exx     
0470:b7                 or      a
0471:20 df              jr      nz,452h
0473:0d                 dec     c
0474:79                 ld      a,c
0475:e6 f8              and     0f8h
0477:4f                 ld      c,a
0478:18 d0              jr      44ah
; ......................................................
047a:dd cb 01 4e        bit     1,(ix+1)
047e:28 0c              jr      z,48ch
0480:dd 7e 0b           ld      a,(ix+0bh)
0483:b7                 or      a
0484:20 13              jr      nz,499h
0486:bb                 cp      e
0487:28 10              jr      z,499h
0489:7b                 ld      a,e
048a:18 0d              jr      499h
; ......................................................
048c:7b                 ld      a,e
048d:b7                 or      a
048e:c3 e2 03           jp      3e2h
; ......................................................
0491:dd e5              push    ix
0493:dd 2a ae b4        ld      ix,(0b4aeh)
0497:18 09              jr      4a2h
; ......................................................
0499:dd e1              pop     ix
049b:f5                 push    af
049c:dd 7e 01           ld      a,(ix+1)
049f:c3 d8 03           jp      3d8h
; ......................................................
04a2:2a 25 b5           ld      hl,(0b525h)
04a5:dd 36 0b 00        ld      (ix+0bh),0
04a9:c3 45 04           jp      445h
; ......................................................
04ac:dd cb 01 4e        bit     1,(ix+1)
04b0:28 0d              jr      z,4bfh
04b2:af                 xor     a
04b3:dd be 0b           cp      (ix+0bh)
04b6:c2 6e 04           jp      nz,46eh
04b9:dd 73 0b           ld      (ix+0bh),e
04bc:c3 6e 04           jp      46eh
; ......................................................
04bf:b7                 or      a
04c0:c3 e2 03           jp      3e2h
; ......................................................
04c3:dd cb 00 96        res     2,(ix+0)
04c7:dd cb 00 ae        res     5,(ix+0)
04cb:21 b0 b4           ld      hl,0b4b0h
04ce:cb 7e              bit     7,(hl)
04d0:cb be              res     7,(hl)
04d2:c0                 ret     nz
04d3:cb 46              bit     0,(hl)
04d5:ca ef 0c           jp      z,0cefh
04d8:cb 86              res     0,(hl)
04da:c3 98 0d           jp      0d98h
; ......................................................
04dd:01 bc b4           ld      bc,0b4bch
04e0:21 9e b7           ld      hl,0b79eh
04e3:5e                 ld      e,(hl)
04e4:23                 inc     hl
04e5:6e                 ld      l,(hl)
04e6:26 00              ld      h,0
04e8:54                 ld      d,h
04e9:09                 add     hl,bc
04ea:eb                 ex      de,hl
04eb:09                 add     hl,bc
04ec:1a                 ld      a,(de)
04ed:4e                 ld      c,(hl)
04ee:77                 ld      (hl),a
04ef:23                 inc     hl
04f0:13                 inc     de
04f1:1a                 ld      a,(de)
04f2:46                 ld      b,(hl)
04f3:77                 ld      (hl),a
04f4:2b                 dec     hl
04f5:6e                 ld      l,(hl)
04f6:67                 ld      h,a
04f7:eb                 ex      de,hl
04f8:c5                 push    bc
04f9:e1                 pop     hl
04fa:01 08 00           ld      bc,8
04fd:09                 add     hl,bc
04fe:eb                 ex      de,hl
04ff:09                 add     hl,bc
0500:1a                 ld      a,(de)
0501:77                 ld      (hl),a
0502:06 03              ld      b,3
0504:23                 inc     hl
0505:13                 inc     de
0506:1a                 ld      a,(de)
0507:77                 ld      (hl),a
0508:10 fa              djnz    504h
050a:c1                 pop     bc
050b:e1                 pop     hl
050c:d1                 pop     de
050d:c5                 push    bc
050e:e5                 push    hl
050f:01 0c 00           ld      bc,0ch
0512:09                 add     hl,bc
0513:eb                 ex      de,hl
0514:09                 add     hl,bc
0515:c1                 pop     bc
0516:d5                 push    de
0517:e5                 push    hl
0518:7e                 ld      a,(hl)
0519:b7                 or      a
051a:28 27              jr      z,543h
051c:12                 ld      (de),a
051d:01 06 00           ld      bc,6
0520:ed 42              sbc     hl,bc
0522:eb                 ex      de,hl
0523:ed 42              sbc     hl,bc
0525:4e                 ld      c,(hl)
0526:23                 inc     hl
0527:46                 ld      b,(hl)
0528:eb                 ex      de,hl
0529:5e                 ld      e,(hl)
052a:23                 inc     hl
052b:56                 ld      d,(hl)
052c:21 0b 00           ld      hl,0bh
052f:eb                 ex      de,hl
0530:19                 add     hl,de
0531:eb                 ex      de,hl
0532:09                 add     hl,bc
0533:4e                 ld      c,(hl)
0534:23                 inc     hl
0535:46                 ld      b,(hl)
0536:c5                 push    bc
0537:e1                 pop     hl
0538:eb                 ex      de,hl
0539:4e                 ld      c,(hl)
053a:23                 inc     hl
053b:46                 ld      b,(hl)
053c:c5                 push    bc
053d:e1                 pop     hl
053e:01 03 00           ld      bc,3
0541:ed b0              ldir    
0543:e1                 pop     hl
0544:2b                 dec     hl
0545:2b                 dec     hl
0546:44                 ld      b,h
0547:4d                 ld      c,l
0548:7e                 ld      a,(hl)
0549:2b                 dec     hl
054a:6e                 ld      l,(hl)
054b:67                 ld      h,a
054c:23                 inc     hl
054d:cb 7e              bit     7,(hl)
054f:23                 inc     hl
0550:28 04              jr      z,556h
0552:5e                 ld      e,(hl)
0553:23                 inc     hl
0554:56                 ld      d,(hl)
0555:eb                 ex      de,hl
0556:23                 inc     hl
0557:7e                 ld      a,(hl)
0558:23                 inc     hl
0559:23                 inc     hl
055a:eb                 ex      de,hl
055b:e1                 pop     hl
055c:e5                 push    hl
055d:01 06 00           ld      bc,6
0560:ed 42              sbc     hl,bc
0562:4e                 ld      c,(hl)
0563:23                 inc     hl
0564:66                 ld      h,(hl)
0565:69                 ld      l,c
0566:e5                 push    hl
0567:eb                 ex      de,hl
0568:ed a0              ldi     
056a:01 04 00           ld      bc,4
056d:0f                 rrca    
056e:30 04              jr      nc,574h
0570:ed b0              ldir    
0572:18 03              jr      577h
; ......................................................
0574:eb                 ex      de,hl
0575:09                 add     hl,bc
0576:eb                 ex      de,hl
0577:0e 02              ld      c,2
0579:0f                 rrca    
057a:30 04              jr      nc,580h
057c:ed b0              ldir    
057e:18 02              jr      582h
; ......................................................
0580:13                 inc     de
0581:13                 inc     de
0582:0e 02              ld      c,2
0584:0f                 rrca    
0585:30 04              jr      nc,58bh
0587:ed b0              ldir    
0589:18 06              jr      591h
; ......................................................
058b:eb                 ex      de,hl
058c:70                 ld      (hl),b
058d:23                 inc     hl
058e:70                 ld      (hl),b
058f:23                 inc     hl
0590:eb                 ex      de,hl
0591:0f                 rrca    
0592:30 04              jr      nc,598h
0594:ed a0              ldi     
0596:03                 inc     bc
0597:1b                 dec     de
0598:13                 inc     de
0599:eb                 ex      de,hl
059a:70                 ld      (hl),b
059b:fd e1              pop     iy
059d:d1                 pop     de
059e:c9                 ret     
; ......................................................
059f:ed 73 03 b3        ld      (0b303h),sp
05a3:e3                 ex      (sp),hl
05a4:f5                 push    af
05a5:af                 xor     a
05a6:be                 cp      (hl)
05a7:3a ea b3           ld      a,(0b3eah)
05aa:20 06              jr      nz,5b2h
05ac:77                 ld      (hl),a
05ad:f1                 pop     af
05ae:e1                 pop     hl
05af:c3 0a 06           jp      60ah
; ......................................................
05b2:d5                 push    de
05b3:5f                 ld      e,a
05b4:56                 ld      d,(hl)
05b5:2a 03 b3           ld      hl,(0b303h)
05b8:23                 inc     hl
05b9:23                 inc     hl
05ba:7e                 ld      a,(hl)
05bb:d6 03              sub     3
05bd:77                 ld      (hl),a
05be:30 02              jr      nc,5c2h
05c0:23                 inc     hl
05c1:35                 dec     (hl)
05c2:c5               * push    bc
05c3:dd e5              push    ix
05c5:fd e5              push    iy
05c7:01 2e 0d           ld      bc,0d2eh
05ca:c5                 push    bc
05cb:ed 73 03 b3        ld      (0b303h),sp
05cf:2a 05 b3           ld      hl,(0b305h)
05d2:ed 4b 03 b3        ld      bc,(0b303h)
05d6:71                 ld      (hl),c
05d7:23                 inc     hl
05d8:70                 ld      (hl),b
05d9:7b                 ld      a,e         ; ‡¡slo funkce
05da:cd 9d 0e           call    0e9dh       ; adresa p©¡znaku funkce
05dd:cb fe              set     7,(hl)
05df:7a                 ld      a,d         ; ‡¡slo funkce
05e0:cd 9d 0e           call    0e9dh       ; adresa p©¡znaku funkce
05e3:cb be              res     7,(hl)
05e5:c3 60 0e           jp      0e60h
; ......................................................
                                            ; FUNKCE RST 28h
05e8:ed 73 03 b3        ld      (0b303h),sp ; ukazatel z sobn¡ku
05ec:e5                 push    hl
05ed:f5                 push    af
05ee:d5                 push    de
05ef:2a 03 b3           ld      hl,(0b303h) ; ukazatel z sobn¡ku
05f2:5e                 ld      e,(hl)
05f3:23                 inc     hl
05f4:56                 ld      d,(hl)      ; n vratov  adresa po RST 28h
05f5:21 fa ff           ld      hl,0fffah   ; = -6
05f8:19                 add     hl,de       ; n vratov  adresa - 6
05f9:5e                 ld      e,(hl)      ; argument prvn¡ instrukce CALL
05fa:23                 inc     hl
05fb:56                 ld      d,(hl)
05fc:13                 inc     de
05fd:eb                 ex      de,hl
05fe:3a ea b3           ld      a,(0b3eah)
0601:be                 cp      (hl)        ; prvn¡ bajt podprogramu CALL
0602:5e                 ld      e,(hl)
0603:36 00              ld      (hl),0
0605:20 05              jr      nz,60ch
0607:d1                 pop     de
0608:f1                 pop     af
0609:e1                 pop     hl
060a:fb                 ei      
060b:c9                 ret     
; ......................................................
060c:57                 ld      d,a
060d:18 b3              jr      5c2h
; ......................................................
                                            ; zru¨en¡ p©¡znaku v tabulce
060f:06 0c              ld      b,0ch
0611:21 66 06           ld      hl,666h
0614:23               * inc     hl
0615:23                 inc     hl
0616:be                 cp      (hl)
0617:28 03              jr      z,61ch
0619:10 f9              djnz    614h
061b:c9                 ret     
; ......................................................
061c:36 00            * ld      (hl),0      ; zru¨en¡
061e:c9                 ret     
; ......................................................
061f:                                       ; tabulka adres funkc¡
                                            ; prvn¡ slovo - adresa z sobn¡ku
061f:                   dw      0b050h,0b47dh  ; funkce 01
0623:                   dw      0b300h,1e88h   ; funkce 02
0627:                   dw      0b030h,0cc9ch  ; funkce 03
062b:                   dw      0b2e0h,3f0ah   ; funkce 04
062f:                   dw      0b2a0h,5c04h   ; funkce 05
0633:                   dw      0b260h,3ef4h   ; funkce 06
0637:                   dw      0b1c0h,3ee4h   ; funkce 07
063b:                   dw      0b240h,4080h   ; funkce 08
063f:                   dw      0b200h,6600h   ; funkce 09
0643:                   dw      0fd3ah,8445h   ; funkce 10
0647:                   dw      0b1a0h,5100h   ; funkce 11
064b:                   dw      0b170h,4f84h   ; funkce 12
064f:                   dw      0,0            ; funkce 13
0653:                   dw      0,0            ; funkce 14
0657:                   dw      0b140h,391eh   ; funkce 15
065b:                   dw      0b100h,478bh   ; funkce 16
065f:                   dw      0b0c0h,5684h   ; funkce 17
0663:                   dw      0b080h,8800h   ; funkce 18

                                            ; tabulka p©¡znak–
0666:                   db      88h,0e7h,0,0e7h,0,0e7h,0,0e7h,0,0e7h
0670:                   db      0,0e7h,0,0e7h,0,0e7h,0,0e7h,0,0e7h
067a:                   db      0,0e7h,0,0e7h,0
                                            ; funkce 01 - vypnut¡ funkce
067f:1a               * ld      a,(de)
0680:2a ec b3           ld      hl,(0b3ech)
0683:cb 76              bit     6,(hl)
0685:cb b6              res     6,(hl)
0687:20 08              jr      nz,0691h
0689:06 86            * ld      b,86h       ; instrukce pro resetov n¡ bitu
068b:cd a6 0e           call    0ea6h       ; operace v bitov‚ mapˆ
068e:c3 c5 0d           jp      0dc5h
0691:b7               * or      a
0692:28 f5              jr      z,0689h
0694:3a ea b3           ld      a,(0b3eah)
0697:4f                 ld      c,a
0698:0d                 dec     c
0699:c3 54 0e           jp      0e54h
                                            ; funkce 06
069c:fb                 ei
069d:13                 inc     de
069e:1a                 ld      a,(de)
069f:cd cd 0e           call    0ecdh
06a2:cd 9d 0e           call    0e9d        ; adresa p©¡znaku funkce
06a5:cb a6              res     4,(hl)
06a7:c3 98 0d           jp      0d98h
; ......................................................
                                            ; funkce 05 - zru¨en¡ funkce
06aa:fb                 ei
06ab:13                 inc     de
06ac:1a                 ld      a,(de)
06ad:cd cd 0e           call    0ecdh
06b0:cd 9d 0e           call    0e9dh       ; adresa p©¡znaku funkce
06b3:0c                 inc     c
06b4:af                 xor     a
06b5:3c                 inc     a
06b6:a6                 and     (hl)
06b7:f6 10              or      10h
06b9:77                 ld      (hl),a      ; nastaven¡ p©¡znak– funkce
06ba:79                 ld      a,c         ; ‡¡so funkce
06bb:06 86              ld      b,86h       ; vypnut¡ funkce v mapˆ
06bd:cd a9 0e           call    0ea9h       ; operace v bitov‚ mapˆ
06c0:cd 0f 06           call    60fh        ; zru¨en¡ p©¡znaku v tabulce
06c3:3a ea b3           ld      a,(0b3eah)  ; ‡¡slo funkce
06c6:bb                 cp      e
06c7:c2 98 0d           jp      nz,0d98h
06ca:21 01 b3           ld      hl,0b301h   ; maska pro bit. mapu
06cd:cb c6              set     0,(hl)
06cf:c3 98 0d           jp      0d98h
; ......................................................
06d2:0a                 ld      a,(bc)
06d3:c5                 push    bc
06d4:0e 00              ld      c,0
06d6:06 0a              ld      b,0ah
06d8:0c                 inc     c
06d9:90                 sub     b
06da:30 fc              jr      nc,6d8h
06dc:0d                 dec     c
06dd:80                 add     a,b
06de:47                 ld      b,a
06df:79                 ld      a,c
06e0:f6 30              or      30h
06e2:77                 ld      (hl),a
06e3:23                 inc     hl
06e4:78                 ld      a,b
06e5:f6 30              or      30h
06e7:77                 ld      (hl),a
06e8:23                 inc     hl
06e9:c1                 pop     bc
06ea:c9                 ret     
; ......................................................
06eb:fb                 ei      
06ec:13                 inc     de
06ed:1a                 ld      a,(de)
06ee:6f                 ld      l,a
06ef:13                 inc     de
06f0:1a                 ld      a,(de)
06f1:67                 ld      h,a
06f2:cd f8 06           call    6f8h
06f5:c3 98 0d           jp      0d98h
; ......................................................
06f8:01 2c b4           ld      bc,0b42ch
06fb:cd d2 06           call    6d2h
06fe:36 3a              ld      (hl),3ah
0700:23                 inc     hl
0701:0b                 dec     bc
0702:cd d2 06           call    6d2h
0705:36 3a              ld      (hl),3ah
0707:23                 inc     hl
0708:0b                 dec     bc
0709:cd d2 06           call    6d2h
070c:c9                 ret     
; ......................................................
                                            ; funcke 00
070d:13                 inc     de
070e:1a                 ld      a,(de)
070f:cd cd 0e           call    0ecdh
0712:cd 9d 0e           call    0e9dh       ; adresa p©¡znaku funkce
0715:cb 66              bit     4,(hl)
0717:c2 98 0d           jp      nz,0d98h
071a:4f                 ld      c,a
071b:1b                 dec     de
071c:1a                 ld      a,(de)
071d:3d                 dec     a
071e:f3                 di      
071f:20 11              jr      nz,732h
0721:11 00 40           ld      de,4000h
0724:06 c6              ld      b,0c6h
0726:cd f5 0e           call    0ef5h
0729:da 98 0d           jp      c,0d98h
072c:cd 15 0f           call    0f15h
072f:c3 98 0d           jp      0d98h
; ......................................................
0732:17                 rla     
0733:79                 ld      a,c
0734:cb 46              bit     0,(hl)
0736:c2 98 0d           jp      nz,0d98h
0739:13                 inc     de
073a:13                 inc     de
073b:d5                 push    de
073c:e5                 push    hl
073d:cd 8c 07           call    78ch        ; vypu¨tˆn¡ polo‘ky 5 B z bufferu
0740:77                 ld      (hl),a
0741:e1                 pop     hl
0742:34                 inc     (hl)
0743:e1                 pop     hl
0744:46                 ld      b,(hl)
0745:23                 inc     hl
0746:ed a0              ldi     
0748:ed a0              ldi     
074a:38 34              jr      c,780h
074c:08                 ex      af,af'
074d:04                 inc     b
074e:cb 78              bit     7,b
0750:c4 c3 07           call    nz,7c3h
0753:eb                 ex      de,hl
0754:70                 ld      (hl),b
0755:78                 ld      a,b
0756:ed 6f              rld     
0758:28 20              jr      z,77ah
075a:be                 cp      (hl)
075b:28 15              jr      z,772h
075d:36 00              ld      (hl),0
075f:23                 inc     hl
0760:36 80              ld      (hl),80h
0762:21 31 b4           ld      hl,0b431h
0765:d5                 push    de
                                                      ; z adresy 0b34h je tato
                                                      ; ‡ st programu nahrazena
                                                      ; 12x instrukcemi RST 20H/NOP
                                                      ; (adresa 0766h a‘ 077dh)
0766:cd 9a 07           call    79ah
0769:77                 ld      (hl),a
076a:e1                 pop     hl
076b:eb                 ex      de,hl
076c:36 ff              ld      (hl),0ffh
076e:23                 inc     hl
076f:36 ff              ld      (hl),0ffh
0771:23                 inc     hl
0772:eb                 ex      de,hl
0773:ed a0              ldi     
0775:7e                 ld      a,(hl)
0776:12                 ld      (de),a
0777:c3 98 0d           jp      0d98h
; ......................................................
077a:77                 ld      (hl),a
077b:23                 inc     hl
077c:77                 ld      (hl),a
077d:c3 98 0d           jp      0d98h
; ......................................................
0780:2b                 dec     hl
0781:2b                 dec     hl
0782:ed a0              ldi     
0784:ed a0              ldi     
0786:cd 9d 0e           call    0e9dh       ; adresa p©¡znaku funkce
0789:4f                 ld      c,a
078a:18 95              jr      721h
; ......................................................
                                            ; vypu¨tˆn¡ polo‘ky 5 B z bufferu
078c:08               * ex      af,af'
078d:21 31 b4           ld      hl,0b431h
0790:3e 0c              ld      a,0ch
0792:96                 sub     (hl)
0793:ca 98 0d           jp      z,0d98h
0796:da 98 0d           jp      c,0d98h
0799:1a                 ld      a,(de)      ; ‡¡slo polo‘ky (1 a‘ 15)
079a:e6 0f              and     0fh
079c:47                 ld      b,a
079d:7e                 ld      a,(hl)      ; ‡¡slo
079e:87                 add     a,a         ; * 2
079f:87                 add     a,a         ; * 4
07a0:86                 add     a,(hl)      ; * 5
07a1:4f                 ld      c,a
07a2:af                 xor     a
07a3:34                 inc     (hl)
07a4:05                 dec     b
07a5:28 04              jr      z,7abh
07a7:2b               * dec     hl
07a8:86                 add     a,(hl)
07a9:10 fc              djnz    7a7h
07ab:2b               * dec     hl
07ac:34                 inc     (hl)
07ad:21 3b b4           ld      hl,0b43bh
07b0:09                 add     hl,bc
07b1:eb                 ex      de,hl
07b2:21 fb ff           ld      hl,0fffbh   ; - 5
07b5:19                 add     hl,de
07b6:4f                 ld      c,a
07b7:87                 add     a,a
07b8:28 05              jr      z,7bfh
07ba:87                 add     a,a
07bb:81                 add     a,c
07bc:4f                 ld      c,a
07bd:ed b8              lddr                ; vypu¨tˆn¡ polo‘ky z bufferu
07bf:eb               * ex      de,hl
07c0:13                 inc     de
07c1:08                 ex      af,af'
07c2:c9                 ret     
; ......................................................
07c3:e5                 push    hl
07c4:c5                 push    bc
07c5:1b                 dec     de
07c6:21 2b b4           ld      hl,0b42bh
07c9:1a                 ld      a,(de)
07ca:96                 sub     (hl)
07cb:4f                 ld      c,a
07cc:1b                 dec     de
07cd:23                 inc     hl
07ce:1a                 ld      a,(de)
07cf:9e                 sbc     a,(hl)
07d0:20 07              jr      nz,7d9h
07d2:67                 ld      h,a
07d3:81                 add     a,c
07d4:20 1a              jr      nz,7f0h
07d6:3c                 inc     a
07d7:18 17              jr      7f0h
; ......................................................
07d9:d5                 push    de
07da:30 02              jr      nc,7deh
07dc:c6 19              add     a,19h
07de:47                 ld      b,a
07df:21 00 00           ld      hl,0
07e2:11 3c 00           ld      de,3ch
07e5:19                 add     hl,de
07e6:10 fd              djnz    7e5h
07e8:b1                 or      c
07e9:f2 ed 07           jp      p,7edh
07ec:05                 dec     b
07ed:09                 add     hl,bc
07ee:d1                 pop     de
07ef:7d                 ld      a,l
07f0:12                 ld      (de),a
07f1:7c                 ld      a,h
07f2:13                 inc     de
07f3:12                 ld      (de),a
07f4:13                 inc     de
07f5:c1                 pop     bc
07f6:e1                 pop     hl
07f7:cb b8              res     7,b
07f9:c9                 ret     
; ......................................................
                                            ; funkce 03 - ru¨en¡ funkce
07fa:2a ec b3           ld      hl,(0b3ech) ; adresa v tabulce funkc¡
07fd:1a                 ld      a,(de)
07fe:cb 27              sla     a
0800:28 21              jr      z,823h
0802:cb 46              bit     0,(hl)
0804:13                 inc     de
0805:d5                 push    de
0806:3a ea b3           ld      a,(0b3eah)  ; ‡¡slo ru¨en‚ funkce
0809:cd 8c 07           call    78ch        ; vypu¨tˆn¡ polo‘ky 5 B z bufferu
080c:77                 ld      (hl),a      ; prvn¡ funkce
080d:3e c0              ld      a,0c0h
080f:28 02              jr      z,813h      ; nen¡ ‘ dn  funkce
0811:cb ef              set     5,a
0813:2b               * dec     hl
0814:77                 ld      (hl),a
0815:2b                 dec     hl
0816:36 00              ld      (hl),0
0818:e1                 pop     hl
0819:23                 inc     hl
081a:ed a0              ldi     
081c:7e                 ld      a,(hl)
081d:12                 ld      (de),a
081e:2a ec b3           ld      hl,(0b3ech)
0821:cb c6              set     0,(hl)
0823:cb de              set     3,(hl)
0825:06 86              ld      b,86h       ; instrukce zru¨en¡ funkce
0827:cd a6 0e           call    0ea6h       ; operace v mapˆ funkc¡
082a:21 01 b3           ld      hl,0b301h
082d:cb ce              set     1,(hl)
082f:c3 98 0d           jp      0d98h
; ......................................................
0832:21 00 00           ld      hl,0
0835:1a                 ld      a,(de)
0836:13                 inc     de
0837:d5                 push    de
0838:fd e1              pop     iy
083a:fe 01              cp      1
083c:ca a0 09           jp      z,9a0h
083f:fe 02              cp      2
0841:28 0b              jr      z,84eh
0843:fe 04              cp      4
0845:c2 e3 09           jp      nz,9e3h
0848:fd 6e 02           ld      l,(iy+2)
084b:fd 66 03           ld      h,(iy+3)
084e:22 e9 b4           ld      (0b4e9h),hl
0851:21 ba b4           ld      hl,0b4bah
0854:1a                 ld      a,(de)
0855:5e                 ld      e,(hl)
0856:23                 inc     hl
0857:56                 ld      d,(hl)
0858:92                 sub     d
0859:fa e3 09           jp      m,9e3h
085c:4f                 ld      c,a
085d:93                 sub     e
085e:f2 e3 09           jp      p,9e3h
0861:79                 ld      a,c
0862:cb 21              sla     c
0864:5f                 ld      e,a
0865:81                 add     a,c
0866:4f                 ld      c,a
0867:32 9e b7           ld      (0b79eh),a
086a:06 00              ld      b,0
086c:23                 inc     hl
086d:09                 add     hl,bc
086e:3e 83              ld      a,83h
0870:16 ff              ld      d,0ffh
0872:23                 inc     hl
0873:23                 inc     hl
0874:be                 cp      (hl)
0875:ca e3 09           jp      z,9e3h
0878:e6 03              and     3
087a:14                 inc     d
087b:be                 cp      (hl)
087c:28 05              jr      z,883h
087e:2b                 dec     hl
087f:2b                 dec     hl
0880:2b                 dec     hl
0881:18 f7              jr      87ah
; ......................................................
0883:fd 7e 00           ld      a,(iy+0)
0886:92                 sub     d
0887:47                 ld      b,a
0888:7b                 ld      a,e
0889:16 ff              ld      d,0ffh
088b:14                 inc     d
088c:cb 7e              bit     7,(hl)
088e:20 05              jr      nz,895h
0890:23                 inc     hl
0891:23                 inc     hl
0892:23                 inc     hl
0893:18 f6              jr      88bh
; ......................................................
0895:14                 inc     d
0896:fd 7e 01           ld      a,(iy+1)
0899:4f                 ld      c,a
089a:90                 sub     b
089b:fa e3 09           jp      m,9e3h
089e:92                 sub     d
089f:f2 e3 09           jp      p,9e3h
08a2:21 bb b4           ld      hl,0b4bbh
08a5:79                 ld      a,c
08a6:96                 sub     (hl)
08a7:4f                 ld      c,a
08a8:cb 21              sla     c
08aa:81                 add     a,c
08ab:4f                 ld      c,a
08ac:32 9f b7           ld      (0b79fh),a
08af:06 00              ld      b,0
08b1:23                 inc     hl
08b2:09                 add     hl,bc
08b3:7b                 ld      a,e
08b4:5e                 ld      e,(hl)
08b5:23                 inc     hl
08b6:56                 ld      d,(hl)
08b7:4f                 ld      c,a
08b8:cb 21              sla     c
08ba:81                 add     a,c
08bb:4f                 ld      c,a
08bc:06 00              ld      b,0
08be:21 bc b4           ld      hl,0b4bch
08c1:09                 add     hl,bc
08c2:4e                 ld      c,(hl)
08c3:23                 inc     hl
08c4:66                 ld      h,(hl)
08c5:69                 ld      l,c
08c6:cb 7e              bit     7,(hl)
08c8:c2 e3 09           jp      nz,9e3h
08cb:cb 5e              bit     3,(hl)
08cd:20 43              jr      nz,912h
08cf:cb 56              bit     2,(hl)
08d1:c2 94 09           jp      nz,994h
08d4:eb                 ex      de,hl
08d5:cb 56              bit     2,(hl)
08d7:c2 94 09           jp      nz,994h
08da:01 bc b4           ld      bc,0b4bch
08dd:21 9e b7           ld      hl,0b79eh
08e0:5e                 ld      e,(hl)
08e1:23                 inc     hl
08e2:6e                 ld      l,(hl)
08e3:26 00              ld      h,0
08e5:54                 ld      d,h
08e6:09                 add     hl,bc
08e7:eb                 ex      de,hl
08e8:09                 add     hl,bc
08e9:4e                 ld      c,(hl)
08ea:23                 inc     hl
08eb:46                 ld      b,(hl)
08ec:2b                 dec     hl
08ed:eb                 ex      de,hl
08ee:7e                 ld      a,(hl)
08ef:12                 ld      (de),a
08f0:23                 inc     hl
08f1:13                 inc     de
08f2:7e                 ld      a,(hl)
08f3:12                 ld      (de),a
08f4:70                 ld      (hl),b
08f5:2b                 dec     hl
08f6:71                 ld      (hl),c
08f7:eb                 ex      de,hl
08f8:56                 ld      d,(hl)
08f9:2b                 dec     hl
08fa:5e                 ld      e,(hl)
08fb:c5                 push    bc
08fc:e1                 pop     hl
08fd:23                 inc     hl
08fe:7e                 ld      a,(hl)
08ff:2b                 dec     hl
0900:e6 06              and     6
0902:20 0b              jr      nz,90fh
0904:01 08 00           ld      bc,8
0907:09                 add     hl,bc
0908:eb                 ex      de,hl
0909:09                 add     hl,bc
090a:1a                 ld      a,(de)
090b:46                 ld      b,(hl)
090c:77                 ld      (hl),a
090d:78                 ld      a,b
090e:12                 ld      (de),a
090f:c3 98 0d           jp      0d98h
; ......................................................
0912:23                 inc     hl
0913:cb 76              bit     6,(hl)
0915:2b                 dec     hl
0916:c2 e3 09           jp      nz,9e3h
0919:eb                 ex      de,hl
091a:cb 56              bit     2,(hl)
091c:c2 88 09           jp      nz,988h
091f:cb 4e              bit     1,(hl)
0921:fd e5              push    iy
0923:d5                 push    de
0924:e5                 push    hl
0925:28 21              jr      z,948h
0927:3a bb b4           ld      a,(0b4bbh)
092a:4f                 ld      c,a
092b:fd 7e 00           ld      a,(iy+0)
092e:91                 sub     c
092f:4f                 ld      c,a
0930:06 00              ld      b,0
0932:21 d7 b4           ld      hl,0b4d7h
0935:09                 add     hl,bc
0936:fd 7e 01           ld      a,(iy+1)
0939:be                 cp      (hl)
093a:c2 77 09           jp      nz,977h
093d:36 00              ld      (hl),0
093f:2a e9 b4           ld      hl,(0b4e9h)
0942:7d                 ld      a,l
0943:b4                 or      h
0944:28 02              jr      z,948h
0946:36 12              ld      (hl),12h
0948:cd dd 04           call    4ddh
094b:dd e1              pop     ix
094d:fd e5              push    iy
094f:d5                 push    de
0950:af                 xor     a
0951:21 ad b4           ld      hl,0b4adh
0954:cb ee              set     5,(hl)
0956:e1                 pop     hl
0957:fd e1              pop     iy
0959:01 0c 00           ld      bc,0ch
095c:ed 42              sbc     hl,bc
095e:e5                 push    hl
095f:cb 46              bit     0,(hl)
0961:dd e1              pop     ix
0963:23                 inc     hl
0964:23                 inc     hl
0965:5e                 ld      e,(hl)
0966:23                 inc     hl
0967:56                 ld      d,(hl)
0968:28 02              jr      z,96ch
096a:eb                 ex      de,hl
096b:e9                 jp      (hl)
; ......................................................
096c:d5                 push    de
096d:23                 inc     hl
096e:7e                 ld      a,(hl)
096f:23                 inc     hl
0970:66                 ld      h,(hl)
0971:6f                 ld      l,a
0972:dd cb 00 c6        set     0,(ix+0)
0976:e9                 jp      (hl)
; ......................................................
0977:77                 ld      (hl),a
0978:c1                 pop     bc
0979:d1                 pop     de
097a:e1                 pop     hl
097b:2a e9 b4           ld      hl,(0b4e9h)
097e:7d                 ld      a,l
097f:b4                 or      h
0980:ca 98 0d           jp      z,0d98h
0983:36 11              ld      (hl),11h
0985:c3 98 0d           jp      0d98h
; ......................................................
0988:2a e9 b4           ld      hl,(0b4e9h)
098b:7d                 ld      a,l
098c:b4                 or      h
098d:28 02              jr      z,991h
098f:36 20              ld      (hl),20h
0991:c3 98 0d           jp      0d98h
; ......................................................
0994:2a e9 b4           ld      hl,(0b4e9h)
0997:7d                 ld      a,l
0998:b4                 or      h
0999:28 02              jr      z,99dh
099b:36 20              ld      (hl),20h
099d:c3 98 0d           jp      0d98h
; ......................................................
09a0:21 ba b4           ld      hl,0b4bah
09a3:1a                 ld      a,(de)
09a4:f5                 push    af
09a5:5e                 ld      e,(hl)
09a6:23                 inc     hl
09a7:56                 ld      d,(hl)
09a8:92                 sub     d
09a9:fa e0 09           jp      m,9e0h
09ac:4f                 ld      c,a
09ad:93                 sub     e
09ae:f2 e0 09           jp      p,9e0h
09b1:79                 ld      a,c
09b2:32 9e b7           ld      (0b79eh),a
09b5:cb 21              sla     c
09b7:81                 add     a,c
09b8:4f                 ld      c,a
09b9:06 00              ld      b,0
09bb:21 bc b4           ld      hl,0b4bch
09be:09                 add     hl,bc
09bf:eb                 ex      de,hl
09c0:21 09 0c           ld      hl,0c09h
09c3:09                 add     hl,bc
09c4:7e                 ld      a,(hl)
09c5:23                 inc     hl
09c6:66                 ld      h,(hl)
09c7:6f                 ld      l,a
09c8:cb 5e              bit     3,(hl)
09ca:ca e0 09           jp      z,9e0h
09cd:7e                 ld      a,(hl)
09ce:e6 02              and     2
09d0:77                 ld      (hl),a
09d1:eb                 ex      de,hl
09d2:73                 ld      (hl),e
09d3:23                 inc     hl
09d4:72                 ld      (hl),d
09d5:3a 9e b7           ld      a,(0b79eh)
09d8:21 08 00           ld      hl,8
09db:19                 add     hl,de
09dc:77                 ld      (hl),a
09dd:c3 98 0d           jp      0d98h
; ......................................................
09e0:f1                 pop     af
09e1:18 09              jr      9ech
; ......................................................
09e3:2a e9 b4           ld      hl,(0b4e9h)
09e6:7d                 ld      a,l
09e7:b4                 or      h
09e8:28 02              jr      z,9ech
09ea:36 10              ld      (hl),10h
09ec:c3 98 0d           jp      0d98h
; ......................................................
                                            ; tabulka adres operac¡ (0d88h)
09ef:                   dw      070dh       ; funkce 00
09f1:                   dw      067fh       ; funkce 01 (vypnut¡ funkce)
09f3:                   dw      0dabh       ; funkce 02 (n vrat z funkce)
09f5:                   dw      07fah       ; funkce 03 (zru¨en¡ funkce)
09f7:                   dw      0dabh       ; funkce 04 (n vrat z funkce)
09f9:                   dw      06aah       ; funkce 05 (vypnut¡)
09fb:                   dw      069ch       ; funkce 06
09fd:                   dw      0dabh       ; funkce 07 (n vrat z funkce)
09ff:                   dw      0200h       ; funkce 08
0a01:                   dw      0832h       ; funkce 09
0a03:                   dw      0dabh       ; funkce 10 (n vrat z funkce)
0a05:                   dw      0dabh       ; funkce 11 (n vrat z funkce)
0a07:                   dw      06ebh       ; funkce 12
0a09:                   dw      0dabh       ; funkce 13 (n vrat z funkce)
0a0b:                   dw      0dabh       ; funkce 14 (n vrat z funkce)
0a0d:                   dw      0dabh       ; funkce 15 (n vrat z funkce)
0a0f:                   dw      0dabh       ; funkce 16 (n vrat z funkce)
0a11:                   dw      0dabh       ; funkce 17 (n vrat z funkce)
0a13:                   dw      0dabh       ; funkce 18 (n vrat z funkce)

                                            ; obsluha p©eru¨en¡ ‡asova‡em CTC-0/ZRE
                                            ; perioda 20 ms
0a15:cd bf 0c           call    0cbfh       ; £schova registr–
0a18:0e 01              ld      c,1         
0a1a:21 29 b4           ld      hl,0b429h   ; ‡¡ta‡e ‡asu
0a1d:34                 inc     (hl)        ; ‡¡ta‡ milisekund
0a1e:3e 32              ld      a,32h       ; = 50
0a20:be                 cp      (hl)        ; dosa‘eno stavu 50
0a21:c2 45 0a           jp      nz,0a45h    
0a24:36 00              ld      (hl),0      
0a26:0c                 inc     c           
0a27:23                 inc     hl          
0a28:34                 inc     (hl)        ; zv˜¨en¡ ‡¡ta‡e sekund
0a29:3e 3c              ld      a,3ch       ; = 60
0a2b:be                 cp      (hl)        
0a2c:c2 45 0a           jp      nz,0a45h    
0a2f:36 00              ld      (hl),0      ; ‡¡ta‡ sekund = 0
0a31:0c                 inc     c           
0a32:23                 inc     hl          ; minuty
0a33:34                 inc     (hl)        ; zv˜¨en¡ ‡¡ta‡e minut
0a34:be                 cp      (hl)        ; = 60
0a35:c2 45 0a           jp      nz,0a45h    
0a38:36 00              ld      (hl),0      ; minuty = 60
0a3a:0c                 inc     c           
0a3b:23                 inc     hl          ; hodiny
0a3c:34                 inc     (hl)        ; zv˜¨en¡ ‡¡ta‡e hodin
0a3d:3e 18              ld      a,18h       ; = 24
0a3f:be                 cp      (hl)        ; hodiny
0a40:c2 45 0a           jp      nz,0a45h    
0a43:36 00              ld      (hl),0      ; hodiny = 0
0a45:21 32 b4           ld      hl,0b432h   
0a48:34                 inc     (hl)        ; zv˜¨en¡ ‡¡ta‡e milisekund
0a49:06 00              ld      b,0         
0a4b:09                 add     hl,bc       
0a4c:34                 inc     (hl)        
0a4d:c3 ef 0c           jp      0cefh       ; n vrat z p©eru¨en¡
; ......................................................
0a50:fb                 ei      
0a51:af                 xor     a
0a52:47                 ld      b,a
0a53:21 32 b4           ld      hl,0b432h   ; inkrementace milisekund
0a56:be                 cp      (hl)        
0a57:f3                 di                  
0a58:c8                 ret     z           ; nebyla zmˆna milisekund
0a59:f3                 di                  
0a5a:35                 dec     (hl)        ; n vrat zmˆny milisekund
0a5b:04                 inc     b           
0a5c:23                 inc     hl          
0a5d:be                 cp      (hl)        
0a5e:28 fb              jr      z,0a5bh     ; nalezen¡ nenulov‚ polo‘ky
0a60:35                 dec     (hl)        
0a61:21 2c b4           ld      hl,0b42ch   ; ‡¡ta‡ hodin
0a64:af                 xor     a
0a65:23                 inc     hl
0a66:86                 add     a,(hl)
0a67:10 fc              djnz    0a65h
0a69:ca 50 0a           jp      z,0a50h
0a6c:47                 ld      b,a
0a6d:04                 inc     b
0a6e:4f                 ld      c,a
0a6f:21 33 b4           ld      hl,0b433h
0a72:11 04 00           ld      de,4
0a75:05                 dec     b
0a76:28 78              jr      z,0af0h
0a78:19                 add     hl,de
0a79:35                 dec     (hl)
0a7a:7e                 ld      a,(hl)
0a7b:23                 inc     hl
0a7c:28 0a              jr      z,0a88h
0a7e:3c                 inc     a
0a7f:20 f4              jr      nz,0a75h
0a81:3d                 dec     a
0a82:be                 cp      (hl)
0a83:28 f0              jr      z,0a75h
0a85:35                 dec     (hl)
0a86:18 ed              jr      0a75h
; ......................................................
0a88:be                 cp      (hl)
0a89:20 ea              jr      nz,0a75h
0a8b:54                 ld      d,h
0a8c:5d                 ld      e,l
0a8d:23                 inc     hl
0a8e:b6                 or      (hl)
0a8f:23                 inc     hl
0a90:1f                 rra     
0a91:20 01              jr      nz,0a94h
0a93:b6                 or      (hl)
0a94:23                 inc     hl
0a95:08                 ex      af,af'
0a96:7e                 ld      a,(hl)
0a97:08                 ex      af,af'
0a98:d9                 exx     
0a99:06 c6              ld      b,0c6h
0a9b:11 00 41           ld      de,4100h
0a9e:28 0d              jr      z,0aadh
0aa0:17                 rla     
0aa1:3f                 ccf     
0aa2:38 0a              jr      c,0aaeh
0aa4:17                 rla     
0aa5:30 07              jr      nc,0aaeh
0aa7:11 08 00           ld      de,8
0aaa:b7                 or      a
0aab:20 01              jr      nz,0aaeh
0aad:13                 inc     de
0aae:08                 ex      af,af'
0aaf:cd ec 0e           call    0eech
0ab2:38 07              jr      c,0abbh
0ab4:21 03 b4           ld      hl,0b403h
0ab7:be                 cp      (hl)
0ab8:30 01              jr      nc,0abbh
0aba:77                 ld      (hl),a
0abb:08                 ex      af,af'
0abc:d9                 exx     
0abd:38 26              jr      c,0ae5h
0abf:08                 ex      af,af'
0ac0:cd 0a 0b           call    0b0ah
0ac3:0d                 dec     c
0ac4:08                 ex      af,af'
0ac5:28 16              jr      z,0addh
0ac7:d9                 exx     
0ac8:08                 ex      af,af'
0ac9:cd fc 0a           call    0afch
0acc:2b                 dec     hl
0acd:54                 ld      d,h
0ace:5d                 ld      e,l
0acf:1b                 dec     de
0ad0:1b                 dec     de
0ad1:ed a8              ldd     
0ad3:d9                 exx     
0ad4:78                 ld      a,b
0ad5:d9                 exx     
0ad6:90                 sub     b
0ad7:7e                 ld      a,(hl)
0ad8:20 01              jr      nz,0adbh
0ada:3c                 inc     a
0adb:12                 ld      (de),a
0adc:d9                 exx     
0add:11 04 00           ld      de,4
0ae0:b7                 or      a
0ae1:ed 52              sbc     hl,de
0ae3:18 90              jr      0a75h
; ......................................................
0ae5:2b                 dec     hl
0ae6:ed a8              ldd     
0ae8:7e                 ld      a,(hl)
0ae9:12                 ld      (de),a
0aea:0c                 inc     c
0aeb:eb                 ex      de,hl
0aec:23                 inc     hl
0aed:c3 72 0a           jp      0a72h
; ......................................................
0af0:21 03 b4           ld      hl,0b403h
0af3:7e                 ld      a,(hl)
0af4:36 ff              ld      (hl),0ffh
0af6:cd 15 0f           call    0f15h
0af9:c3 50 0a           jp      0a50h
; ......................................................
0afc:21 31 b4           ld      hl,0b431h
0aff:46                 ld      b,(hl)
0b00:11 05 00           ld      de,5
0b03:19                 add     hl,de
0b04:19                 add     hl,de
0b05:be                 cp      (hl)
0b06:c8                 ret     z
0b07:10 fb              djnz    0b04h
0b09:c9                 ret     
; ......................................................
0b0a:c5                 push    bc
0b0b:eb                 ex      de,hl
0b0c:21 31 b4           ld      hl,0b431h
0b0f:79                 ld      a,c
0b10:96                 sub     (hl)
0b11:35                 dec     (hl)
0b12:ed 44              neg     
0b14:80                 add     a,b
0b15:3d                 dec     a
0b16:4f                 ld      c,a
0b17:2b                 dec     hl
0b18:96                 sub     (hl)
0b19:30 fc              jr      nc,0b17h
0b1b:35                 dec     (hl)
0b1c:79                 ld      a,c
0b1d:87                 add     a,a
0b1e:87                 add     a,a
0b1f:81                 add     a,c
0b20:4f                 ld      c,a
0b21:20 02              jr      nz,0b25h
0b23:0e 05              ld      c,5
0b25:06 00              ld      b,0
0b27:21 fc ff           ld      hl,0fffch
0b2a:19                 add     hl,de
0b2b:1a                 ld      a,(de)
0b2c:e5                 push    hl
0b2d:eb                 ex      de,hl
0b2e:23                 inc     hl
0b2f:ed b0              ldir    
0b31:e1                 pop     hl
0b32:c1                 pop     bc
0b33:c9                 ret     
; ......................................................
                                            ; pokra‡ov n¡ v inicializaci syst‚mu
                                            ; z adresy 00d7h
                                            ; vytvo©en¡ str nky obrazvoky
0b34:06 0c              ld      b,0ch       ; po‡et = 12
0b36:21 66 07           ld      hl,766h     
0b39:36 e7              ld      (hl),0e7h   ; instrukce RST 20h
0b3b:23                 inc     hl          
0b3c:36 00              ld      (hl),0      ; instrukce NOP
0b3e:23                 inc     hl          
0b3f:10 f8              djnz    0b39h       ; adresy 0766h a‘ 077dh
                                            ; buffer obrazovky ABS
0b41:01 ff 03           ld      bc,3ffh     ; d‚lka bufferu - 1
0b44:21 00 c0           ld      hl,0c000h   ; buffer obrazovky ABS
0b47:36 20              ld      (hl),20h    ; mazac¡ znak (mezera)
0b49:11 01 c0           ld      de,0c001h   
0b4c:ed b0              ldir                ; vymaz n¡ bufferu obrazovky
0b4e:21 00 c0           ld      hl,0c000h   ; prvn¡ © dek
0b51:3e 3d              ld      a,3dh       ; "="
0b53:cd 8b 0b           call    0b8bh       ; £vodn¡ © dek (znaky =)
0b56:21 94 0b           ld      hl,0b94h    ; text "A 6422 ..."
0b59:11 15 c0           ld      de,0c015h   ; p©enos licen‡n¡ch informac¡
0b5c:0e 16              ld      c,16h       ; po‡et znak– k p©enosu 22
0b5e:ed b0              ldir                
0b60:11 40 00           ld      de,40h      ; d‚lka © dku obrazovky=64
0b63:21 40 c0           ld      hl,0c040h   ; 2. © dek obrazovky
0b66:22 78 b4           ld      (0b478h),hl ; 2. © dek v bufferu ABS
0b69:22 7a b4           ld      (0b47ah),hl ; aktu ln¡ pozice v bufferu ABS
0b6c:06 04              ld      b,4         
0b6e:19                 add     hl,de       
0b6f:10 fd              djnz    0b6eh       ; 6. © dek v bufferu ABS
0b71:3e 2d              ld      a,2dh       ; znak "-"
0b73:cd 8b 0b           call    0b8bh       ; z pis © dku znak– "-"
0b76:19                 add     hl,de       
0b77:19                 add     hl,de       ; 8. © dek v bufferu ABS
0b78:3e 3d              ld      a,3dh       ; znak "="
0b7a:cd 8b 0b           call    0b8bh       ; z pis © dku znak– "="
0b7d:11 aa 0b           ld      de,0baah    ; informace "PROT:"
0b80:0e 17              ld      c,17h       
0b82:09                 add     hl,bc       ; adresa textu
0b83:eb                 ex      de,hl       
0b84:0e 13              ld      c,13h       ; po‡et znak– textu
0b86:ed b0              ldir                ; p©enos textu PROT:
0b88:c3 ad 0d           jp      0dadh       ; pokra‡ov n¡ inicializace

                                            ; z pis © dku znak– do bufferu
0b8b:e5                 push    hl          
0b8c:06 40              ld      b,40h       ; d‚lka © dku = 64 znak–
0b8e:77                 ld      (hl),a
0b8f:23                 inc     hl
0b90:10 fc              djnz    0b8eh
0b92:e1                 pop     hl
0b93:c9                 ret     

0b94:                   db   " A 6422 DIMITROFFGRAD
0baa:                   db   "PROT:5421H:C3 C6 55"
; ......................................................

0bbd:c5                 push    bc
0bbe:d5                 push    de
0bbf:3a 7c b4           ld      a,(0b47ch)
0bc2:b7                 or      a
0bc3:28 29              jr      z,0beeh
0bc5:fe 04              cp      4
0bc7:11 40 00           ld      de,40h
0bca:20 14              jr      nz,0be0h
0bcc:47                 ld      b,a
0bcd:21 00 00           ld      hl,0
0bd0:05                 dec     b
0bd1:19                 add     hl,de
0bd2:10 fd              djnz    0bd1h
0bd4:44                 ld      b,h
0bd5:4d                 ld      c,l
0bd6:2a 78 b4           ld      hl,(0b478h)
0bd9:eb                 ex      de,hl
0bda:19                 add     hl,de
0bdb:ed b0              ldir    
0bdd:eb                 ex      de,hl
0bde:18 08              jr      0be8h
; ......................................................
0be0:3c                 inc     a
0be1:32 7c b4           ld      (0b47ch),a
0be4:2a 7a b4           ld      hl,(0b47ah)
0be7:19                 add     hl,de
0be8:22 7a b4           ld      (0b47ah),hl
0beb:d1                 pop     de
0bec:c1                 pop     bc
0bed:c9                 ret     
; ......................................................
0bee:2a 78 b4           ld      hl,(0b478h)
0bf1:3c                 inc     a
0bf2:32 7c b4           ld      (0b47ch),a
0bf5:18 f1              jr      0be8h
; ......................................................
0bf7:c9                 ret     
; ......................................................
0bf8:                   db      0,0,0,0,0,0,0,0
0c00:                   db      0,0,0,0
0c04:                   db      0,0,0,0,0

0c09:                   db      0,0,83h
0c0c:                   db      0,0,83h
0c0f:                   db      0fbh,1eh,83h
0c12:                   db      12h,20h,83h
0c15:                   db      0,0,83h
0c18:                   db      0ebh,0b4h,83h
0c1b:                   db      0dh,0b5h,83h
0c1e:                   db      30h,0b5h,3
0c21:                   db      3dh,0b5h,86h

0c24:                   db      70h,8ah,0c8h
0c27:                   db      0f7h,0bh,0f8h
0c2a:                   db      0b4h,0,0b1h
0c2d:                   db      0b4h,0e0h,0
0c30:                   db      0,0

0c32:                   db      12h
0c33:                   db      51h,0cbh,7eh
0c36:                   db      0cch,1ah,0b5h
0c39:                   db      0,0b4h,0b4h

0c3c:                   db      55h,71h,0fh,36h
0c40:                   db      1ah,4ah,0b5h,0
0c44:                   db      55h,71h,0fh,36h
0c48:                   db      1ah,4ah,0b5h,1
0c4c:                   db      0b7h,0b4h,8,0
0c50:                   db      0c2h,0ffh,0c3h

                                            ; inicializace tabulek
0c53:21 09 0c           ld      hl,0c09h    ; tabulka
0c56:11 bc b4           ld      de,0b4bch   
0c59:01 2f 00           ld      bc,2fh      ; d‚lka 47B
0c5c:ed b0              ldir                ; p©enos 0c09h a‘ 0c38h
0c5e:3e 09              ld      a,9         
0c60:32 ba b4           ld      (0b4bah),a  
0c63:3e 11              ld      a,11h       
0c65:32 bb b4           ld      (0b4bbh),a  
0c68:3e 01              ld      a,1         ; ‡¡ta‡ pr–chod–
0c6a:21 24 0c           ld      hl,0c24h    
0c6d:11 ec b4           ld      de,0b4ech   
0c70:01 08 00           ld      bc,8        ; p©enos 0c24h a‘ 0c2bh
0c73:ed b0              ldir                
0c75:eb                 ex      de,hl       
0c76:0e 0f              ld      c,0fh       
0c78:09                 add     hl,bc       ; 0b4f4h + 000fh = 0b503h
0c79:eb                 ex      de,hl       
0c7a:0e 06              ld      c,6         
0c7c:ed b0              ldir                ; p©enos 0c2ch a‘ 0c31h
0c7e:eb                 ex      de,hl       
0c7f:0e 05              ld      c,5         
0c81:09                 add     hl,bc       ; 0b509h + 5 = 0b50eh
0c82:eb                 ex      de,hl       
0c83:3d                 dec     a           
0c84:20 ea              jr      nz,0c70h    
0c86:3e 01              ld      a,1         
0c88:21 32 0c           ld      hl,0c32h    
0c8b:11 0e b5           ld      de,0b50eh   
0c8e:01 08 00           ld      bc,8        
0c91:ed b0              ldir                ; p©enos 0c32h a‘ 0c39h
0c93:0e 05              ld      c,5         
0c95:eb                 ex      de,hl       
0c96:09                 add     hl,bc       ; 0b516h + 5 = 0b51bh
0c97:eb                 ex      de,hl       
0c98:3d                 dec     a           
0c99:20 f3              jr      nz,0c8eh    
0c9b:11 25 b5           ld      de,0b525h   ; p©enos 0c3ah a‘ 0c3bh
0c9e:0e 02              ld      c,2         
0ca0:ed b0              ldir                
0ca2:3e 02              ld      a,2         
0ca4:21 3c 0c           ld      hl,0c3ch    ; 0c3ch
0ca7:11 31 b5           ld      de,0b531h   ; 0b531h
0caa:01 08 00           ld      bc,8        
0cad:ed b0              ldir                ; p©enos 0c3ch a‘ 0c43h
0caf:0e 05              ld      c,5         
0cb1:eb                 ex      de,hl       
0cb2:09                 add     hl,bc       ; 0b539h + 5 = 0b53eh
0cb3:eb                 ex      de,hl       
0cb4:3d                 dec     a           
0cb5:20 f3              jr      nz,0caah    ; p©enos 0c44h a‘ 0c4bh
0cb7:11 55 b5           ld      de,0b555h   
0cba:0e 02              ld      c,2         
0cbc:ed b0              ldir                ; p©enos 0c4ch a‘ 0c4dh
0cbe:c9                 ret                 
; ......................................................
                                            ; £schova registr–
0cbf:08                 ex      af,af'      ; £schova registru A
0cc0:3a 00 b3           ld      a,(0b300h)  ; 01=ochrana z sobn¡ku p©i p©eru¨en¡
0cc3:0f                 rrca                
0cc4:38 24              jr      c,0ceah     ; je ochrana z sobn¡ku
0cc6:08                 ex      af,af'      ; n vrat registru A
0cc7:e3                 ex      (sp),hl     ; stack<-HL, HL<-n vrat.adresa
0cc8:f5                 push    af          ; £schova AF
0cc9:d5                 push    de          ; £schova DE
0cca:c5                 push    bc          ; £schova BC
0ccb:dd e5              push    ix          ; £schova IX
0ccd:fd e5              push    iy          ; £schova IY
0ccf:d9                 exx                 ; £schova n vratov‚ adresy HL
0cd0:21 29 0d           ld      hl,0d29h    ; adresa n vratu z podprogramu
0cd3:e5                 push    hl          
0cd4:af                 xor     a           
0cd5:21 02 b3           ld      hl,0b302h   
0cd8:be                 cp      (hl)        
0cd9:20 0c              jr      nz,0ce7h    
0cdb:34                 inc     (hl)        
0cdc:ed 73 03 b3        ld      (0b303h),sp 
0ce0:31 e5 b3           ld      sp,0b3e5h   ; vlastn¡ z sobn¡k
0ce3:21 f9 0c           ld      hl,0cf9h    
0ce6:e5                 push    hl          
0ce7:d9                 exx                 
0ce8:e9                 jp      (hl)        
; ......................................................
0ce9:                   db   0e1h
0cea:af                 xor     a           ; zru¨en¡ ochrany z sobn¡ku
0ceb:32 00 b3           ld      (0b300h),a  ; 01=ochrana z sobn¡ku p©i p©eru¨en¡
0cee:c9                 ret                 
; ...........................................
                                            ; n vrat z p©eru¨en¡
0cef:f3                 di                  
0cf0:21 00 b3           ld      hl,0b300h   ; nastaven¡ ochrany z sobn¡ku
0cf3:36 01              ld      (hl),1      
0cf5:fb                 ei                  
0cf6:00                 nop                 
0cf7:ed 4d              reti                ; n vrat z p©eru¨en¡
; ...........................................
                                            ; n vrat z podprogramu 2
0cf9:f3                 di
0cfa:36 00              ld      (hl),0
0cfc:cd 50 0a           call    0a50h
0cff:21 01 b3           ld      hl,0b301h
0d02:7e               * ld      a,(hl)
0d03:0f                 rrca    
0d04:38 0a              jr      c,0d10h
0d06:0f                 rrca    
0d07:38 0c              jr      c,0d15h
0d09:23                 inc     hl
0d0a:77                 ld      (hl),a
0d0b:ed 7b 03 b3        ld      sp,(0b303h)
0d0f:c9                 ret     
; ......................................................
0d10:af                 xor     a
0d11:77                 ld      (hl),a
0d12:c3 ad 0d           jp      0dadh
; ......................................................
0d15:af                 xor     a
0d16:77                 ld      (hl),a
0d17:2a ec b3           ld      hl,(0b3ech)
0d1a:cb fe              set     7,(hl)
0d1c:2a 05 b3           ld      hl,(0b305h)
0d1f:ed 5b 03 b3        ld      de,(0b303h)
0d23:73                 ld      (hl),e
0d24:23                 inc     hl
0d25:72                 ld      (hl),d
0d26:c3 ad 0d           jp      0dadh
; ......................................................
                                            ; n vrat z podprogramu
0d29:f3                 di                  
0d2a:af                 xor     a           ; zru¨en¡ ochrany z sobn¡ku
0d2b:32 00 b3           ld      (0b300h),a  ; 01=ochrana z sobn¡ku p©i p©eru¨en¡
0d2e:fd e1            * pop     iy          ; n vrat v¨ech registr–
0d30:dd e1              pop     ix          
0d32:c1                 pop     bc          
0d33:d1                 pop     de          
0d34:f1                 pop     af          
0d35:e1                 pop     hl          
0d36:fb               * ei
0d37:c9                 ret                 ; n vrat z podprogramu
; ......................................................
                                            ; FUNKCE RST 8
0d38:21 02 00           ld      hl,2        ; offset n vratov‚ adresy
0d3b:18 0f              jr      0d4ch
                                            ; FUNKCE RST 10h, RST 18h
0d3d:e5                 push    hl
0d3e:f5                 push    af
0d3f:d5                 push    de
0d40:c5                 push    bc
0d41:dd e5              push    ix
0d43:fd e5              push    iy
0d45:21 2e 0d           ld      hl,0d2eh    ; adresa pro ukon‡en¡ podprogramu
0d48:e5                 push    hl
0d49:21 0e 00           ld      hl,0eh      ; offset n vratov‚ adresy
0d4c:39               * add     hl,sp       ; n vratov  adresa
0d4d:44                 ld      b,h
0d4e:4d                 ld      c,l         ; adresa n vratov‚ adresy
0d4f:5e                 ld      e,(hl)
0d50:23                 inc     hl
0d51:56                 ld      d,(hl)      ; n vratov  adresa
0d52:dd 21 ff ff        ld      ix,0ffffh
0d56:dd 19              add     ix,de       ; n vratov  adresa - 1 (instrukce)
0d58:eb                 ex      de,hl
0d59:7e                 ld      a,(hl)      ; prvn¡ bajt za instrukc¡
0d5a:23                 inc     hl
0d5b:cb 27              sla     a           ; A * 2
0d5d:38 0d              jr      c,0d6ch     ; bit 7 = 1
0d5f:08                 ex      af,af'
0d60:5d                 ld      e,l
0d61:54                 ld      d,h         ; adresa 2. bajtu za instrukc¡
0d62:7e                 ld      a,(hl)      ; druh˜ bajt za instrukc¡ (d‚lka)
0d63:e6 0f              and     0fh
0d65:3c                 inc     a
0d66:6f                 ld      l,a
0d67:26 00              ld      h,0
0d69:19                 add     hl,de       ; zv˜¨en¡ adresy o offset
0d6a:18 05              jr      0d71h
; ......................................................
0d6c:08               * ex      af,af'
0d6d:5e                 ld      e,(hl)      ; 2. a 3. bajt za instrukc¡
0d6e:23                 inc     hl
0d6f:56                 ld      d,(hl)
0d70:23                 inc     hl
0d71:7d               * ld      a,l
0d72:02                 ld      (bc),a      ; zmˆna n vratov‚ adresy (p©esko‡¡
                                            ; se 3 bajty za instrukc¡)
0d73:03                 inc     bc
0d74:7c                 ld      a,h
0d75:02                 ld      (bc),a
0d76:af                 xor     a
0d77:47                 ld      b,a
0d78:21 02 b3           ld      hl,0b302h
0d7b:be                 cp      (hl)        ; = 0 ?
0d7c:20 07              jr      nz,0d85h
0d7e:ed 73 03 b3        ld      (0b303h),sp
0d82:31 e5 b3           ld      sp,0b3e5h
0d85:34               * inc     (hl)        ; ukazatel £schov z sobn¡ku
0d86:08                 ex      af,af'
0d87:4f                 ld      c,a         ; ‡¡slo funkce
0d88:21 ef 09           ld      hl,9efh
0d8b:09                 add     hl,bc
0d8c:7e                 ld      a,(hl)
0d8d:23                 inc     hl
0d8e:66                 ld      h,(hl)      ; adresa funkce
0d8f:6f                 ld      l,a
0d90:cb 39              srl     c           ; ‡¡slo funkce
0d92:3e 12              ld      a,12h       ; po‡et funkc¡
0d94:b9                 cp      c
0d95:38 01              jr      c,0d98h     ; chr nˆn  funkce
0d97:e9                 jp      (hl)        ; skok do funkce
; ......................................................
                                            ; funkce 02 - n vrat z funkce
0d98:21 00 b3           ld      hl,0b300h   ; 01=ochrana z sobn¡ku p©i p©eru¨en¡
0d9b:36 01              ld      (hl),1      ; nastaven¡ ochrany z sobn¡ku
0d9d:fb                 ei      
0d9e:00                 nop     
0d9f:f3                 di      
0da0:36 00              ld      (hl),0      ; zru¨en¡ ochrany z sobn¡ku
0da2:23                 inc     hl
0da3:23                 inc     hl
0da4:35                 dec     (hl)
0da5:c0                 ret     nz
0da6:34                 inc     (hl)
0da7:2b                 dec     hl
0da8:c3 02 0d           jp      0d02h
; ......................................................
                                            ; funkce 02,04
0dab:18 eb              jr      0d98h
; ......................................................
                                            ; pokra‡ov n¡ v inicializaci
0dad:3a eb b3           ld      a,(0b3ebh)  ; ‡¡slo bitu v bitov‚ mapˆ
0db0:b7                 or      a           ; = 0
0db1:20 05              jr      nz,0db8h    ; je ulo‘eno ‡¡slo bitu
0db3:3a ea b3           ld      a,(0b3eah)  ; = 1 ‡¡slo bitu v mapˆ
0db6:18 0d              jr      0dc5h       ; vytvo©en¡ bitov‚ mapy
; ......................................................
0db8:06 46              ld      b,46h       ; instrukce testu bitu v mapˆ
0dba:cd a9 0e           call    0ea9h       ; operace v bitov‚ mapˆ
0dbd:21 eb b3           ld      hl,0b3ebh   
0dc0:4f                 ld      c,a         
0dc1:36 00              ld      (hl),0      ; nen¡ aktu ln¡ bit
0dc3:20 69              jr      nz,0e2eh    ; pokra‡ov n¡ v inicializaci
                                            ; nalezen¡ dal¨¡ho nastaven‚ho bitu
0dc5:21 ea b3           ld      hl,0b3eah   ; ‡¡slo bitu v mapˆ
0dc8:36 ff              ld      (hl),0ffh   ; posledn¡ bit
0dca:3d                 dec     a           ; ‡¡slo bitu v mapˆ
0dcb:e6 f8              and     0f8h        ; 0
0dcd:57                 ld      d,a         
0dce:0f                 rrca                
0dcf:0f                 rrca                
0dd0:0f                 rrca                ; offset bajtu v bitov‚ mapˆ
0dd1:4f                 ld      c,a         ; offset bajtu
0dd2:06 00              ld      b,0         
0dd4:21 ee b3           ld      hl,0b3eeh   ; za‡ tek bitov‚ mapy
0dd7:09                 add     hl,bc       ; adresa bajtu v bitov‚ mapˆ
0dd8:3e 12              ld      a,12h       ; posledn¡ bit v mapˆ = 18
0dda:3d                 dec     a           
0ddb:0f                 rrca                
0ddc:0f                 rrca                
0ddd:0f                 rrca                
0dde:e6 1f              and     1fh         ; offset posledn¡ho bajtu v mapˆ
0de0:3c                 inc     a           
0de1:91                 sub     c           ; po‡et bajt– do konce + 1
0de2:4a                 ld      c,d         ; vy¨¨¡ © d ‡¡sla bitu
0de3:47                 ld      b,a         ; po‡et bajt– do konce + 1
0de4:11 01 b3           ld      de,0b301h   
0de7:1a                 ld      a,(de)      ; = 0 maska pro bit. mapu
0de8:b7                 or      a           
0de9:20 23              jr      nz,0e0eh    
0deb:86                 add     a,(hl)      ; bajt v bitov‚ mapˆ
0dec:20 37              jr      nz,0e25h    ; nalezen¡ prvn¡ho nenul. bitu
0dee:23                 inc     hl          ; dal¨¡ bajt
0def:3e 08              ld      a,8         ; zv˜¨en¡ ‡¡sla bitu
0df1:81                 add     a,c         
0df2:4f                 ld      c,a         ; ‡¡slo bitu
0df3:fb                 ei                  
0df4:00                 nop                 
0df5:f3                 di                  
0df6:10 ef              djnz    0de7h       ; dal¨¡ bajt v mapˆ
0df8:21 00 b3           ld      hl,0b300h   ; 01=ochrana z sobn¡ku p©i p©eru¨en¡
0dfb:34                 inc     (hl)        ; nastaven¡ ochrany z sobn¡ku
0dfc:fb                 ei                  
0dfd:76                 halt                ; ‡ek n¡ na p©eru¨en¡ hodinami
0dfe:f3                 di                  
0dff:36 00              ld      (hl),0      ; zru¨en¡ ochrany z sobn¡ku
0e01:cd 50 0a           call    0a50h       ; obsluha hodin
0e04:21 01 b3           ld      hl,0b301h
0e07:af                 xor     a
0e08:be                 cp      (hl)
0e09:28 ed              jr      z,0df8h
0e0b:77                 ld      (hl),a
0e0c:18 9f              jr      0dadh
; ......................................................
0e0e:cb 4f              bit     1,a         ; = 0
0e10:3e 00              ld      a,0         
0e12:32 01 b3           ld      (0b301h),a  ; zru¨en¡ masky
0e15:28 d4              jr      z,0debh     ; nen¡ nastaven bit 1
0e17:3a eb b3           ld      a,(0b3ebh)  ; aktu ln¡ bit v bitov‚ masce
0e1a:b9                 cp      c           
0e1b:38 9b              jr      c,0db8h     ; je men¨¡ ne‘ po‘adovan˜
0e1d:08                 ex      af,af'
0e1e:af                 xor     a
0e1f:32 eb b3           ld      (0b3ebh),a
0e22:c3 43 1f           jp      1f43h
; ......................................................
0e25:7e                 ld      a,(hl)      ; nenulov˜ bajt bit. mapy
0e26:0c                 inc     c           
0e27:1f                 rra                 
0e28:30 fc              jr      nc,0e26h    ; v˜po‡et ‡¡sla bitu
0e2a:08                 ex      af,af'      
0e2b:79                 ld      a,c         ; dal¨¡ nastaven˜ bit
0e2c:d9                 exx                 
0e2d:4f                 ld      c,a         ; n sleduj¡c¡ nastaven˜ bit v mapˆ
                                            ; pokra‡ov n¡ v inicializaci
0e2e:0d                 dec     c           ; ‡¡slo bitu v mapˆ
0e2f:06 00              ld      b,0         
0e31:21 f1 b3           ld      hl,0b3f1h   ; tabulka
0e34:09                 add     hl,bc       ; offset bajtu v tabulce
0e35:cb 6e              bit     5,(hl)      ; = 0
0e37:28 18              jr      z,0e51h     
0e39:cb ae              res     5,(hl)      
0e3b:21 eb b3           ld      hl,0b3ebh   ; aktu ln¡ bit v mapˆ
0e3e:34                 inc     (hl)        ; test ‡¡sla bitu v mapˆ
0e3f:35                 dec     (hl)        
0e40:ca c5 0d           jp      z,0dc5h     ; nebyl ‘ dn˜ bit - nalezen¡ dal¨¡ho
0e43:36 00              ld      (hl),0      ; zru¨en¡ ‡¡sla bitu
0e45:d9                 exx                 
0e46:08                 ex      af,af'      
0e47:b7                 or      a           
0e48:20 dc              jr      nz,0e26h    
0e4a:0d                 dec     c
0e4b:79                 ld      a,c
0e4c:e6 f8              and     0f8h
0e4e:4f                 ld      c,a
0e4f:18 9d              jr      0deeh
; ......................................................
0e51:32 ea b3           ld      (0b3eah),a  ; po‡ te‡n¡ nastaven˜ bit
0e54:af                 xor     a           
0e55:32 02 b3           ld      (0b302h),a  ;
0e58:cb 7e              bit     7,(hl)      ; 0
0e5a:cb be              res     7,(hl)      
0e5c:20 02              jr      nz,0e60h    
0e5e:cb b6              res     6,(hl)      
0e60:08                 ex      af,af'      
0e61:cb 21              sla     c           ; ‡¡slo bitu v mapˆ * 2
0e63:cb 10              rl      b           
0e65:22 ec b3           ld      (0b3ech),hl ; adresa v tabulce 0b3f1h
0e68:21 05 b4           ld      hl,0b405h   
0e6b:09                 add     hl,bc       ; v˜po‡et adresy
0e6c:22 05 b3           ld      (0b305h),hl ; adresa v tabulce
0e6f:08                 ex      af,af'      
0e70:28 06              jr      z,0e78h     ; nen¡ bit 7
0e72:5e                 ld      e,(hl)      
0e73:23                 inc     hl          
0e74:56                 ld      d,(hl)      
0e75:eb                 ex      de,hl       ; HL <-- slovo z tabulky
0e76:f9                 ld      sp,hl       ; adresa z sobn¡ku
0e77:c9                 ret                 
; ......................................................
0e78:cb 21              sla     c
0e7a:cb 10              rl      b           ; ‡¡slo bitu v mapˆ * 4
0e7c:21 1f 06           ld      hl,61fh     ; tabulka adres
0e7f:09                 add     hl,bc       
0e80:5e                 ld      e,(hl)      
0e81:23                 inc     hl          
0e82:56                 ld      d,(hl)      
0e83:eb                 ex      de,hl       
0e84:f9                 ld      sp,hl       ; nov  adresa z sobn¡ku
0e85:eb                 ex      de,hl       
0e86:23                 inc     hl          
0e87:5e                 ld      e,(hl)      
0e88:23                 inc     hl          
0e89:56                 ld      d,(hl)      
0e8a:eb                 ex      de,hl       
0e8b:fb                 ei                  
0e8c:e9                 jp      (hl)        ; adresa skoku do programu
; ......................................................
0e8d:f3                 di      
0e8e:06 86              ld      b,86h
0e90:cd a6 0e           call    0ea6h
0e93:af                 xor     a
0e94:32 01 b3           ld      (0b301h),a
0e97:c3 ad 0d           jp      0dadh
; ......................................................
                                            ; adresa p©¡znaku funkce
0e9a:3a ea b3           ld      a,(0b3eah)  ; ‡¡slo funkce
                                            ; adresa p©¡znaku funkce
0e9d:4f                 ld      c,a
0e9e:0d                 dec     c
0e9f:06 00              ld      b,0
0ea1:21 f1 b3           ld      hl,0b3f1h   ; tabulka p©¡znak–
0ea4:09                 add     hl,bc
0ea5:c9                 ret     
; ......................................................
0ea6:3a ea b3           ld      a,(0b3eah)

                                            ; operace v bitov‚ mapˆ
                                            ; A=‡¡slo bitu, B=k¢d
                                            ; (46=BIT, 86=RES, C6=SET)
                                            ; v˜stup: C=bajt v mapˆ
0ea9:4f                 ld      c,a         ; A=12h, B=0C6h
0eaa:3d                 dec     a           ; 11h
0eab:0f                 rrca                
0eac:0f                 rrca                
0ead:0f                 rrca                ; 22h
0eae:e6 1f              and     1fh         ; 02h
0eb0:5f                 ld      e,a         ; 02h
0eb1:16 00              ld      d,0         
0eb3:21 ee b3           ld      hl,0b3eeh   ; tabulka bit–
0eb6:19                 add     hl,de       ; adresa bajtu v mapˆ
0eb7:53                 ld      d,e         ; d=2
0eb8:79                 ld      a,c         ; 12h
0eb9:3d                 dec     a           ; 11h
0eba:e6 07              and     7           ; 01h
0ebc:59                 ld      e,c         ; 12h
0ebd:4a                 ld      c,d         ; 02h
0ebe:07                 rlca                
0ebf:07                 rlca                
0ec0:07                 rlca                ; 08h
0ec1:b0                 or      b           ; 0ceh (SET 1,(hl))
0ec2:32 e8 b3           ld      (0b3e8h),a  ; k¢d instrukce  ...
0ec5:cd e7 b3           call    0b3e7h      ; instrukce SET ..., RET
0ec8:7b                 ld      a,e         ; 12h
0ec9:c9                 ret                 
; ......................................................
0eca:cb 00              rlc     b
0ecc:c9                 ret     
; .....................................................

0ecd:f3                 di      
0ece:4f                 ld      c,a         ; ‡¡slo funkce
0ecf:fe 01              cp      1
0ed1:28 0b              jr      z,0edeh
0ed3:3e 12              ld      a,12h
0ed5:b9                 cp      c
0ed6:38 06              jr      c,0edeh
0ed8:79                 ld      a,c
0ed9:fe 00              cp      0
0edb:28 01              jr      z,0edeh     ; nen¡ ‘ dn  funkce
0edd:c9                 ret     
; ......................................................
0ede:3a 02 b3           ld      a,(0b302h)  ; ochrana z sobn¡ku
0ee1:fe 02              cp      2
0ee3:3e 00              ld      a,0
0ee5:da 98 0d           jp      c,0d98h
0ee8:e1                 pop     hl          ; zru¨en¡ n vratov‚ adresy
0ee9:c3 98 0d           jp      0d98h
; ......................................................
0eec:c5                 push    bc          ; instrukce operace v bitov‚ mapˆ
0eed:cd 9d 0e           call    0e9dh       
0ef0:c1                 pop     bc          
0ef1:cb 66              bit     4,(hl)      
0ef3:c0                 ret     nz          
0ef4:4f                 ld      c,a         
0ef5:7e                 ld      a,(hl)      
0ef6:b2                 or      d           
0ef7:57                 ld      d,a         
0ef8:7b                 ld      a,e         
0ef9:2f                 cpl                 
0efa:a2                 and     d           
0efb:77                 ld      (hl),a      
0efc:e6 38              and     38h         
0efe:20 12              jr      nz,0f12h    
0f00:3e 09              ld      a,9         
0f02:a3                 and     e           
0f03:79                 ld      a,c         ; ‡¡slo bitu v bitov‚ mapˆ
0f04:20 08              jr      nz,0f0eh    
0f06:cb 7e              bit     7,(hl)      
0f08:c0                 ret     nz          
0f09:21 ea b3           ld      hl,0b3eah   
0f0c:be                 cp      (hl)        
0f0d:c8                 ret     z           
0f0e:cd a9 0e           call    0ea9h       ; operace v bitov‚ mapˆ
0f11:c9                 ret     
; ......................................................
0f12:37                 scf     
0f13:79                 ld      a,c
0f14:c9                 ret     
; ......................................................
0f15:5f                 ld      e,a
0f16:21 ea b3           ld      hl,0b3eah
0f19:be                 cp      (hl)
0f1a:d0                 ret     nc
0f1b:23                 inc     hl
0f1c:7e                 ld      a,(hl)
0f1d:3d                 dec     a
0f1e:93                 sub     e
0f1f:d8                 ret     c
0f20:73                 ld      (hl),e
0f21:21 01 b3           ld      hl,0b301h
0f24:cb ce              set     1,(hl)
0f26:c9                 ret     
; ......................................................
0f27:2a 03 b3           ld      hl,(0b303h)
0f2a:5e                 ld      e,(hl)
0f2b:23                 inc     hl
0f2c:56                 ld      d,(hl)
0f2d:21 36 0d           ld      hl,0d36h
0f30:af                 xor     a
0f31:ed 52              sbc     hl,de
0f33:20 04              jr      nz,0f39h
0f35:3e 02              ld      a,2
0f37:18 0e              jr      0f47h
; ......................................................
0f39:21 2e 0d           ld      hl,0d2eh
0f3c:af                 xor     a
0f3d:ed 52              sbc     hl,de
0f3f:20 04              jr      nz,0f45h
0f41:3e 0e              ld      a,0eh
0f43:18 02              jr      0f47h
; ......................................................
0f45:3e 16              ld      a,16h
0f47:6f                 ld      l,a
0f48:26 00              ld      h,0
0f4a:ed 5b 03 b3        ld      de,(0b303h)
0f4e:19                 add     hl,de
0f4f:dd e5              push    ix
0f51:d1                 pop     de
0f52:73                 ld      (hl),e
0f53:23                 inc     hl
0f54:72                 ld      (hl),d
0f55:21 01 b3           ld      hl,0b301h
0f58:cb ce              set     1,(hl)
0f5a:c9                 ret     
; ......................................................
0f5b:1e 00              ld      e,0
0f5d:cd 9d 0e           call    0e9dh
0f60:cb 7e              bit     7,(hl)
0f62:c8                 ret     z
0f63:cb 5e              bit     3,(hl)
0f65:28 02              jr      z,0f69h
0f67:bf                 cp      a
0f68:c9                 ret     
; ......................................................
0f69:cb ae              res     5,(hl)
0f6b:06 c6              ld      b,0c6h      ; nastaven¡ bitu v bitov‚ mapˆ
0f6d:cd a9 0e           call    0ea9h       ; operace v bitov‚ mapˆ
0f70:c9                 ret     
; ......................................................
0f71:08                 ex      af,af'
0f72:3a 4a b5           ld      a,(0b54ah)
0f75:fe 04              cp      4
0f77:28 06              jr      z,0f7fh
0f79:fe 08              cp      8
0f7b:28 02              jr      z,0f7fh
0f7d:18 11              jr      0f90h
; ......................................................
0f7f:af                 xor     a
0f80:32 5d b5           ld      (0b55dh),a
0f83:cd 36 1a           call    1a36h
0f86:cd 96 1a           call    1a96h
0f89:3e 4f              ld      a,4fh
0f8b:ed 79              out     (c),a
0f8d:c3 31 ee           jp      0ee31h
; ......................................................
0f90:08                 ex      af,af'
0f91:ed 4b 4f b5        ld      bc,(0b54fh)
0f95:79                 ld      a,c
0f96:32 61 b5           ld      (0b561h),a
0f99:78                 ld      a,b
0f9a:32 60 b5           ld      (0b560h),a  ; stopa s po‘adovan˜m sektorem
0f9d:38 5e              jr      c,0ffdh
0f9f:d6 4a              sub     4ah
0fa1:f2 9a 10           jp      p,109ah
0fa4:78                 ld      a,b
0fa5:d6 01              sub     1
0fa7:da 9a 10           jp      c,109ah
0faa:2a 4d b5           ld      hl,(0b54dh)
0fad:7c                 ld      a,h
0fae:b5                 or      l
0faf:ca 9a 10           jp      z,109ah
0fb2:3e 01              ld      a,1
0fb4:bc                 cp      h
0fb5:da 9a 10           jp      c,109ah
0fb8:20 05              jr      nz,0fbfh
0fba:af                 xor     a
0fbb:bd                 cp      l
0fbc:c2 9a 10           jp      nz,109ah
0fbf:3a 53 b5           ld      a,(0b553h)  ; typ diskety (0=disketa 512 B)
0fc2:b7                 or      a
0fc3:11 08 00           ld      de,8
0fc6:28 02              jr      z,0fcah
0fc8:1e 1a              ld      e,1ah
0fca:79                 ld      a,c
0fcb:b7                 or      a
0fcc:ca 9a 10           jp      z,109ah
0fcf:7b                 ld      a,e
0fd0:91                 sub     c
0fd1:da 9a 10           jp      c,109ah
0fd4:af                 xor     a
0fd5:b4                 or      h
0fd6:28 0d              jr      z,0fe5h
0fd8:7b                 ld      a,e
0fd9:26 20              ld      h,20h
0fdb:fe 08              cp      8
0fdd:28 17              jr      z,0ff6h
0fdf:26 09              ld      h,9
0fe1:3e 16              ld      a,16h
0fe3:18 0a              jr      0fefh
; ......................................................
0fe5:7d                 ld      a,l
0fe6:93                 sub     e
0fe7:38 05              jr      c,0feeh
0fe9:28 0b              jr      z,0ff6h
0feb:24                 inc     h
0fec:18 f8              jr      0fe6h
; ......................................................
0fee:83                 add     a,e
0fef:81                 add     a,c
0ff0:3d                 dec     a
0ff1:3d                 dec     a
0ff2:93                 sub     e
0ff3:38 01              jr      c,0ff6h
0ff5:04                 inc     b
0ff6:7c                 ld      a,h
0ff7:80                 add     a,b
0ff8:d6 4a              sub     4ah
0ffa:d2 9a 10           jp      nc,109ah
0ffd:06 00              ld      b,0
0fff:dd 4e 08           ld      c,(ix+8)
1002:cb 21              sla     c
1004:21 cc 1a           ld      hl,1acch
1007:09                 add     hl,bc
1008:7e                 ld      a,(hl)
1009:32 66 b5           ld      (0b566h),a  ; v˜stup na ©¡d¡c¡ port A-PIO2/AFS
100c:23                 inc     hl
100d:7e                 ld      a,(hl)
100e:21 5b b5           ld      hl,0b55bh   ; b zov  adresa port– AFS
1011:77                 ld      (hl),a
1012:23                 inc     hl
1013:3c                 inc     a
1014:77                 ld      (hl),a
1015:3a 4a b5           ld      a,(0b54ah)
1018:d6 01              sub     1
101a:28 04              jr      z,1020h
101c:fe 01              cp      1
101e:20 7a              jr      nz,109ah
1020:21 5e b5           ld      hl,0b55eh   ; diskov  operace
1023:77                 ld      (hl),a
1024:1f                 rra     
1025:cd 4b 1f           call    1f4bh
1028:21 67 b5           ld      hl,0b567h
102b:36 03              ld      (hl),3
102d:dd cb 00 4e        bit     1,(ix+0)
1031:c4 50 19           call    nz,1950h
1034:20 35              jr      nz,106bh
1036:3e cf              ld      a,0cfh
1038:32 6e b5           ld      (0b56eh),a
103b:3e 03              ld      a,3
103d:32 69 b5           ld      (0b569h),a  ; po‘adovan˜ po‡et stop k vystaven¡
1040:21 4e 10           ld      hl,104eh
1043:22 7a b5           ld      (0b57ah),hl
1046:16 cf              ld      d,0cfh
1048:cd 52 19           call    1952h
104b:c3 69 11           jp      1169h
