
code     segment
         assume    cs:code,ds:code
         org       100h

start:
         mov       ax,3510h
         int       21h
         mov       word ptr ds:[Old10],bx
         mov       word ptr ds:[old10+2],es

         mov       dx,offset int10
         mov       ax,2510h
         int       21h

         mov       dx,offset konec
         int       27h

old10    dd        0


int10    proc      far

         cmp       ah,0
         je        int101
int100:  jmp       dword ptr cs:[old10]

int101:  ;cmp       al,13
         ;jb        int100
         ;cmp       al,18
         ;ja        int100

         pushf
         call      dword ptr cs:[old10]

         push      ax
         push      bx
         push      cx
         push      dx
         push      si
         push      di
         push      bp
         push      ds
         push      es

         mov       ax,1012h
         xor       bx,bx
         mov       cx,256
         mov       dx,offset registry
         push      cs
         pop       es
         pushf
         call      dword ptr cs:[old10]

         pop       es
         pop       ds
         pop       bp
         pop       di
         pop       si
         pop       dx
         pop       cx
         pop       bx
         pop       ax
         iret

int10    endp

registry label     byte
         db        00,00,00                 ; 00
         db        04,04,04                 ; 01
         db        08,08,08                 ; 02
         db        12,12,12                 ; 03
         db        16,16,16                 ; 04
         db        20,20,20                 ; 05
         db        24,24,24                 ; 06
         db        28,28,28                 ; 07
         db        32,32,32                 ; 08
         db        36,36,36                 ; 09
         db        40,40,40                 ; 0a
         db        44,44,44                 ; 0b
         db        48,48,48                 ; 0c
         db        52,52,52                 ; 0d
         db        56,56,56                 ; 0e
         db        60,60,60                 ; 0f
         db        00,00,00                 ; 10
         db        04,04,04                 ; 11
         db        08,08,08                 ; 12
         db        12,12,12                 ; 13
         db        16,16,16                 ; 14
         db        20,20,20                 ; 15
         db        24,24,24                 ; 16
         db        28,28,28                 ; 17
         db        32,32,32                 ; 18
         db        36,36,36                 ; 19
         db        40,40,40                 ; 1a
         db        44,44,44                 ; 1b
         db        48,48,48                 ; 1c
         db        52,52,52                 ; 1d
         db        56,56,56                 ; 1e
         db        60,60,60                 ; 1f
         db        00,00,00                 ; 20
         db        04,04,04                 ; 21
         db        08,08,08                 ; 22
         db        12,12,12                 ; 23
         db        16,16,16                 ; 24
         db        20,20,20                 ; 25
         db        24,24,24                 ; 26
         db        28,28,28                 ; 27
         db        32,32,32                 ; 28
         db        36,36,36                 ; 29
         db        40,40,40                 ; 2a
         db        44,44,44                 ; 2b
         db        48,48,48                 ; 2c
         db        52,52,52                 ; 2d
         db        56,56,56                 ; 2e
         db        60,60,60                 ; 2f
         db        00,00,00                 ; 30
         db        04,04,04                 ; 31
         db        08,08,08                 ; 32
         db        12,12,12                 ; 33
         db        16,16,16                 ; 34
         db        20,20,20                 ; 35
         db        24,24,24                 ; 36
         db        28,28,28                 ; 37
         db        32,32,32                 ; 38
         db        36,36,36                 ; 39
         db        40,40,40                 ; 3a
         db        44,44,44                 ; 3b
         db        48,48,48                 ; 3c
         db        52,52,52                 ; 3d
         db        56,56,56                 ; 3e
         db        60,60,60                 ; 3f
         db        00,00,00                 ; 40
         db        04,04,04                 ; 41
         db        08,08,08                 ; 42
         db        12,12,12                 ; 43
         db        16,16,16                 ; 44
         db        20,20,20                 ; 45
         db        24,24,24                 ; 46
         db        28,28,28                 ; 47
         db        32,32,32                 ; 48
         db        36,36,36                 ; 49
         db        40,40,40                 ; 4a
         db        44,44,44                 ; 4b
         db        48,48,48                 ; 4c
         db        52,52,52                 ; 4d
         db        56,56,56                 ; 4e
         db        60,60,60                 ; 4f
         db        00,00,00                 ; 50
         db        04,04,04                 ; 51
         db        08,08,08                 ; 52
         db        12,12,12                 ; 53
         db        16,16,16                 ; 54
         db        20,20,20                 ; 55
         db        24,24,24                 ; 56
         db        28,28,28                 ; 57
         db        32,32,32                 ; 58
         db        36,36,36                 ; 59
         db        40,40,40                 ; 5a
         db        44,44,44                 ; 5b
         db        48,48,48                 ; 5c
         db        52,52,52                 ; 5d
         db        56,56,56                 ; 5e
         db        60,60,60                 ; 5f
         db        00,00,00                 ; 60
         db        04,04,04                 ; 61
         db        08,08,08                 ; 62
         db        12,12,12                 ; 63
         db        16,16,16                 ; 64
         db        20,20,20                 ; 65
         db        24,24,24                 ; 66
         db        28,28,28                 ; 67
         db        32,32,32                 ; 68
         db        36,36,36                 ; 69
         db        40,40,40                 ; 6a
         db        44,44,44                 ; 6b
         db        48,48,48                 ; 6c
         db        52,52,52                 ; 6d
         db        56,56,56                 ; 6e
         db        60,60,60                 ; 6f
         db        00,00,00                 ; 70
         db        04,04,04                 ; 71
         db        08,08,08                 ; 72
         db        12,12,12                 ; 73
         db        16,16,16                 ; 74
         db        20,20,20                 ; 75
         db        24,24,24                 ; 76
         db        28,28,28                 ; 77
         db        32,32,32                 ; 78
         db        36,36,36                 ; 79
         db        40,40,40                 ; 7a
         db        44,44,44                 ; 7b
         db        48,48,48                 ; 7c
         db        52,52,52                 ; 7d
         db        56,56,56                 ; 7e
         db        60,60,60                 ; 7f
         db        00,00,00                 ; 80
         db        04,04,04                 ; 81
         db        08,08,08                 ; 82
         db        12,12,12                 ; 83
         db        16,16,16                 ; 84
         db        20,20,20                 ; 85
         db        24,24,24                 ; 86
         db        28,28,28                 ; 87
         db        32,32,32                 ; 88
         db        36,36,36                 ; 89
         db        40,40,40                 ; 8a
         db        44,44,44                 ; 8b
         db        48,48,48                 ; 8c
         db        52,52,52                 ; 8d
         db        56,56,56                 ; 8e
         db        60,60,60                 ; 8f
         db        00,00,00                 ; 90
         db        04,04,04                 ; 91
         db        08,08,08                 ; 92
         db        12,12,12                 ; 93
         db        16,16,16                 ; 94
         db        20,20,20                 ; 95
         db        24,24,24                 ; 96
         db        28,28,28                 ; 97
         db        32,32,32                 ; 98
         db        36,36,36                 ; 99
         db        40,40,40                 ; 9a
         db        44,44,44                 ; 9b
         db        48,48,48                 ; 9c
         db        52,52,52                 ; 9d
         db        56,56,56                 ; 9e
         db        60,60,60                 ; 9f
         db        00,00,00                 ; a0
         db        04,04,04                 ; a1
         db        08,08,08                 ; a2
         db        12,12,12                 ; a3
         db        16,16,16                 ; a4
         db        20,20,20                 ; a5
         db        24,24,24                 ; a6
         db        28,28,28                 ; a7
         db        32,32,32                 ; a8
         db        36,36,36                 ; a9
         db        40,40,40                 ; aa
         db        44,44,44                 ; ab
         db        48,48,48                 ; ac
         db        52,52,52                 ; ad
         db        56,56,56                 ; ae
         db        60,60,60                 ; af
         db        00,00,00                 ; b0
         db        04,04,04                 ; b1
         db        08,08,08                 ; b2
         db        12,12,12                 ; b3
         db        16,16,16                 ; b4
         db        20,20,20                 ; b5
         db        24,24,24                 ; b6
         db        28,28,28                 ; b7
         db        32,32,32                 ; b8
         db        36,36,36                 ; b9
         db        40,40,40                 ; ba
         db        44,44,44                 ; bb
         db        48,48,48                 ; bc
         db        52,52,52                 ; bd
         db        56,56,56                 ; be
         db        60,60,60                 ; bf
         db        00,00,00                 ; c0
         db        04,04,04                 ; c1
         db        08,08,08                 ; c2
         db        12,12,12                 ; c3
         db        16,16,16                 ; c4
         db        20,20,20                 ; c5
         db        24,24,24                 ; c6
         db        28,28,28                 ; c7
         db        32,32,32                 ; c8
         db        36,36,36                 ; c9
         db        40,40,40                 ; ca
         db        44,44,44                 ; cb
         db        48,48,48                 ; cc
         db        52,52,52                 ; cd
         db        56,56,56                 ; ce
         db        60,60,60                 ; cf
         db        00,00,00                 ; d0
         db        04,04,04                 ; d1
         db        08,08,08                 ; d2
         db        12,12,12                 ; d3
         db        16,16,16                 ; d4
         db        20,20,20                 ; d5
         db        24,24,24                 ; d6
         db        28,28,28                 ; d7
         db        32,32,32                 ; d8
         db        36,36,36                 ; d9
         db        40,40,40                 ; da
         db        44,44,44                 ; db
         db        48,48,48                 ; dc
         db        52,52,52                 ; dd
         db        56,56,56                 ; de
         db        60,60,60                 ; df
         db        00,00,00                 ; e0
         db        04,04,04                 ; e1
         db        08,08,08                 ; e2
         db        12,12,12                 ; e3
         db        16,16,16                 ; e4
         db        20,20,20                 ; e5
         db        24,24,24                 ; e6
         db        28,28,28                 ; e7
         db        32,32,32                 ; e8
         db        36,36,36                 ; e9
         db        40,40,40                 ; ea
         db        44,44,44                 ; eb
         db        48,48,48                 ; ec
         db        52,52,52                 ; ed
         db        56,56,56                 ; ee
         db        60,60,60                 ; ef
         db        00,00,00                 ; f0
         db        04,04,04                 ; f1
         db        08,08,08                 ; f2
         db        12,12,12                 ; f3
         db        16,16,16                 ; f4
         db        20,20,20                 ; f5
         db        24,24,24                 ; f6
         db        28,28,28                 ; f7
         db        32,32,32                 ; f8
         db        36,36,36                 ; f9
         db        40,40,40                 ; fa
         db        44,44,44                 ; fb
         db        48,48,48                 ; fc
         db        52,52,52                 ; fd
         db        56,56,56                 ; fe
         db        60,60,60                 ; ff

konec    label     near

code     ends
         end       start
