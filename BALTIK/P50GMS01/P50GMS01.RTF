{\rtf1\ansi\deff0\deftab720{\fonttbl{\f0\fnil MS Sans Serif;}{\f1\froman\fcharset2{\*\fname Symbol;}MT Symbol;}{\f2\fswiss\fcharset238{\*\fname Arial;}Arial CE;}{\f3\froman\fcharset238{\*\fname Times New Roman;}Times New Roman CE;}}
{\colortbl\red0\green0\blue0;}
\deflang1029\pard\plain\f2\fs20 Pro lep\'9a\'ed prodejnost Baltazara (a Balt\'edka) pot\'f8ebujeme zav\'e9st ochranu SGP registrac\'ed (ji\'9e ne licen\'e8n\'ed disketou). Na disket\'e1ch bude pouze jedna verze SGP, kter\'e1 bez registrace bude fungovat jako demo. U\'9eivatel\'e9 po zasl\'e1n\'ed \'fadaj\'f9 o sob\'ec a zaplacen\'ed registrace (programu) obdr\'9e\'ed registra\'e8n\'ed \'e8\'edslo, kter\'fdm "odemknou" demo verzi na ostrou verzi. Tak budeme moci jednodu\'9ae prod\'e1vat p\'f8es Internet a jednodu\'9ae prov\'e1d\'ect updaty.
\par 
\par N\'e1vrh zm\'ecn do SGP pro novou ochranu registrac\'ed:
\par 1. P\'f8i ka\'9ed\'e9m spu\'9at\'ecn\'ed SGP volat funkci \plain\f2\fs20\b ReadRegistration\plain\f2\fs20  (\plain\f2\fs20\i RegProt.pas\plain\f2\fs20 ), kter\'e1 na\'e8te a zkontroluje \'fadaje uveden\'e9 v registraci.
\par \pard\li360\plain\f2\fs20 function \plain\f2\fs20\b ReadRegistration\plain\f2\fs20 ( const \plain\f2\fs20\b filename\plain\f2\fs20 : String; var \plain\f2\fs20\b user\plain\f2\fs20 : TRegUserData; var \plain\f2\fs20\b reg\plain\f2\fs20 : TRegData; \plain\f2\fs20\b minversion\plain\f2\fs20 : Word ): Integer;
\par \plain\f2\fs20\i Parametry: \plain\f2\fs20 
\par \plain\f2\fs20\i vstupn\'ed:\plain\f2\fs20 
\par \pard\li720\fi-360{\*\pn\pnlvlblt\pnf1\pnindent360{\pntxtb\'b7}}\plain\f2\fs20 {\pntext\f1\'b7\tab}filename - \'f8et\'eczec ozna\'e8uj\'edc\'ed jm\'e9no souboru s registrac\'ed; pro Baltazara navrhuji sgpbalt.rdt, v adres\'e1\'f8i, kde je sgpbalt.exe. filename mus\'ed b\'fdt v\'e8etn\'ec absolutn\'ed cesty, nap\'f8. C:\\SGP\\BALTAZAR\\SGPBALT.RDT
\par {\pntext\f1\'b7\tab}minversion - verze SGP, pro kterou je je\'9at\'ec st\'e1vaj\'edc\'ed verze SGP zdarma, nap\'f8. pro verzi 5.03 bude minversion 5.00, tedy pro registrace verz\'ed 5.00 v\'e8etn\'ec a v\'fd\'9ae bude verze 5.03 zdarma - nebude pot\'f8eba nov\'e1 registrace. minversion je verze*100, tj. veze 5.00 je zak\'f3dov\'e1na jako 500. Doporu\'e8uji zav\'e9st v SGP dv\'ec prom\'ecnn\'e9 BaltazarVersion a BaltazarMinVersion s t\'edmto k\'f3dov\'e1n\'edm (je vhodn\'e9 pro p\'f8\'edm\'e9 porovn\'e1v\'e1n\'ed). Pozor ale na v\'fdpis, aby nebyl nap\'f8. pro 5.10 a 5.01 podobn\'fd (5.10 a 5.1).
\par \pard\li360\plain\f2\fs20\i v\'fdstupn\'ed:\plain\f2\fs20 
\par \pard\li720\fi-360{\*\pn\pnlvlblt\pnf1\pnindent360{\pntxtb\'b7}}\plain\f2\fs20 {\pntext\f1\'b7\tab}user - \'fadaje o u\'9eivateli uveden\'e9 v registra\'e8n\'edm souboru (viz RegProt.pas)
\par {\pntext\f1\'b7\tab}reg - \'fadaje o registraci uveden\'e9 v registra\'e8n\'edm souboru; jednotliv\'e9 d\'f9le\'9eit\'e9 polo\'9eky jsou n\'e1sleduj\'edc\'ed:
\par \pard\li1080\fi-360{\*\pn\pnlvlblt\pnf1\pnindent360{\pntxtb\'b7}}\plain\f2\fs20 {\pntext\f1\'b7\tab}LicenceNum - \'e8\'edslo licence - bude vyps\'e1no v dialogu About
\par {\pntext\f1\'b7\tab}Product - 4 m\'edstn\'e9 \'e8\'edslo produktu (prozat\'edm nejsem s Mirkem domluven na \'e8\'edslov\'e1n\'ed); m\'eclo by se kontrolovat t\'ecsn\'ec po ReadRegistration a WriteRegistration (viz d\'e1le), zda obsahuje \'e8\'edslo produktu, kter\'fd u\'9eivatel spou\'9at\'ed nap\'f8. Baltazar, Balt\'edk. Lze tak\'e9 u Baltazara rozli\'9ait norm\'e1ln\'ed a Profi verzi, a tak pro Profi zapnou mo\'9enost generov\'e1n\'ed .EXE
\par {\pntext\f1\'b7\tab}Version - verze produktu, pro kterou plat\'ed tato registrace; mus\'ed b\'fdt v\'ect\'9a\'ed nebo rovno minversion (ReadRegistration kontroluje).
\par {\pntext\f1\'b7\tab}NetLicCount - je-li v\'ect\'9a\'ed ne\'9e 0, je registrace s\'ed\'9dov\'e1. Toto \'e8\'edslo ud\'e1v\'e1 po\'e8et licenc\'ed (je-li $FF, pak je neomezen\'e1). Zat\'edm se jen rozli\'9auje =0, >0. Pou\'9eit\'ed do budoucna.
\par {\pntext\f1\'b7\tab}Duration - po\'e8et dn\'f9 platn\'e9 registrace od data registrace (WriteRegistration). Po uplynut\'ed t\'e9to doby mus\'ed SGP po\'9eadovat novou registraci (n\'e1vratov\'e1 hodnota -5 viz d\'e1le). 0 zna\'e8\'ed neomezenou dobu.
\par {\pntext\f1\'b7\tab}ValidityDate - datum platnosti registrace - do tohoto data, v\'e8etn\'ec, lze SGP spustit jako ostrou verzi (n\'e1vratov\'e1 hodnota -6 viz d\'e1le). ValidDate.Year=0 zna\'e8\'ed neomezenou platnost.
\par \pard\li360\plain\f2\fs20\i n\'e1vratov\'e1 hodnota:
\par \pard\li720\fi-360{\*\pn\pnlvlblt\pnf1\pnindent360{\pntxtb\'b7}}\plain\f2\fs20 {\pntext\f1\'b7\tab}0 - OK
\par {\pntext\f1\'b7\tab}-2 - \'fadaje o u\'9eivateli (user) byly v souboru o registraci nekorektn\'ec zm\'ecn\'ecny
\par {\pntext\f1\'b7\tab}-3 - \'9apatn\'fd form\'e1t registra\'e8n\'edho souboru - obsah souboru byl nekorektn\'ec zm\'ecn\'ecn nebo soubor nem\'e1 hlavi\'e8ku registra\'e8n\'edho souboru
\par {\pntext\f1\'b7\tab}-4 - verze uveden\'e1 v registraci nen\'ed v\'ect\'9a\'ed \'e8i stejn\'e1 jako minversion - u\'9eivatel mus\'ed zaplatit upgrade a znovu se zaregistrovat
\par {\pntext\f1\'b7\tab}-5 - uplynula doba Duration od posledn\'ed registrace - u\'9eivatel se mus\'ed znovu zaregistrovat (nejlep\'9a\'ed by bylo, kdyby registrace p\'f8estala pracovat a u\'9eivatel by musel cel\'fd program odinstalovat a nainstalovat znovu)
\par {\pntext\f1\'b7\tab}-6 - datum platnosti registrace p\'f8ekro\'e8eno (viz ValidityDate)
\par {\pntext\f1\'b7\tab}-7 - program je spu\'9at\'ecn na jin\'e9m po\'e8\'edta\'e8i ne\'9e byl zaregistrov\'e1n
\par {\pntext\f1\'b7\tab}< -1000 - do\'9alo k i/o chyb\'ec - nap\'f8. -1003 zna\'e8\'ed chybu IOResult 3. Jedin\'e1 korektn\'ed je -1002 - soubor nenalezen - u\'9eivatel je\'9at\'ec neprovedl registraci.
\par \pard\li360\plain\f2\fs20\i reakce:\plain\f2\fs20 
\par 0 - zkontrolovat \'e8\'edslo produktu; je-li v po\'f8\'e1dku, pak odblokovat "demo" k\'f3d p\'f8\'edpadn\'ec podle \'e8\'edsla produktu i dal\'9a\'ed funkce SGP. Nen\'ed-li v po\'f8\'e1dku, pak dialog pro volbu spu\'9at\'ecn\'ed demo verze nebo registrace.
\par -2, -3,-7,-1002 - zobrazit dialog pro volbu spu\'9at\'ecn\'ed demo verze nebo registrace
\par -4 - dialog: "Va\'9ae registrace je pro verzi <reg.Version> programu. Pro spu\'9at\'ecn\'ed verze <BaltazarVersion> je nutn\'e9 zakoupit novou registraci (upgrade) nejm\'e9n\'ec pro verzi <BaltazarMinVersion>"+tla\'e8\'edtko "Spustit DEMO"
\par -5 - dialog: "Zku\'9aebn\'ed doba <reg.Duration> uplynula. Pokud chcete nad\'e1le pou\'9e\'edvat ostrou verzi, mus\'edte zakoupit plnou registraci."+tla\'e8\'edtko "Spustit DEMO"+vypnout v demu mo\'9enost nov\'e9ho zaregistrov\'e1n\'ed.
\par -6 - dialog: "Va\'9ae registrace byla platn\'e1 do <reg.ValidityDate>. Pro spou\'9at\'ecn\'ed ostr\'e9 verze programu mus\'edte zakoupit novou platnou registraci."+tla\'e8\'edtko "Spustit DEMO"
\par       <-1000 (jin\'e1 ne\'9e -1002) dialog: "Nelze otev\'f8\'edt registra\'e8n\'ed soubor <filename>."+tla\'e8\'edtko "Spustit DEMO"+tla\'e8\'edtko "Nov\'e1 registrace"
\par  
\par \pard\plain\f2\fs20 2. Do menu zahrnout mo\'9enost registrace - registra\'e8n\'ed dialog: formul\'e1\'f8 s \'f8\'e1dky Jm\'e9no, Adresa, M\'ecsto, St\'e1t a Registra\'e8n\'ed \'e8\'edslo + tla\'e8\'edtko "Zaregistrovat". Po stisknut\'ed tla\'e8\'edtka naplnit z\'e1znam user: TRegUserData a zavolat funkci \plain\f2\fs20\b WriteRegistration\plain\f2\fs20 :
\par \pard\li360\plain\f2\fs20 function \plain\f2\fs20\b WriteRegistration\plain\f2\fs20 ( const \plain\f2\fs20\b filename\plain\f2\fs20 : String; var \plain\f2\fs20\b user\plain\f2\fs20 : TRegUserData; const \plain\f2\fs20\b regnum\plain\f2\fs20 : String; var \plain\f2\fs20\b reg\plain\f2\fs20 : TRegData ): Integer;
\par \plain\f2\fs20\i Parametry:\plain\f2\fs20 
\par \plain\f2\fs20\i vstupn\'ed:\plain\f2\fs20 
\par \pard\li720\fi-360{\*\pn\pnlvlblt\pnf1\pnindent360{\pntxtb\'b7}}\plain\f2\fs20 {\pntext\f1\'b7\tab}filename - jm\'e9no registra\'e8n\'edho souboru viz ReadRegistration
\par {\pntext\f1\'b7\tab}user - z\'e1znam napln\'ecn\'fd daty o u\'9eivateli z formul\'e1\'f8e
\par {\pntext\f1\'b7\tab}regnum - registra\'e8n\'ed \'e8\'edslo z formul\'e1\'f8e (\'e8\'edslo, kter\'e9 obdr\'9e\'ed u\'9eivatel po zaplacen\'ed registrace, a kter\'e9 "odem\'e8e" demo verzi jako ostrou verzi podle \'fadaj\'f9 uveden\'fdch v tomto registra\'e8n\'edm \'e8\'edsle)
\par \pard\li360\plain\f2\fs20\i v\'fdstupn\'ed:\plain\f2\fs20 
\par \pard\li720\fi-360{\*\pn\pnlvlblt\pnf1\pnindent360{\pntxtb\'b7}}\plain\f2\fs20 {\pntext\f1\'b7\tab}reg - \'fadaje o registraci z\'edskan\'e9 z registra\'e8n\'edho \'e8\'edsla viz ReadRegistration
\par \pard\li360\plain\f2\fs20\i n\'e1vratov\'e1 hodnota:\plain\f2\fs20 
\par \pard\li720\fi-360{\*\pn\pnlvlblt\pnf1\pnindent360{\pntxtb\'b7}}\plain\f2\fs20 {\pntext\f1\'b7\tab}0 - OK
\par {\pntext\f1\'b7\tab}>0 - \'9apatn\'e1 "syntaxe" registra\'e8n\'edho \'e8\'edsla. Hodnota ud\'e1v\'e1 pozici s chybou v registra\'e8n\'edm \'e8\'edsle.
\par {\pntext\f1\'b7\tab}-1 - neplatn\'e9 registra\'e8n\'ed \'e8\'edslo
\par {\pntext\f1\'b7\tab}-2 - \'fadaje o u\'9eivateli nesouhlas\'ed s registra\'e8n\'edm \'e8\'edslem, tj. \'e8\'edslo je platn\'e9, ale \'fadaje o u\'9eivateli jsou \'9apatn\'e9
\par {\pntext\f1\'b7\tab}<-1000 - i/o chyba, nap\'f8. -1003 je chyba IOResult 3.
\par \pard\li360\plain\f2\fs20 
\par \plain\f2\fs20\b !\plain\f2\fs20 Po \'fasp\'ec\'9an\'e9m vol\'e1n\'ed WriteRegistration je nutn\'e9 znovu "restartovat" SGP, tj. prov\'e9st kroky uveden\'e9 v bod\'ec 1 v\'e8etn\'ec vol\'e1n\'ed ReadRegistration, kter\'e9 provede kontrolu \'fadaj\'f9 v registraci.
\par 
\par \pard\plain\f2\fs20 3. Do dialogu About, p\'f8\'edpadn\'ec p\'f8\'edmo na plochu, uv\'e9st \'fadaje o u\'9eivateli (user) a \'fadaje o registraci (licen\'e8n\'ed \'e8\'edslo atd.). S Mirkem jsme se tak\'e9 domluvili, \'9ee by bylo t\'f8eba zav\'e9st je\'9at\'ec datum verze SGP, kter\'e9 mus\'ed b\'fdt tak\'e9 zobrazeno pro u\'9eivatele (aby v\'ecd\'ecli, zda maj\'ed nejnov\'ecj\'9a\'ed verzi). Nejl\'e9pe by bylo konstanty BaltazarVersion, BaltazarVersionDate, BaltazarMinVersion d\'e1t do samostatn\'e9ho includu a ten pak p\'f8i v\'fdrob\'ec editovat. Tyto zm\'ecny samoz\'f8ejm\'ec plat\'ed i pro st\'e1vaj\'edc\'ed verzi SGP.
\par 
\par \pard\plain\f3\fs20 
\par }
 