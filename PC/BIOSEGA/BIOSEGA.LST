CONTEXT   0 241   4   5  90










; p©¡davn˜ modul ROM v AT - "BIOS EGA" - segment C000H

0000                 dw     0aa55h          ; identifikace modulu ROM
0002                 db     20h             ; d‚lka modulu = 4000H bajt–

0003  eb6b           jmp    0070            ; skok na inicializaci

                                          ;* licen‡n¡ informace
0010                 db     'GEMINI '
0017                 db     'VC-001 IBM COMPATIBLE EGA BIOS (V2.4), '
003e                 db     'Copyright (C) Gemini Technology Inc 1987-1988     '

; *****************************************************************************
;                        Instalace karty EGA do syst‚mu
; *****************************************************************************
                                          ;* start a inicializace BIOS-EGA
0070  55             push   bp              ; £schova BP
0071  33c0           xor    ax,ax           ; AX <- 0000
0073  8ed8           mov    ds,ax           ; DS <- 0000
0075  8ec0           mov    es,ax           ; ES <- 0000
0077  e80700         call   0081            ; instalace ovlada‡e EGA karty
007a  e81a04         call   0497            ; zobrazen¡ £vodn¡ho textu BIOS EGA
007d  5d             pop    bp              ; n vrat BP
007e  33c0           xor    ax,ax           ; AX <- 0000
0080  cb             ret    far             ; n vrat do zavadˆ‡e syst‚mu
; -----------------------------------------------------------------------------
;         Instalace ovlada‡e EGA karty
; -----------------------------------------------------------------------------
                                          ;* instalace ovlada‡e EGA karty
0081  e86300       * call   00e7            ; na‡ten¡ p©ep¡na‡– DIL 1-4
0084  813e72043412   cmp    [0472],1234     ; je hork˜ start ?
008a  751d           jnz    00a9            ; je studen˜ start

                                          ;* je hork˜ start - vol no z RAM ?
008c  8bec           mov    bp,sp           ; BP <- SP ukazatel dat v z sobn¡ku
008e  817e0600b0     cmp    [bp+06],b000    ; vol no ze z kladn¡ RAM ?
0093  721b           jc     00b0            ; instalace vol na ze z kladn¡ RAM
0095  2e813e004055aa cmp    cs:[4000],aa55  ; n sleduje dal¨¡ modul ROM ?
009c  750b           jnz    00a9            ; nen¡ dal¨¡ modul ROM

009e  b040           mov    al,40           ; pou‘it‚ nastaven¡ sign l– EGA
00a0  2e813e17405643 cmp    cs:[4017],"CV"  ; ozna‡en¡ modulu ROM "VC" ?
00a7  740b           jz     00b4            ; je dal¨¡ modul ROM "VC"


00a9  a0a104       * mov    al,[04a1]       ; nastaven¡ p©ep¡na‡– DIL
00ac  24c0           and    al,c0           ; maskov n¡ - bity DIL 3 a DIL 4
00ae  7b04           jnp    00b4            ; je sekund rn¡ displej

                                          ;* je prim rn¡ displej - instalace
00b0  e8fb01       * call   02ae            ; inicializace displeje EGA
00b3  c3             ret                    
; -----------------------------------------------------------------------------
;         Instalace sekund rn¡ho displeje
; -----------------------------------------------------------------------------
                                          ;* instalace sekund rn¡ho displeje
00b4  50           * push   ax              ; nastaven¡ p©ep¡na‡–
00b5  e8f601         call   02ae            ; inicializace displeje EGA
00b8  58             pop    ax              ; n vrat nastaven¡ p©ep¡na‡–
00b9  8d36fc00       lea    si,[00fc]       ; SI <- 00FCh instalace displeje CGA
00bd  3c40           cmp    al,40           
00bf  7404           jz     00c5            
00c1  8d369b01       lea    si,[019b]       ; SI <- 019Bh instalace displeje MDA
00c5  ffd6         * call   si              ; vyvol n¡ podprogramu 00FCh/019Bh
00c7  7212           jc     00db            ; chyba inicializace
00c9  33c0           xor    ax,ax           
00cb  a28404         mov    [0484],al       ; ‡¡slo posledn¡ho © dku
00ce  a38504         mov    [0485],ax       ; po‡et linek na znak (v˜¨ka znaku)
00d1  a38704         mov    [0487],ax       ; statut ©¡zen¡ video
00d4  a3a804         mov    [04a8],ax       ; ukazatek videoparametr– EGA
00d7  a3aa04         mov    [04aa],ax       ; ukazatek videoparametr– EGA-segm.
00da  c3             ret
; -----------------------------------------------------------------------------

                                          ;* chyba instalace sekund. displeje

00db  e8d522         call   23b3            ; p¡pnut¡
00de  b03e           mov    al,3e           ; doba prodlevy
00e0  e8e222         call   23c5            ; prodleva
00e3  e8cd22         call   23b3            ; p¡pnut¡
00e6  c3             ret
; -----------------------------------------------------------------------------
;         Na‡ten¡ nastaven¡ p©ep¡na‡– DIL 1-4
; -----------------------------------------------------------------------------
                                          ;* na‡ten¡ p©ep¡na‡– DIL 1-4
00e7  bac803       * mov    dx,03c8         ; adresa portu 03C8h
00ea  b080           mov    al,80           
00ec  ee             out    dx,al           ; port [03c8] <- 80h
00ed  e82702         call   0317            ; na‡ten¡ nastaven¡ p©ep¡na‡– DIL1-4
00f0  d0e0           shl    al,1            
00f2  d0e0           shl    al,1            
00f4  d0e0           shl    al,1            
00f6  d0e0           shl    al,1            ; p©ep¡na‡e DIL * 16
00f8  a2a104         mov    [04a1],al       ; ulo‘en¡ nastaven¡ p©ep¡na‡– DIL
00fb  c3             ret                    
; -----------------------------------------------------------------------------

                                          ;* instalace sekund rn¡ho displeje CGA

00fc  f606870402   * test   [0487],02       ; status ©¡zen¡ video - je MDA ?
0101  f9             stc                    ; p©¡znak chyby
0102  754e           jnz    0152            ; je displej MDA - chyba
0104  8cc8           mov    ax,cs           ; AX <- CS
0106  8ec0           mov    es,ax           ; ES <- CS
0108  c7066304d403   mov    [0463],03d4     ; b zov  ©¡d¡c¡ adresa displeje=CGA
010e  8d2e0034       lea    bp,[3400]       ; BP <- 3400h inicializa‡n¡ tabulka znak–
0112  b300           mov    bl,00           ; blok fontu 0
0114  e83c00         call   0153            ; inicializace font– pro text. m¢d
0117  b302           mov    bl,02           ; blok fontu 2
0119  e83700         call   0153            ; inicializace font– pro text. m¢d
011c  8d2e0034       lea    bp,[3400]       ; BP <- 3400h inicial. tabulka znak–
0120  b301           mov    bl,01           ; blok fontu 1
0122  e82e00         call   0153            ; inicializace font– pro text. m¢d
0125  b303           mov    bl,03           ; blok fontu 3
0127  e82900         call   0153            ; inicializace font– pro text. m¢d
012a  8d366001       lea    si,[0160]       ; SI <- 0160h tabulka inicializace
012e  e80f21         call   2240            ; inicializace videoparametr–
0131  e84b22         call   237f            ; rozsv¡cen¡ displeje
0134  e86a01         call   02a1            ; instalace obsluhy INT 10h pro CGA
0137  bac803         mov    dx,03c8         ; adresa portu 03C8h
013a  b006           mov    al,06
013c  ee             out    dx,al           ;
013d  b2da           mov    dl,da           ; adresa portu 03DAh
013f  b001           mov    al,01           ; nastaven¡ v˜stupu FC0,nulov n¡ FC1
0141  ee             out    dx,al           ; nastaven¡ sign l– FC0, FC1
0142  80261004cf     and    [0410],cf       ; tabulka v˜pisu vybaven¡
0147  800e100420     or     [0410],20       ; inicializa‡n¡ videom¢d 80x25/color
014c  b80300         mov    ax,0003         ; funkce ‡ten¡ pozice kurzoru
014f  cd10           int    10              ; ‡ten¡ pozice a velikosti kurzoru
0151  f8             clc                    ; p©¡znak - instalace OK
0152  c3           * ret                    

; -----------------------------------------------------------------------------

                                          ;* inicializace font– pro text. m¢d

0153  b90001       * mov    cx,0100         ; po‡et znak– = 256
0156  b708           mov    bh,08           ; po‡et bajt– na znak = 8
0158  33d2           xor    dx,dx           ; offset tabulky znak–
015a  b80011         mov    ax,1100         ; na‡ten¡ gener toru znak– EGA
015d  cd10           int    10              
015f  c3             ret                    
; -----------------------------------------------------------------------------

                                          ;* tabulka pro inicializaci CGA

0160   00 03 00 03 21 70 4F 5C 2F 5F 07 04 11 00 07 06   ....!pO\/_......
0170   07 00 00 00 00 E1 24 C7 28 08 E0 F0 83 FF 00 01   ......$.(.......
0180   02 03 04 05 14 07 38 39 3A 3B 3C 3D 3E 3F 00 00   ......89:;<=>?..
0190   0F 00 00 00 00 00 00 10 0E 00 FF F6 06 87 04 02   ................

; -----------------------------------------------------------------------------
                                          ;* nastaven¡ obsluhy sekund rn¡ho MDA

019b  f606870402   * test   [0487],02       ; statut ©¡zen¡ video
01a0  7526           jnz    01c8            
01a2  a08804         mov    al,[0488]       ; statut ©¡zen¡ video - vy¨¨¡ bajt
01a5  240e           and    al,0e           ; nastaven¡ p©ep¡na‡– DIL
01a7  3c08           cmp    al,08           ;
01a9  7404           jz     01af            
01ab  3c02           cmp    al,02           
01ad  7517           jnz    01c6            ; chyba
01af  b800b0       * mov    ax,b000         ; segment pro MDA
01b2  8ec0           mov    es,ax           
01b4  33ff           xor    di,di           ; offset za‡ tku videopamˆti
01b6  268b05         mov    ax,es:[di]      ; slovo na za‡ tku videopamˆti
01b9  f6d0           not    al
01bb  268905         mov    es:[di],ax      ; negace slova
01be  263b05         cmp    ax,es:[di]      ; byl obsah ulo‘en spr vnˆ ?
01c1  26f615         not    b/es:[di]       
01c4  7502           jnz    01c8
01c6  f9           * stc
01c7  c3             ret                    

01c8  bac803       * mov    dx,03c8
01cb  b000           mov    al,00           
01cd  8d364702       lea    si,[0247]       
01d1  f606870402     test   [0487],02       ; statut ©¡zen¡ video
01d6  7507           jnz    01df            
01d8  8d360c02       lea    si,[020c]       
01dc  b080           mov    al,80           
01de  ee             out    dx,al           
01df  8ad8           mov    bl,al           
01e1  800e870402     or     [0487],02       ; statut ©¡zen¡ video - je MDA
01e6  800e100430     or     [0410],30       ; tabulka v˜pisu vybaven¡ - je MONO
01eb  b80700         mov    ax,0007         
01ee  cd10           int    10              ; nastaven¡ videom¢du 7 (MDA)
01f0  8cc8           mov    ax,cs           
01f2  8ec0           mov    es,ax           
01f4  e84920         call   2240            
01f7  e88521         call   237f            ; rozsv¡cen¡ displeje
01fa  e8a400         call   02a1            ; instalace obsluhy INT 10h pro CGA
01fd  8ac3           mov    al,bl           
01ff  0c05           or     al,05           
0201  ee             out    dx,al           
0202  b80700         mov    ax,0007         
0205  cd10           int    10              ; nastaven¡ videom¢du 7 (MDA)
0207  e87800         call   0282            
020a  f8             clc                    
020b  c3             ret                    

0200   05 EE B8 07 00 CD 10 E8 78 00 F8 C3 00 03 00 03   ........x.......
0210   AC 60 4F 56 3A 51 60 70 1F 00 0D 0B 0C 00 00 00   .`OV:Q`p........
0220   00 5E 2E 5D 28 0D 5E 6E A3 FF 00 07 07 07 07 07   .^.](.^n........
0230   07 07 00 3F 3F 3F 3F 3F 3F 3F 04 00 0F 00 00 00   ...???????......
0240   00 00 00 10 0A 00 FF 00 03 00 03 A4 60 4F 56 3A   ............`OV:
0250   51 60 70 1F 00 0D 0B 0C 00 00 00 00 5E 2E 5D 28   Q`p.........^.](
0260   0D 5E 6E A3 FF 00 08 08 08 08 08 08 08 00 18 18   .^n.............
0270   18 18 18 18 18 04 00 0F 00 00 00 00 00 00 10 0A   ................
0280   00 FF A1 70 00 A3 A4 04 A1 72 00 A3 A6 04 FA C7   ...p.....r......


027e  100a           adc    [bp+si],cl
0280  00ff           add    bh,bh           
; -----------------------------------------------------------------------------
                                          ;* instalace obsluhy INT 1Ch

0282  a17000       * mov    ax,[0070]       ; offset adresy INT 1Ch
0285  a3a404         mov    [04a4],ax       ; £schova adresy INT 1Ch
0288  a17200         mov    ax,[0072]       ; segment adresy INT 1Ch
028b  a3a604         mov    [04a6],ax       ; £schova adresy INT 1Ch
028e  fa             cli                    ; z kaz p©eru¨en¡
028f  c7067000da10   mov    [0070],10da     ; vlastn¡ obsluha INT 1Ch
0295  8c0e7200       mov    [0072],cs       ; segment adresy obsluhy INT 1Ch
0299  fb             sti                    ; povolen¡ p©eru¨en¡
029a  c706a2044866   mov    [04a2],6648     ;
02a0  c3             ret                    
; -----------------------------------------------------------------------------
                                          ;* instalace obsluhy INT 10h pro CGA
02a1  fa           * cli                    ; z kaz p©eru¨en¡
02a2  c70640004011   mov    [0040],1140     ; adresa obsluhy displeje CGA
02a8  8c0e4200       mov    [0042],cs       ; segment adresy obsluhy CGA
02ac  fb             sti                    ; povolen¡ p©eru¨en¡
02ad  c3             ret                    

; -----------------------------------------------------------------------------
;     Instalace displeje
; -----------------------------------------------------------------------------

                                          ;* ztmaven¡ displeje
02ae  b000           mov    al,00
02b0  e80202         call   04b5            ; ??? nastaven¡ portu 03c8h a 03c6h
02b3  baba03         mov    dx,03ba         ; stavov˜ registr MDA
02b6  ec             in     al,dx           ; synchronizace registr– pro CGA
02b7  bada03         mov    dx,03da         ; stavov˜ registr CGA
02ba  ec             in     al,dx           ; synchronizace registr– pro MDA
02bb  bac003         mov    dx,03c0         ; ©¡d¡c¡ port EGA
02be  33c0           xor    ax,ax           ; AX <- 0000
02c0  ee             out    dx,al           ;

                                          ;* instalace INT 24h a INT 10h
02c1  fa             cli                    ; z kaz p©eru¨en¡
02c2  c706080165f0   mov    [0108],f065     ; INT 42h (offset stand.obsluhy CGA)
02c8  c7060a0100f0   mov    [010a],f000     ; segment standardn¡ obsluhy CGA
02ce  c70640008911   mov    [0040],1189     ; vstupn¡ bod obsluhy INT 10h
02d4  8c0e4200       mov    [0042],cs       ; segment pro INT 10h
02d8  fb             sti                    ; povolen¡ p©eru¨en¡

                                          ;* ukazatel graf. znak– INT 1fh
02d9  c7067c000038   mov    [007c],3800     ; ukazatel tab. znak– EGA (INT 1FH)
02df  8c0e7e00       mov    [007e],cs       ; segment ukazatele znak– EGA

                                          ;* ukazatel inic. fontu EGA INT 43h
02e3  c7060c010034   mov    [010c],3400     ; offset inicializa‡n¡ho fontu EGA
02e9  8c0e0e01       mov    [010e],cs       ; segment inicializa‡n¡ho fontu EGA

                                          ;* ukazatel tabulky videoparametr–
02ed  8d06c804       lea    ax,[04c8]       ; tabulka videoparametr– EGA
02f1  f606a10420     test   [04a1],20       ; je prim rn¡ displej ?
02f6  7404           jz     02fc            ; je
02f8  8d06e404       lea    ax,[04e4]       ; jinak standardn¡ videoparametry
02fc  a3a804       * mov    [04a8],ax       ; ukazatel na videoparametry EGA
02ff  8c0eaa04       mov    [04aa],cs       ; segment ukazatele videoparametr–
0303  c606870474     mov    [0487],74       ; statut ©¡zen¡ video

                                          ;* zji¨tˆn¡ stavu
0308  e80c00         call   0317            ; na‡ten¡ nastaven¡ p©ep¡na‡– DIL1-4
030b  e83300         call   0341            ; ‡ten¡ stavu sign l– FEAT0 a FEAT1

                                          ;* inicializace videom¢du
030e  e89f00         call   03b0            ; prvn¡ inicializace videom¢du
0311  80268704ef     and    [0487],ef       ; status ©¡zen¡ video
0316  c3             ret                    
; -----------------------------------------------------------------------------
;         Na‡ten¡ stavu p©ep¡na‡– DIL 1-4
; -----------------------------------------------------------------------------
                                          ;* na‡ten¡ nastaven¡ p©ep¡na‡– DIL 1-4
0317  32e4           xor    ah,ah           ; AH <- 00 st©ada‡ pro ‡ten¡ DIL
0319  b00d           mov    al,0d           ; nastaven¡ taktu 11 (=DIL 1)
031b  bac203         mov    dx,03c2         ; ©¡dic¡ registr EGA
031e  b90400         mov    cx,0004         ; po‡et bit– p©ep¡na‡– DIL k na‡ten¡
0321  ee           * out    dx,al           ; nastaven¡ ‡ten¡ bitu p©ep. DIL
0322  8ad8           mov    bl,al           ; £schova nastaven¡ ‡¡ta‡e DIL
0324  ec             in     al,dx           ; ‡ten¡ stavu p©ep¡na‡e DIL
0325  2410           and    al,10           ; stav p©ep¡na‡e DIL
0327  0ae0           or     ah,al           ; ulo‘en¡ na‡ten‚ho p©ep¡na‡e DIL
0329  d0ec           shr    ah,1            ; st©ada‡ DIL / 2
032b  8ac3           mov    al,bl           ; v˜stup pro nastaven¡ DIL
032d  2c04           sub    al,04           ; sn¡‘en¡ ‡¡ta‡e DIL (0Dh,9,5,1)
032f  e2f0           loop   0321            ; na‡ten¡ dal¨¡ho p©ep¡na‡e DIL
0331  8ac4           mov    al,ah           ; nov‚ nastaven¡ p©ep¡na‡– DIL
0333  80268804f0     and    [0488],f0       ; statut ©¡zen¡ video-nul.p©ep. DIL
0338  08068804       or     [0488],al       ; nov‚ nastaven¡ stavy p©ep¡na‡– DIL
033c  0806a104       or     [04a1],al       ; nastaven¡ p©ep¡na‡– DIL
0340  c3             ret                    
; -----------------------------------------------------------------------------
;     €ten¡ stavu sign l– FEAT0 a FEAT1 pro FC0 a FC1
; -----------------------------------------------------------------------------
0341  b001           mov    al,01           ; sign l FC0
0343  e81700         call   035d            ; nastaven¡ sign lu FC0
0346  d0e8           shr    al,1            ; sign ly FEAT0 a FEAT1 do bit– 4,5
0348  8ae0           mov    ah,al           ; £schova
034a  b002           mov    al,02           ; sign l FC1
034c  e80e00         call   035d            ; nastaven¡ sign lu FC1
034f  d0e0           shl    al,1            ; sign ly FEAT0 a FEAT1 do bit– 6,7
0351  0ac4           or     al,ah           ; slou‡en¡ se stavem z FC0
0353  802688040f     and    [0488],0f       ; nulov n¡ bit–
0358  08068804       or     [0488],al       ; statut ©¡zen¡ video - vy¨¨¡ bajt
035c  c3             ret                    
; -----------------------------------------------------------------------------
;     Nastaven¡ sign lu FC0 a ‡ten¡ sign l– FEAT0 a FEAT1
; -----------------------------------------------------------------------------
035d  bada03         mov    dx,03da         ; stavov˜ registr CGA
0360  ee             out    dx,al           ; nastaven¡ v˜stup– FC0 a FC1
0361  bac203         mov    dx,03c2         ; ©¡d¡c¡ registr EGA
0364  ec             in     al,dx           ; p©e‡ten¡ sign l– FEAT0 a FEAT1
0365  2460           and    al,60           ; stav FEAT0 a FEAT1
0367  c3             ret                    
; -----------------------------------------------------------------------------
;     —vodn¡ inicializa‡n¡ tabulky videom¢d–
; -----------------------------------------------------------------------------
                                          ;* 0: prim. MDA, sek. EGA barev. 40x25
0368                 db     0               ; p©¡znak barevn‚ho displeje
                     db     1               ; nastaven¡ ©¡d. registru 03c2h
                     db     10h             ; inicializa‡n¡ videom¢d EGA 40x25
                     db     1               ; videom¢d pro inicial. 40x25 EGA
                     db     30h             ; inicializa‡n¡ videom¢d MDA
                     db     7               ; videom¢d pro inicial. 80x25 MDA

036e                                      ;* 1: prim. MDA, sek. EGA barev. 80x25
                     db     0               ; p©¡znak barevn‚ho displeje
                     db     1               ; nastaven¡ ©¡d. registru 03c2h
                     db     20h             ; inicial. videom¢d EGA 80x25 barev.
                     db     3               ; videom¢d pro inicial. 80x25 EGA
                     db     30h             ; inicializa‡n¡ videom¢d MDA 80x25
                     db     7               ; videom¢d pro inicial. 80x25 MDA

0374                                      ;* 2: prim. MDA, sek. EGA s ECM (CGA)
                     db     0               ; p©¡znak barevn‚ho displeje
                     db     1               ; nastaven¡ ©¡d. registru 03c2h
                     db     20h             ; inicial. videom¢d EGA 80x25 barev.
                     db     3               ; videom¢d pro inicial. 80x25 EGA
                     db     30h             ; inicializa‡n¡ videom¢d MDA 80x25
                     db     7               ; videom¢d pro inicial. 80x25 MDA

037a                                      ;* 3: prim. MDA, sek. EGA s ECM (high)
                     db     0               ; p©¡znak barevn‚ho displeje
                     db     1               ; nastaven¡ ©¡d. registru 03c2h
                     db     20h             ; inicial. videom¢d EGA 80x25 barev.
                     db     3               ; videom¢d pro inicial. 80x25 EGA
                     db     30h             ; inicializa‡n¡ videom¢d MDA 80x25
                     db     7               ; videom¢d pro inicial. 80x25 MDA

0380                                      ;* 4: prim. CGA 40x25, sek. EGA mono
                     db     2               ; p©¡znak monochrom. displeje
                     db     0               ; nastaven¡ ©¡d. registru 03c2h
                     db     30h             ; inicial. videom¢d EGA 80x25 mono
                     db     7               ; videom¢d pro inicial. 80x25 EGA
                     db     10h             ; inicializa‡n¡ videom¢d CGA 40x25
                     db     1               ; videom¢d pro inicial. 40x25 CGA

0386                                      ;* 5: prim. CGA 80x25, sek. EGA mono
                     db     2               ; p©¡znak monochrom. displeje
                     db     0               ; nastaven¡ ©¡d. registru 03c2h
                     db     30h             ; inicial. videom¢d EGA 80x25 mono
                     db     7               ; videom¢d pro inicial. 80x25 EGA
                     db     20h             ; inicializa‡n¡ videom¢d CGA 80x25
                     db     3               ; videom¢d pro inicial. 80x25 CGA

038c                                      ;* 6: prim. EGA 40x25 barev., sek. MDA
                     db     0               ; p©¡znak barevn‚ho displeje
                     db     1               ; nastaven¡ ©¡d. registru 03c2h
                     db     30h             ; inicial. videom¢d MDA 80x25 mono
                     db     7               ; videom¢d pro inicial. 80x25 MDA
                     db     10h             ; inicializa‡n¡ videom¢d EGA 40x25
                     db     1               ; videom¢d pro inicial. 40x25 EGA

0392                                      ;* 7: prim. EGA 80x25 barev., sek. MDA
                     db     0               ; p©¡znak barevn‚ho displeje
                     db     1               ; nastaven¡ ©¡d. registru 03c2h
                     db     30h             ; inicial. videom¢d MDA 80x25 mono
                     db     7               ; videom¢d pro inicial. 80x25 MDA
                     db     20h             ; inicializa‡n¡ videom¢d EGA 80x25
                     db     3               ; videom¢d pro inicial. 80x25 EGA

0398                                      ;* 8: prim. EGA s ECM (CGA), sek. MDA
                     db     0               ; p©¡znak barevn‚ho displeje
                     db     1               ; nastaven¡ ©¡d. registru 03c2h
                     db     30h             ; inicial. videom¢d MDA 80x25 mono
                     db     7               ; videom¢d pro inicial. 80x25 MDA
                     db     20h             ; inicializa‡n¡ videom¢d EGA 80x25
                     db     3               ; videom¢d pro inicial. 80x25 EGA

039e                                      ;* 9: prim. EGA s ECM (high), sek. MDA
                     db     0               ; p©¡znak barevn‚ho displeje
                     db     1               ; nastaven¡ ©¡d. registru 03c2h
                     db     30h             ; inicial. videom¢d MDA 80x25 mono
                     db     7               ; videom¢d pro inicial. 80x25 MDA
                     db     20h             ; inicializa‡n¡ videom¢d EGA 80x25
                     db     3               ; videom¢d pro inicial. 80x25 EGA

03a4                                      ;* 0ah: prim. EGA mono, sek. CGA 40x25
                     db     2               ; p©¡znak monochromatick‚ho displeje
                     db     0               ; nastaven¡ ©¡d. registru 03c2h
                     db     10h             ; inicial. videom¢d CGA 40x25 mono
                     db     1               ; videom¢d pro inicial. 40x25 CGA
                     db     30h             ; inicializa‡n¡ videom¢d EGA mono
                     db     7               ; videom¢d pro inicial. EGA mono

03aa                                      ;* 0bh: prim. EGA mono, sek. CGA 80x25
                     db     2               ; p©¡znak monochromatick‚ho displeje
                     db     0               ; nastaven¡ ©¡d. registru 03c2h
                     db     20h             ; inicial. videom¢d CGA 80x25 mono
                     db     3               ; videom¢d pro inicial. 80x25 CGA
                     db     30h             ; inicializa‡n¡ videom¢d EGA mono
                     db     7               ; videom¢d pro inicial. EGA mono
; -----------------------------------------------------------------------------
;     Prvn¡ inicializace videom¢du
; -----------------------------------------------------------------------------
                                            ; prvn¡ inicializace videom¢du

                                          ;* kontrola nastaven¡ p©ep¡na‡–
03b0  a08804         mov    al,[0488]       ; statut ©¡zen¡ video - vy¨¨¡ bajt
03b3  250f00         and    ax,000f         ; p©ep¡na‡e DIL 1 a‘ DIL 4
03b6  3c0b           cmp    al,0b           ; ‡¡slo kombinace monitor– na DIL
03b8  7731           ja     03eb            ; chybn‚ nastaven¡ p©ep¡na‡–

                                          ;* adresa v tabulce
03ba  8d366803       lea    si,[0368]       ; £vodn¡ inicializa‡n¡ tabulka
03be  d1e0           shl    ax,1            ; ‡¡slo mombinace DIL * 2
03c0  03f0           add    si,ax
03c2  d1e0           shl    ax,1            ; ‡¡slo * 4
03c4  03f0           add    si,ax           ; adresa v tabulce (po 6 bajtech)

                                          ;* p©¡znak monochromatick‚ho displeje
03c6  2eac           cs:lodsb               ; p©¡znak monochrom. displeje
03c8  80268704fd     and    [0487],fd       ; zru¨en¡ p©¡znaku monochrom. displ.
03cd  08068704       or     [0487],al       ; p©¡znak monochromn¡ho displeje

                                          ;* ©¡dic¡ registr displeje (03c2h)
03d1  2eac           cs:lodsb               ; nastaven¡ ©¡dic¡ho registru displ.
03d3  bac203         mov    dx,03c2         ; ©¡d¡c¡ registr EGA
03d6  ee             out    dx,al           ; nastaven¡ ©¡zen¡ podle m¢du

03d7  e80000         call   03da            ; inicializace videom¢du

                                          ;* inicializa‡n¡ videom¢d
03da  2eac           cs:lodsb               ; inicializa‡n¡ videom¢d
03dc  80261004cf     and    [0410],cf       ; zru¨en¡ nastaven¡ videom¢du
03e1  08061004       or     [0410],al       ; nastaven¡ inicializa‡n¡ho videom¢du

                                          ;* videom¢d pro inicializaci
03e5  2eac           cs:lodsb               ; m¢d pro inicializace displeje
03e7  32e4           xor    ah,ah
03e9  cd10           int    10              ; inicializace videom¢du

03eb  c3           * ret
; -----------------------------------------------------------------------------
;         —vodn¡ text p©i studen‚m startu
; -----------------------------------------------------------------------------
03ec               db     13,10
                   db     'GEMINI VC-001 EGA BIOS, Version V2.4',13,10
                   db     'Copyright (C) Gemini Technology Inc 1987-1988',13,10
                   db     'Licenced to: Puretek Industrial CO., LTD. ',13,10
                   db     13,10,0

0472               db     37 dup(0)
; -----------------------------------------------------------------------------
;         Zobrazen¡ £vodn¡ho textu BIOS EGA
; -----------------------------------------------------------------------------
                                          ;* zobrazen¡ £vodn¡ho textu BIOS EGA
0497  813e72043412   cmp    [0472],1234     ; je hork˜ start ?
049d  7415           jz     04b4            ; je hork˜ start - text se nezobraz¡
049f  8d36ec03       lea    si,[03ec]       ; £vodn¡ text
04a3  2eac         * cs:lodsb               ; na‡ten¡ znaku k zobrazen¡
04a5  0ac0           or     al,al           ; je ji‘ konec textu ?
04a7  7406           jz     04af            ; je konec textu
04a9  b40e           mov    ah,0e           ; funkce tisku znaku
04ab  cd10           int    10              ; zobrazen¡ znaku £vodn¡ho textu
04ad  ebf4           jmp    short 04a3      ; zobrazen¡ dal¨¡ho znaku
04af  b0fa         * mov    al,fa           ; doba prodlevy
04b1  e8111f         call   23c5            ; prodleva p©i zobrazen¡ textu
04b4  c3           * ret
; -----------------------------------------------------------------------------
;     ???
; -----------------------------------------------------------------------------
04b5  50             push   ax
04b6  bac803         mov    dx,03c8         ; registr EGA
04b9  b01c           mov    al,1c
04bb  ee             out    dx,al
04bc  bac603         mov    dx,03c6
04bf  58             pop    ax
04c0  ee             out    dx,al
04c1  bac803         mov    dx,03c8
04c4  b000           mov    al,00
04c6  ee             out    dx,al
04c7  c3             ret
; -----------------------------------------------------------------------------
                                          ;* tabulka videoparametr– EGA

04c8                 dd     0c000:052ah     ; ukazatel tabulky videoparametr–
04cc                 dd     0               ; ukazatel prostoru dynam. ulo‘en¡
                                            ; (zde se p©i inicializaci ukl daj¡
                                            ; barvy - 16 bajt–)
04d0                 dd     0               ; ukazatel pomoc. gener. text. znak–
04d4                 dd     0               ; ukazatel pomoc. gener. graf. znak–
04d8                 dd     0               ; rezervov no
04dc                 dd     0               ; rezervov no
04e0                 dd     0               ; rezervov no
; -----------------------------------------------------------------------------
                                          ;* tabulka videoparametr– EGA

04e4                 dd     0c000:0aeah     ; ukazatel tabulky videoparametr–
04e8                 dd     0               ; ukazatel prostoru dynam. ulo‘en¡
04ec                 dd     0               ; ukazatel pomoc. gener. text. znak–
04f0                 dd     0               ; ukazatel pomoc. gener. graf. znak–
04f4                 dd     0               ; rezervov no
04f8                 dd     0               ; rezervov no
04fc                 dd     0               ; rezervov no

0500                                      ;* tabulka nastav. registru m¢du 3d8h
                     db     2ch             ; videom¢d 0
                     db     28h             ; videom¢d 1
                     db     2dh             ; videom¢d 2
                     db     29h             ; videom¢d 3
                     db     2ah             ; videom¢d 4
                     db     2eh             ; videom¢d 5
                     db     1eh             ; videom¢d 6
                     db     29h             ; videom¢d 7

0500   2C 28 2D 29 2A 2E 1E 29 06 00 06 00 07 00 07 00   ,(-)*..)........
0510   05 00 05 00 04 00 05 00 00 00 00 00 00 00 00 00   ................
0520   00 00 05 00 06 00 04 00 04 00 28 18 08 00 08 0B   ..........(.....


                                            ; 052ah 0 text. 40x25/16 ¨ed 
                                            ; 056ah 1 text. 40x25/16 barevn˜
                                            ; 05aah 2 text. 80x25/16 ¨ed 
                                            ; 05eah 3 text. 80x25/16 barevn˜
                                            ; 062ah 4 graf. 320x200/4 barevn˜
                                            ; 066ah 5 graf. 320x200/4 ¨ed 
                                            ; 06aah 6 graf. 640x200/2
                                            ; 06eah 7 text. 80x25 mono
                                            ; 072ah 8 graf. 160x200/16 PCjr
                                            ; 076ah 9 graf. 320x200/16 PCjr
                                            ; 07aah 0ah graf. 640x200/4 PCjr
                                            ; 07eah 0bh vnit©n¡ EGA
                                            ; 082ah 0ch vnit©n¡ EGA
                                            ; 086ah 0dh graf. 320x200/16 barevn˜
                                            ; 08aah 0eh graf. 640x200/16 barevn˜
                                            ; 08eah (0fh graf. 640x350/mono)
                                            ; 092ah (10h graf. 640x350/16 barevn˜)
                                            ; 096ah 0fh graf. 640x350/mono
                                            ; 09aah 10h graf. 640x350/16 barevn˜
                                            ; 09eah 0 text.40x25/16 ¨ed  ECM hi
                                            ; 0a2ah 1 text.40x25/16 barev.ECM hi
                                            ; 0a6ah 2 text.80x25/16 ¨ed  ECM hi
                                            ; 0aaah 3 text.80x25/16 barev.ECM hi

                                            ; 0aeah 0 text. 40x25/16 ¨ed 
                                            ; 0b2ah 1 text. 40x25/16 barevn˜
                                            ; 0b6ah 2 text. 80x25/16 ¨ed 
                                            ; 0baah 3 text. 80x25/16 barevn˜
                                            ; 0beah 4 graf. 320x200/4 barevn˜
                                            ; 0c2ah 5 graf. 320x200/4 ¨ed 
                                            ; 0c6ah 6 graf. 640x200/2
                                            ; 0caah 7 text. 80x25 mono
                                            ; 0ceah 8 graf. 160x200/16 PCjr
                                            ; 0d2ah 9 graf. 320x200/16 PCjr
                                            ; 0d6ah 0ah graf. 640x200/4 PCjr
                                            ; 0daah 0bh vnit©n¡ EGA
                                            ; 0deah 0ch vnit©n¡ EGA
                                            ; 0e2ah 0dh graf. 320x200/16 barevn˜
                                            ; 0e6ah 0eh graf. 640x200/16 barevn˜
                                            ; 0eaah (0fh graf. 640x350/mono)
                                            ; 0eeah (10h graf. 640x350/16 barevn˜
                                            ; 0f2ah 0fh graf. 640x350/mono
                                            ; 0f6ah 10h graf. 640x350/16 barevn˜
                                            ; 0faah 0 text.40x25/16 ¨ed  ECM hi
                                            ; 0feah 1 text.40x25/16 barev.ECM hi
                                            ; 102ah 2 text.80x25/16 ¨ed  ECM hi
                                            ; 106ah 3 text.80x25/16 barev.ECM hi

; -----------------------------------------------------------------------------
;     Videom¢d 0: 40x25 text barevn˜
; -----------------------------------------------------------------------------
þ                                          ;* m¢d 0: 40x25/textov˜
052a                 db     40              ; po‡et znak– na © dek
052b                 db     24              ; ‡¡slo posledn¡ho © dku
052c                 db     8               ; po‡et linek na znak
052d                 dw     0800h           ; d‚lka zobrazen‚ho bufferu str nky
                                          ;* nastaven¡ registr– 03c4h:
052f                 db     0bh             ; reg.1 - taktov n¡
0530                 db     3               ; reg.2 - maska z pisu
0531                 db     0               ; reg.3 - mapa znak–
0532                 db     3               ; reg.4 - m¢d pamˆti
0533                 db     23h             ; reg.03c2h - spec. ©¡zen¡
                                          ;* nastaven¡ registr– 03d4h:
0534                 db     55              ; reg.0 - d‚lka hor.synr.
0535                 db     39              ; reg.1 - posledn¡ zobr.znak
0536                 db     45              ; reg.2 - po‡ t.horiz.zatemn.
0537                 db     55              ; reg.3 - konec horiz.zatemn.
0538                 db     49              ; reg.4 - po‡ t.hor.zpˆt.bˆhu
0539                 db     21              ; reg.5 - konec horiz.zp.bˆhu
053a                 db     4               ; reg.6 - po‡ t.zob.vert.linky
053b                 db     17              ; reg.7 - dopl¤uj¡c¡ bity 8
053c                 db     0               ; reg.8 - 1.© dek po zpˆt.bˆhu
053d                 db     7               ; reg.9 - ‡¡s.posl.linky znaku
053e                 db     6               ; reg.10 - po‡.linka kurzoru
053f                 db     7               ; reg.11 - konc.linka kurzoru
0540                 db     0               ; reg.12 - adr.VRAM HIGH
0541                 db     0               ; reg.13 - adr.VRAM LOW
0542                 db     0               ; reg.14 - adr.kurzoru HIGH
0543                 db     0               ; reg.15 - adr.kurzoru LOW
0544                 db     0e1h            ; reg.16 - za‡.vert.zp.bˆhu
0545                 db     36              ; reg.17 - konec vert.zp.bˆhu
0546                 db     0c7h            ; reg.18 - konc. zobr.linka
0547                 db     20              ; reg.19 - vert.vyst©edˆn¡
0548                 db     8               ; reg.20 - poloha podtr‘en¡
0549                 db     0e0h            ; reg.21 - za‡.vert.zatemnˆn¡
054a                 db     0f0h            ; reg.22 - konec vert.zatemnˆn¡
054b                 db     0a3h            ; reg.23 - ©¡zen¡ m¢du
054c                 db     0ffh            ; reg.24 - porovn n¡ linek
                                          ;* nastaven¡ registr– 03C0h
054d                 db     0               ; reg.0 - barva 0
054e                 db     1               ; reg.1 - barva 1
054f                 db     2               ; reg.2 - barva 2
0550                 db     3               ; reg.3 - barva 3
0551                 db     4               ; reg.4 - barva 4
0552                 db     5               ; reg.5 - barva 5
0553                 db     6               ; reg.6 - barva 6
0554                 db     7               ; reg.7 - barva 7
0555                 db     10h             ; reg.8 - barva 8
0556                 db     11h             ; reg.9 - barva 9
0557                 db     12h             ; reg.10 - barva 10
0558                 db     13h             ; reg.11 - barva 11
0559                 db     14h             ; reg.12 - barva 12
055a                 db     15h             ; reg.13 - barva 13
055b                 db     16h             ; reg.14 - barva 14
055c                 db     17h             ; reg.15 - barva 15
055d                 db     8               ; reg.10h - ©¡zen¡ m¢du
055e                 db     0               ; reg.11h - barva okol¡ (border)
055f                 db     0fh             ; reg.12h - mo‘n‚ roviny barev
0560                 db     0               ; reg.13h - posun horizont. bod–
                                          ;* nastaven¡ registr– 03ceh
0561                 db     0               ; reg.0 - roviny pro z pis
0562                 db     0               ; reg.1 - mo‘n‚ nastav./reset.
0563                 db     0               ; reg.2 - barvy pro ‡ten¡
0564                 db     0               ; reg.3 - rotace dat, funkce z pisu
0565                 db     0               ; reg.4 - volba ‡tec¡ mapy
0566                 db     10h             ; reg.5 - registr m¢du
0567                 db     0eh             ; reg.6 - nast.graf.©adi‡e
0568                 db     0               ; reg.7 - z kaz maskov n¡ barev
0569                 db     0ffh            ; reg.8 - bitov  maska



0
0530   03 00 03 23 37 27 2D 37 31 15 04 11 00 07 06 07   ...#7'-71.......
0540   00 00 00 00 E1 24 C7 14 08 E0 F0 A3 FF 00 01 02   .....$..........
0550   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
0560   00 00 00 00 00 00 10 0E 00 FF 28 18 08 00 08 0B   ..........(.....

                                          ;* m¢d 1: 40x25 textov˜

0570   03 00 03 23 37 27 2D 37 31 15 04 11 00 07 06 07   ...#7'-71.......
0580   00 00 00 00 E1 24 C7 14 08 E0 F0 A3 FF 00 01 02   .....$..........
0590   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
05A0   00 00 00 00 00 00 10 0E 00 FF 50 18 08 00 10 01   ..........P.....

                                          ;* m¢d 2: 80x25 textov˜

05B0   03 00 03 23 70 4F 5C 2F 5F 07 04 11 00 07 06 07   ...#pO\/_.......
05C0   00 00 00 00 E1 24 C7 28 08 E0 F0 A3 FF 00 01 02   .....$.(........
05D0   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
05E0   00 00 00 00 00 00 10 0E 00 FF 50 18 08 00 10 01   ..........P.....

                                          ;* m¢d 3: 80x25 textov˜

05F0   03 00 03 23 70 4F 5C 2F 5F 07 04 11 00 07 06 07   ...#pO\/_.......
0600   00 00 00 00 E1 24 C7 28 08 E0 F0 A3 FF 00 01 02   .....$.(........
0610   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
0620   00 00 00 00 00 00 10 0E 00 FF 28 18 08 00 40 0B   ..........(...@.

                                          ;* m¢d 4: 320x200 grafick˜

0630   03 00 02 23 37 27 2D 37 30 14 04 11 00 01 00 00   ...#7'-70.......
0640   00 00 00 00 E1 24 C7 14 00 E0 F0 A2 FF 00 13 15   .....$..........
0650   17 02 04 06 07 10 11 12 13 14 15 16 17 01 00 03   ................
0660   00 00 00 00 00 00 30 0F 00 FF 28 18 08 00 40 0B   ......0...(...@.

                                          ;* m¢d 5: 320x200 grafick˜

0670   03 00 02 23 37 27 2D 37 30 14 04 11 00 01 00 00   ...#7'-70.......
0680   00 00 00 00 E1 24 C7 14 00 E0 F0 A2 FF 00 13 15   .....$..........
0690   17 02 04 06 07 10 11 12 13 14 15 16 17 01 00 03   ................
06A0   00 00 00 00 00 00 30 0F 00 FF 50 18 08 00 40 01   ......0...P...@.

                                          ;* m¢d 6: 640x200 grafick˜

06B0   01 00 06 23 70 4F 59 2D 5E 06 04 11 00 01 00 00   ...#pOY-^.......
06C0   00 00 00 00 E0 23 C7 28 00 DF EF C2 FF 00 17 17   .....#.(........
06D0   17 17 17 17 17 17 17 17 17 17 17 17 17 01 00 01   ................
06E0   00 00 00 00 00 00 00 0D 00 FF 50 18 0E 00 10 00   ..........P.....

                                          ;* m¢d 7: 80x25 textov˜ MDA

06F0   03 00 03 A6 60 4F 56 3A 51 60 70 1F 00 0D 0B 0C   ....`OV:Q`p.....
0700   00 00 00 00 5E 2E 5D 28 0D 5E 6E A3 FF 00 08 08   ....^.](.^n.....
0710   08 08 08 08 08 10 18 18 18 18 18 18 18 0E 00 0F   ................
0720   08 00 00 00 00 00 10 0A 00 FF 28 18 08 00 40 00   ..........(...@.

                                          ;* m¢d 8: 160x200 grafick˜ PCjr

0730   00 00 03 23 37 27 2D 37 31 15 04 11 00 07 06 07   ...#7'-71.......
0740   00 00 00 00 E1 24 C7 14 08 E0 F0 A3 FF 00 01 02   .....$..........
0750   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
0760   00 00 00 00 00 00 10 0E 00 FF 28 18 08 00 40 00   ..........(...@.

                                          ;* m¢d 9: 320x200 grafick˜ PCjr

0770   00 00 03 23 37 27 2D 37 31 15 04 11 00 07 06 07   ...#7'-71.......
0780   00 00 00 00 E1 24 C7 14 08 E0 F0 A3 FF 00 01 02   .....$..........
0790   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
07A0   00 00 00 00 00 00 10 0E 00 FF 28 18 08 00 40 00   ..........(...@.

                                          ;* m¢d 10: 640x200 grafick˜ PCjr

07B0   00 00 03 23 37 27 2D 37 31 15 04 11 00 07 06 07   ...#7'-71.......
07C0   00 00 00 00 E1 24 C7 14 08 E0 F0 A3 FF 00 01 02   .....$..........
07D0   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
07E0   00 00 00 00 00 00 10 0E 00 FF 50 18 08 00 10 01   ..........P.....

                                          ;* m¢d 11: intern¡ EGA

07F0   04 00 07 23 70 4F 5C 2F 5F 07 04 11 00 07 06 07   ...#pO\/_.......
0800   00 00 00 00 E1 24 C7 28 08 E0 F0 A3 FF 00 00 00   .....$.(........
0810   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0F   ................
0820   00 00 00 00 00 00 00 04 00 FF 50 18 0E 00 10 00   ..........P.....

                                          ;* m¢d 12: intern¡ EGA

0830   04 00 07 A6 60 4F 56 3A 51 60 70 1F 00 0D 0B 0C   ....`OV:Q`p.....
0840   00 00 00 00 5E 2E 5D 28 0D 5E 6E A3 FF 00 00 00   ....^.](.^n.....
0850   00 00 00 00 00 00 00 00 00 00 00 00 00 0E 00 0F   ................
0860   08 00 00 00 00 00 00 04 00 FF 28 18 08 00 20 0B   ..........(... .

                                          ;* m¢d 13: 320x200/16 grafick˜ EGA

0870   0F 00 06 23 37 27 2D 37 30 14 04 11 00 00 00 00   ...#7'-70.......
0880   00 00 00 00 E1 24 C7 14 00 E0 F0 E3 FF 00 01 02   .....$..........
0890   03 04 05 06 07 10 11 12 13 14 15 16 17 01 00 0F   ................
08A0   00 00 00 00 00 00 00 05 0F FF 50 18 08 00 40 01   ..........P...@.

                                          ;* m¢d 14: 640x200/16 grafick˜ EGA

08B0   0F 00 06 23 70 4F 59 2D 5E 06 04 11 00 00 00 00   ...#pOY-^.......
08C0   00 00 00 00 E0 23 C7 28 00 DF EF E3 FF 00 01 02   .....#.(........
08D0   03 04 05 06 07 10 11 12 13 14 15 16 17 01 00 0F   ................
08E0   00 00 00 00 00 00 00 05 0F FF 50 18 0E 00 80 05   ..........P.....

;                                          ;* m¢d 15: 640x350/2 grafick˜ EGA

08F0   0F 00 00 A2 60 4F 56 1A 50 E0 70 1F 00 00 00 00   ....`OV.P.p.....
0900   00 00 00 00 5E 2E 5D 14 0D 5E 6E 8B FF 00 08 00   ....^.]..^n.....
0910   00 18 18 00 00 00 08 00 00 00 18 00 00 0B 00 05   ................
0920   00 00 00 00 00 00 10 07 0F FF 50 18 0E 00 80 05   ..........P.....

;                                          ;* m¢d 16: 640x350/16 grafick˜ EGA

0930   0F 00 00 A7 5B 4F 53 17 50 BA 6C 1F 00 00 00 00   ....[OS.P.l.....
0940   00 00 00 00 5E 2B 5D 14 0F 5F 0A 8B FF 00 01 00   ....^+].._......
0950   00 04 07 00 00 00 01 00 00 04 07 00 00 01 00 05   ................
0960   00 00 00 00 00 00 10 07 0F FF 50 18 0E 00 80 01   ..........P.....

                                          ;* m¢d 15: 640x350/2 grafick˜ EGA

0970   0F 00 06 A2 60 4F 56 3A 50 60 70 1F 00 00 00 00   ....`OV:P`p.....
0980   00 00 00 00 5E 2E 5D 28 0D 5E 6E E3 FF 00 08 00   ....^.](.^n.....
0990   00 18 18 00 00 00 08 00 00 00 18 00 00 0B 00 05   ................
09A0   00 00 00 00 00 00 00 05 0F FF 50 18 0E 00 80 01   ..........P.....

                                          ;* m¢d 16: 640x350/16 grafick˜ EGA

09B0   0F 00 06 A7 5B 4F 53 37 52 00 6C 1F 00 00 00 00   ....[OS7R.l.....
09C0   00 00 00 00 5E 2B 5E 28 0F 5F 0A E3 FF 00 01 02   ....^+^(._......
09D0   03 04 05 14 07 38 39 3A 3B 3C 3D 3E 3F 01 00 0F   .....89:;<=>?...
09E0   00 00 00 00 00 00 00 05 0F FF 28 18 0E 00 08 0B   ..........(.....

                                          ;* m¢d 0: 40x25

09F0   03 00 03 A7 2D 27 2B 2D 29 6D 6C 1F 00 0D 06 07   ....-'+-)ml.....
0A00   00 00 00 00 5E 2B 5D 14 0F 5E 0A A3 FF 00 01 02   ....^+]..^......
0A10   03 04 05 14 07 38 39 3A 3B 3C 3D 3E 3F 0A 00 0F   .....89:;<=>?...
0A20   00 00 00 00 00 00 10 0E 00 FF 28 18 0E 00 08 0B   ..........(.....

                                          ;* m¢d 1: 40x25

0A30   03 00 03 A7 2D 27 2B 2D 29 6D 6C 1F 00 0D 06 07   ....-'+-)ml.....
0A40   00 00 00 00 5E 2B 5D 14 0F 5E 0A A3 FF 00 01 02   ....^+]..^......
0A50   03 04 05 14 07 38 39 3A 3B 3C 3D 3E 3F 0A 00 0F   .....89:;<=>?...
0A60   00 00 00 00 00 00 10 0E 00 FF 50 18 0E 00 10 01   ..........P.....

                                          ;* m¢d 2: 80x25

0A70   03 00 03 A7 5B 4F 53 37 51 5B 6C 1F 00 0D 06 07   ....[OS7Q[l.....
0A80   00 00 00 00 5E 2B 5D 28 0F 5E 0A A3 FF 00 01 02   ....^+](.^......
0A90   03 04 05 14 07 38 39 3A 3B 3C 3D 3E 3F 0A 00 0F   .....89:;<=>?...
0AA0   00 00 00 00 00 00 10 0E 00 FF 50 18 0E 00 10 01   ..........P.....

                                          ;* m¢d 3: 80x25

0AB0   03 00 03 A7 5B 4F 53 37 51 5B 6C 1F 00 0D 06 07   ....[OS7Q[l.....
0AC0   00 00 00 00 5E 2B 5D 28 0F 5E 0A A3 FF 00 01 02   ....^+](.^......
0AD0   03 04 05 14 07 38 39 3A 3B 3C 3D 3E 3F 0A 00 0F   .....89:;<=>?...
0AE0   00 00 00 00 00 00 10 0E 00 FF 28 18 08 00 08 0B   ..........(.....

; -----------------------------------------------------------------------------
0aea                                      ;* tabulka videoparametr–

0AF0   03 00 03 23 37 27 2D 37 31 15 04 11 00 07 06 07   ...#7'-71.......
0B00   00 00 00 00 E1 24 C7 14 08 E0 F0 A3 FF 00 01 02   .....$..........
0B10   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
0B20   00 00 00 00 00 00 10 0E 00 FF 28 18 08 00 08 0B   ..........(.....

0B30   03 00 03 23 37 27 2D 37 31 15 04 11 00 07 06 07   ...#7'-71.......
0B40   00 00 00 00 E1 24 C7 14 08 E0 F0 A3 FF 00 01 02   .....$..........
0B50   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
0B60   00 00 00 00 00 00 10 0E 00 FF 50 18 08 00 10 01   ..........P.....

0B70   03 00 03 23 70 4F 5C 2F 5F 07 04 11 00 07 06 07   ...#pO\/_.......
0B80   00 00 00 00 E1 24 C7 28 08 E0 F0 A3 FF 00 01 02   .....$.(........
0B90   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
0BA0   00 00 00 00 00 00 10 0E 00 FF 50 18 08 00 10 01   ..........P.....

0BB0   03 00 03 23 70 4F 5C 2F 5F 07 04 11 00 07 06 07   ...#pO\/_.......
0BC0   00 00 00 00 E1 24 C7 28 08 E0 F0 A3 FF 00 01 02   .....$.(........
0BD0   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
0BE0   00 00 00 00 00 00 10 0E 00 FF 28 18 08 00 40 0B   ..........(...@.

0BF0   03 00 02 23 37 27 2D 37 30 14 04 11 00 01 00 00   ...#7'-70.......
0C00   00 00 00 00 E1 24 C7 14 00 E0 F0 A2 FF 00 13 15   .....$..........
0C10   17 02 04 06 07 10 11 12 13 14 15 16 17 01 00 03   ................
0C20   00 00 00 00 00 00 30 0F 00 FF 28 18 08 00 40 0B   ......0...(...@.

0C30   03 00 02 23 37 27 2D 37 30 14 04 11 00 01 00 00   ...#7'-70.......
0C40   00 00 00 00 E1 24 C7 14 00 E0 F0 A2 FF 00 13 15   .....$..........
0C50   17 02 04 06 07 10 11 12 13 14 15 16 17 01 00 03   ................
0C60   00 00 00 00 00 00 30 0F 00 FF 50 18 08 00 40 01   ......0...P...@.

0C70   01 00 06 23 70 4F 59 2D 5E 06 04 11 00 01 00 00   ...#pOY-^.......
0C80   00 00 00 00 E0 23 C7 28 00 DF EF C2 FF 00 17 17   .....#.(........
0C90   17 17 17 17 17 17 17 17 17 17 17 17 17 01 00 01   ................
0CA0   00 00 00 00 00 00 00 0D 00 FF 50 18 0E 00 10 00   ..........P.....

0CB0   03 00 03 A6 60 4F 56 3A 51 60 70 1F 00 0D 0B 0C   ....`OV:Q`p.....
0CC0   00 00 00 00 5E 2E 5D 28 0D 5E 6E A3 FF 00 08 08   ....^.](.^n.....
0CD0   08 08 08 08 08 10 18 18 18 18 18 18 18 0E 00 0F   ................
0CE0   08 00 00 00 00 00 10 0A 00 FF 28 18 08 00 40 00   ..........(...@.

0CF0   00 00 03 23 37 27 2D 37 31 15 04 11 00 07 06 07   ...#7'-71.......
0D00   00 00 00 00 E1 24 C7 14 08 E0 F0 A3 FF 00 01 02   .....$..........
0D10   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
0D20   00 00 00 00 00 00 10 0E 00 FF 28 18 08 00 40 00   ..........(...@.

0D30   00 00 03 23 37 27 2D 37 31 15 04 11 00 07 06 07   ...#7'-71.......
0D40   00 00 00 00 E1 24 C7 14 08 E0 F0 A3 FF 00 01 02   .....$..........
0D50   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
0D60   00 00 00 00 00 00 10 0E 00 FF 28 18 08 00 40 00   ..........(...@.

0D70   00 00 03 23 37 27 2D 37 31 15 04 11 00 07 06 07   ...#7'-71.......
0D80   00 00 00 00 E1 24 C7 14 08 E0 F0 A3 FF 00 01 02   .....$..........
0D90   03 04 05 06 07 10 11 12 13 14 15 16 17 08 00 0F   ................
0DA0   00 00 00 00 00 00 10 0E 00 FF 50 18 08 00 10 01   ..........P.....

0DB0   04 00 07 23 70 4F 5C 2F 5F 07 04 11 00 07 06 07   ...#pO\/_.......
0DC0   00 00 00 00 E1 24 C7 28 08 E0 F0 A3 FF 00 00 00   .....$.(........
0DD0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0F   ................
0DE0   00 00 00 00 00 00 00 04 00 FF 50 18 0E 00 10 00   ..........P.....

0DF0   04 00 07 A6 60 4F 56 3A 51 60 70 1F 00 0D 0B 0C   ....`OV:Q`p.....
0E00   00 00 00 00 5E 2E 5D 28 0D 5E 6E A3 FF 00 00 00   ....^.](.^n.....
0E10   00 00 00 00 00 00 00 00 00 00 00 00 00 0E 00 0F   ................
0E20   08 00 00 00 00 00 00 04 00 FF 28 18 08 00 20 0B   ..........(... .

0E30   0F 00 06 23 37 27 2D 37 30 14 04 11 00 00 00 00   ...#7'-70.......
0E40   00 00 00 00 E1 24 C7 14 00 E0 F0 E3 FF 00 01 02   .....$..........
0E50   03 04 05 06 07 10 11 12 13 14 15 16 17 01 00 0F   ................
0E60   00 00 00 00 00 00 00 05 0F FF 50 18 08 00 40 01   ..........P...@.

0E70   0F 00 06 23 70 4F 59 2D 5E 06 04 11 00 00 00 00   ...#pOY-^.......
0E80   00 00 00 00 E0 23 C7 28 00 DF EF E3 FF 00 01 02   .....#.(........
0E90   03 04 05 06 07 10 11 12 13 14 15 16 17 01 00 0F   ................
0EA0   00 00 00 00 00 00 00 05 0F FF 50 18 0E 00 80 05   ..........P.....

0EB0   0F 00 00 A2 60 4F 56 1A 50 E0 70 1F 00 00 00 00   ....`OV.P.p.....
0EC0   00 00 00 00 5E 2E 5D 14 0D 5E 6E 8B FF 00 08 00   ....^.]..^n.....
0ED0   00 18 18 00 00 00 08 00 00 00 18 00 00 0B 00 05   ................
0EE0   00 00 00 00 00 00 10 07 0F FF 50 18 0E 00 80 05   ..........P.....

0EF0   0F 00 00 A7 5B 4F 53 17 50 BA 6C 1F 00 00 00 00   ....[OS.P.l.....
0F00   00 00 00 00 5E 2B 5D 14 0F 5F 0A 8B FF 00 01 00   ....^+].._......
0F10   00 04 07 00 00 00 01 00 00 04 07 00 00 01 00 05   ................
0F20   00 00 00 00 00 00 10 07 0F FF 50 18 0E 00 80 01   ..........P.....

0F30   0F 00 06 A2 60 4F 56 3A 50 60 70 1F 00 00 00 00   ....`OV:P`p.....
0F40   00 00 00 00 5E 2E 5D 28 0D 5E 6E E3 FF 00 08 00   ....^.](.^n.....
0F50   00 18 18 00 00 00 08 00 00 00 18 00 00 0B 00 05   ................
0F60   00 00 00 00 00 00 00 05 0F FF 50 18 0E 00 80 01   ..........P.....

0F70   0F 00 06 A7 5B 4F 53 37 52 00 6C 1F 00 00 00 00   ....[OS7R.l.....
0F80   00 00 00 00 5E 2B 5E 28 0F 5F 0A E3 FF 00 01 02   ....^+^(._......
0F90   03 04 05 14 07 38 39 3A 3B 3C 3D 3E 3F 01 00 0F   .....89:;<=>?...
0FA0   00 00 00 00 00 00 00 05 0F FF 28 18 0E 00 08 0B   ..........(.....

0FB0   03 00 03 A7 2D 27 2B 2D 29 6D 6C 1F 00 0D 06 07   ....-'+-)ml.....
0FC0   00 00 00 00 5E 2B 5D 14 0F 5E 0A A3 FF 00 01 02   ....^+]..^......
0FD0   03 04 05 14 07 38 39 3A 3B 3C 3D 3E 3F 0A 00 0F   .....89:;<=>?...
0FE0   00 00 00 00 00 00 10 0E 00 FF 28 18 0E 00 08 0B   ..........(.....

0FF0   03 00 03 A7 2D 27 2B 2D 29 6D 6C 1F 00 0D 06 07   ....-'+-)ml.....
1000   00 00 00 00 5E 2B 5D 14 0F 5E 0A A3 FF 00 01 02   ....^+]..^......
1010   03 04 05 14 07 38 39 3A 3B 3C 3D 3E 3F 0A 00 0F   .....89:;<=>?...
1020   00 00 00 00 00 00 10 0E 00 FF 50 18 0E 00 10 01   ..........P.....

1030   03 00 03 A7 5B 4F 53 37 51 5B 6C 1F 00 0D 06 07   ....[OS7Q[l.....
1040   00 00 00 00 5E 2B 5D 28 0F 5E 0A A3 FF 00 01 02   ....^+](.^......
1050   03 04 05 14 07 38 39 3A 3B 3C 3D 3E 3F 0A 00 0F   .....89:;<=>?...
1060   00 00 00 00 00 00 10 0E 00 FF 50 18 0E 00 10 01   ..........P.....

1070   03 00 03 A7 5B 4F 53 37 51 5B 6C 1F 00 0D 06 07   ....[OS7Q[l.....
1080   00 00 00 00 5E 2B 5D 28 0F 5E 0A A3 FF 00 01 02   ....^+](.^......
1090   03 04 05 14 07 38 39 3A 3B 3C 3D 3E 3F 0A 00 0F   .....89:;<=>?...
; -----------------------------------------------------------------------------
;     Adresy skok– do slu‘eb
; -----------------------------------------------------------------------------
10aa                 dw     11afh           ; INT 10h/0 - nastaven¡ videom¢du
10ac                 dw     1374h           ; INT 10h/1 - nastav. velik. kurzoru
10ae                 dw     13d4h           ; INT 10h/2 - nastav. pozice kurzoru
10b0                 dw     1404h           ; INT 10h/3 - ‡ten¡ pozice kurzoru
10b2                 dw     1414h           ; INT 10h/4 - ‡ten¡ pozice svˆt.pera
10b4                 dw     14d5h           ; INT 10h/5 - nastaven¡ akt. str nky
10b6                 dw     1506h           ; INT 10h/6 - rolov n¡ okna nahoru
10b8                 dw     16a4h           ; INT 10h/7 - rolov n¡ okna dol–
10ba                 dw     1851h           ; INT 10h/8 - ‡ten¡ znaku a atrib.
10bc                 dw     198bh           ; INT 10h/9 - z pis znaku s atrib.
10be                 dw     1bbah           ; INT 10h/0ah - z pis znaku
10c0                 dw     1c18h           ; INT 10h/0bh - nastaven¡ palety
10c2                 dw     1cc6h           ; INT 10h/0ch - z pis bodu
10c4                 dw     1d83h           ; INT 10h/0dh - ‡ten¡ bodu
10c6                 dw     1e1ch           ; INT 10h/0eh - z pis znaku CTTY
10c8                 dw     1e9ah           ; INT 10h/0fh - poskytnut¡ videom¢du
10ca                 dw     1each           ; INT 10h/10h - nastaven¡ palet
10cc                 dw     1f6ah           ; INT 10h/11h - gener tor znak–
10ce                 dw     20b1h           ; INT 10h/12h - alternativn¡ nastav.
10d0                 dw     20f1h           ; INT 10h/13h - z pis ©etˆzce znak–

10d2                 dw     1189h           ; adresa obsluhy INT 10h pro EGA
10d4                 dw     1140h           ; obsluha INT 10h pro sek. displej
10d6                 dw     10dah           ; adresa vlastn¡ obsluhy INT 1Ch
10d8                 dw     0

; *****************************************************************************
;
;                    Obsluha p©eru¨en¡ od ‡asova‡e INT 1Ch
;
; *****************************************************************************

                                          ;* obsluha ‡asova‡e INT 1Ch

10da  50             push   ax              ; £schova AX
10db  1e             push   ds              ; £schova DS
10dc  33c0           xor    ax,ax           ; AX <- 0
10de  8ed8           mov    ds,ax           ; DS <- 0
10e0  813ea2044866   cmp    [04a2],6648
10e6  753a           jnz    1122            ; n vrat z obsluhy INT 1Ch

10e8  fa             cli                    ; z kaz p©eru¨en¡
10e9  53             push   bx              ; £schova BX
10ea  51             push   cx              ; £schova CX
10eb  52             push   dx              ; £schova DX
10ec  1e             push   ds              ; £schova DS
10ed  b800b0         mov    ax,b000         ; segment videopamˆti MDA
10f0  8ed8           mov    ds,ax           ; segment videopamˆti MDA
10f2  bbff7f         mov    bx,7fff
10f5  babf03         mov    dx,03bf         ; adresa portu 03BFh
10f8  8d0eff10       lea    cx,[10ff]       ; CX <- adresa pro dal¨¡ pokra‡.
10fc  eb2c           jmp    112a
10fe  90             nop

10ff  741d         * jz     111e
1101  b001           mov    al,01
1103  ee             out    dx,al
1104  8d0e0b11       lea    cx,[110b]
1108  eb20           jmp    112a
110a  90             nop
110b  b003           mov    al,03
110d  ee             out    dx,al
110e  740e           jz     111e
1110  bab403         mov    dx,03b4         ; adresa portu 03B4h
1113  b80305         mov    ax,0503         ; ¨¡©ka synchr. puls–
1116  ef             out    dx,ax           ; ¨¡©ka synchr. puls–
1117  b8022f         mov    ax,2f02         ; horiz. synchr. pozice
111a  ef             out    dx,ax           ; nastaven¡ horiz. synchr. pozice
111b  b00f           mov    al,0f           ;
111d  ee             out    dx,al
111e  1f           * pop    ds              ; n vrat DS
111f  5a             pop    dx              ; n vrat DX
1120  59             pop    cx              ; n vrat CX
1121  5b             pop    bx              ; n vrat BX

1122  9c           * pushf                  ; simulace vol n¡ INT xx
1123  ff1ea404       call   far [04a4]      ; vol n¡ p–vodn¡ obsluhy INT 1Ch
1127  1f             pop    ds              ; n vrat DS
1128  58             pop    ax              ; n vrat AX
1129  cf             iret                   ; n vrat z obsluhy p©eru¨en¡
; -----------------------------------------------------------------------------

112a  8a07         * mov    al,[bx]
112c  3a8700f0       cmp    al,[bx+f000]
1130  750c           jnz    113e
1132  8ae0           mov    ah,al
1134  fec0           inc    al
1136  8807           mov    [bx],al
1138  3a8700f0       cmp    al,[bx+f000]
113c  8827           mov    [bx],ah
113e  ffe1         * jmp    cx              ; dal¨¡ pokra‡ov n¡ programu

; *****************************************************************************
;
;               Obsluha funkc¡ INT 10h pro sekund rn¡ monitor CGA
;
; *****************************************************************************

                                          ;* obsluha sekund.displeje CGA INT 10h

1140  50           * push   ax              ; £schova AX
1141  1e             push   ds              ; £schova DS
1142  80fc00         cmp    ah,00           ; je funkce inicializace m¢du 0 ?
1145  742b           jz     1172            ; je inicializace videom¢du CGA
1147  80fc01         cmp    ah,01           ; je nastaven¡ velikosti kurzoru ?
114a  7407           jz     1153            ; je nastaven¡ velikosti kurzoru
114c  1f           * pop    ds              ; n vrat DS
114d  58             pop    ax              ; n vrat AX
114e  ea65f000f0     jmp    f000:f065       ; vol n¡ obsluhy displeje CGA
                                          ;* nastaven¡ velikosti kurzoru CGA
1153  33c0         * xor    ax,ax           ; AX <- 0
1155  8ed8           mov    ds,ax           ; DS <- 0
1157  b80706         mov    ax,0607         ; maxim ln¡ velikost kurzoru pro CGA
115a  803e490407     cmp    [0449],07       ; aktivn¡ m¢d displeje = 7 (MDA) ?
115f  7503           jnz    1164            ; nen¡ videom¢d MDA
1161  b80d0c         mov    ax,0c0d         ; maxim. velikost kurzoru pro MDA
1164  3ac8         * cmp    cl,al           ; koncov  linka kurzoru
1166  72e4           jc     114c            ; nen¡ p©ekro‡ena koncov  linka
1168  fec9           dec    cl              ; sn¡‘en¡ koncov‚ linky
116a  3aec           cmp    ch,ah           ; p©ekro‡ena po‡ te‡n¡ linka ?
116c  72de           jc     114c            ; nen¡ p©ekro‡ena koncov  linka
116e  fecd           dec    ch              ; sn¡‘en¡ po‡ te‡n¡ linky
1170  ebda           jmp    114c            ; n vrat z obsluhy INT 10h
                                          ;* inicializace videom¢du CGA
1172  9c           * pushf                  ; £schova registru p©¡znak–
1173  9a65f000f0     call   f000:f065       ; inicializace videom¢du CGA
1178  51             push   cx              ; £schova registru CX
1179  33c0           xor    ax,ax           ; AX <- 0
117b  8ed8           mov    ds,ax           ; DS <- 0
117d  8b0e6004       mov    cx,[0460]       ; koncov  a po‡ te‡n¡ linka kurzoru
1181  b401           mov    ah,01           ; funkce nastaven¡ velikosti kurz.
1183  cd10           int    10              ; nastaven¡ velikosti kurzoru
1185  59             pop    cx              ; n vrat CX
1186  1f             pop    ds              ; n vrat DS
1187  58             pop    ax              ; n vrat AX
1188  cf             iret                   ; n vrat z obsluhy

; *****************************************************************************
;
;                   Obsluha funkc¡ INT 10h pro EGA
;
; *****************************************************************************
                                          ;* vstupn¡ bod obsluhy INT 10h EGA

1189  fb             sti                    ; z kaz p©eru¨en¡
118a  fc             cld                    ; p©¡znak ukazatele nahoru
118b  80fc13         cmp    ah,13           ; je platn‚ ‡¡slo funkce ?
118e  771c           ja     11ac            ; funkce nen¡ obsluhovan 
1190  1e             push   ds              ; £schova DS
1191  56             push   si              ; £schova SI
1192  57             push   di              ; £schova DI
1193  33ff           xor    di,di           ; DI <- 0
1195  8edf           mov    ds,di           ; DS <- 0 ukazatel dat EGA
1197  86c4           xchg   al,ah           ; AL <- ‡¡slo funkce
1199  8bf0           mov    si,ax           ; SI <- ‡¡slo funkce
119b  86c4           xchg   al,ah           ; AH <- n vrat ‡¡sla funkce
119d  81e6ff00       and    si,00ff         ; zru¨en¡ p–vodn¡ho obsahu AL
11a1  d1e6           shl    si,1            ; ‡¡slo funkce * 2
11a3  2eff94aa10     call   cs:[si+10aa]    ; vyvol n¡ obsluhy funkce AH
11a8  5f             pop    di              ; n vrat DI
11a9  5e             pop    si              ; n vrat SI
11aa  1f             pop    ds              ; n vrat DS
11ab  cf             iret                   ; n vrat z p©eru¨en¡

                                          ;* p–vodn¡ obsluha INT 10h
11ac  cd42         * int    42              ; vol n¡ p–vodn¡ obsluhy BIOS
11ae  cf             iret
; -----------------------------------------------------------------------------
;        Funkce 00h - inicializace videom¢du
; -----------------------------------------------------------------------------
                                          ;* INT 10h/0 - nastaven¡ videom¢du
                                            ; VSTUP: AH=0
                                            ;        AL=po‘adovan˜ videom¢d

11af  50           * push   ax              ; £schova po‘adovan‚ho videom¢du
11b0  c7060c010034   mov    [010c],3400     ; ukazatel na inicializa‡n¡ font EGA
11b6  8c0e0e01       mov    [010e],cs       ; segment adresy inicial. fontu EGA
11ba  8ae0           mov    ah,al           ; AH <- po‘adovan˜ videom¢d
11bc  a08704         mov    al,[0487]       ; status ©¡zen¡ video
11bf  24f3           and    al,f3           ; nulov n¡ bit– 2 a 3
11c1  f606100430     test   [0410],30       ; tabulka v˜pisu vybaven¡ - inic.m¢d
11c6  7402           jz     11ca            ; inic. m¢d = 0 - automatick˜ m¢d
11c8  7a43           jp     120d            ; je m¢d monochromn¡ 80x25 (7)
                                          ;* p©ep¡nateln˜ provoz
11ca  a802         * test   al,02           ; p©¡znak - je karta MDA ?
11cc  7505           jnz    11d3            ; nen¡ karta MDA
11ce  bed403         mov    si,03d4         ; b zov  ©¡dic¡ adresa karty CGA
11d1  eb47           jmp    121a

                                          ;* je karta MDA (CGA ?)
11d3  0c08         * or     al,08           ; p©¡znak obsluhy druh‚ho displeje
11d5  c70685040800   mov    [0485],0008     ; po‡et linek na znak (v˜¨ka znaku)
11db  c606840418     mov    [0484],18       ; ‡¡slo posledn¡ho © dku = 25
11e0  80fc02         cmp    ah,02           ; je videom¢d 40x25 text ?
11e3  7207           jc     11ec            ; je videom¢d 0 nebo 1 (40x25/text)
11e5  80fc03         cmp    ah,03           ; je videom¢d 2 nebo 3 (80x25/text)?
11e8  7702           ja     11ec            ; nen¡ videom¢d 2 ani 3
11ea  0c04           or     al,04           ; p©¡znak - je karta MDA
11ec  a28704       * mov    [0487],al       ; statut ©¡zen¡ video
11ef  58             pop    ax              ; n vrat po‘adovan‚ho videom¢du
11f0  cd42           int    42              ; standardn¡ inicializace
11f2  c3             ret

                                          ;* je karta MDA
11f3  0c08           or     al,08           ; p©¡znak obsluhy druh‚ho displeje
11f5  c70685040e00   mov    [0485],000e     ; po‡et linek na znak (v˜¨ka)=14
11fb  c606840418     mov    [0484],18       ; ‡¡slo posledn¡ho © dku=24
1200  a28704         mov    [0487],al       ; statut ©¡zen¡ video
1203  58             pop    ax
1204  cd42           int    42
1206  c70660040c0b   mov    [0460],0b0c     ; koncov  a po‡ te‡n¡ linka kurzoru
120c  c3             ret
; -----------------------------------------------------------------------------
                                          ;* videom¢d MONO 80x25
120d  a802         * test   al,02           ; je displej MDA ?
120f  74e2           jz     11f3            ; nen¡ displej MDA
1211  beb403         mov    si,03b4         ; b zov  ©¡dic¡ adresa karty MDA
1214  80e48f         and    ah,8f           ; videom¢dy 0 a‘ 0fh
1217  80cc07         or     ah,07           ; videom¢d 7 nebo 0fh

                                          ;* je obsluha karty EGA
121a  d1e0         * shl    ax,1
121c  d0d8           rcr    al,1
121e  d0ec           shr    ah,1            ; aktivn¡ videom¢d displeje
1220  a28704         mov    [0487],al       ; statut ©¡zen¡ video
1223  88264904       mov    [0449],ah       ; aktivn¡ m¢d displeje
1227  89366304       mov    [0463],si       ; b zov  ©¡dic¡ adresa displeje


                                          ;* inicicializace registr– ©adi‡e
122b  53             push   bx              ; £schova BX
122c  51             push   cx              ; £schova CX
122d  52             push   dx              ; £schova DX
122e  55             push   bp              ; £schova BP
122f  06             push   es              ; £schova ES

1230  33c0           xor    ax,ax           ; AX <- 0
1232  8ec0           mov    es,ax           ; ES <- 0 segment dat EGA
1234  a26204         mov    [0462],al       ; aktivn¡ str nka displeje = 0
1237  a34e04         mov    [044e],ax       ; po‡ te‡n¡ adresa buff. displeje=0
123a  8d3e5004       lea    di,[0450]       ; tabulka pozic kurzor– ve str nk ch
123e  b90800         mov    cx,0008         ; max. po‡et str nek = 8
1241  f3ab           rep    stosw           ; vynulov n¡ pozic kurz.ve str nk ch

                                          ;* po‡et pozic na © dek
1243  e8fa10         call   2340            ; poskytnut¡ adresy videoparametr–
1246  33c0           xor    ax,ax           ; AX <- 0
1248  26ac           es:lodsb               ; AL <- po‡et pozic na © dek
124a  a34a04         mov    [044a],ax       ; po‡et pozic na © dek

                                          ;* ‡¡slo posledn¡ho © dku
124d  26ac           es:lodsb               ; AL <- ‡¡slo posledn¡ho © dku
124f  a28404         mov    [0484],al       ; ‡¡slo posledn¡ho © dku

                                          ;* po‡et linek na znak
1252  26ac           es:lodsb               ; AL <- po‡et linek na znak
1254  a38504         mov    [0485],ax       ; po‡et linek na znak (v˜¨ka znaku)

                                          ;* d‚lka bufferu displeje
1257  26ad           es:lodsw               ; AX <- d‚lka bufferu displeje
1259  a34c04         mov    [044c],ax       ; d‚lka zobrazovan‚ho bufferu disp.

                                          ;* inicializace font– text. videom¢du
125c  b001           mov    al,01           ; AL <- 1 fonty 14 linek
125e  803e490407     cmp    [0449],07       ; aktivn¡ m¢d displeje = 7 (MDA) ?
1263  740d           jz     1272            ; je videom¢d 7 MDA
1265  803e490403     cmp    [0449],03       ; aktivn¡ m¢d displeje
126a  7715           ja     1281            ; je grafick˜ videom¢d
126c  e80211         call   2371            ; monitor ECM s vy¨¨¡m rozli¨en¡m ?
126f  7401           jz     1272            ; je vy¨¨¡ rozli¨en¡
1271  40             inc    ax              ; fonty 8 linek
1272  33db         * xor    bx,bx           ; BX <- 0 blok font– 0
1274  e85b0f         call   21d2            ; inicializace font– videokarty
                                          ;* p©einstalov n¡ nˆkter˜ch znak– MDA
1277  803e490407     cmp    [0449],07       ; aktivn¡ m¢d displeje
127c  7503           jne    1281            ; nen¡ videom¢d 7 (MDA textov˜)
127e  e85200         call   12d3            ; inicializace vybran˜ch znak– MDA

1281  e8c10f       * call   2245            ; inicializace registr– videokarty

1284  e8170f         call   219e            ; vymaz n¡ cel‚ videopamˆti

1287  e8f510         call   237f            ; rozsv¡cen¡ displeje

128a  a04904         mov    al,[0449]       ; aktivn¡ m¢d displeje
128d  3c0f           cmp    al,0f           ; je videom¢d 15 ?
128f  7206           jb     1297            ; je men¨¡ videom¢d ne‘ 640x350
1291  c7060c01d024   mov    [010c],24d0     ; inicial. font EGA 14 linek
1297  3c03         * cmp    al,03           ; je videom¢d
1299  7604           jna    129f            ; je textov˜ videom¢d CGA
129b  3c07           cmp    al,07           ; je videom¢d MDA ?
129d  7505           jnz    12a4            ; nen¡ videom¢d MDA
129f  e88900       * call   132b            ; inicializace font– textov‚ho m¢du
12a2  eb03           jmp    12a7
12a4  e84e00       * call   12f5            ; inicializace font– graf. m¢du

12a7  a04904       * mov    al,[0449]       ; aktivn¡ m¢d displeje
12aa  3c07           cmp    al,07           ; je videom¢d MDA ?
12ac  7717           ja     12c5            ; je grafick˜ m¢d EGA

                                          ;* registr nastaven¡ videom¢du 03d8h
12ae  8ae0           mov    ah,al           ; £schova aktivn¡ho videom¢du
12b0  8d1e0005       lea    bx,[0500]       ; tabulka registr– m¢du
12b4  2e             cs:
12b5  d7             xlat                   ; bajt pro dan˜ videom¢d
12b6  a26504         mov    [0465],al       ; sou‡asn‚ nastaven¡ registru m¢du

                                          ;* registr nastaven¡ barev 03d9h
12b9  b030           mov    al,30
12bb  80fc06         cmp    ah,06           ; je videom¢d 6 ?
12be  7502           jnz    12c2            ; nen¡ videom¢d 6
12c0  b03f           mov    al,3f           ; nastaven¡ pro videom¢d 6
12c2  a26604       * mov    [0466],al       ; sou‡asn‚ nastaven¡ registru barev

                                          ;* nastaven¡ velikosti kurzoru
12c5  8b0e6004     * mov    cx,[0460]       ; koncov  a po‡ te‡n¡ linka kurzoru
12c9  e8a800         call   1374            ; nastaven¡ velikosti kurzoru
12cc  07             pop    es
12cd  5d             pop    bp
12ce  5a             pop    dx
12cf  59             pop    cx
12d0  5b             pop    bx
12d1  58             pop    ax
12d2  c3             ret
; -----------------------------------------------------------------------------
                                          ;* inicializace vybran˜ch znak– MDA
12d3  8d2ed132     * lea    bp,[32d1]       ; BP <- 32d1h tabulka font– MDA
12d7  2e8e06ca04     mov    es,cs:[04ca]    ; segment tabulky videoparametr–
12dc  bb000e         mov    bx,0e00         ; 14 linek na znak, blok font– 0

12df  b90100       * mov    cx,0001         ; 1 znak
12e2  32f6           xor    dh,dh           ;
12e4  268a56ff       mov    dl,es:[bp-01]   ; znak k inicializaci
12e8  e8210f         call   220c            ; inicializace znaku
12eb  83c50f         add    bp,000f         ; zv˜¨en¡ adresy v tabulce
12ee  26384eff       cmp    es:[bp-01],cl   ; je to ji‘ posledn¡ znak (=0) ?
12f2  75eb           jnz    12df            ; dal¨¡ znak
12f4  c3             ret
; -----------------------------------------------------------------------------
                                          ;* inicializace font– graf. m¢du

12f5  c43ea804     * les    di,[04a8]       ; ukazatek videoparametr– EGA
12f9  26c47d0c       les    di,es:[di+0c]   ; pomocn˜ gener tor znak– graf.m¢du
12fd  8cc0           mov    ax,es           ; segment adresy
12ff  0bc7           or     ax,di           ; offset adresy
1301  7427           jz     132a            ; tabulka nen¡ definov na
1303  8d7507         lea    si,[di+07]      ; ukazatel povolen˜ch m¢d– fontu
1306  26           * es:
1307  ac             lodsb                  ; na‡ten¡ povolen‚ho m¢du
1308  3a064904       cmp    al,[0449]       ; aktivn¡ m¢d displeje
130c  7405           jz     1313            ; nalezen povolen˜ m¢d fontu
130e  fec0           inc    al              ; je ji‘ posledn¡ m¢d ?
1310  75f4           jnz    1306            ; test dal¨¡ho m¢du
1312  c3             ret                    ; nen¡ povolen˜ m¢d
1313  8d35         * lea    si,[di]         ; ukazatel parametr– gener toru
1315  26             es:
1316  ac             lodsb                  ; po‡et zobraziteln˜ch © dk–
1317  48             dec    ax              ; ‡¡slo posledn¡ho © dku
1318  a28404         mov    [0484],al       ; ‡¡slo posledn¡ho © dku
131b  26             es:
131c  ad             lodsw                  ; po‡et bajt– na znak
131d  a38504         mov    [0485],ax       ; po‡et linek na znak (v˜¨ka znaku)
1320  26             es:
1321  ad             lodsw                  ; ukazatel na tabulku font– - offset
1322  a30c01         mov    [010c],ax       ; offset ukazatele inicial. fontu
1325  26             es:
1326  ad             lodsw                  ; segment ukazatele inic. fontu
1327  a30e01         mov    [010e],ax       ; segment ukazatele inic. fontu
132a  c3           * ret
; -----------------------------------------------------------------------------
                                          ;* inicializace font– textov‚ho m¢du

132b  c43ea804     * les    di,[04a8]       ; ukazatek videoparametr– EGA
132f  26c47d08       les    di,es:[di+08]   ; pomocn˜ gener tor znak– text.m¢du
1333  8cc0           mov    ax,es           ; segment adresy
1335  0bc7           or     ax,di           ; offset adresy
1337  743a           jz     1373            ; je neplatn  adresa
1339  8d750b         lea    si,[di+0b]      ; ukazatel povolen˜ch m¢d– fontu
133c  26           * es:
133d  ac             lodsb                  ; na‡ten¡ povolen‚ho m¢du
133e  3a064904       cmp    al,[0449]       ; aktivn¡ m¢d displeje
1342  7405           jz     1349            ; nalezen povolen˜ m¢d
1344  fec0           inc    al              ; AL + 1
1346  75f4           jnz    133c            ; nen¡ je¨tˆ posledn¡ m¢d v tabulce
1348  c3             ret

1349  268a450a     * mov    al,es:[di+0a]   ; maxim ln¡ po‡et zobrazit. © dk–
134d  268a3d         mov    bh,es:[di]      ; po‡et bajt– na znak
1350  268a5d01       mov    bl,es:[di+01]   ; ‡¡slo bloku font– k na‡ten¡
1354  268b4d02       mov    cx,es:[di+02]   ; po‡et znak– k ulo‘en¡
1358  268b5504       mov    dx,es:[di+04]   ; offset znak–
135c  268b6d06       mov    bp,es:[di+06]   ; ukazatel na tabulku font–
1360  268e4508       mov    es,es:[di+08]   ; segment ukazatele na tabulku font–
1364  50             push   ax              ; £schova AX (max. po‡et © dk–)
1365  b81011         mov    ax,1110         ; funkce na‡ten¡ u‘ivatelsk˜ch font–
1368  cd10           int    10              ; na‡ten¡ u‘ivatelsk˜ch text. font–
136a  58             pop    ax              ; n vrat AX (max. po‡et © dk–)
136b  3cff           cmp    al,ff           ; po‘aduje se v˜po‡et po‡tu © dk– ?
136d  7404           jz     1373            ; po‘aduje se v˜po‡et po‡tu © dk–
136f  48             dec    ax              ; ‡¡slo posledn¡ho © dku
1370  a28404         mov    [0484],al       ; ‡¡slo posledn¡ho © dku
1373  c3           * ret
; -----------------------------------------------------------------------------
;     Slu‘ba 01h - nastaven¡ velikosti kurzoru
; -----------------------------------------------------------------------------
                                          ;* INT 10h/1 - nastav. velik. kurzoru
                                            ; VSTUP: AH=01h
                                            ;        CH=po‡ te‡n¡ linka kurzoru
                                            ;        CL=koncov  linka kurzoru

1374  52             push   dx              ; £schova DX
1375  8bc1           mov    ax,cx           ; po‘adovan‚ nastaven¡ velik.kurzoru
1377  a36004         mov    [0460],ax       ; koncov  a po‡ te‡n¡ linka kurzoru
137a  f606870408     test   [0487],08       ; obsluha druh‚ho displeje
137f  753b           jnz    13bc            ; druh˜ displej - bez kontroly

                                          ;* korekce pro displej EGA
1381  80e460         and    ah,60           ;
1384  80fc20         cmp    ah,20
1387  b8001e         mov    ax,1e00         ; kurzor na spodn¡m okraji
138a  7430           jz     13bc            ; nastaven¡ kurzoru
138c  8bc1           mov    ax,cx           ; po‘adovan‚ nastaven¡ kurzoru
138e  f606870401     test   [0487],01       ; je hust‚ zobrazen¡ (43 © dk–) ?
1393  7527           jnz    13bc            ; je hust‚ zobrazen¡
1395  803e490403     cmp    [0449],03       ; je grafick˜ videom¢d ?
139a  7713           ja     13af            ; nen¡ text. videom¢d CGA
                                          ;* korekce pro monitor ECM high
139c  e8d20f         call   2371            ; monitor ECM s vy¨¨¡m rozli¨en¡m ?
139f  750e           jnz    13af            ; nen¡ ECM s vy¨¨¡m rozli¨en¡m
13a1  80fc05         cmp    ah,05           ; je po‡ te‡n¡ linka men¨¡ ne‘ 5 ?
13a4  7203           jc     13a9            ; po‡ te‡n¡ linka je men¨¡ ne‘ 5
13a6  80c405         add    ah,05           ; zv˜¨en¡ po‡ te‡n¡ linky o 5
13a9  3c05         * cmp    al,05           ; je koncov  linka men‘¡ ne‘ 5 ?
13ab  7202           jc     13af            ; koncov  linka je men¨¡ ne‘ 5
13ad  0405           add    al,05           ; zv˜¨en¡ koncov‚ linky o 5

13af  40           * inc    ax              ; zv˜¨en¡ koncov‚ linky kurzoru
13b0  0ae4           or     ah,ah           ; po‡ te‡n¡ linka kurzoru
13b2  7408           jz     13bc            ; po‡ te‡n¡ linka kurzoru = 0
13b4  3a068504       cmp    al,[0485]       ; po‡et linek na znak (v˜¨ka znaku)
13b8  7202           jc     13bc            ; nen¡ je¨tˆ p©ekro‡en spodn¡ okraj
13ba  32c0           xor    al,al           ; koncov  linka = 0

13bc  3d0d0d       * cmp    ax,0d0d         ; jsou linky na posledn¡ pozici ?
13bf  74ee           je     13af            ; zv˜¨en¡ koncov‚ linky
                                          ;* nastaven¡ velikosti kurzoru
13c1  8bf9           mov    di,cx           ; £schova po‘adov. nastaven¡ kurz.
13c3  8b166304       mov    dx,[0463]       ; b zov  ©¡dic¡ adresa displeje
13c7  8ac8           mov    cl,al           ; £schova koncov‚ linky kurzoru
13c9  b00a           mov    al,0a           ; registr 10 (po‡ te‡n¡ linka kurz.)
13cb  ef             out    dx,ax           ; nastaven¡ pop‡ te‡n¡ linky kurzoru
13cc  40             inc    ax              ; registr 11
13cd  8ae1           mov    ah,cl           ; koncov  linka kurzoru
13cf  ef             out    dx,ax           ; nastaven¡ koncov‚ linky kurzoru
13d0  8bcf           mov    cx,di           ; n vrat po‘adov. nastaven¡ kurz.
13d2  5a             pop    dx              ; n vrat DX
13d3  c3             ret
; -----------------------------------------------------------------------------
;     Slu‘ba 02h - nastaven¡ pozice kurzoru
; -----------------------------------------------------------------------------
                                          ;* INT 10h/2 - nastav. pozice kurzoru
                                            ; VSTUP: AH=2
                                            ;        BH=‡¡slo str nky displeje
                                            ;        DH=© dek kurzoru
                                            ;        DL=pozice kurzoru

13d4  8ac7           mov    al,bh           ; ‡¡slo str nky displeje
13d6  98             cbw                    ; AX <- AL
13d7  8bf0           mov    si,ax           ; ‡¡slo str nky displeje
13d9  d1e6           shl    si,1            ; ‡¡slo str nky displeje * 2
13db  89945004       mov    [si+0450],dx    ; nastaven¡ nov‚ pozice kurzoru
13df  38066204       cmp    [0462],al       ; aktivn¡ str nka displeje
13e3  751e           jnz    1403            ; nen¡ to aktivn¡ str nka displeje
                                          ;* fyzick‚ nastaven¡ kurzoru
13e5  52             push   dx              ; £schova po‘adovan‚ pozice kurzoru
13e6  8bc2           mov    ax,dx           ; po‘adovan  pozice kurzoru
13e8  e8830d       * call   216e            ; v˜po‡et offsetu v text. str nce
13eb  03064e04       add    ax,[044e]       ; po‡ te‡n¡ adresa bufferu displeje
13ef  d1e8           shr    ax,1            ; adresa v bufferu / 2
13f1  8bf1           mov    si,cx           ; £schova registru CX
13f3  8b166304       mov    dx,[0463]       ; b zov  ©¡dic¡ adresa displeje
13f7  8ac8           mov    cl,al           ; £schova ni‘¨¡ho bajtu adresy kurz.
13f9  b00e           mov    al,0e           ; registr 14 - vy¨¨¡ bajt kurzoru
13fb  ef             out    dx,ax           ; nastaven¡ vy¨¨¡ho bajtu adresy k.
13fc  40             inc    ax              ; registr 15 - ni‘¨¡ bajt kurzoru
13fd  8ae1           mov    ah,cl           ; ni‘¨¡ bajt adresy kurzoru
13ff  ef             out    dx,ax           ; nastaven¡ ni‘¨¡ho bajtu adresy k.
1400  8bce           mov    cx,si           ; n vrat registru CX
1402  5a             pop    dx              ; n vrat registru DX

1403  c3           * ret
; -----------------------------------------------------------------------------
;     Slu‘ba 03h - ‡ten¡ pozice a rozmˆr– kurzoru
; -----------------------------------------------------------------------------
                                          ;* INT 10h/3 - ‡ten¡ pozice kurzoru
                                            ; VSTUP: AH=3
                                            ;        BH=‡¡slo str nky displeje

1404  8ac7           mov    al,bh           ; ‡¡slo str nky displeje
1406  98             cbw                    ; AL <- AX
1407  8bf0           mov    si,ax           ; SI <- ‡¡slo str nky displeje
1409  d1e6           shl    si,1            ; ‡¡slo str nky * 2
140b  8b945004       mov    dx,[si+0450]    ; pozice kurzoru v po‘ad. str nce
140f  8b0e6004       mov    cx,[0460]       ; koncov  a po‡ te‡n¡ linka kurzoru
1413  c3             ret
; -----------------------------------------------------------------------------
;     Slu‘ba 04h - ‡ten¡ pozice svˆteln‚ho pera
; -----------------------------------------------------------------------------
                                          ;* INT 10h/4 - ‡ten¡ pozice svˆt.pera
                                            ; VSTUP: AH=4
                                            ; VSTUP:AH=stav (1=aktivn¡)
                                            ;        BX=‡¡slo sloupce bodu
                                            ;        CH=‡¡slo © dku bodu
                                            ;        CX=‡¡slo © dku m¢d– 0fh-10h
                                            ;        DH=‡¡slo © dku znaku
                                            ;        DL=‡¡slo pozice znaku

1414  a04904         mov    al,[0449]       ; aktivn¡ m¢d displeje
1417  3c07           cmp    al,07           ; je videom¢d EGA ?
1419  7712           ja     142d            ; je grafick˜ m¢d EGA
141b  f606870402     test   [0487],02       ; je displej MDA ?
1420  7507           jnz    1429            ; je displej MDA
1422  3c07           cmp    al,07           ; je videom¢d MDA ?
1424  7507           jnz    142d            ; nen¡ videom¢d MDA
1426  cd42         * int    42              ; vol n¡ p–vodn¡ obsluhy INT 10h
1428  c3             ret

1429  3c07         * cmp    al,07           ; je videom¢d MDA ?
142b  75f9           jnz    1426            ; nen¡ videom¢d MDA

                                          ;* vlastn¡ obsluha (EGA)
142d  8b166304     * mov    dx,[0463]       ; b zov  ©¡dic¡ adresa displeje
1431  80c206         add    dl,06           ; adresa portu 03DAh
1434  ec             in     al,dx           ; ‡ten¡ stavov‚ho registru
1435  a804           test   al,04           ; je sp¡na‡ svˆteln‚ho pera otev©en?
1437  7406           jz     143f            ; sp¡na‡ svˆteln‚ho pera je aktivn¡
1439  42             inc    dx              ; adresa portu 03DBh
143a  ee             out    dx,al           ; vymaz n¡ registru svˆteln‚ho pera
143b  4a             dec    dx              ; registr portu 03DAh
143c  32e4         * xor    ah,ah           ; stav - svˆteln‚ pero nen¡ aktivn¡
143e  c3             ret                    ; n vrat p©i neaktivn¡m peru


143f  a802         * test   al,02           ; je svˆteln‚ pero aktivov no ?
1441  74f9           jz     143c            ; svˆteln‚ pero nen¡ aktivov no
1443  b010           mov    al,10           ; po‘adovan˜ registr 10h
1445  80ea06         sub    dl,06           ; registr portu 03D4h
1448  ee             out    dx,al           ; nastaven¡ registru 10h
1449  42             inc    dx              ; adresa portu 03D5h
144a  ec             in     al,dx           ; ‡ten¡ vy¨¨¡ adresy svˆt. pera
144b  8ae0           mov    ah,al           ; £schova vy¨¨¡ adresy svˆt. pera
144d  b011           mov    al,11           ; registr 11h
144f  4a             dec    dx              ; adresa portu 03D4h
1450  ee             out    dx,al           ; nastaven¡ registru 11h
1451  42             inc    dx              ; adresa portu 03D5h
1452  ec             in     al,dx           ; ‡ten¡ ni‘¨¡ adresy svˆt. pera
1453  80c206         add    dl,06           ; adresa registru 03DBh
1456  ee             out    dx,al           ; vymaz n¡ registru svˆteln‚ho pera
1457  8bd0           mov    dx,ax           ; £schova adresy svˆt. pera
1459  a04904         mov    al,[0449]       ; aktivn¡ m¢d displeje
145c  98             cbw                    ; AX <- AL aktivn¡ m¢d displeje
145d  8bd8           mov    bx,ax           ; BX <- AX aktivn¡ m¢d displeje
145f  d1e3           shl    bx,1            ; aktivn¡ m¢d displeje * 2
1461  2e2b970805     sub    dx,cs:[bx+0508] ;
1466  8b0e4e04       mov    cx,[044e]       ; po‡ te‡n¡ adresa bufferu displeje
146a  d1e9           shr    cx,1            ; po‡ te‡n¡ adresa / 2
146c  2bd1           sub    dx,cx           ; offset pozice pera ve str nce
146e  7302           jnc    1472            ; nen¡ podte‡en¡ adresy pera
1470  33d2           xor    dx,dx           ; n hradn¡ pozice = 0
1472  3c03         * cmp    al,03           ; je textov˜ videom¢d CGA ?
1474  7644           jna    14ba            ; je textov˜ videom¢d CGA
1476  3c07           cmp    al,07           ; je text. m¢d MDA ?
1478  7440           jz     14ba            ; je text. m¢d MDA
147a  7723           ja     149f            ; je grafick˜ m¢d EGA
                                          ;* nastaven¡ pro graf. m¢dy CGA
147c  3c06           cmp    al,06           ; je m¢d 640x200 ?
147e  8bc2           mov    ax,dx           ; pozice ve str nce
1480  b250           mov    dl,50           ; po‡et znak– na © dek = 80
1482  7402           jz     1486            ; je m¢d 640x200
1484  b228           mov    dl,28           ; po‡et znak– na © dek = 40
1486  f6f2         * div    dl              ; v˜po‡et pozice na © dku
1488  8adc           mov    bl,ah           ; pozice na © dku displeje
148a  d1e3           shl    bx,1            ; pozice * 2
148c  d1e3           shl    bx,1            ; pozice * 4
148e  d1e3           shl    bx,1            ; pozice * 8
1490  8ae8           mov    ch,al           ; ‡¡slo © dku
1492  d0e5           shl    ch,1            ; ‡¡slo © dku * 2
1494  8ad4           mov    dl,ah           ; pozice na © dku
1496  8af0           mov    dh,al           ; ‡¡slo © dku
1498  d0ee           shr    dh,1            ; ‡¡slo © dku / 2
149a  d0ee           shr    dh,1            ; ‡¡slo © dku / 4
149c  b401           mov    ah,01           ; p©¡znak - pero je aktivn¡
149e  c3             ret
; -----------------------------------------------------------------------------
                                          ;* nastaven¡ pro grafick˜ m¢d EGA
149f  8bc2           mov    ax,dx           ; pozice ve str nce
14a1  33d2           xor    dx,dx           ; DX <- 0
14a3  f7364a04       div    w/[044a]        ; v˜po‡et ‡¡sla © dku
14a7  8bc8           mov    cx,ax           ; ‡¡slo © dku
14a9  8bda           mov    bx,dx           ; ‡¡slo pozice na © dku
14ab  d1e3           shl    bx,1            ; pozice * 2
14ad  d1e3           shl    bx,1            ; pozice * 4
14af  d1e3           shl    bx,1            ; pozice * 8
14b1  f6368504       div    b/[0485]        ; p©epo‡et ‡¡sla linky na © dek
14b5  8af0           mov    dh,al           ; ‡¡slo © dku
14b7  b401           mov    ah,01           ; p©¡znak - pero je aktivn¡
14b9  c3             ret
; -----------------------------------------------------------------------------
                                          ;* nastaven¡ pro textov‚ m¢dy
14ba  8bc2         * mov    ax,dx           ; pozice ve str nce
14bc  f6364a04       div    b/[044a]        ; v˜po‡et ‡¡sla © dku
14c0  8bd0           mov    dx,ax           ; DH-‡¡slo pozice, DL-‡¡slo © dku
14c2  86d6           xchg   dl,dh           ; DH-‡¡slo © dku, DL-‡¡slo pozice
14c4  8adc           mov    bl,ah           ; ‡¡slo pozice
14c6  d1e3           shl    bx,1            ; ‡¡slo pozice * 2
14c8  d1e3           shl    bx,1            ; ‡¡slo pozice * 4
14ca  d1e3           shl    bx,1            ; ‡¡slo pozice * 8
14cc  f6268504       mul    b/[0485]        ; p©epo‡et ‡¡sla © dku na linky
14d0  8bc8           mov    cx,ax           ; ‡¡slo graf. linky
14d2  b401           mov    ah,01           ; p©¡znak - pero je aktivn¡
14d4  c3             ret

; -----------------------------------------------------------------------------
;     Sku‘ba 05h - nastaven¡ aktivn¡ str nky
; -----------------------------------------------------------------------------
                                          ;* INT 10h/5 - nastaven¡ akt. str nky
                                            ; VSTUP: AH=5
                                            ;        AL=‡¡slo str nky displeje

14d5  52             push   dx              ; £schova registru DX
14d6  98             cbw                    ; AX <- AL ‡¡slo po‘adovan‚ str nky
14d7  8bf0           mov    si,ax           ; SI <- ‡¡slo po‘adovan‚ str nky
14d9  a26204         mov    [0462],al       ; aktivn¡ str nka displeje
14dc  f7264c04       mul    w/[044c]        ; d‚lka zobrazovan‚ho bufferu disp.
14e0  a34e04         mov    [044e],ax       ; po‡ te‡n¡ adresa bufferu displeje
14e3  803e490407     cmp    [0449],07       ; aktivn¡ m¢d displeje
14e8  7702           ja     14ec            ; je videom¢d EGA
14ea  d1e8           shr    ax,1            ; po‡ te‡n¡ adresa bufferu / 2
14ec  8bf9         * mov    di,cx           ; £schova registru CX
14ee  8b166304       mov    dx,[0463]       ; b zov  ©¡dic¡ adresa displeje
14f2  8ac8           mov    cl,al           ; £schova ni‘¨¡ho bajtu adresy
14f4  b00c           mov    al,0c           ; registr 12
14f6  ef             out    dx,ax           ; nastaven¡ vy¨¨¡ho bajtu adresy
14f7  40             inc    ax              ; registr 13
14f8  8ae1           mov    ah,cl           ; ni‘¨¡ bajt adresy zobraz. str nky
14fa  ef             out    dx,ax           ; nastaven¡ ni‘¨¡ho bajtu adresy
14fb  8bcf           mov    cx,di           ; n vrat registru CX
14fd  d1e6           shl    si,1            ; ‡¡slo po‘adovan‚ str nky * 2
14ff  8b845004       mov    ax,[si+0450]    ; pozice kurzoru ve str nce
1503  e9e2fe         jmp    13e8            ; nastaven¡ nov‚ pozice kurzoru
; -----------------------------------------------------------------------------
;     Slu‘ba 06h - rolov n¡ okna nahoru
; -----------------------------------------------------------------------------
                                          ;* INT 10h/6 - rolov n¡ okna nahoru
                                            ; VSTUP: AH=6
                                            ;        AL=po‡et © dek k rolov n¡
                                            ;        BH=atributy barev
                                            ;        CH=po‡ te‡n¡ © dek
                                            ;        CL=po‡ te‡n¡ pozice
                                            ;        DH=koncov˜ © dek
                                            ;        DL=koncov  pozice

1506  53             push   bx              ; £schova BX
1507  51             push   cx              ; £schova CX
1508  52             push   dx              ; £schova DX
1509  55             push   bp              ; £schova BP
150a  06             push   es              ; £schova ES
150b  8ad8           mov    bl,al           ; po‡et © dek k rolov n¡
150d  48             dec    ax              ; po‡et © dek - 1
150e  2ac6           sub    al,dh           ; po‡et © dek - koncov˜ © dek - 1
1510  02c5           add    al,ch           ; po‡et © dek - v˜¨ka okna
1512  98             cbw                    ; AX <- (po‡et © dek - v˜¨ka okna)
1513  22dc           and    bl,ah           ; po‡et © dek ...
1515  a04904         mov    al,[0449]       ; aktivn¡ m¢d displeje
1518  3c07           cmp    al,07           ; je videom¢d EGA nebo CGA ?
151a  7213           jc     152f            ; je videom¢d CGA
151c  770a           ja     1528            ; je videom¢d EGA
                                          ;* je videom¢d MDA
151e  be00b0         mov    si,b000         ; segment pro videom¢d MDA
1521  8ec6           mov    es,si           ; segment pro videom¢d MDA
1523  eb13           jmp    1538
                                          ;* je grafick˜ m¢d CGA
1525  e98e00       * jmp    15b6
                                          ;* je videom¢d EGA
1528  3c0d         * cmp    al,0d           ; je grafick˜ m¢d EGA ?
152a  726d           jc     1599            ; nen¡ videom¢d EGA - n vrat
152c  e9fa00         jmp    1629            ; proveden¡ operace pro EGA m¢d
                                          ;* je videom¢d CGA
152f  be00b8       * mov    si,b800         ; segment pro videom¢d CGA
1532  8ec6           mov    es,si           ; segment pro videom¢d CGA
1534  3c03           cmp    al,03           ; je textov˜ videom¢d CGA ?
1536  77ed           ja     1525            ; je grafick˜ videom¢d CGA
                                          ;* proveden¡ operace pro textov‚ m¢dy
1538  8bc2         * mov    ax,dx           ; koncov  pozice
153a  2bc1           sub    ax,cx           ; - po‡ te‡n¡ pozice
153c  050101         add    ax,0101         ; rozmˆry okna
153f  91             xchg   ax,cx           ; CX<-rozmˆry okna, AX<-po‡ t.pozice
1540  e82b0c         call   216e            ; v˜po‡et offsetu v text. str nce
1543  03064e04       add    ax,[044e]       ; po‡ te‡n¡ adresa bufferu displeje
1547  8bf0           mov    si,ax           ; po‡ te‡n¡ adresa okna ve VRAM
1549  8bf8           mov    di,ax           ; po‡ te‡n¡ adresa okna ve VRAM
154b  a14a04         mov    ax,[044a]       ; po‡et pozic na © dek
154e  8be8           mov    bp,ax           ; po‡et pozic na © dek
1550  f6e3           mul    bl              ; po‡et pozic na © dek * ..
1552  d1e0           shl    ax,1
1554  03f0           add    si,ax           ; po‡ te‡n¡ adresa rolov. textu
1556  8ac5           mov    al,ch
1558  2ac3           sub    al,bl
155a  32e4           xor    ah,ah
155c  8ad1           mov    dl,cl
155e  2bea           sub    bp,dx
1560  d1e5           shl    bp,1
1562  f606870404     test   [0487],04       ; testuje se snˆ‘en¡ ?
1567  753a           jnz    15a3            ; prov d¡ se testov n¡ snˆ‘en¡

1569  8cc1         * mov    cx,es
156b  8ed9           mov    ds,cx
156d  0adb           or     bl,bl           ; je nˆjak˜ © dek k maz n¡ ?
156f  742e           jz     159f            ; nen¡ ‘ dn˜ © dek
1571  8bca         * mov    cx,dx           ; po‡et bajt– na © dek k rolov n¡
1573  f3a5           rep    movsw           ; p©enos jednoho © dku
1575  03f5           add    si,bp           ; zv˜¨en¡ adresy © dku
1577  03fd           add    di,bp           ; zv˜¨en¡ adresy © dku
1579  48             dec    ax              ; ‡¡ta‡ © dk– k rolov n¡
157a  75f5           jnz    1571            ; p©enos dal¨¡ho © dku
157c  86e7         * xchg   ah,bh           ; AH <- atribut barvy, BH <- 0
157e  b020           mov    al,20           ; mezera k vymaz n¡ © dku
1580  8bca         * mov    cx,dx           ; po‡et bajt– na © dek
1582  f3ab           rep    stosw           ; vymaz n¡ © dku textu
1584  03fd           add    di,bp           ; zv˜¨en¡ adresy © dku
1586  4b             dec    bx              ; ‡¡ta‡ © dk– k maz n¡
1587  75f7           jnz    1580            ; vymaz n¡ dal¨¡ho © dku
1589  8edb           mov    ds,bx           ; DS <- 0
158b  803e490407     cmp    [0449],07       ; aktivn¡ m¢d displeje
1590  7407           jz     1599            ; je videom¢d MDA
1592  a06504         mov    al,[0465]       ; sou‡asn‚ nastaven¡ registru m¢du
1595  bad803         mov    dx,03d8         ; registr volby barev
1598  ee             out    dx,al           ; nastaven¡ registru volby barev
1599  07           * pop    es              ; n vrat ES
159a  5d             pop    bp              ; n vrat BP
159b  5a             pop    dx              ; n vrat DX
159c  59             pop    cx              ; n vrat CX
159d  5b             pop    bx              ; n vrat BX
159e  c3             ret
159f  8ad8         * mov    bl,al           ; BL <- po‡et © dk– k vymaz n¡
15a1  ebd9           jmp    157c            ; vymaz n¡ cel‚ho okna
                                          ;* je ‡ek n¡ na synchr. impuls
15a3  50             push   ax
15a4  52             push   dx
15a5  bada03         mov    dx,03da         ; stavov˜ registr karty
15a8  ec           * in     al,dx           ; ‡ten¡ stavov‚ho registru
15a9  2408           and    al,08           ; prob¡h  vert. impuls ?
15ab  74fb           jz     15a8            ; ‡ek n¡ na za‡ tek vert. impulsu
15ad  b2d8           mov    dl,d8           ; adresa registru volby barev
15af  b025           mov    al,25           ; modr‚ pozad¡ (???)
15b1  ee             out    dx,al           ; nastaven¡ registru barev
15b2  5a             pop    dx
15b3  58             pop    ax
15b4  ebb3           jmp    1569            ; pokra‡ov n¡ v operaci
                                          ;* je grafick˜ videom¢d CGA
15b6  8bc2           mov    ax,dx           ; koncov  pozice okna
15b8  2bc1           sub    ax,cx           ; rozd¡l pozic okna
15ba  050101         add    ax,0101         ; velikost okna
15bd  d0e4           shl    ah,1            ; AH * 2
15bf  d0e4           shl    ah,1            ; AH * 4
15c1  91             xchg   ax,cx           ; AX<-po‡ te‡n¡ pozice, CX<-rozmˆry
15c2  e8b70b         call   217c            ; v˜po‡et offsetu v graf. str nce
15c5  803e490406     cmp    [0449],06       ; aktivn¡ m¢d displeje
15ca  7404           jz     15d0            ; je videom¢d 640x200 (bajt na znak)
15cc  d1e0           shl    ax,1            ; offset ve videostr nce * 2
15ce  d0e1           shl    cl,1            ; po‡et pozic * 2
15d0  8bf8         * mov    di,ax           ; po‡ te‡n¡ pozice ve videostr nce
15d2  8bf0           mov    si,ax           ; po‡ te‡n¡ pozice ve videostr nce
15d4  d0e3           shl    bl,1            ; po‡et © dk– k vymaz n¡ * 2
15d6  d0e3           shl    bl,1            ; po‡et © dk– k vymaz n¡ * 4
15d8  b050           mov    al,50           ; p©¡rustek adresy = 80 bajt–
15da  f6e3           mul    bl              ; offset za‡ tku textu
15dc  03f0           add    si,ax           ; offset za‡ tku textu k rolov n¡
15de  8ac5           mov    al,ch
15e0  2ac3           sub    al,bl
15e2  32e4           xor    ah,ah
15e4  8ad1           mov    dl,cl
15e6  8bea           mov    bp,dx
15e8  f7dd           neg    bp
15ea  8cc1           mov    cx,es
15ec  8ed9           mov    ds,cx
15ee  0adb           or     bl,bl           ; po‡et © dek k vymaz n¡
15f0  7433           jz     1625            ; nen¡ ‘ dn˜ © dek k vymaz n¡
15f2  8bca         * mov    cx,dx
15f4  f3a4           rep    movsb           ; rolov n¡ 1 © dku
15f6  8db20020       lea    si,[bp+si+2000] ; adresa druh‚ ‡ sti videostr nky
15fa  8dbb0020       lea    di,[bp+di+2000]
15fe  8bca           mov    cx,dx           ; d‚lka 1 © dku
1600  f3a4           rep    movsb           ; rolov n¡ 1 © dku
1602  8db250e0       lea    si,[bp+si+e050] ; adresa prvn¡ ‡ sti videostr nky
1606  8dbb50e0       lea    di,[bp+di+e050]
160a  48             dec    ax              ; sn¡‘en¡ ‡¡ta‡e © dek
160b  75e5           jnz    15f2            ; p©enos dal¨¡ho © dku
160d  86c7           xchg   al,bh           ; AL<-atribut barvy, BH<-0
160f  8bca         * mov    cx,dx           ; d‚lka 1 © dku
1611  f3aa           rep    stosb           ; vymaz n¡ 1 © dku
1613  8dbb0020       lea    di,[bp+di+2000] ; adresa 2. ‡ sti videopamˆti
1617  8bca           mov    cx,dx           ; d‚lka 1 © dku
1619  f3aa           rep    stosb           ; vymaz n¡ 1 © dku
161b  8dbb50e0       lea    di,[bp+di+e050] ; adresa 1. ‡ sti videopamˆti
161f  4b             dec    bx              ; sn¡‘en¡ ‡¡ta‡e © dk–
1620  75ed           jnz    160f            ; maz n¡ dal¨¡ho © dku
1622  e974ff         jmp    1599            ; n vrat z obsluhy
1625  86d8         * xchg   bl,al           ; BL <- v˜¨ka okna v © dc¡ch
1627  ebe4           jmp    160d            ; vymaz n¡ okna
                                          ;* proveden¡ rolov n¡ pro EGA m¢d
1629  8bc2         * mov    ax,dx
162b  2bc1           sub    ax,cx
162d  050101         add    ax,0101
1630  91             xchg   ax,cx
1631  e8580b         call   218c            ; v˜po‡et offsetu v graf. str nce EGA
1634  03064e04       add    ax,[044e]       ; po‡ te‡n¡ adresa bufferu displeje
1638  8bf8           mov    di,ax
163a  8bf0           mov    si,ax
163c  bace03         mov    dx,03ce
163f  b80501         mov    ax,0105
1642  ef             out    dx,ax
1643  b2c4           mov    dl,c4
1645  b8020f         mov    ax,0f02
1648  ef             out    dx,ax
1649  a14a04         mov    ax,[044a]       ; po‡et pozic na © dek
164c  8be8           mov    bp,ax
164e  f6e3           mul    bl
1650  f7268504       mul    w/[0485]        ; po‡et linek na znak (v˜¨ka znaku)
1654  03f0           add    si,ax
1656  a18504         mov    ax,[0485]       ; po‡et linek na znak (v˜¨ka znaku)
1659  50             push   ax
165a  2aeb           sub    ch,bl
165c  f6e5           mul    ch
165e  8ad1           mov    dl,cl
1660  2bea           sub    bp,dx
1662  0adb           or     bl,bl
1664  53             push   bx
1665  8bd8           mov    bx,ax
1667  b800a0         mov    ax,a000
166a  8ec0           mov    es,ax
166c  8ed8           mov    ds,ax
166e  742f           jz     169f
1670  8bca           mov    cx,dx
1672  f3a4           rep    movsb
1674  03f5           add    si,bp
1676  03fd           add    di,bp
1678  4b             dec    bx
1679  75f5           jnz    1670
167b  5b             pop    bx
167c  8bf2           mov    si,dx
167e  bace03         mov    dx,03ce
1681  b80502         mov    ax,0205
1684  ef             out    dx,ax
1685  58             pop    ax
1686  f6e3           mul    bl
1688  8bd0           mov    dx,ax
168a  8ac7           mov    al,bh
168c  8bce           mov    cx,si
168e  f3aa           rep    stosb
1690  03fd           add    di,bp
1692  4a             dec    dx
1693  75f7           jnz    168c
1695  bace03         mov    dx,03ce
1698  b80500         mov    ax,0005
169b  ef             out    dx,ax
169c  e9fafe         jmp    1599

169f  5b             pop    bx
16a0  8add           mov    bl,ch
16a2  ebd8           jmp    167c
; -----------------------------------------------------------------------------
;     Slu‘ba 07h - rolov n¡ okna dol–
; -----------------------------------------------------------------------------
                                            ; INT 10h/7 - rolov n¡ okna dol–
                                            ; VSTUP: AH=7
                                            ;        AL=po‡et © dek k rolov n¡
                                            ;        BH=atributy barev
                                            ;        CH=po‡ te‡n¡ © dek
                                            ;        CL=po‡ te‡n¡ pozice
                                            ;        DH=koncov˜ © dek
                                            ;        DL=koncov  pozice

16a4  53             push   bx
16a5  51             push   cx
16a6  52             push   dx
16a7  55             push   bp
16a8  06             push   es
16a9  fd             std
16aa  8ad8           mov    bl,al
16ac  48             dec    ax
16ad  2ac6           sub    al,dh
16af  02c5           add    al,ch
16b1  98             cbw
16b2  22dc           and    bl,ah
16b4  a04904         mov    al,[0449]       ; aktivn¡ m¢d displeje
16b7  3c07           cmp    al,07
16b9  7213           jc     16ce
16bb  770a           ja     16c7
16bd  be00b0         mov    si,b000
16c0  8ec6           mov    es,si
16c2  eb13           jmp    16d7

16c4  e99000         jmp    1757

16c7  3c0d           cmp    al,0d
16c9  726f           jc     173a
16cb  e90001         jmp    17ce

16ce  be00b8         mov    si,b800
16d1  8ec6           mov    es,si
16d3  3c03           cmp    al,03
16d5  77ed           ja     16c4
16d7  8bc2           mov    ax,dx
16d9  2bd1           sub    dx,cx
16db  81c20101       add    dx,0101
16df  8bca           mov    cx,dx
16e1  e88a0a         call   216e            ; v˜po‡et offsetu v text. str nce
16e4  03064e04       add    ax,[044e]       ; po‡ te‡n¡ adresa bufferu displeje
16e8  8bf0           mov    si,ax
16ea  8bf8           mov    di,ax
16ec  a14a04         mov    ax,[044a]       ; po‡et pozic na © dek
16ef  8be8           mov    bp,ax
16f1  f6e3           mul    bl
16f3  d1e0           shl    ax,1
16f5  2bf0           sub    si,ax
16f7  8ac5           mov    al,ch
16f9  2ac3           sub    al,bl
16fb  32e4           xor    ah,ah
16fd  8ad1           mov    dl,cl
16ff  2bea           sub    bp,dx
1701  d1e5           shl    bp,1
1703  f606870404     test   [0487],04       ; statut ©¡zen¡ video
1708  753a           jnz    1744
170a  8cc1           mov    cx,es
170c  8ed9           mov    ds,cx
170e  0adb           or     bl,bl
1710  742e           jz     1740
1712  8bca           mov    cx,dx
1714  f3a5           rep    movsw
1716  2bf5           sub    si,bp
1718  2bfd           sub    di,bp
171a  48             dec    ax
171b  75f5           jnz    1712
171d  86e7           xchg   ah,bh
171f  b020           mov    al,20
1721  8bca           mov    cx,dx
1723  f3ab           rep    stosw
1725  2bfd           sub    di,bp
1727  4b             dec    bx
1728  75f7           jnz    1721
172a  8edb           mov    ds,bx
172c  803e490407     cmp    [0449],07       ; aktivn¡ m¢d displeje
1731  7407           jz     173a
1733  a06504         mov    al,[0465]       ; sou‡asn‚ nastaven¡ registru m¢du
1736  bad803         mov    dx,03d8
1739  ee             out    dx,al
173a  07             pop    es
173b  5d             pop    bp
173c  5a             pop    dx
173d  59             pop    cx
173e  5b             pop    bx
173f  c3             ret

1740  8ad8           mov    bl,al
1742  ebd9           jmp    171d

1744  50             push   ax
1745  52             push   dx
1746  bada03         mov    dx,03da
1749  ec             in     al,dx
174a  2408           and    al,08
174c  74fb           jz     1749
174e  b2d8           mov    dl,d8
1750  b025           mov    al,25
1752  ee             out    dx,al
1753  5a             pop    dx
1754  58             pop    ax
1755  ebb3           jmp    170a

1757  8bc2           mov    ax,dx
1759  2bd1           sub    dx,cx
175b  81c20101       add    dx,0101
175f  d0e6           shl    dh,1
1761  d0e6           shl    dh,1
1763  8bca           mov    cx,dx
1765  e8140a         call   217c            ; v˜po‡et offsetu v graf. str nce
1768  803e490406     cmp    [0449],06       ; aktivn¡ m¢d displeje
176d  7405           jz     1774
176f  d1e0           shl    ax,1
1771  40             inc    ax
1772  d0e1           shl    cl,1
1774  05f000         add    ax,00f0
1777  8bf8           mov    di,ax
1779  8bf0           mov    si,ax
177b  d0e3           shl    bl,1
177d  d0e3           shl    bl,1
177f  b050           mov    al,50
1781  f6e3           mul    bl
1783  2bf0           sub    si,ax
1785  8ac5           mov    al,ch
1787  2ac3           sub    al,bl
1789  32e4           xor    ah,ah
178b  8ad1           mov    dl,cl
178d  8bea           mov    bp,dx
178f  8cc1           mov    cx,es
1791  8ed9           mov    ds,cx
1793  0adb           or     bl,bl
1795  7433           jz     17ca
1797  8bca           mov    cx,dx
1799  f3a4           rep    movsb
179b  8db20020       lea    si,[bp+si+2000]
179f  8dbb0020       lea    di,[bp+di+2000]
17a3  8bca           mov    cx,dx
17a5  f3a4           rep    movsb
17a7  8db2b0df       lea    si,[bp+si+dfb0]
17ab  8dbbb0df       lea    di,[bp+di+dfb0]
17af  48             dec    ax
17b0  75e5           jnz    1797
17b2  86c7           xchg   al,bh
17b4  8bca           mov    cx,dx
17b6  f3aa           rep    stosb
17b8  8dbb0020       lea    di,[bp+di+2000]
17bc  8bca           mov    cx,dx
17be  f3aa           rep    stosb
17c0  8dbbb0df       lea    di,[bp+di+dfb0]
17c4  4b             dec    bx
17c5  75ed           jnz    17b4
17c7  e970ff         jmp    173a

17ca  86d8           xchg   bl,al
17cc  ebe4           jmp    17b2

17ce  8bc2           mov    ax,dx
17d0  2bd1           sub    dx,cx
17d2  81c20101       add    dx,0101
17d6  8bca           mov    cx,dx
17d8  fec4           inc    ah
17da  e8af09         call   218c            ; v˜po‡et offsetu v graf. str nce EGA
17dd  2b064a04       sub    ax,[044a]       ; po‡et pozic na © dek
17e1  03064e04       add    ax,[044e]       ; po‡ te‡n¡ adresa bufferu displeje
17e5  8bf8           mov    di,ax
17e7  8bf0           mov    si,ax
17e9  bace03         mov    dx,03ce
17ec  b80501         mov    ax,0105
17ef  ef             out    dx,ax
17f0  b2c4           mov    dl,c4
17f2  b8020f         mov    ax,0f02
17f5  ef             out    dx,ax
17f6  a14a04         mov    ax,[044a]       ; po‡et pozic na © dek
17f9  8be8           mov    bp,ax
17fb  f6e3           mul    bl
17fd  f7268504       mul    w/[0485]        ; po‡et linek na znak (v˜¨ka znaku)
1801  2bf0           sub    si,ax
1803  a18504         mov    ax,[0485]       ; po‡et linek na znak (v˜¨ka znaku)
1806  50             push   ax
1807  2aeb           sub    ch,bl
1809  f6e5           mul    ch
180b  8ad1           mov    dl,cl
180d  2bea           sub    bp,dx
180f  0adb           or     bl,bl
1811  53             push   bx
1812  8bd8           mov    bx,ax
1814  b800a0         mov    ax,a000
1817  8ec0           mov    es,ax
1819  8ed8           mov    ds,ax
181b  742f           jz     184c
181d  8bca           mov    cx,dx
181f  f3a4           rep    movsb
1821  2bf5           sub    si,bp
1823  2bfd           sub    di,bp
1825  4b             dec    bx
1826  75f5           jnz    181d
1828  5b             pop    bx
1829  8bf2           mov    si,dx
182b  bace03         mov    dx,03ce
182e  b80502         mov    ax,0205
1831  ef             out    dx,ax
1832  58             pop    ax
1833  f6e3           mul    bl
1835  8bd0           mov    dx,ax
1837  8ac7           mov    al,bh
1839  8bce           mov    cx,si
183b  f3aa           rep    stosb
183d  2bfd           sub    di,bp
183f  4a             dec    dx
1840  75f7           jnz    1839
1842  bace03         mov    dx,03ce
1845  b80500         mov    ax,0005
1848  ef             out    dx,ax
1849  e9eefe         jmp    173a

184c  5b             pop    bx
184d  8add           mov    bl,ch
184f  ebd8           jmp    1829

; -----------------------------------------------------------------------------
;     Slu‘ba 08h - ‡ten¡ znaku a atributu
; -----------------------------------------------------------------------------

                                          ;* INT 10h/8 - ‡ten¡ znaku a atrib.
                                            ; VSTUP: AH=8
                                            ;        BH=‡¡slo str nky displeje

1851  52             push   dx              ; £schova DX
1852  a04904         mov    al,[0449]       ; aktivn¡ m¢d displeje
1855  ba00b8         mov    dx,b800         ; segment videopamˆti pro CGA m¢dy
1858  3c03           cmp    al,03           ; je CGA m¢d ?
185a  7606           jna    1862            ; je CGA m¢d
185c  3c07           cmp    al,07           ; je MDA m¢d ?
185e  753b           jnz    189b            ; nen¡ MDA m¢d
1860  b6b0           mov    dh,b0           ; segment videopamˆti pro MDA m¢d
                                          ;* je textov˜ m¢d
1862  52           * push   dx              ; segment videopamˆti -> STACK
1863  8ac7           mov    al,bh           ; ‡¡slo str nky displeje
1865  98             cbw                    ; AX <- ‡¡slo str nky
1866  8bf8           mov    di,ax           ; DI <- ‡¡slo str nky
1868  f7264c04       mul    w/[044c]        ; d‚lka zobrazovan‚ho bufferu disp.
186c  8bf0           mov    si,ax           ; offset str nky ve videopamˆti
186e  d1e7           shl    di,1            ; ‡¡slo str nky * 2
1870  8b855004       mov    ax,[di+0450]    ; pozice kurzoru ve str nce
1874  e8f708         call   216e            ; v˜po‡et offsetu v text. str nce
1877  03f0           add    si,ax           ; adresa kurzoru ve str nce
1879  f606870404     test   [0487],04       ; statut ©¡zen¡ video
187e  7504           jnz    1884            ; prov d¡ se kontrola snˆ‘en¡
1880  1f             pop    ds              ; DS <- segment videopamˆti
1881  ad             lodsw                  ; na‡ten¡ znaku s atributem
1882  5a             pop    dx              ; n vrat DX
1883  c3             ret
                                          ;* prov d¡ se kontrola snˆ‘en¡
1884  8b166304       mov    dx,[0463]       ; b zov  ©¡dic¡ adresa displeje
1888  80c206         add    dl,06
188b  1f             pop    ds
188c  ec           * in     al,dx
188d  d0e8           shr    al,1
188f  72fb           jc     188c
1891  fa             cli
1892  ec           * in     al,dx
1893  d0e8           shr    al,1
1895  73fb           jnc    1892
1897  ad             lodsw                  ; na‡ten¡ znaku s atributem
1898  fb             sti
1899  5a             pop    dx
189a  c3             ret
                                          ;* ‡ten¡ znaku v grafick‚m m¢du
189b  51             push   cx              ; £schova CX
189c  06             push   es              ; £schova ES
189d  776b           ja     190a            ; je grafick˜ m¢d EGA
189f  a15004         mov    ax,[0450]       ; pozice kurzor– ve str nk ch
18a2  e8d708         call   217c            ; v˜po‡et offsetu v graf. str nce
18a5  8bf0           mov    si,ax           ; offset znaku ve videopamˆti
18a7  83ec08         sub    sp,0008         ; rezerva v z sobn¡ku pro data
18aa  8bfc           mov    di,sp           ; adresa pro ukl d n¡ dat do z sob.
18ac  8cd0           mov    ax,ss           ; segment pro ukl d n¡ dat
18ae  8ec0           mov    es,ax           ; segment pro ukl d n¡ dat
18b0  b800b8         mov    ax,b800         ; segment videopamˆti pro CGA m¢d
18b3  b90400         mov    cx,0004         ; po‡et slov znaku k p©enosu
18b6  803e490406     cmp    [0449],06       ; aktivn¡ m¢d displeje
18bb  8ed8           mov    ds,ax
18bd  740f           jz     18ce            ; je videom¢d CGA 640x200
                                          ;* na‡ten¡ znaku pro videom¢dy CGA
18bf  d1e6           shl    si,1            ; offset ve videopamˆti
18c1  e8ab00       * call   196f            ; na‡ten¡ bajtu graf. znaku CGA
18c4  e8a800         call   196f            ; na‡ten¡ bajtu graf. znaku CGA
18c7  83c650         add    si,0050         ; zv˜¨en¡ adresy
18ca  e2f5           loop   18c1            ; na‡ten¡ dal¨¡ho bajtu znaku
18cc  eb0d           jmp    18db            ; nalezen¡ znaku ve fontech
                                          ;* na‡ten¡ znaku pro videom¢d 640x200
18ce  8a04         * mov    al,[si]         ; bajt graf. znaku
18d0  aa             stosb                  ; ulo‘en¡ bajtu graf. znaku
18d1  8a840020       mov    al,[si+2000]    ; sud˜ bajt graf. znaku
18d5  aa             stosb                  ; ulo‘en¡ bajtu graf. znaku
18d6  83c650         add    si,0050         ; zv˜¨en¡ adresy
18d9  e2f3           loop   18ce            ; na‡ten¡ dal¨¡ch 2 bajt–
18db  8ed9         * mov    ds,cx           ; DS <- 0
18dd  c5360c01       lds    si,[010c]       ; ukazatel na inicializa‡n¡ font EGA
18e1  83ef08         sub    di,0008         ; n vrat ulo‘en‚ho znaku v z sobn¡ku
18e4  33c0           xor    ax,ax           ; AX <- 0 ‡¡ta‡ znak–
18e6  56           * push   si              ; £schova ukazatele v tabulce font–
18e7  57             push   di              ; £schova ukazatele na‡ten‚ho znaku
18e8  b104           mov    cl,04           ; po‡et slov k porovn n¡
18ea  f3a7           rep    cmpsw           ; porovn n¡ znaku s fontem
18ec  5f             pop    di              ; n vrat ukazatele na‡ten‚ho znaku
18ed  5e             pop    si              ; n vrat ukazatele v tabulce font–
18ee  7413           je     1903            ; znak byl nalezen
18f0  83c608         add    si,0008         ; zv˜¨en¡ adresy v tabulce znak–
18f3  fec0           inc    al              ; zv˜¨en¡ ukazatele znaku
18f5  740c           jz     1903            ; je ji‘ konec tabulky font–
18f7  71ed           jno    18e6            ; nen¡ je¨tˆ p©ete‡en¡ konce tabulky
18f9  33c9           xor    cx,cx           ; CX <- 0
18fb  8ed9           mov    ds,cx           ; DS <- 0 nov  adresa segmentu
18fd  c5367c00       lds    si,[007c]       ; ukazatel tabulky graf. znak–
1901  ebe3           jmp    18e6            ; hled n¡ v tabulce znak– 128 - 255
                                          ;* konec hled n¡
1903  83c408       * add    sp,0008         ; n vrat ukazatele SP
1906  07             pop    es              ; n vrat ES
1907  59             pop    cx              ; n vrat CX
1908  5a             pop    dx              ; n vrat DX
1909  c3             ret
                                          ;* ‡ten¡ znaku v graf. m¢du EGA
190a  53           * push   bx              ; £schova ‡¡sla str nky
190b  b6a0           mov    dh,a0           ; segment videopamˆti A000h
190d  52             push   dx              ; £schova segment videopamˆti
190e  8ac7           mov    al,bh           ; AL <- ‡¡slo str nky
1910  98             cbw                    ; AX <- ‡¡slo str nky
1911  8bf8           mov    di,ax           ; DI <- ‡¡slo str nky
1913  f7264c04       mul    w/[044c]        ; d‚lka zobrazovan‚ho bufferu disp.
1917  8bf0           mov    si,ax           ; offset za‡ tku str nky
1919  d1e7           shl    di,1            ; ‡¡slo str nky * 2
191b  8b855004       mov    ax,[di+0450]    ; pozice kurzoru ve str nce
191f  e86a08         call   218c            ; v˜po‡et offsetu v graf. str nce EGA
1922  03f0           add    si,ax           ; adresa kurzoru ve videopamˆti
1924  bace03         mov    dx,03ce         ; adresa registru ©adi‡e grafiky
1927  b80508         mov    ax,0805         ; nastaven¡ m¢du ‡ten¡
192a  ef             out    dx,ax           ; nastaven¡ registru m¢du ‡ten¡
192b  8b1e8504       mov    bx,[0485]       ; po‡et linek na znak (v˜¨ka znaku)
192f  8b164a04       mov    dx,[044a]       ; po‡et pozic na © dek
1933  1f             pop    ds              ; segment videopamˆti
1934  2be3           sub    sp,bx           ; vytvo©en¡ m¡sta pro na‡ten¡ znaku
1936  8bfc           mov    di,sp           ; ukl dac¡ adresa pro na‡ten¡ znaku
1938  8cd0           mov    ax,ss           ; segment z sobn¡ku
193a  8ec0           mov    es,ax           ; ES <- segment ukl dac¡ adresy
193c  8bcb           mov    cx,bx           ; po‡et bajt– k na‡ten¡
193e  8a04         * mov    al,[si]         ; na‡ten¡ bajtu z videopamˆti
1940  f6d0           not    al              ; negace barev
1942  aa             stosb                  ; ulo‘en¡ bajtu
1943  03f2           add    si,dx           ; zv˜¨en¡ adresy ve videopamˆti
1945  e2f7           loop   193e            ; na‡ten¡ dal¨¡ho bajtu
1947  bace03         mov    dx,03ce         ; registr grafick‚ho ©adi‡e
194a  b80500         mov    ax,0005         ; nastaven¡ m¢du ‡ten¡
194d  ef             out    dx,ax           ; zpˆtn‚ nastaven¡ registru ©adi‡e
194e  8ed9           mov    ds,cx           ; DS <- 0
1950  c5360c01       lds    si,[010c]       ; ukazatel na inicializa‡n¡ m¢d EGA
1954  2bfb           sub    di,bx           ; n vrat adresy na‡ten‚ho znaku
1956  33c0           xor    ax,ax           ; AX <- 0 ‡¡ta‡ znak–
1958  56             push   si              ; £schova ukazatele v tabulce font–
1959  57             push   di              ; £schova ukazatele na‡ten‚ho znaku
195a  8bcb           mov    cx,bx           ; po‡et bajt– k porovn n¡
195c  f3a6           rep    cmpsb           ; porovn n¡ znaku s fontem
195e  5f             pop    di              ; n vrat ukazatele na‡ten‚ho znaku
195f  5e             pop    si              ; n vrat ukazatele v tabulce font–
1960  7406           jz     1968            ; znak nalezen
1962  03f3           add    si,bx           ; zv˜¨en¡ adresy v tabulce font–
1964  fec0           inc    al              ; zv˜¨en¡ ‡¡ta‡e znak–
1966  75f0           jnz    1958            ; test dal¨¡ho znaku
1968  03e3         * add    sp,bx           ; n vrat ukazatele SP
196a  5b             pop    bx              ; n vrat BX
196b  07             pop    es              ; n vrat ES
196c  59             pop    cx              ; n vrat CX
196d  5a             pop    dx              ; n vrat DX
196e  c3             ret

                                          ;* na‡ten¡ bajtu graf. znaku CGA
196f  51             push   cx              ; £schova CX
1970  8b14           mov    dx,[si]         ; slovo graf.znaku z videopamˆti
1972  86d6           xchg   dl,dh
1974  b90800         mov    cx,0008         ; po‡et bit– bajtu
1977  d1e2         * shl    dx,1            ; graf. slovo * 2
1979  7203           jc     197e            ; bit 15 = 1
197b  7901           jns    197e            ; bit 14 = 0
197d  f9             stc                    ;
197e  d0d0         * rcl    al,1            ; narolov n¡ v˜sledn‚ho bitu
1980  d1e2           shl    dx,1            ; graf. slovo * 2
1982  e2f3           loop   1977            ; p©ek¢dov n¡ dal¨¡ dvojice bit–
1984  aa             stosb                  ; ulo‘en¡ na‡ten‚ho bajtu
1985  81f60020       xor    si,2000         ; zmˆna ‡ sti videostr nky
1989  59             pop    cx              ; n vrat CX
198a  c3             ret
; -----------------------------------------------------------------------------
;     Slu‘ba 09h - z pis znaku s atributem
; -----------------------------------------------------------------------------
                                            ; INT 10h/9 - z pis znaku s atrib.
198b  51             push   cx
198c  52             push   dx
198d  06             push   es
198e  8ae3           mov    ah,bl
1990  50             push   ax
1991  a04904         mov    al,[0449]       ; aktivn¡ m¢d displeje
1994  ba00b8         mov    dx,b800
1997  3c03           cmp    al,03
1999  7606           jna    19a1
199b  3c07           cmp    al,07
199d  7545           jnz    19e4
199f  b6b0           mov    dh,b0
19a1  8ec2           mov    es,dx
19a3  8ac7           mov    al,bh
19a5  98             cbw
19a6  8bf0           mov    si,ax
19a8  f7264c04       mul    w/[044c]        ; d‚lka zobrazovan‚ho bufferu disp.
19ac  8bf8           mov    di,ax
19ae  d1e6           shl    si,1
19b0  8b845004       mov    ax,[si+0450]    ; pozice kurzor– ve str nk ch
19b4  e8b707         call   216e            ; v˜po‡et offsetu v text. str nce
19b7  03f8           add    di,ax
19b9  f606870404     test   [0487],04       ; statut ©¡zen¡ video
19be  7507           jnz    19c7
19c0  58             pop    ax
19c1  f3ab           rep    stosw
19c3  07             pop    es
19c4  5a             pop    dx
19c5  59             pop    cx
19c6  c3             ret

19c7  8b166304       mov    dx,[0463]       ; b zov  ©¡dic¡ adresa displeje
19cb  80c206         add    dl,06
19ce  5e             pop    si
19cf  ec             in     al,dx
19d0  d0e8           shr    al,1
19d2  72fb           jc     19cf
19d4  fa             cli
19d5  ec             in     al,dx
19d6  d0e8           shr    al,1
19d8  73fb           jnc    19d5
19da  8bc6           mov    ax,si
19dc  ab             stosw
19dd  fb             sti
19de  e2ef           loop   19cf
19e0  07             pop    es
19e1  5a             pop    dx
19e2  59             pop    cx
19e3  c3             ret

19e4  773d           ja     1a23
19e6  8ec2           mov    es,dx
19e8  a15004         mov    ax,[0450]       ; pozice kurzor– ve str nk ch
19eb  e88e07         call   217c            ; v˜po‡et offsetu v graf. str nce
19ee  8bf8           mov    di,ax
19f0  8a164904       mov    dl,[0449]       ; aktivn¡ m¢d displeje
19f4  58             pop    ax
19f5  0ac0           or     al,al
19f7  7908           jns    1a01
19f9  c5367c00       lds    si,[007c]
19fd  247f           and    al,7f
19ff  eb04           jmp    1a05

1a01  c5360c01       lds    si,[010c]
1a05  98             cbw
1a06  d1e0           shl    ax,1
1a08  d1e0           shl    ax,1
1a0a  d1e0           shl    ax,1
1a0c  03f0           add    si,ax
1a0e  80fa06         cmp    dl,06
1a11  7409           jz     1a1c
1a13  d1e7           shl    di,1
1a15  53             push   bx
1a16  e81301         call   1b2c
1a19  5b             pop    bx
1a1a  eb03           jmp    1a1f

1a1c  e8a900         call   1ac8
1a1f  07             pop    es
1a20  5a             pop    dx
1a21  59             pop    cx
1a22  c3             ret

1a23  b6a0           mov    dh,a0
1a25  8ec2           mov    es,dx
1a27  8ac7           mov    al,bh
1a29  98             cbw
1a2a  8bf0           mov    si,ax
1a2c  f7264c04       mul    w/[044c]        ; d‚lka zobrazovan‚ho bufferu disp.
1a30  8bf8           mov    di,ax
1a32  d1e6           shl    si,1
1a34  8b845004       mov    ax,[si+0450]    ; pozice kurzor– ve str nk ch
1a38  e85107         call   218c            ; v˜po‡et offsetu v graf. str nce EGA
1a3b  03f8           add    di,ax
1a3d  58             pop    ax
1a3e  55             push   bp
1a3f  51             push   cx
1a40  8b2e4a04       mov    bp,[044a]       ; po‡et pozic na © dek
1a44  8b0e8504       mov    cx,[0485]       ; po‡et linek na znak (v˜¨ka znaku)
1a48  c5360c01       lds    si,[010c]
1a4c  f6e1           mul    cl
1a4e  03f0           add    si,ax
1a50  0adb           or     bl,bl
1a52  783d           js     1a91
1a54  b052           mov    al,52
1a56  51             push   cx
1a57  51             push   cx
1a58  bac403         mov    dx,03c4
1a5b  b8020f         mov    ax,0f02
1a5e  ef             out    dx,ax
1a5f  33c0           xor    ax,ax
1a61  57             push   di
1a62  268805         mov    es:[di],al
1a65  03fd           add    di,bp
1a67  e2f9           loop   1a62
1a69  5f             pop    di
1a6a  b002           mov    al,02
1a6c  8ae3           mov    ah,bl
1a6e  ef             out    dx,ax
1a6f  8bd7           mov    dx,di
1a71  59             pop    cx
1a72  ac             lodsb
1a73  268805         mov    es:[di],al
1a76  03fd           add    di,bp
1a78  e2f8           loop   1a72
1a7a  59             pop    cx
1a7b  2bf1           sub    si,cx
1a7d  8bfa           mov    di,dx
1a7f  47             inc    di
1a80  5a             pop    dx
1a81  4a             dec    dx
1a82  75d1           jnz    1a55
1a84  bac403         mov    dx,03c4
1a87  b8020f         mov    ax,0f02
1a8a  ef             out    dx,ax
1a8b  5d             pop    bp
1a8c  07             pop    es
1a8d  5a             pop    dx
1a8e  59             pop    cx
1a8f  c3             ret

1a90  52             push   dx
1a91  bace03         mov    dx,03ce
1a94  b80318         mov    ax,1803
1a97  ef             out    dx,ax
1a98  bac403         mov    dx,03c4
1a9b  b002           mov    al,02
1a9d  8ae3           mov    ah,bl
1a9f  ef             out    dx,ax
1aa0  51             push   cx
1aa1  8bd7           mov    dx,di
1aa3  ac             lodsb
1aa4  268605         xchg   al,es:[di]
1aa7  03fd           add    di,bp
1aa9  e2f8           loop   1aa3
1aab  59             pop    cx
1aac  2bf1           sub    si,cx
1aae  8bfa           mov    di,dx
1ab0  47             inc    di
1ab1  5a             pop    dx
1ab2  4a             dec    dx
1ab3  75db           jnz    1a90
1ab5  bace03         mov    dx,03ce
1ab8  b80300         mov    ax,0003
1abb  ef             out    dx,ax
1abc  bac403         mov    dx,03c4
1abf  b8020f         mov    ax,0f02
1ac2  ef             out    dx,ax
1ac3  5d             pop    bp
1ac4  07             pop    es
1ac5  5a             pop    dx
1ac6  59             pop    cx
1ac7  c3             ret

1ac8  0adb           or     bl,bl
1aca  7830           js     1afc
1acc  ad             lodsw
1acd  268805         mov    es:[di],al
1ad0  2688a50020     mov    es:[di+2000],ah
1ad5  ad             lodsw
1ad6  26884550       mov    es:[di+50],al
1ada  2688a55020     mov    es:[di+2050],ah
1adf  ad             lodsw
1ae0  268885a000     mov    es:[di+00a0],al
1ae5  2688a5a020     mov    es:[di+20a0],ah
1aea  ad             lodsw
1aeb  268885f000     mov    es:[di+00f0],al
1af0  2688a5f020     mov    es:[di+20f0],ah
1af5  83ee08         sub    si,0008
1af8  47             inc    di
1af9  e2d1           loop   1acc
1afb  c3             ret

1afc  ad             lodsw
1afd  263005         xor    es:[di],al
1b00  2630a50020     xor    es:[di+2000],ah
1b05  ad             lodsw
1b06  26304550       xor    es:[di+50],al
1b0a  2630a55020     xor    es:[di+2050],ah
1b0f  ad             lodsw
1b10  263085a000     xor    es:[di+00a0],al
1b15  2630a5a020     xor    es:[di+20a0],ah
1b1a  ad             lodsw
1b1b  263085f000     xor    es:[di+00f0],al
1b20  2630a5f020     xor    es:[di+20f0],ah
1b25  83ee08         sub    si,0008
1b28  47             inc    di
1b29  e2d1           loop   1afc
1b2b  c3             ret

1b2c  8ad3           mov    dl,bl
1b2e  80e203         and    dl,03
1b31  8af2           mov    dh,dl
1b33  d0e2           shl    dl,1
1b35  d0e2           shl    dl,1
1b37  0ad6           or     dl,dh
1b39  d0e2           shl    dl,1
1b3b  d0e2           shl    dl,1
1b3d  0ad6           or     dl,dh
1b3f  d0e2           shl    dl,1
1b41  d0e2           shl    dl,1
1b43  0ad6           or     dl,dh
1b45  8af2           mov    dh,dl
1b47  0adb           or     bl,bl
1b49  7823           js     1b6e
1b4b  b704           mov    bh,04
1b4d  ac             lodsb
1b4e  e84000         call   1b91
1b51  268905         mov    es:[di],ax
1b54  ac             lodsb
1b55  e83900         call   1b91
1b58  2689850020     mov    es:[di+2000],ax
1b5d  83c750         add    di,0050
1b60  fecf           dec    bh
1b62  75e9           jnz    1b4d
1b64  83ee08         sub    si,0008
1b67  81ef3e01       sub    di,013e
1b6b  e2de           loop   1b4b
1b6d  c3             ret

1b6e  b704           mov    bh,04
1b70  ac             lodsb
1b71  e81d00         call   1b91
1b74  263105         xor    es:[di],ax
1b77  ac             lodsb
1b78  e81600         call   1b91
1b7b  2631850020     xor    es:[di+2000],ax
1b80  83c750         add    di,0050
1b83  fecf           dec    bh
1b85  75e9           jnz    1b70
1b87  83ee08         sub    si,0008
1b8a  81ef3e01       sub    di,013e
1b8e  e2de           loop   1b6e
1b90  c3             ret

1b91  d1c8           ror    ax,1
1b93  d0fc           sar    ah,1
1b95  d1c8           ror    ax,1
1b97  d0fc           sar    ah,1
1b99  d1c8           ror    ax,1
1b9b  d0fc           sar    ah,1
1b9d  d1c8           ror    ax,1
1b9f  d0fc           sar    ah,1
1ba1  8adc           mov    bl,ah
1ba3  d1c8           ror    ax,1
1ba5  d0fc           sar    ah,1
1ba7  d1c8           ror    ax,1
1ba9  d0fc           sar    ah,1
1bab  d1c8           ror    ax,1
1bad  d0fc           sar    ah,1
1baf  d1c8           ror    ax,1
1bb1  d0fc           sar    ah,1
1bb3  8ac4           mov    al,ah
1bb5  8ae3           mov    ah,bl
1bb7  23c2           and    ax,dx
1bb9  c3             ret
; -----------------------------------------------------------------------------
;     Slu‘ba 0ah - z pis znaku
; -----------------------------------------------------------------------------
                                            ; INT 10h/0ah - z pis znaku
1bba  51             push   cx
1bbb  52             push   dx
1bbc  06             push   es
1bbd  50             push   ax
1bbe  a04904         mov    al,[0449]       ; aktivn¡ m¢d displeje
1bc1  ba00b8         mov    dx,b800
1bc4  3c03           cmp    al,03
1bc6  7606           jna    1bce
1bc8  3c07           cmp    al,07
1bca  7549           jnz    1c15
1bcc  b6b0           mov    dh,b0
1bce  8ec2           mov    es,dx
1bd0  8ac7           mov    al,bh
1bd2  98             cbw
1bd3  8bf0           mov    si,ax
1bd5  f7264c04       mul    w/[044c]        ; d‚lka zobrazovan‚ho bufferu disp.
1bd9  8bf8           mov    di,ax
1bdb  d1e6           shl    si,1
1bdd  8b845004       mov    ax,[si+0450]    ; pozice kurzor– ve str nk ch
1be1  e88a05         call   216e            ; v˜po‡et offsetu v text. str nce
1be4  03f8           add    di,ax
1be6  58             pop    ax
1be7  f606870404     test   [0487],04       ; statut ©¡zen¡ video
1bec  7508           jnz    1bf6
1bee  aa             stosb
1bef  47             inc    di
1bf0  e2fc           loop   1bee
1bf2  07             pop    es
1bf3  5a             pop    dx
1bf4  59             pop    cx
1bf5  c3             ret

1bf6  8b166304       mov    dx,[0463]       ; b zov  ©¡dic¡ adresa displeje
1bfa  80c206         add    dl,06
1bfd  8ae0           mov    ah,al
1bff  ec             in     al,dx
1c00  d0e8           shr    al,1
1c02  72fb           jc     1bff
1c04  fa             cli
1c05  ec             in     al,dx
1c06  d0e8           shr    al,1
1c08  73fb           jnc    1c05
1c0a  8ac4           mov    al,ah
1c0c  aa             stosb
1c0d  fb             sti
1c0e  47             inc    di
1c0f  e2ee           loop   1bff
1c11  07             pop    es
1c12  5a             pop    dx
1c13  59             pop    cx
1c14  c3             ret

1c15  e9ccfd         jmp    19e4
; -----------------------------------------------------------------------------
;     Slu‘ba 0bh - nastaven¡ palety
; -----------------------------------------------------------------------------
                                            ; INT 10h/0bh - nastaven¡ palety
1c18  803e6304b4     cmp    [0463],b4       ; b zov  ©¡dic¡ adresa displeje
1c1d  7409           jz     1c28            ; je displej MDA nebo videom¢d MONO
1c1f  f606870402     test   [0487],02       ; je displej MDA ?
1c24  7403           jz     1c29            ; nen¡ disple MDA
1c26  cd42           int    42
1c28  c3             ret

1c29  53             push   bx
1c2a  06             push   es
1c2b  c43ea804       les    di,[04a8]       ; ukazatek videoparametr– EGA
1c2f  26c47d04       les    di,es:[di+04]
1c33  8cc6           mov    si,es
1c35  0bf7           or     si,di
1c37  0aff           or     bh,bh
1c39  754f           jnz    1c8a
1c3b  a06604         mov    al,[0466]       ; sou‡asn‚ nastaven¡ registru barev
1c3e  8ae3           mov    ah,bl
1c40  25e01f         and    ax,1fe0
1c43  0ac4           or     al,ah
1c45  8af8           mov    bh,al
1c47  a26604         mov    [0466],al       ; sou‡asn‚ nastaven¡ registru barev
1c4a  80e408         and    ah,08
1c4d  d0e4           shl    ah,1
1c4f  80e307         and    bl,07
1c52  0adc           or     bl,ah
1c54  803e490403     cmp    [0449],03       ; aktivn¡ m¢d displeje
1c59  7610           jna    1c6b
1c5b  8ac3           mov    al,bl
1c5d  32e4           xor    ah,ah
1c5f  e82d07         call   238f            ; synchronizov. nastaven¡ reg. 03C0h
1c62  0bf6           or     si,si
1c64  740a           jz     1c70
1c66  268805         mov    es:[di],al
1c69  eb05           jmp    1c70

1c6b  e80307         call   2371            ; monitor ECM s vy¨¨¡m rozli¨en¡m ?
1c6e  7407           jz     1c77
1c70  8ac3           mov    al,bl
1c72  b411           mov    ah,11
1c74  e81807         call   238f            ; synchronizov. nastaven¡ reg. 03C0h
1c77  0bf6           or     si,si
1c79  7404           jz     1c7f
1c7b  26884510       mov    es:[di+10],al
1c7f  8adf           mov    bl,bh
1c81  80e320         and    bl,20
1c84  d0e3           shl    bl,1
1c86  d0e3           shl    bl,1
1c88  d0c3           rol    bl,1
1c8a  803e490403     cmp    [0449],03       ; aktivn¡ m¢d displeje
1c8f  7620           jna    1cb1
1c91  a06604         mov    al,[0466]       ; sou‡asn‚ nastaven¡ registru barev
1c94  24df           and    al,df
1c96  80e301         and    bl,01
1c99  7402           jz     1c9d
1c9b  0c20           or     al,20
1c9d  a26604         mov    [0466],al       ; sou‡asn‚ nastaven¡ registru barev
1ca0  2410           and    al,10
1ca2  0c02           or     al,02
1ca4  0ac3           or     al,bl
1ca6  b401           mov    ah,01
1ca8  e80c00         call   1cb7
1cab  e80900         call   1cb7
1cae  e80600         call   1cb7
1cb1  e8cb06         call   237f            ; rozsv¡cen¡ displeje
1cb4  07             pop    es
1cb5  5b             pop    bx
1cb6  c3             ret

1cb7  e8d506         call   238f            ; synchronizov. nastaven¡ reg. 03C0h
1cba  0bf6           or     si,si
1cbc  7404           jz     1cc2
1cbe  47             inc    di
1cbf  268805         mov    es:[di],al
1cc2  050201         add    ax,0102
1cc5  c3             ret
; -----------------------------------------------------------------------------
;     Slu‘ba 0ch - z pis bodu
; -----------------------------------------------------------------------------
                                            ; INT 10h/0ch - z pis bodu
1cc6  51             push   cx
1cc7  52             push   dx
1cc8  50             push   ax
1cc9  803e490407     cmp    [0449],07       ; aktivn¡ m¢d displeje
1cce  7757           ja     1d27
1cd0  8af0           mov    dh,al
1cd2  8ae2           mov    ah,dl
1cd4  80e4fe         and    ah,fe
1cd7  b028           mov    al,28
1cd9  f6e4           mul    ah
1cdb  d0ea           shr    dl,1
1cdd  7303           jnc    1ce2
1cdf  80cc20         or     ah,20
1ce2  8bf8           mov    di,ax
1ce4  8bf1           mov    si,cx
1ce6  d1ee           shr    si,1
1ce8  d1ee           shr    si,1
1cea  803e490406     cmp    [0449],06       ; aktivn¡ m¢d displeje
1cef  b800b8         mov    ax,b800
1cf2  8ed8           mov    ds,ax
1cf4  8ae6           mov    ah,dh
1cf6  7206           jc     1cfe
1cf8  d1ee           shr    si,1
1cfa  b080           mov    al,80
1cfc  eb06           jmp    1d04

1cfe  d0e1           shl    cl,1
1d00  b0c0           mov    al,c0
1d02  d0cc           ror    ah,1
1d04  03fe           add    di,si
1d06  d0cc           ror    ah,1
1d08  80e107         and    cl,07
1d0b  22e0           and    ah,al
1d0d  d3e8           shr    ax,cl
1d0f  8a0d           mov    cl,[di]
1d11  d0e6           shl    dh,1
1d13  720a           jc     1d1f
1d15  f6d0           not    al
1d17  22c8           and    cl,al
1d19  0acc           or     cl,ah
1d1b  880d           mov    [di],cl
1d1d  eb04           jmp    1d23

1d1f  32cc           xor    cl,ah
1d21  880d           mov    [di],cl
1d23  58             pop    ax
1d24  5a             pop    dx
1d25  59             pop    cx
1d26  c3             ret

1d27  8bc2           mov    ax,dx
1d29  f7264a04       mul    w/[044a]        ; po‡et pozic na © dek
1d2d  8bf9           mov    di,cx
1d2f  d1ef           shr    di,1
1d31  d1ef           shr    di,1
1d33  d1ef           shr    di,1
1d35  03f8           add    di,ax
1d37  8ac7           mov    al,bh
1d39  98             cbw
1d3a  f7264c04       mul    w/[044c]        ; d‚lka zobrazovan‚ho bufferu disp.
1d3e  03f8           add    di,ax
1d40  b480           mov    ah,80
1d42  80e107         and    cl,07
1d45  d2ec           shr    ah,cl
1d47  bace03         mov    dx,03ce
1d4a  b008           mov    al,08
1d4c  ef             out    dx,ax
1d4d  b800a0         mov    ax,a000
1d50  8ed8           mov    ds,ax
1d52  59             pop    cx
1d53  0ac9           or     cl,cl
1d55  7908           jns    1d5f
1d57  b80318         mov    ax,1803
1d5a  ef             out    dx,ax
1d5b  b2c4           mov    dl,c4
1d5d  eb0a           jmp    1d69

1d5f  b2c4           mov    dl,c4
1d61  b8020f         mov    ax,0f02
1d64  ef             out    dx,ax
1d65  32c0           xor    al,al
1d67  8605           xchg   al,[di]
1d69  b002           mov    al,02
1d6b  8ae1           mov    ah,cl
1d6d  ef             out    dx,ax
1d6e  b0ff           mov    al,ff
1d70  8605           xchg   al,[di]
1d72  b8020f         mov    ax,0f02
1d75  ef             out    dx,ax
1d76  b2ce           mov    dl,ce
1d78  b80300         mov    ax,0003
1d7b  ef             out    dx,ax
1d7c  b808ff         mov    ax,ff08
1d7f  ef             out    dx,ax
1d80  5a             pop    dx
1d81  59             pop    cx
1d82  c3             ret

; -----------------------------------------------------------------------------
;     Slu‘ba 0dh - ‡ten¡ bodu
; -----------------------------------------------------------------------------
                                            ; INT 10h/0dh - ‡ten¡ bodu
1d83  51             push   cx
1d84  52             push   dx
1d85  803e490407     cmp    [0449],07       ; aktivn¡ m¢d displeje
1d8a  7749           ja     1dd5
1d8c  8ae2           mov    ah,dl
1d8e  80e4fe         and    ah,fe
1d91  b028           mov    al,28
1d93  f6e4           mul    ah
1d95  d0ea           shr    dl,1
1d97  7303           jnc    1d9c
1d99  80cc20         or     ah,20
1d9c  8bf8           mov    di,ax
1d9e  8bf1           mov    si,cx
1da0  d1ee           shr    si,1
1da2  d1ee           shr    si,1
1da4  803e490406     cmp    [0449],06       ; aktivn¡ m¢d displeje
1da9  b800b8         mov    ax,b800
1dac  8ed8           mov    ds,ax
1dae  7211           jc     1dc1
1db0  d1ee           shr    si,1
1db2  03fe           add    di,si
1db4  80e107         and    cl,07
1db7  8a05           mov    al,[di]
1db9  d2e0           shl    al,cl
1dbb  d0c0           rol    al,1
1dbd  2401           and    al,01
1dbf  eb11           jmp    1dd2

1dc1  03fe           add    di,si
1dc3  80e103         and    cl,03
1dc6  d0e1           shl    cl,1
1dc8  8a05           mov    al,[di]
1dca  d2e0           shl    al,cl
1dcc  d0c0           rol    al,1
1dce  d0c0           rol    al,1
1dd0  2403           and    al,03
1dd2  5a             pop    dx
1dd3  59             pop    cx
1dd4  c3             ret

1dd5  8bc2           mov    ax,dx
1dd7  f7264a04       mul    w/[044a]        ; po‡et pozic na © dek
1ddb  8bf9           mov    di,cx
1ddd  d1ef           shr    di,1
1ddf  d1ef           shr    di,1
1de1  d1ef           shr    di,1
1de3  03f8           add    di,ax
1de5  8ac7           mov    al,bh
1de7  98             cbw
1de8  f7264c04       mul    w/[044c]        ; d‚lka zobrazovan‚ho bufferu disp.
1dec  03f8           add    di,ax
1dee  b580           mov    ch,80
1df0  80e107         and    cl,07
1df3  d2ed           shr    ch,cl
1df5  b800a0         mov    ax,a000
1df8  8ed8           mov    ds,ax
1dfa  bace03         mov    dx,03ce
1dfd  8bf3           mov    si,bx
1dff  32db           xor    bl,bl
1e01  b403           mov    ah,03
1e03  b004           mov    al,04
1e05  ef             out    dx,ax
1e06  8a05           mov    al,[di]
1e08  22c5           and    al,ch
1e0a  d0c3           rol    bl,1
1e0c  0ad8           or     bl,al
1e0e  fecc           dec    ah
1e10  79f1           jns    1e03
1e12  41             inc    cx
1e13  d2c3           rol    bl,cl
1e15  8ac3           mov    al,bl
1e17  8bde           mov    bx,si
1e19  5a             pop    dx
1e1a  59             pop    cx
1e1b  c3             ret
; -----------------------------------------------------------------------------
;     Slu‘ba 0eh - z pis znaku v telegrafn¡m m¢du
; -----------------------------------------------------------------------------
                                            ; INT 10h/0eh - z pis znaku CTTY
1e1c  53             push   bx
1e1d  51             push   cx
1e1e  52             push   dx
1e1f  8bf8           mov    di,ax
1e21  a06204         mov    al,[0462]       ; aktivn¡ str nka displeje
1e24  8af8           mov    bh,al
1e26  98             cbw
1e27  8bf0           mov    si,ax
1e29  d1e6           shl    si,1
1e2b  8b945004       mov    dx,[si+0450]    ; pozice kurzor– ve str nk ch
1e2f  8bc7           mov    ax,di
1e31  3c0d           cmp    al,0d
1e33  7618           jna    1e4d
1e35  b90100         mov    cx,0001
1e38  b40a           mov    ah,0a
1e3a  cd10           int    10
1e3c  42             inc    dx
1e3d  3a164a04       cmp    dl,[044a]       ; po‡et pozic na © dek
1e41  7428           jz     1e6b
1e43  b402           mov    ah,02
1e45  cd10           int    10
1e47  8bc7           mov    ax,di
1e49  5a             pop    dx
1e4a  59             pop    cx
1e4b  5b             pop    bx
1e4c  c3             ret

1e4d  7411           jz     1e60
1e4f  3c0a           cmp    al,0a
1e51  741a           jz     1e6d
1e53  3c08           cmp    al,08
1e55  740d           jz     1e64
1e57  3c07           cmp    al,07
1e59  75da           jnz    1e35
1e5b  e85505         call   23b3            ; p¡pnut¡
1e5e  ebe7           jmp    1e47

1e60  32d2           xor    dl,dl
1e62  ebdf           jmp    1e43

1e64  0ad2           or     dl,dl
1e66  74db           jz     1e43
1e68  4a             dec    dx
1e69  ebd8           jmp    1e43

1e6b  32d2           xor    dl,dl
1e6d  fec6           inc    dh
1e6f  3a368404       cmp    dh,[0484]       ; ‡¡slo posledn¡ho © dku
1e73  76ce           jna    1e43
1e75  fece           dec    dh
1e77  e85af5         call   13d4
1e7a  a04904         mov    al,[0449]       ; aktivn¡ m¢d displeje
1e7d  3c03           cmp    al,03
1e7f  7605           jna    1e86
1e81  98             cbw
1e82  3c07           cmp    al,07
1e84  7504           jnz    1e8a
1e86  b408           mov    ah,08
1e88  cd10           int    10
1e8a  8afc           mov    bh,ah
1e8c  33c9           xor    cx,cx
1e8e  8a164a04       mov    dl,[044a]       ; po‡et pozic na © dek
1e92  4a             dec    dx
1e93  b80106         mov    ax,0601
1e96  cd10           int    10
1e98  ebad           jmp    1e47

; -----------------------------------------------------------------------------
;     Slu‘ba 0fh - poskytnut¡ vidoem¢du
; -----------------------------------------------------------------------------
                                            ; INT 10h/0fh - poskytnut¡ videom¢du

1e9a  a08704         mov    al,[0487]       ; statut ©¡zen¡ video
1e9d  2480           and    al,80
1e9f  0a064904       or     al,[0449]       ; aktivn¡ m¢d displeje
1ea3  8a264a04       mov    ah,[044a]       ; po‡et pozic na © dek
1ea7  8a3e6204       mov    bh,[0462]       ; aktivn¡ str nka displeje
1eab  c3             ret
; -----------------------------------------------------------------------------
;     Slu‘ba 10h - nastaven¡ palet
; -----------------------------------------------------------------------------
                                            ; INT 10h/10h - nastaven¡ palet
1eac  803e6304b4     cmp    [0463],b4       ; b zov  ©¡dic¡ adresa displeje
1eb1  7413           jz     1ec6
1eb3  3c03           cmp    al,03
1eb5  770e           ja     1ec5
1eb7  98             cbw
1eb8  d1e0           shl    ax,1
1eba  8bf0           mov    si,ax
1ebc  53             push   bx
1ebd  06             push   es
1ebe  2eff94ce1e     call   cs:[si+1ece]
1ec3  07             pop    es
1ec4  5b             pop    bx
1ec5  c3             ret

1ec6  f606870402     test   [0487],02       ; statut ©¡zen¡ video
1ecb  75e6           jnz    1eb3
1ecd  c3             ret

1ece  d6             db     d6
1ecf  1e             push   ds
1ed0  f1             db     f1
1ed1  1e             push   ds
1ed2  f5             cmc
1ed3  1e             push   ds
1ed4  46             inc    si
1ed5  1f             pop    ds
1ed6  8ac7           mov    al,bh
1ed8  8ae3           mov    ah,bl
1eda  e8b204         call   238f            ; synchronizov. nastaven¡ reg. 03C0h
1edd  c43ea804       les    di,[04a8]       ; ukazatek videoparametr– EGA
1ee1  26c47d04       les    di,es:[di+04]
1ee5  8cc6           mov    si,es
1ee7  0bf7           or     si,di
1ee9  7405           jz     1ef0
1eeb  32ff           xor    bh,bh
1eed  268801         mov    es:[bx+di],al
1ef0  c3             ret

1ef1  b311           mov    bl,11
1ef3  ebe1           jmp    1ed6

1ef5  51             push   cx
1ef6  52             push   dx
1ef7  06             push   es
1ef8  c43ea804       les    di,[04a8]       ; ukazatek videoparametr– EGA
1efc  26c47d04       les    di,es:[di+04]
1f00  8cc6           mov    si,es
1f02  0bf7           or     si,di
1f04  740b           jz     1f11
1f06  1f             pop    ds
1f07  1e             push   ds
1f08  8bf2           mov    si,dx
1f0a  b91100         mov    cx,0011
1f0d  f3a4           rep    movsb
1f0f  8ed9           mov    ds,cx
1f11  07             pop    es
1f12  8bf2           mov    si,dx
1f14  32e4           xor    ah,ah
1f16  b91000         mov    cx,0010
1f19  8b166304       mov    dx,[0463]       ; b zov  ©¡dic¡ adresa displeje
1f1d  80c206         add    dl,06
1f20  ec             in     al,dx
1f21  2408           and    al,08
1f23  75fb           jnz    1f20
1f25  fb             sti
1f26  90             nop
1f27  fa             cli
1f28  ec             in     al,dx
1f29  2408           and    al,08
1f2b  74f8           jz     1f25
1f2d  b2c0           mov    dl,c0
1f2f  8ac4           mov    al,ah
1f31  ee             out    dx,al
1f32  fec4           inc    ah
1f34  26             es:
1f35  ac             lodsb
1f36  ee             out    dx,al
1f37  e2f6           loop   1f2f
1f39  b011           mov    al,11
1f3b  ee             out    dx,al
1f3c  26             es:
1f3d  ac             lodsb
1f3e  ee             out    dx,al
1f3f  b020           mov    al,20
1f41  ee             out    dx,al
1f42  fb             sti
1f43  5a             pop    dx
1f44  59             pop    cx
1f45  c3             ret

1f46  e8f703         call   2340            ; poskytnut¡ adresy videoparametr–
1f49  268a4433       mov    al,es:[si+33]
1f4d  80fb01         cmp    bl,01
1f50  7712           ja     1f64
1f52  24f7           and    al,f7
1f54  80266504df     and    [0465],df       ; sou‡asn‚ nastaven¡ registru m¢du
1f59  0adb           or     bl,bl
1f5b  7407           jz     1f64
1f5d  0c08           or     al,08
1f5f  800e650420     or     [0465],20       ; sou‡asn‚ nastaven¡ registru m¢du
1f64  b410           mov    ah,10
1f66  e82604         call   238f            ; synchronizov. nastaven¡ reg. 03C0h
1f69  c3             ret

; -----------------------------------------------------------------------------
;     Slu‘ba 11h - gener tor znak–
; -----------------------------------------------------------------------------
                                            ; INT 10h/11h - gener tor znak–
1f6a  8d36971f       lea    si,[1f97]
1f6e  3c10           cmp    al,10
1f70  7216           jc     1f88
1f72  8d36c01f       lea    si,[1fc0]
1f76  3c20           cmp    al,20
1f78  720e           jc     1f88
1f7a  8d363620       lea    si,[2036]
1f7e  3c30           cmp    al,30
1f80  7206           jc     1f88
1f82  7512           jnz    1f96
1f84  e8fc00         call   2083            ; podslu‘ba 30h
1f87  c3             ret

1f88  53             push   bx
1f89  51             push   cx
1f8a  52             push   dx
1f8b  06             push   es
1f8c  55             push   bp
1f8d  240f           and    al,0f
1f8f  ffd6           call   si              ; vol n¡ slu‘by
1f91  5d             pop    bp
1f92  07             pop    es
1f93  5a             pop    dx
1f94  59             pop    cx
1f95  5b             pop    bx
1f96  c3           * ret

                                          ;* podslu‘by 00h a‘ 03h
1f97  3c03           cmp    al,03
1f99  7724           ja     1fbf
1f9b  7412           jz     1faf
1f9d  e83202         call   21d2            ; inicializace font– videokarty
1fa0  e8a202         call   2245            ; inicializace registr– videokarty
1fa3  e8d903         call   237f            ; rozsv¡cen¡ displeje
1fa6  8b0e6004       mov    cx,[0460]       ; koncov  a po‡ te‡n¡ linka kurzoru
1faa  b401           mov    ah,01
1fac  cd10           int    10              ; inicializace velikosti kurzoru
1fae  c3             ret

                                          ;* volba bloku font–
1faf  bac403       * mov    dx,03c4
1fb2  b80001         mov    ax,0100
1fb5  ef             out    dx,ax
1fb6  b003           mov    al,03
1fb8  8ae3           mov    ah,bl
1fba  ef             out    dx,ax
1fbb  b80003         mov    ax,0300
1fbe  ef             out    dx,ax
1fbf  c3             ret

                                          ;* podslu‘by 10h a‘ 1fh
1fc0  3c02           cmp    al,02
1fc2  7771           ja     2035            ; nepovolen˜ povel
1fc4  50             push   ax
1fc5  53             push   bx
1fc6  e80902         call   21d2            ; inicializace font– videokarty
1fc9  e87902         call   2245            ; inicializace registr– videokarty
1fcc  5b             pop    bx
1fcd  58             pop    ax
1fce  98             cbw
1fcf  fec8           dec    al
1fd1  8ac7           mov    al,bh
1fd3  7806           js     1fdb
1fd5  b00e           mov    al,0e
1fd7  7402           jz     1fdb
1fd9  b008           mov    al,08
1fdb  a38504         mov    [0485],ax       ; po‡et linek na znak (v˜¨ka znaku)
1fde  8b166304       mov    dx,[0463]       ; b zov  ©¡dic¡ adresa displeje
1fe2  8ae0           mov    ah,al
1fe4  803e490407     cmp    [0449],07       ; aktivn¡ m¢d displeje
1fe9  7503           jnz    1fee
1feb  b014           mov    al,14
1fed  ef             out    dx,ax
1fee  fecc           dec    ah
1ff0  b009           mov    al,09
1ff2  ef             out    dx,ax
1ff3  8acc           mov    cl,ah
1ff5  8ae9           mov    ch,cl
1ff7  fecd           dec    ch
1ff9  b401           mov    ah,01
1ffb  cd10           int    10
1ffd  b85e01         mov    ax,015e
2000  803e490403     cmp    [0449],03       ; aktivn¡ m¢d displeje
2005  7708           ja     200f
2007  e86703         call   2371            ; monitor ECM s vy¨¨¡m rozli¨en¡m ?
200a  7403           jz     200f
200c  b8c800         mov    ax,00c8
200f  f6368504       div    b/[0485]        ; po‡et linek na znak (v˜¨ka znaku)
2013  48             dec    ax
2014  a28404         mov    [0484],al       ; ‡¡slo posledn¡ho © dku
2017  40             inc    ax
2018  f6268504       mul    b/[0485]        ; po‡et linek na znak (v˜¨ka znaku)
201c  48             dec    ax
201d  8ae0           mov    ah,al
201f  b012           mov    al,12
2021  ef             out    dx,ax
2022  a08404         mov    al,[0484]       ; ‡¡slo posledn¡ho © dku
2025  40             inc    ax
2026  f6264a04       mul    b/[044a]        ; po‡et pozic na © dek
202a  d1e0           shl    ax,1
202c  050001         add    ax,0100
202f  a34c04         mov    [044c],ax       ; d‚lka zobrazovan‚ho bufferu disp.
2032  e84a03         call   237f            ; rozsv¡cen¡ displeje
2035  c3             ret

                                          ;* podslu‘by 20h a‘ 2fh
2036  3c03           cmp    al,03
2038  7748           ja     2082            ; nepovolen˜ povel
203a  fec8           dec    al              ;
203c  7420           jz     205e
203e  7909           jns    2049
2040  892e7c00       mov    [007c],bp       ; nastaven¡ adresy INT 1fh
2044  8c067e00       mov    [007e],es
2048  c3             ret

2049  8d2ed024       lea    bp,[24d0]       ; font 14 linek na znak
204d  b90e00         mov    cx,000e         ; 14 linek na znak
2050  fec8           dec    al              ; je font 8x14 ?
2052  8cc8           mov    ax,cs
2054  8ec0           mov    es,ax
2056  7406           jz     205e            ; je font 8x14
2058  8d2e0034       lea    bp,[3400]       ; font 8 linek na znak
205c  b108           mov    cl,08           ; 8 linek na znak

                                          ;* na‡ten¡ u‘ivatelsk˜ch font–
205e  892e0c01       mov    [010c],bp       ; adresa INT 43h
2062  8c060e01       mov    [010e],es
2066  890e8504       mov    [0485],cx       ; po‡et linek na znak (v˜¨ka znaku)
206a  8ac2           mov    al,dl           ; po‡et © dk–
206c  81e3ff00       and    bx,00ff
2070  740c           jz     207e            ; po‡et © dk– je zad n
2072  b019           mov    al,19           ; 25 © dk–
2074  80fb03         cmp    bl,03
2077  7705           ja     207e            ; chybn‚ zad n¡ - je 25 © dk–
2079  2e8a87b224     mov    al,cs:[bx+24b2] ; po‡et © dk– z tabulky
207e  48           * dec    ax
207f  a28404         mov    [0484],al       ; ‡¡slo posledn¡ho © dku
2082  c3           * ret


                                          ;* podslu‘ba 30h - informace o fontu
2083  8b0e8504       mov    cx,[0485]       ; po‡et linek na znak (v˜¨ka znaku)
2087  8a168404       mov    dl,[0484]       ; ‡¡slo posledn¡ho © dku
208b  8ac7           mov    al,bh           ; po‘adovan˜ ukazatel
208d  2c02           sub    al,02
208f  98             cbw
2090  7212           jc     20a4            ; po‘adov n ukazatel INT 1fh,INT 43h
2092  3c03           cmp    al,03
2094  771a           ja     20b0            ; nespr vn˜ parametr
2096  d1e0           shl    ax,1
2098  8bf0           mov    si,ax
209a  2e8bacb624     mov    bp,cs:[si+24b6] ; tabulka ukazatel– (2 a‘ 5)
209f  8cc8           mov    ax,cs
20a1  8ec0           mov    es,ax
20a3  c3             ret

20a4  40             inc    ax
20a5  7805           js     20ac
20a7  c42e0c01       les    bp,[010c]       ; ukazatel INT 43h
20ab  c3             ret

20ac  c42e7c00       les    bp,[007c]       ; ukazatel INT 1fh
20b0  c3           * ret
; -----------------------------------------------------------------------------
;     Slu‘ba 12h - alternativn¡ nastaven¡ a informace o EGA
; -----------------------------------------------------------------------------
                                          ;* INT 10h/12h - alternativn¡ nastav.
                                            ; VSTUP: AH=12h
                                            ;        BL=podslu‘ba 10h, 20h

20b1  80fb20       * cmp    bl,20           ; je podslu‘ba 20h ?
20b4  742e           jz     20e4            ; alternativn¡ nastaven¡ EGA
20b6  80fb10         cmp    bl,10           ; je podslu‘ba 10h ?
20b9  7401           jz     20bc            ; je poskytnut¡ informac¡ o EGA
20bb  c3             ret                    ; nezn m  podslu‘ba

20bc  a08704       * mov    al,[0487]       ; statut ©¡zen¡ video
20bf  d0e8           shr    al,1            ; AL / 2
20c1  8af8           mov    bh,al
20c3  80e701         and    bh,01           ; m¢d displeje (0=barevn˜)
20c6  d0e8           shr    al,1            ; AL / 4
20c8  d0e8           shr    al,1            ; AL / 8
20ca  d0e8           shr    al,1            ; AL / 16
20cc  d0e8           shr    al,1            ; AL / 32
20ce  2403           and    al,03           ; k¢d velikosti videopamˆti
20d0  8ad8           mov    bl,al           ; velikost pamˆti EGA
20d2  a08804         mov    al,[0488]       ; statut ©¡zen¡ video - vy¨¨¡ bajt
20d5  8ae8           mov    ch,al           ; bity adapt‚ru EGA
20d7  d0ed           shr    ch,1            ; CH / 2
20d9  d0ed           shr    ch,1            ; CH / 4
20db  d0ed           shr    ch,1            ; CH / 8
20dd  d0ed           shr    ch,1            ; CH / 16
20df  240f           and    al,0f           ; nastaven¡ p©ep¡na‡– DIL
20e1  8ac8           mov    cl,al           ; nastaven¡ p©ep¡na‡– EGA
20e3  c3             ret

                                          ;* alternat.nastaven¡ EGA Print Screen

20e4  fa           * cli                    ; z kaz p©eru¨en¡
20e5  c70614004424   mov    [0014],2444     ; adresa obsluhy tisku obrazovky
20eb  8c0e1600       mov    [0016],cs       ; segment adresy
20ef  fb             sti                    ; povolen¡ p©eru¨en¡
20f0  c3             ret

; -----------------------------------------------------------------------------
;     Slu‘ba 13h - z pis ©etˆzce znak–
; -----------------------------------------------------------------------------
                                          ;* INT 10h/13h - z pis ©etˆzce znak–
                                            ; VSTUP: AH=13h
                                            ;        AL=podslu‘ba 0 - 3
                                            ;        BH=‡¡slo str nky
                                            ;        BL=atributy
                                            ;        CX=d‚lka ©etˆzce
                                            ;        DH=© dek pro z pis
                                            ;        DL=pozice pro z pis
                                            ;        ES:BP=ukazatel na ©etˆzec

20f1  53           * push   bx              ; £schova BX
20f2  51             push   cx              ; £schova CX
20f3  52             push   dx              ; £schova DX
20f4  55             push   bp              ; £schova BP
20f5  3c03           cmp    al,03           ; ‡¡slo podslu‘by
20f7  7745           ja     213e            ; chyba ‡¡sla podslu‘by - konec
20f9  e343           jcxz   213e            ; nulov˜ ©etˆzec - konec
20fb  98             cbw                    ; AX <- AL ‡¡slo podslu‘by
20fc  8bf8           mov    di,ax           ; DI <- ‡¡slo podslu‘by
20fe  4f             dec    di              ; ‡¡slo podslu‘by - 1
20ff  8ac7           mov    al,bh           ; ‡¡slo str nky displeje
2101  8bf0           mov    si,ax           ; SI <- ‡¡slo str nky displeje
2103  d1e6           shl    si,1            ; ‡¡slo str nky * 2
2105  ffb45004       push   [si+0450]       ; pozice kurzoru v po‘adov. str nce
2109  b402           mov    ah,02           ; funkce nastaven¡ pozice kurzoru
210b  cd10           int    10              ; nastaven¡ po‡ te‡n¡ pozice kurzoru
210d  51           * push   cx              ; £schova d‚lky ©etˆzce
210e  268a4600       mov    al,es:[bp+00]   ; znak k v˜stupu
2112  45             inc    bp              ; zv˜¨en¡ ukazatele textu
2113  3c0d           cmp    al,0d           ; je znak od© dkov n¡ ?
2115  762c           jna    2143            ; je ©¡dic¡ znak
2117  0bff         * or     di,di           ; je p©i©azen¡ atributu BL ?
2119  7e05           jng    2120            ; je p©i©azen¡ atributu BL
211b  268a5e00       mov    bl,es:[bp+00]   ; atribut se vezme z textu
211f  45             inc    bp              ; zv˜¨en¡ ukazatele v textu
2120  b90100       * mov    cx,0001         ; p¢cet znak– k zobrazen¡
2123  b409           mov    ah,09           ; funkce v˜stupu znaku s atributem
2125  cd10           int    10              ; zobrazen¡ znaku s atributem
2127  42             inc    dx              ; zv˜¨en¡ pozice na © dku
2128  3a164a04       cmp    dl,[044a]       ; dosa‘eno konce © dku ?
212c  732d           jnc    215b            ; dosa‘eno konce © dku
212e  b402         * mov    ah,02           ; funkce nastaven¡ pozice kurzoru
2130  cd10           int    10              ; nastaven¡ nov‚ pozice kurzoru
2132  59           * pop    cx              ; n vrat ‡¡ta‡e d‚lky ©etˆzce
2133  e2d8           loop   210d            ; zobrazen¡ dal¨¡ho znaku
2135  5a             pop    dx              ; n vrat p–vodn¡ pozice kurzoru
2136  d1ef           shr    di,1            ; test - m  se kurzor navr tit ?
2138  7304           jnc    213e            ; kurzor se nem  navr tit
213a  b402           mov    ah,02           ; funkce nastaven¡ pozice kurzoru
213c  cd10           int    10              ; navr cen¡ pozice kurzoru
213e  5d           * pop    bp              ; n vrat BP
213f  5a             pop    dx              ; n vrat DX
2140  59             pop    cx              ; n vrat CX
2141  5b             pop    bx              ; n vrat BX
2142  c3             ret

                                          ;* jsou ©¡dic¡ znaky
2143  740c         * jz     2151            ; je znak 0Dh <CR> - za‡ tek © dku
2145  3c0a           cmp    al,0a           ; je znak 0Ah <LF> ?
2147  7408           jz     2151            ; je znak 0Ah <LF> - dal¨¡ © dek
2149  3c08           cmp    al,08           ; je znak 08h <BS> ?
214b  7404           jz     2151            ; je znak 08h <BS> - krok zpˆt
214d  3c07           cmp    al,07           ; je znak 07h <BEL> (zvonek) ?
214f  75c6           jnz    2117            ; nen¡ znak 07h - tisknuteln˜ znak
2151  b40e         * mov    ah,0e           ; funkce v˜stupu znaku v m¢du CTTY
2153  cd10           int    10              ; v˜stup ©¡dic¡ho znaku
2155  8b945004       mov    dx,[si+0450]    ; nov  pozice kurzoru ve str nce
2159  ebd7           jmp    2132            ; pokra‡ov n¡ dal¨¡m znakem

                                          ;* dosa‘eno koncov‚ pozice na © dku
215b  32d2         * xor    dl,dl           ; DL <- 0 (nov  pozice 0)
215d  fec6           inc    dh              ; zv˜¨en¡ © dky s kurzorem
215f  3a368404       cmp    dh,[0484]       ; dosa‘eno posledn¡ho © dku ?
2163  76c9           jna    212e            ; nen¡ je¨tˆ posledn¡ © dek
2165  fece           dec    dh              ; n vrat ‡¡sla © dku
2167  b80a0e         mov    ax,0e0a         ; funkce zobrazen¡ znaku 0AH <LF>
216a  cd10           int    10              ; posun o © dek <LF>
216c  ebc0           jmp    212e            ; pokra‡ov n¡ dal¨¡m znakem

; *****************************************************************************
;
;                                Podprogramy
;
; *****************************************************************************

                                          ;* v˜po‡et offsetu v tex. videostr nce

216e  8ad0         * mov    dl,al           ; pozice na displeji
2170  a04a04         mov    al,[044a]       ; po‡et pozic na © dek
2173  f6e4           mul    ah              ; p©epo‡et © dk– na po‡et znak–
2175  32f6           xor    dh,dh           ; DH <- 0
2177  03c2           add    ax,dx           ; p©i‡ten¡ ‡¡sla pozice
2179  d1e0           shl    ax,1            ; po‡et pozice * 2 = po‡et bajt–
217b  c3             ret
; -----------------------------------------------------------------------------

                                          ;* v˜po‡et offsetu v graf.videostr nce

217c  8ad0           mov    dl,al           ; pozice na obrazovce
217e  a04a04         mov    al,[044a]       ; po‡et pozic na © dek
2181  f6e4           mul    ah              ; p©epo‡et © dk– na pozice
2183  d1e0           shl    ax,1            ; po‡et pozic * 2
2185  d1e0           shl    ax,1            ; po‡et pozic * 4
2187  32f6           xor    dh,dh           ; DH <- 0
2189  03c2           add    ax,dx           ; AX <- p
218b  c3             ret
; -----------------------------------------------------------------------------

                                          ;* v˜po‡et offsetu v graf. str nce EGA

218c  8ad0           mov    dl,al           ; pozice ve videostr nce
218e  a04a04         mov    al,[044a]       ; po‡et pozic na © dek
2191  f6e4           mul    ah              ; p©epo‡et © dk– na pozice
2193  52             push   dx              ; £schova pozice ve videostr nce
2194  f7268504       mul    w/[0485]        ; po‡et linek na znak (v˜¨ka znaku)
2198  5a             pop    dx
2199  32f6           xor    dh,dh
219b  03c2           add    ax,dx
219d  c3             ret
; -----------------------------------------------------------------------------
;     Vymaz n¡ videopamˆti
; -----------------------------------------------------------------------------
                                          ;* vymaz n¡ cel‚ videopamˆti
219e  f606870480   * test   [0487],80       ; ma‘e se videopamˆŸ ?
21a3  752c           jnz    21d1            ; videopamˆŸ se nema‘e
21a5  53             push   bx              ; £schova BX
21a6  51             push   cx              ; £schova CX
21a7  52             push   dx              ; £schova DX
21a8  a04904         mov    al,[0449]       ; aktivn¡ m¢d displeje
21ab  bb00a0         mov    bx,a000         ; segment videopamˆti EGA (A000h)
21ae  b90080         mov    cx,8000         ; d‚lka videopamˆti 8000h
21b1  3c07           cmp    al,07           ; je videom¢d MDA ?
21b3  770f           ja     21c4            ; je grafick˜ videom¢d EGA
21b5  b7b0           mov    bh,b0           ; segment videopamˆti MDA (B000h)
21b7  b540           mov    ch,40           ; d‚lka videopamˆti 4000h
21b9  ba2007         mov    dx,0720         ; nulovac¡ slovo pro text. m¢dy
21bc  7408           jz     21c6            ; je videom¢d MDA
21be  b7b8           mov    bh,b8           ; segment videopamˆti CGA (B800h)
21c0  3c03           cmp    al,03           ; je textov˜ m¢d CGA ?
21c2  7602           jna    21c6            ; je textov˜ m¢d CGA
21c4  33d2         * xor    dx,dx           ; nulovac¡ slovo pro grafiku CGA
21c6  8ec3         * mov    es,bx           ; po‡ te‡n¡ segment videopamˆti
21c8  8bc2           mov    ax,dx           ; nulovac¡ slovo videopamˆti
21ca  33ff           xor    di,di           ; po‡ te‡n¡ offset = 0
21cc  f3ab           rep    stosw           ; vymaz n¡ videopamˆti
21ce  5a             pop    dx              ; n vrat DX
21cf  59             pop    cx              ; n vrat CX
21d0  5b             pop    bx              ; n vrat BX
21d1  c3           * ret
; -----------------------------------------------------------------------------
;     Inicializace font– videokarty
; -----------------------------------------------------------------------------
                                          ;* VSTUP: AL=0 - definovan‚ fonty
                                            ;            ES:BP=ukazatel font–
                                            ;            CX=po‡et znak–
                                            ;            DX=prvn¡ def. znak
                                            ;            BL=blok fontu
                                            ;            BH=po‡et bajt– na znak
                                            ;       AL=1 - fonty 8x14
                                            ;            BL=blok fontu
                                            ;       AL=2 - fonty 8x8
                                            ;            BL=blok fontu

                                          ;* inicializace na vnit©n¡ videom¢d
21d2  50           * push   ax              ; £schova AX
21d3  06             push   es              ; £schova ES
21d4  b00c           mov    al,0c           ; 0ch = vnit©n¡ videom¢d mono
21d6  803e490407     cmp    [0449],07       ; aktivn¡ m¢d displeje = MDA ?
21db  7401           jz     21de            ; je videom¢d MDA/text.
21dd  48             dec    ax              ; 0bh = vnit©n¡ videom¢d barevn˜
21de  ff364904     * push   [0449]          ; £schova aktivn¡ho m¢du displeje
21e2  a24904         mov    [0449],al       ; aktivn¡ m¢d displeje = 12 nebo 11
21e5  e85d00         call   2245            ; inicializace registr– videokarty
21e8  8f064904       pop    [0449]          ; n vrat aktivn¡ho m¢du displeje
21ec  07             pop    es              ; n vrat ES
21ed  58             pop    ax              ; n vrat AX


21ee  0ac0           or     al,al
21f0  741a           jz     220c            ; inicializace definovan˜ch font–
21f2  b90001         mov    cx,0100         ; po‡et znak– k inicializaci = 256
21f5  33d2           xor    dx,dx           ; po‡ te‡n¡ znak k ulo‘en¡
21f7  2e8e06ca04     mov    es,cs:[04ca]    ; segment tabulky videoparametr–
21fc  8d2ed024       lea    bp,[24d0]       ; font 14 linek na znak
2200  b70e           mov    bh,0e           ; 14 linek na znak
2202  3c01           cmp    al,01           ; je font 14 linek ?
2204  7406           je     220c            ; jsou fonty 14 linek
2206  8d2e0034       lea    bp,[3400]       ; font 8 linek na znak
220a  b708           mov    bh,08           ; 8 linek na znak

                                          ;* inicializace font–
                                            ; VSTUP: ES:BP=adresa fontu
                                            ;        CX=po‡et znak–
                                            ;        DX=prvn¡ znak
                                            ;        BL=blok fontu
                                            ;        BH=po‡et linek na znak

220c  e331         * jcxz   223f            ; nen¡ ‘ dn  tabulka k p©enosu
220e  51             push   cx              ; £schova po‡tu znak– k p©enosu
220f  8bf5           mov    si,bp           ; za‡ tek tabulky fontu
2211  8cc0           mov    ax,es           ; segment adresy fontu
2213  8ed8           mov    ds,ax           ; segment adresy fontu
2215  b800a0         mov    ax,a000         ; AX <- A000h
2218  8ec0           mov    es,ax           ; ES <- A000h segment videopamˆti
221a  b105           mov    cl,05
221c  d3e2           shl    dx,cl           ; DX * 32 offset prvn¡ho znaku
221e  8ae3           mov    ah,bl           ; ‡¡slo bloku
2220  b040           mov    al,40           ; d‚lka bloku (= 16 KB)
2222  f6e4           mul    ah
2224  02f0           add    dh,al           ; adresa bloku font–
2226  8bfa           mov    di,dx           ; ukl dac¡ adresa fontu
2228  8ad7           mov    dl,bh
222a  32f6           xor    dh,dh
222c  58             pop    ax              ; po‡et znak– k p©enosu
222d  8bca         * mov    cx,dx           ; po‡et bajt– na znak
222f  f3a4           rep    movsb           ; p©enos jednoho znaku
2231  2bfa           sub    di,dx           ; n vrat adresy p©ed p©enosem
2233  83c720         add    di,0020         ; adresa dal¨¡ho znaku
2236  48             dec    ax              ; ‡¡ta‡ znak–
2237  75f4           jnz    222d            ; p©enos dal¨¡ho znaku
2239  8cd8           mov    ax,ds           ; AX <- DS
223b  8ec0           mov    es,ax           ; n vrat ES
223d  8ed9           mov    ds,cx           ; DS <- 0
223f  c3           * ret

; -----------------------------------------------------------------------------
                                          ;* inicializace registr– videokarty

2240  51           * push   cx
2241  52             push   dx
2242  1e             push   ds
2243  eb09           jmp    224e
; -----------------------------------------------------------------------------
;     Inicializace registr– videokarty
; -----------------------------------------------------------------------------
                                          ;* inicializace registr– videokarty

2245  51           * push   cx
2246  52             push   dx
2247  1e             push   ds
2248  e8f500         call   2340            ; poskytnut¡ adresy videoparametr–
224b  83c605         add    si,0005         ; p©esko‡en¡ £vodn¡ch parametr–

                                          ;* nastaven¡ portu 03c4h (reg. 0 a‘ 4)
224e  bac403       * mov    dx,03c4         ; b zov  adresa 03c4h
2251  b90400         mov    cx,0004         ; po‡et bajt– k v˜stupu
2254  b80001         mov    ax,0100         ; nastaven¡ registru 0
2257  fa             cli                    ; z kaz p©eru¨en¡
2258  ef             out    dx,ax           ; nastaven¡ registru 0
2259  40             inc    ax              ; ukazatel na registr 1
225a  e85a00         call   22b7            ; inicializace reg. podle tabulky

                                          ;* nastaven¡ portu 03c2h
225d  b2c2           mov    dl,c2           ; ©¡d¡c¡ registr EGA
225f  26ac           es:lodsb               ; bajt k inicializaci registru
2261  ee             out    dx,al           ; inicializace registru

                                          ;* nastaven¡ portu 03c4h
2262  b2c4           mov    dl,c4           ; registr m¢du
2264  b80003         mov    ax,0300         ; nastaven¡ registru 0
2267  ef             out    dx,ax           ; nastaven¡ registru 0

                                          ;* nastaven¡ registr– 03d4h
2268  fb             sti                    ; povolen¡ p©eru¨en¡
2269  e85400         call   22c0            ; nastaven¡ registr– ©adi‡e CRT

                                          ;* £schova nastaven¡ rozmˆr– kurzoru
226c  268b44f1       mov    ax,es:[si-0f]   ; kone‡n  a po‡ te‡n¡ linka kurzoru
2270  86c4           xchg   al,ah           
2272  a36004         mov    [0460],ax       ; kone‡n  a po‡ te‡n¡ linka kurzoru


2275  56             push   si
2276  80c206         add    dl,06           ; port 03dah
2279  ec             in     al,dx           ; synchronizace port–

                                          ;* inicial. portu 03c2h (reg. 0-13h)
227a  b2c0           mov    dl,c0           ; port 03c0h
227c  b114           mov    cl,14           ; po‡et registr– barev (=20)
227e  33c0           xor    ax,ax           ; ukazatel registr–
2280  8ac4         * mov    al,ah           ; ‡¡slo registru
2282  ee             out    dx,al           ; nastaven¡ ‡¡sla registru
2283  fec4           inc    ah              ; zvy¨en¡ ‡¡sla registru
2285  26ac           es:lodsb               ; bajt pro nastaven¡ registru
2287  ee             out    dx,al           ; nastaven¡ registru
2288  e2f6           loop   2280            ; dal¨¡ registr k nastaven¡
228a  33c0           xor    ax,ax
228c  ee             out    dx,al           ; n vrat registru 0

228d  b2cc           mov    dl,cc           ; port 03cch
228f  ee             out    dx,al           ; graf. pozice 1 <- 0
2290  b2ca           mov    dl,ca           
2292  40             inc    ax
2293  ee             out    dx,al           ; graf. pozice 2 <- 1

                                          ;* inicializace graf. registru 03cah
2294  b2ce           mov    dl,ce
2296  b109           mov    cl,09           ; po‡et registr– = 9
2298  48             dec    ax              
2299  e81b00         call   22b7            ; inicializace reg. podle tabulky
229c  5e             pop    si              


229d  06             push   es              ; £schova ES
229e  c43ea804       les    di,[04a8]       ; ukazatek videoparametr– EGA
22a2  26c47d04       les    di,es:[di+04]   ; ukazatel prostoru dynam. ulo‘en¡
22a6  1f             pop    ds              ; n vrat DS (=ES)
22a7  8cc0           mov    ax,es           ; segment adresy dynam. ulo‘.
22a9  0bc7           or     ax,di           ; je adresa definov na ?
22ab  7406           jz     22b3            ; adresa nen¡ definov na
                                          ;* barvy do dynamick‚ho prostoru
22ad  b108           mov    cl,08           ;
22af  f3a5           rep    movsw           ; p©enos nastaven¡ barev
22b1  46             inc    si              
22b2  a4             movsb

22b3  1f           * pop    ds
22b4  5a             pop    dx              
22b5  59             pop    cx              
22b6  c3             ret                    

; -----------------------------------------------------------------------------
;     Inicializace registr– podle tabulky
; -----------------------------------------------------------------------------
                                          ;* inicializace registr– podle tabulky
                                            ; VSTUP: ES:SI=ukazatel dat
                                            ;        DX=adresa portu
                                            ;        CX=po‡et registr– k inic.
                                            ;        AL=po‡ te‡n¡ ‡¡slo registru

22b7  268a24       * mov    ah,es:[si]      ; bajt k inicializaci registru
22ba  46             inc    si              ; zv˜¨en¡ ukazatele v tabulce
22bb  ef             out    dx,ax           ; inicializace registru
22bc  40             inc    ax              ; zv˜¨en¡ ‡¡sla registru
22bd  e2f8           loop   22b7            ; inicializace ostatn¡ch registr–
22bf  c3             ret                    
; -----------------------------------------------------------------------------
;     Nastaven¡ registr– video©adi‡e
; -----------------------------------------------------------------------------
                                          ;* nastaven¡ registr– ©adi‡e CRT
22c0  53           * push   bx              ; £schova BX
22c1  e82500         call   22e9            ; test polarity vert. synchronizace

22c4  8b166304       mov    dx,[0463]       ; b zov  ©¡d¡c¡ adresa CRT
22c8  b8f980         mov    ax,80f9         ; nastaven¡ v¨ech registr– ©adi‡e
22cb  ef             out    dx,ax           
22cc  33c0           xor    ax,ax           
22ce  b91900         mov    cx,0019         ; po‡et registr– k inicializaci

22d1  268a24       * mov    ah,es:[si]      ; bajt k inicializaci registru CRT
22d4  46             inc    si              ; zv˜¨en¡ ukazatele registr–
22d5  3ac7           cmp    al,bh           ; je spec. registr ? (11h)
22d7  7506           jnz    22df            ; nen¡
22d9  80e4df         and    ah,df           ; povolen¡ p©eru¨en¡ IRQ2
22dc  80cc10         or     ah,10           ; vertik ln¡ p©eru¨en¡
22df  ef           * out    dx,ax           ; nastaven¡ registru
22e0  40             inc    ax              ; zvy¨en¡ ‡¡sla registru
22e1  e2ee           loop   22d1            ; dal¨¡ registr k nastaven¡

22e3  b8f900         mov    ax,00f9         ; ukon‡en¡ nastaven¡ registr–
22e6  ef             out    dx,ax           

22e7  5b             pop    bx              ; n vrat BX
22e8  c3             ret                    
; -----------------------------------------------------------------------------
;
; -----------------------------------------------------------------------------
                                          ;* test polarity vertik. synchronizace
22e9  1e             push   ds              ; £schova DS
22ea  b800f0         mov    ax,f000         ; AX <- F000h
22ed  8ed8           mov    ds,ax           ; DS <- F000 segment ROM-BIOS
22ef  a0feff         mov    al,[fffe]       ; identifik tor syst‚mov‚ho modelu
22f2  0c04           or     al,04           ;
22f4  1f             pop    ds              
22f5  ba2100         mov    dx,0021         ; port masky p©eru¨en¡ 021h
22f8  bb04ff         mov    bx,ff04         ; bit p©eru¨en¡ pro XT
22fb  3cfc           cmp    al,fc           ; je AT ?
22fd  7504           jnz    2303            ; nen¡ AT
22ff  b2a1           mov    dl,a1           ; port masky p©eru¨en¡ pro AT
2301  d0eb           shr    bl,1            ; BL/2 (bit p©eru¨en¡)
2303  ec           * in     al,dx           ; vstup z registru masky p©eru¨en¡
2304  84c3           test   bl,al           ; je povoleno p©er.p©i zpˆtn‚m bˆhu?
2306  7537           jnz    233f            ; p©eru¨en¡ nen¡ povoleno
2308  f606870410     test   [0487],10       ; status ©¡zen¡ video
230d  7530           jnz    233f            ; nen¡ povoleno p©er. p©i zpˆt. bˆhu
230f  8ae0           mov    ah,al           ; maska registru p©eru¨en¡
2311  0ac3           or     al,bl           ; z kaz p©eru¨en¡ od EGA
2313  ee             out    dx,al           ; z kaz p©eru¨en¡ od EGA
2314  8bfa           mov    di,dx           ; £schova adresy portu p©eru¨en¡
2316  8b166304       mov    dx,[0463]       ; ©¡d¡c¡ adresa CRT
231a  80c206         add    dl,06           ; stavov˜ registr EGA
231d  b9d503         mov    cx,03d5         ; max. doba pro vert. synchronizaci
2320  ec           * in     al,dx           ; p©e‡ten¡ stavu synchronizace
2321  a808           test   al,08           ; je vert. synchronizace ?
2323  e0fb           loopnz 2320            ; ‡ek n¡ na konec synchroimpulsu
2325  e313           jcxz   233a            ; bylo p©ete‡en¡ doby
2327  b9b04c         mov    cx,4cb0         ; max. doba mezi impulsy
232a  ec           * in     al,dx           ; p©e‡ten¡ stavu synchronizace
232b  a808           test   al,08           ; je vert. synchronizace ?
232d  e1fb           loopz  232a            ; ‡ek n¡ na za‡ tek synchroimpulsu
232f  e309           jcxz   233a            ; synchroimpulsy nepracuj¡
2331  b2c2           mov    dl,c2           ; ©¡d¡c¡ registr EGA
2333  ec             in     al,dx           ; stav sign l– pro p©eru¨en¡
2334  d0e0           shl    al,1            ; p©e‡ten¡ polarity sign lu
2336  7302           jnc    233a            ; polarita je negativn¡
2338  b711           mov    bh,11           ; pozitivn¡ polarita
233a  8bd7         * mov    dx,di           ; adresa registru p©eru¨en¡
233c  8ac4           mov    al,ah           ; n vrat nastaven¡ registru p©eru¨en¡
233e  ee             out    dx,al           ; zpˆtn‚ nastaven¡ registru p©eru¨en¡
233f  c3           * ret
; -----------------------------------------------------------------------------
;     Poskytnut¡ adresy tabulky videoparametr–
; -----------------------------------------------------------------------------
                                          ;* poskytnut¡ adresy videoparametr–

                                            ; 052ah 0 text. 40x25/16 ¨ed 
                                            ; 056ah 1 text. 40x25/16 barevn˜
                                            ; 05aah 2 text. 80x25/16 ¨ed 
                                            ; 05eah 3 text. 80x25/16 barevn˜
                                            ; 062ah 4 graf. 320x200/4 barevn˜
                                            ; 066ah 5 graf. 320x200/4 ¨ed 
                                            ; 06aah 6 graf. 640x200/2
                                            ; 06eah 7 text. 80x25 mono
                                            ; 072ah 8 graf. 160x200/16 PCjr
                                            ; 076ah 9 graf. 320x200/16 PCjr
                                            ; 07aah 0ah graf. 640x200/4 PCjr
                                            ; 07eah 0bh vnit©n¡ EGA
                                            ; 082ah 0ch vnit©n¡ EGA
                                            ; 086ah 0dh graf. 320x200/16 barevn˜
                                            ; 08aah 0eh graf. 640x200/16 barevn˜
                                            ; 08eah (0fh graf. 640x350/mono)
                                            ; 092ah (10h graf. 640x350/16 barevn˜)
                                            ; 096ah 0fh graf. 640x350/mono
                                            ; 09aah 10h graf. 640x350/16 barevn˜
                                            ; 09eah 0 text.40x25/16 ¨ed  ECM hi
                                            ; 0a2ah 1 text.40x25/16 barev.ECM hi
                                            ; 0a6ah 2 text.80x25/16 ¨ed  ECM hi
                                            ; 0aaah 3 text.80x25/16 barev.ECM hi

                                            ; 0aeah 0 text. 40x25/16 ¨ed 
                                            ; 0b2ah 1 text. 40x25/16 barevn˜
                                            ; 0b6ah 2 text. 80x25/16 ¨ed 
                                            ; 0baah 3 text. 80x25/16 barevn˜
                                            ; 0beah 4 graf. 320x200/4 barevn˜
                                            ; 0c2ah 5 graf. 320x200/4 ¨ed 
                                            ; 0c6ah 6 graf. 640x200/2
                                            ; 0caah 7 text. 80x25 mono
                                            ; 0ceah 8 graf. 160x200/16 PCjr
                                            ; 0d2ah 9 graf. 320x200/16 PCjr
                                            ; 0d6ah 0ah graf. 640x200/4 PCjr
                                            ; 0daah 0bh vnit©n¡ EGA
                                            ; 0deah 0ch vnit©n¡ EGA
                                            ; 0e2ah 0dh graf. 320x200/16 barevn˜
                                            ; 0e6ah 0eh graf. 640x200/16 barevn˜
                                            ; 0eaah (0fh graf. 640x350/mono)
                                            ; 0eeah (10h graf. 640x350/16 barevn˜
                                            ; 0f2ah 0fh graf. 640x350/mono
                                            ; 0f6ah 10h graf. 640x350/16 barevn˜
                                            ; 0faah 0 text.40x25/16 ¨ed  ECM hi
                                            ; 0feah 1 text.40x25/16 barev.ECM hi
                                            ; 102ah 2 text.80x25/16 ¨ed  ECM hi
                                            ; 106ah 3 text.80x25/16 barev.ECM hi

2340  c436a804     * les    si,[04a8]       ; ukazatel videoparametr– EGA
2344  26c434         les    si,es:[si]      ; ukazatel tabulky videoparametr–
2347  a04904         mov    al,[0449]       ; aktivn¡ m¢d displeje

234a  81c64004       add    si,0440         ; 440h: adresa m¢du 640x350/2 graf.
234e  3c0f           cmp    al,0f           ; je videom¢d 640x350/2 graf. ?
2350  741e           je     2370            ; je videom¢d 640x350/2 grafick˜

2352  83c640         add    si,0040         ; 480: videom¢d 640x350/16 grafick˜
2355  3c10           cmp    al,10           ; je videom¢d 640x350/16 graf. ?
2357  7417           je     2370            ; je videom¢d 640x350/16 grafick˜

2359  81ee8004       sub    si,0480         ; 0:
235d  3c03           cmp    al,03
235f  7709           ja     236a
2361  e80d00         call   2371            ; monitor ECM s vy¨¨¡m rozli¨en¡m ?
2364  7504           jnz    236a            ; nen¡ monitor ECM s vy¨¨¡m rozli¨.
2366  81c6c004       add    si,04c0         ; 4c0: tabulka m¢d– pro ECM (high)
236a  b440         * mov    ah,40           ; d‚lka 1 tabulky parametr–
236c  f6e4           mul    ah
236e  03f0           add    si,ax           ; adresa tabulky videoparametr–
2370  c3           * ret
; -----------------------------------------------------------------------------
;     Je monitor ECM s vy¨¨¡m rozli¨en¡m ? (ZY)
; -----------------------------------------------------------------------------
2371  50             push   ax              ; £schova AX
2372  a08804         mov    al,[0488]       ; statut ©¡zen¡ video - p©ep¡n. DIL
2375  240f           and    al,0f           ; ponech n¡ p©ep¡na‡– DIL
2377  3c03           cmp    al,03           ; monitor ECM s vy¨¨¡m rozli¨en¡m ?
2379  7402           jz     237d
237b  3c09           cmp    al,09           ; monitor ECM s vy¨¨¡m rozli¨en¡m ?
237d  58           * pop    ax
237e  c3             ret
; -----------------------------------------------------------------------------
;     Rozsv¡cen¡ displeje
; -----------------------------------------------------------------------------
                                          ;* rozsv¡cen¡ displeje
237f  52             push   dx              ; £schova DX
2380  8b166304       mov    dx,[0463]       ; b zov  ©¡dic¡ adresa displeje
2384  80c206         add    dl,06           ; adresa portu 03DAh
2387  ec             in     al,dx           ; synchronizace n slednosti registr–
2388  b2c0           mov    dl,c0           ; adresa portu 03C0h
238a  b020           mov    al,20           ; p©¡znak pro rozsv¡cen¡ displeje
238c  ee             out    dx,al           ; rozsv¡cen¡ displeje
238d  5a             pop    dx              ; n vrat DX
238e  c3             ret
; -----------------------------------------------------------------------------

                                          ;* synchronizovan‚ nastaven¡ reg.03C0h
                                            ; VSTUP: AH=‡¡slo registru 03C0h
                                            ;        AL=po‘adovan‚ nastaven¡

238f  53           * push   bx              ; £schova BX
2390  52             push   dx              ; £schova DX
2391  8bd8           mov    bx,ax           ; £schova po‘adovan‚ho nastaven¡
2393  8b166304       mov    dx,[0463]       ; b zov  ©¡dic¡ adresa displeje
2397  80c206         add    dl,06           ; adresa portu 03DAh/02DAh
239a  fb           * sti                    ; povolen¡ p©eru¨en¡
239b  90             nop                    ; prodleva pro mo‘nost p©eru¨en¡
239c  fa             cli                    ; z kaz p©eru¨en¡
239d  ec             in     al,dx           ; ‡ten¡ stavov‚ho registru
239e  2408           and    al,08           ; prob¡h  vertik ln¡ synchr.impuls ?
23a0  74f8           jz     239a            ; ‡ek n¡ na za‡ t.vert.synchr.imp.
23a2  b2c0           mov    dl,c0           ; adresa portu 03C0h/02C0h
23a4  8ac7           mov    al,bh           ; po‘adovan˜ registr
23a6  ee             out    dx,al           ; nastaven¡ ‡¡sla registru
23a7  8ac3           mov    al,bl           ; po‘adovan‚ nastaven¡ registru
23a9  ee             out    dx,al           ; nastaven¡ registru
23aa  b020           mov    al,20           ; p©¡znak pro rozsv¡cen¡ displeje
23ac  ee             out    dx,al           ; zapnut¡ displeje
23ad  fb             sti                    ; povolen¡ p©eru¨en¡
23ae  8bc3           mov    ax,bx           ; n vrat po‘adovan‚ho nastaven¡
23b0  5a             pop    dx              ; n vrat DX
23b1  5b             pop    bx              ; n vrat BX
23b2  c3             ret
; -----------------------------------------------------------------------------

                                          ;* p¡pnut¡

23b3  e461         * in     al,[61]         ; ‡ten¡ sou‡asn‚ho nastaven¡
23b5  8ae0           mov    ah,al           ; £schova nastaven¡ portu
23b7  0c03           or     al,03           ; zapnut¡ zvukov‚ho v˜stupu
23b9  e661           out    [61],al         ; zapnut¡ zvukov‚ho v˜stupu
23bb  b025           mov    al,25           ; doba prodlevy
23bd  e80500         call   23c5            ; prodleva pro p¡pnut¡
23c0  8ac4           mov    al,ah           ; p–vodn¡ nastaven¡ portu
23c2  e661           out    [61],al         ; n vrat nastaven¡ portu
23c4  c3             ret
; -----------------------------------------------------------------------------
                                          ;* prodleva
                                            ; VSTUP: AL=doba prodlevy

23c5  e86c00       * call   2434            ; inicializace zvukov‚ho gener toru
23c8  50             push   ax              ; £schova AX
23c9  51             push   cx              ; £schova CX
23ca  52             push   dx              ; £schova DX
23cb  1e             push   ds              ; £schova DS
23cc  ba00f0         mov    dx,f000         ; segment BIOSu F000h
23cf  8eda           mov    ds,dx           ; DS <- segment BIOSu F000h
23d1  ba6200         mov    dx,0062         ; adresa registru pro ‡ten¡ ‡¡ta‡e
23d4  803efefffc     cmp    [fffe],fc       ; je AT ?
23d9  7501           jnz    23dc            ; nen¡ AT
23db  4a             dec    dx              ; DX <- 61h (adresa portu pro AT)
23dc  1f           * pop    ds              ; n vrat DS
23dd  8ac8           mov    cl,al           ; po‘adovan  doba p¡pnut¡
23df  32ed           xor    ch,ch           ; CH <- 0
23e1  d1e1           shl    cx,1            ; doba p¡pnut¡ * 2
23e3  d1e1           shl    cx,1            ; doba p¡pnut¡ * 4
23e5  d1e1           shl    cx,1            ; doba p¡pnut¡ * 8
23e7  e31d           jcxz   2406            ; doba p¡pnut¡ = 0 (konec)
23e9  e461           in     al,[61]         ; sou‡asn‚ nastaven¡ v˜stupu
23eb  8ae0           mov    ah,al           ; £schova nastaven¡ v˜stupu
23ed  0c01           or     al,01           ; zapnut¡ hradla ‡¡ta‡e
23ef  e661           out    [61],al         ; zapnut¡ hradla ‡¡ta‡e
23f1  e81600         call   240a            ; test v˜stupu z kan lu ‡¡ta‡e
23f4  740c           jz     2402            ; byla provedena vnit©n¡ prodleva
23f6  ec           * in     al,dx           ; ‡ten¡ stavu v˜stupu kan. 2 ‡¡ta‡e
23f7  2420           and    al,20           ; je aktivn¡ v˜stup z kan lu ‡¡ta‡e?
23f9  75fb           jnz    23f6            ; ‡ek n¡ na konec hrany
23fb  ec           * in     al,dx           ; ‡ten¡ stavu v˜stupu kan. 2 ‡¡ta‡e
23fc  2420           and    al,20           ; je aktivn¡ v˜stup z kan lu ‡¡ta‡e?
23fe  74fb           jz     23fb            ; ‡ek n¡ na za‡ tek hrany impulsu
2400  e2f4           loop   23f6            ; ‡ek n¡ na dan˜ po‡et impuls–
2402  8ac4         * mov    al,ah           ; p–vodn¡ nastaven¡ v˜stupu
2404  e661           out    [61],al         ; p–vodn¡ nastaven¡ v˜stupu
2406  5a           * pop    dx              ; n vrat DX
2407  59             pop    cx              ; n vrat CX
2408  58             pop    ax              ; n vrat AX
2409  c3             ret
; -----------------------------------------------------------------------------

                                          ;* test v˜stupu z kan lu ‡¡ta‡e
                                            ; VSTUP: CX=doba prodlevy
                                            ; VSTUP: ZN=test v˜stupu lze pou‘¡t
                                            ;         ZY=byla provedena prodleva

240a  50           * push   ax              ; £schova AX
240b  51             push   cx              ; £schova CX
240c  81f9d007       cmp    cx,07d0         ; minim ln¡ doba prodlevy
2410  7204           jc     2416            ; prodleva kr tk 
2412  24fd           and    al,fd           ; maskov n¡ v˜stupu na reproduktor
2414  e661           out    [61],al         ; vypnut¡ zvuku
2416  ec           * in     al,dx           ; ‡ten¡ v˜stupu z kan lu 2 ‡asova‡e
2417  2420           and    al,20           ; v˜stup z kan lu 2 ‡asova‡e
2419  8ae0           mov    ah,al           ; £schova stavu kan lu 2 ‡asova‡e
241b  b95e01         mov    cx,015e         ; max. doba pro ‡ek n¡ na impuls
241e  ec           * in     al,dx           ; ‡ten¡ v˜stupu z kan lu 2 ‡asova‡e
241f  2420           and    al,20           ; v˜stup z kan lu 2 ‡asova‡e
2421  3ac4           cmp    al,ah           ; nastala zmˆna v˜stupu ?
2423  750c           jnz    2431            ; nastala zmˆna v˜stupu kan lu 2
2425  e2f7           loop   241e            ; dal¨¡ ‡ek n¡ na zmˆnu
2427  58             pop    ax              ; AX <- doba prodlevy
2428  50             push   ax              ; £schova doby prodlevy
2429  b95d01       * mov    cx,015d         ; ni‘¨¡ slovo prodlevy
242c  e2fe         * loop   242c            ; prodleva
242e  48             dec    ax              ; ‡¡ta‡ prodlevy
242f  75f8           jnz    2429            ; dal¨¡ prodleva
2431  59           * pop    cx              ; n vrat CX
2432  58             pop    ax              ; n vrat AX
2433  c3             ret
; -----------------------------------------------------------------------------

                                          ;* inicializace zvukov‚ho gener toru

2434  50           * push   ax              ; £schova AX
2435  b0b6           mov    al,b6           ; povel pro nastaven¡ kan. 2 ‡¡ta‡e
2437  e643           out    [43],al         ; nastaven¡ m¢du kan lu 2 ‡¡ta‡e
2439  b8a904         mov    ax,04a9         ; dˆlic¡ konstanta pro p¡pnut¡
243c  e642           out    [42],al         ; nastaven¡ ni‘¨¡ho bajtu dˆli‡ky
243e  8ac4           mov    al,ah           ; vy¨¨¡ bajt pro nastaven¡ dˆli‡ky
2440  e642           out    [42],al         ; nastaven¡ vy¨¨¡ho bajtu dˆli‡ky
2442  58             pop    ax              ; n vrat AX
2443  c3             ret

; *****************************************************************************
;
;                    Obsluha p©eru¨en¡ INT 05h (Print Screen)
;
; *****************************************************************************

                                          ;* obsluha p©eru¨en¡ tisku obrazovky

2444  fb           * sti                    ; povolen¡ p©eru¨en¡
2445  50             push   ax              ; £schova AX
2446  53             push   bx              ; £schova BX
2447  51             push   cx              ; £schova CX
2448  52             push   dx              ; £schova DX
2449  1e             push   ds              ; £schova DS
244a  33c0           xor    ax,ax           ; AX <- 0
244c  8ed8           mov    ds,ax           ; DS <- 0
244e  40             inc    ax              ; AX <- 1
244f  86060005       xchg   al,[0500]       ; nastaven¡ p©¡znaku obsluhy INT 05h
2453  48             dec    ax              ; sou‡asn˜ stav - 1
2454  7442           jz     2498            ; obsluha INT 05h ji‘ prob¡h 
2456  b40f           mov    ah,0f           ; funkce poskytnut¡ videom¢du
2458  cd10           int    10              ; poskytnut¡ aktivn¡ho videom¢du
245a  8adc           mov    bl,ah           ; po‡et znak– na © dek
245c  b403           mov    ah,03           ; funkce ‡ten¡ pozice kurzoru
245e  cd10           int    10              ; ‡ten¡ pozice kurzoru
2460  52             push   dx              ; £schova p–vodn¡ pozice kurzoru
2461  e83a00         call   249e            ; od© dkov n¡ tisk rny
2464  b1ff           mov    cl,ff           ; p©¡znak chyby tisku
2466  33d2           xor    dx,dx           ; po‡ te‡n¡ pozice kurzoru
2468  b402         * mov    ah,02           ; funkce nastaven¡ pozice kurzoru
246a  cd10           int    10              ; nastaven¡ pozice kurzoru
246c  b408           mov    ah,08           ; funkce ‡ten¡ znaku
246e  cd10           int    10              ; ‡ten¡ znaku z pozice kurzoru
2470  0ac0           or     al,al           ; je znak 00 ?
2472  7502           jnz    2476            ; nen¡ znak 00
2474  b020           mov    al,20           ; n hradn¡ znak mezery
2476  e82c00       * call   24a5            ; tisk znaku na tisk rnu
2479  7514           jnz    248f            ; chyba tisk rny - konec
247b  42             inc    dx              ; zv˜¨en¡ pozice kurzoru
247c  3ad3           cmp    dl,bl           ; je dosa‘eno konce © dku ?
247e  72e8           jc     2468            ; nen¡ je¨tˆ konec © dku
2480  e81b00         call   249e            ; od© dkov n¡ tisk rny
2483  32d2           xor    dl,dl           ; pozice na za‡ tek © dku
2485  fec6           inc    dh              ; zv˜¨en¡ ‡¡sla © dku
2487  3a368404       cmp    dh,[0484]       ; dosa‘eno posledn¡ho © dku ?
248b  76db           jna    2468            ; nen¡ je¨tˆ posledn¡ © dek
248d  32c9           xor    cl,cl           ; CL <- 0 p©¡znak operace OK
248f  5a           * pop    dx              ; n vrat p–vodn¡ pozice kurzoru
2490  b402           mov    ah,02           ; funkce nastaven¡ pozice kurzoru
2492  cd10           int    10              ; nastaven¡ p–vodn¡ pozice kurzoru
2494  880e0005       mov    [0500],cl       ; ulo‘en¡ statusu operace tisku
2498  1f           * pop    ds              ; n vrat DS
2499  5a             pop    dx              ; n vrat DX
249a  59             pop    cx              ; n vrat CX
249b  5b             pop    bx              ; n vrat BX
249c  58             pop    ax              ; n vrat AX
249d  cf             iret                   ; n vrat z p©eru¨en¡

; -----------------------------------------------------------------------------

                                          ;* od© dkov n¡ tisk rny
                                            ; VSTUP: AH=stav tisk rny
                                            ;         ZN=chyba tisk rny

249e  b00d         * mov    al,0d           ; znak <CR>
24a0  e80200         call   24a5            ; v˜stup znaku na tisk rnu
24a3  b00a           mov    al,0a           ; znak <LF>

; -----------------------------------------------------------------------------

                                          ;* v˜stup znaku na tisk rnu LPT1
                                            ; VSTUP: AL=znak k v˜stupu
                                            ; VSTUP: AH=stav tisk rny
                                            ;         ZN=chyba tisk rny

24a5  52           * push   dx              ; £schova DX
24a6  33d2           xor    dx,dx           ; DX <- 0 (= tisk rna LPT1)
24a8  32e4           xor    ah,ah           ; AH <- 0 (=funkce v˜stupu na tisk.)
24aa  cd17           int    17              ; v˜stup znaku AL na tisk rnu
24ac  f6c429         test   ah,29           ; test chyby tisk rny
24af  5a             pop    dx              ; n vrat DX
24b0  c3             ret

                     nop
; *****************************************************************************
;
;                               Fonty
;
; *****************************************************************************
                                          ;* tabulka po‡tu © dk–
24b2                 db     0               ; 0
                     db     14              ; 1
                     db     25              ; 2
                     db     43              ; 3

                                          ;* tabulka ukazatel– font–
24b6                 dw     24d0h           ; 8x14
                     dw     3400h           ; 8x8
                     dw     3800h           ; dvoubodov˜ 8x8 (vrchol)
                     dw     32d0h           ; alternativn¡ 9x14
                     dw     3400h

24B0   C3 90 00 0E 19 2B D0 24 00 34 00 38 D0 32 00 34   .....+.$.4.8.2.4
24C0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................

                                          ;* font 14 linek na znak
                                            ; k¢dy 0 a‘ 255

24D0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
24E0   7E 81 A5 81 81 BD 99 81 7E 00 00 00 00 00 7E FF   ~.......~.....~.
24F0   DB FF FF C3 E7 FF 7E 00 00 00 00 00 00 6C FE FE   ......~......l..
2500   FE FE 7C 38 10 00 00 00 00 00 00 10 38 7C FE 7C   ..|8........8|.|
2510   38 10 00 00 00 00 00 00 18 3C 3C E7 E7 E7 18 18   8........<<.....
2520   3C 00 00 00 00 00 18 3C 7E FF FF 7E 18 18 3C 00   <......<~..~..<.
2530   00 00 00 00 00 00 00 18 3C 3C 18 00 00 00 00 00   ........<<......
2540   FF FF FF FF FF E7 C3 C3 E7 FF FF FF FF FF 00 00   ................
2550   00 00 3C 66 42 42 66 3C 00 00 00 00 FF FF FF FF   ..<fBBf<........
2560   C3 99 BD BD 99 C3 FF FF FF FF 00 00 1E 0E 1A 32   ...............2
2570   78 CC CC CC 78 00 00 00 00 00 3C 66 66 66 3C 18   x...x.....<fff<.
2580   7E 18 18 00 00 00 00 00 3F 33 3F 30 30 30 70 F0   ~.......?3?000p.
2590   E0 00 00 00 00 00 7F 63 7F 63 63 63 67 E7 E6 C0   ......ccccg...
25A0   00 00 00 00 18 18 DB 3C E7 3C DB 18 18 00 00 00   .......<.<......
25B0   00 00 80 C0 E0 F8 FE F8 E0 C0 80 00 00 00 00 00   ................
25C0   02 06 0E 3E FE 3E 0E 06 02 00 00 00 00 00 18 3C   ...>.>.........<
25D0   7E 18 18 18 7E 3C 18 00 00 00 00 00 66 66 66 66   ~...~<......ffff
25E0   66 66 00 66 66 00 00 00 00 00 7F DB DB DB 7B 1B   ff.ff........{.
25F0   1B 1B 1B 00 00 00 00 7C C6 60 38 6C C6 C6 6C 38   .......|.`8l..l8
2600   0C C6 7C 00 00 00 00 00 00 00 00 00 FE FE FE 00   ..|.............
2610   00 00 00 00 18 3C 7E 18 18 18 7E 3C 18 7E 00 00   .....<~...~<.~..
2620   00 00 18 3C 7E 18 18 18 18 18 18 00 00 00 00 00   ...<~...........
2630   18 18 18 18 18 18 7E 3C 18 00 00 00 00 00 00 00   ......~<........
2640   18 0C FE 0C 18 00 00 00 00 00 00 00 00 00 30 60   ..............0`
2650   FE 60 30 00 00 00 00 00 00 00 00 00 00 C0 C0 C0   .`0.............
2660   FE 00 00 00 00 00 00 00 00 00 28 6C FE 6C 28 00   ..........(l.l(.
2670   00 00 00 00 00 00 00 10 38 38 7C 7C FE FE 00 00   ........88||....
2680   00 00 00 00 00 FE FE 7C 7C 38 38 10 00 00 00 00   .......||88.....
2690   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
26A0   18 3C 3C 3C 18 18 00 18 18 00 00 00 00 66 66 66   .<<<.........fff
26B0   24 00 00 00 00 00 00 00 00 00 00 00 6C 6C FE 6C   $...........ll.l
26C0   6C 6C FE 6C 6C 00 00 00 18 18 7C C6 C2 C0 7C 06   ll.ll.....|...|.
26D0   86 C6 7C 18 18 00 00 00 00 00 C2 C6 0C 18 30 66   ..|...........0f
26E0   C6 00 00 00 00 00 38 6C 6C 38 76 DC CC CC 76 00   ......8ll8v...v.
26F0   00 00 00 30 30 30 60 00 00 00 00 00 00 00 00 00   ...000`.........
2700   00 00 0C 18 30 30 30 30 30 18 0C 00 00 00 00 00   ....00000.......
2710   30 18 0C 0C 0C 0C 0C 18 30 00 00 00 00 00 00 00   0.......0.......
2720   66 3C FF 3C 66 00 00 00 00 00 00 00 00 00 18 18   f<.<f...........
2730   7E 18 18 00 00 00 00 00 00 00 00 00 00 00 00 00   ~...............
2740   18 18 18 30 00 00 00 00 00 00 00 00 FE 00 00 00   ...0............
2750   00 00 00 00 00 00 00 00 00 00 00 00 00 18 18 00   ................
2760   00 00 00 00 02 06 0C 18 30 60 C0 80 00 00 00 00   ........0`......
2770   00 00 7C C6 CE DE F6 E6 C6 C6 7C 00 00 00 00 00   ..|.......|.....
2780   18 38 78 18 18 18 18 18 7E 00 00 00 00 00 7C C6   .8x.....~.....|.
2790   06 0C 18 30 60 C6 FE 00 00 00 00 00 7C C6 06 06   ...0`.......|...
27A0   3C 06 06 C6 7C 00 00 00 00 00 0C 1C 3C 6C CC FE   <...|.......<l..
27B0   0C 0C 1E 00 00 00 00 00 FE C0 C0 C0 FC 06 06 C6   ................
27C0   7C 00 00 00 00 00 38 60 C0 C0 FC C6 C6 C6 7C 00   |.....8`......|.
27D0   00 00 00 00 FE C6 06 0C 18 30 30 30 30 00 00 00   .........0000...
27E0   00 00 7C C6 C6 C6 7C C6 C6 C6 7C 00 00 00 00 00   ..|...|...|.....
27F0   7C C6 C6 C6 7E 06 06 0C 78 00 00 00 00 00 00 18   |...~...x.......
2800   18 00 00 00 18 18 00 00 00 00 00 00 00 18 18 00   ................
2810   00 00 18 18 30 00 00 00 00 00 06 0C 18 30 60 30   ....0........0`0
2820   18 0C 06 00 00 00 00 00 00 00 00 7E 00 00 7E 00   ...........~..~.
2830   00 00 00 00 00 00 60 30 18 0C 06 0C 18 30 60 00   ......`0.....0`.
2840   00 00 00 00 7C C6 C6 0C 18 18 00 18 18 00 00 00   ....|...........
2850   00 00 7C C6 C6 DE DE DE DC C0 7C 00 00 00 00 00   ..|.......|.....
2860   10 38 6C C6 C6 FE C6 C6 C6 00 00 00 00 00 FC 66   .8l............f
2870   66 66 7C 66 66 66 FC 00 00 00 00 00 3C 66 C2 C0   ff|fff......<f..
2880   C0 C0 C2 66 3C 00 00 00 00 00 F8 6C 66 66 66 66   ...f<......lffff
2890   66 6C F8 00 00 00 00 00 FE 66 62 68 78 68 62 66   fl.......fbhxhbf
28A0   FE 00 00 00 00 00 FE 66 62 68 78 68 60 60 F0 00   .......fbhxh``..
28B0   00 00 00 00 3C 66 C2 C0 C0 DE C6 66 3A 00 00 00   ....<f.....f:...
28C0   00 00 C6 C6 C6 C6 FE C6 C6 C6 C6 00 00 00 00 00   ................
28D0   3C 18 18 18 18 18 18 18 3C 00 00 00 00 00 1E 0C   <.......<.......
28E0   0C 0C 0C 0C CC CC 78 00 00 00 00 00 E6 66 6C 6C   ......x......fll
28F0   78 6C 6C 66 E6 00 00 00 00 00 F0 60 60 60 60 60   xllf.......`````
2900   62 66 FE 00 00 00 00 00 C6 EE FE FE D6 C6 C6 C6   bf..............
2910   C6 00 00 00 00 00 C6 E6 F6 FE DE CE C6 C6 C6 00   ................
2920   00 00 00 00 38 6C C6 C6 C6 C6 C6 6C 38 00 00 00   ....8l.....l8...
2930   00 00 FC 66 66 66 7C 60 60 60 F0 00 00 00 00 00   ...fff|```......
2940   7C C6 C6 C6 C6 D6 DE 7C 0C 0E 00 00 00 00 FC 66   |......|.......f
2950   66 66 7C 6C 66 66 E6 00 00 00 00 00 7C C6 C6 60   ff|lff......|..`
2960   38 0C C6 C6 7C 00 00 00 00 00 7E 7E 5A 18 18 18   8...|.....~~Z...
2970   18 18 3C 00 00 00 00 00 C6 C6 C6 C6 C6 C6 C6 C6   ..<.............
2980   7C 00 00 00 00 00 C6 C6 C6 C6 C6 C6 6C 38 10 00   |...........l8..
2990   00 00 00 00 C6 C6 C6 C6 D6 D6 FE 7C 6C 00 00 00   ...........|l...
29A0   00 00 C6 C6 6C 38 38 38 6C C6 C6 00 00 00 00 00   ....l888l.......
29B0   66 66 66 66 3C 18 18 18 3C 00 00 00 00 00 FE C6   ffff<...<.......
29C0   8C 18 30 60 C2 C6 FE 00 00 00 00 00 3C 30 30 30   ..0`........<000
29D0   30 30 30 30 3C 00 00 00 00 00 80 C0 E0 70 38 1C   0000<........p8.
29E0   0E 06 02 00 00 00 00 00 3C 0C 0C 0C 0C 0C 0C 0C   ........<.......
29F0   3C 00 00 00 10 38 6C C6 00 00 00 00 00 00 00 00   <....8l.........
2A00   00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF 00   ................
2A10   30 30 18 00 00 00 00 00 00 00 00 00 00 00 00 00   00..............
2A20   00 00 00 78 0C 7C CC CC 76 00 00 00 00 00 E0 60   ...x.|..v......`
2A30   60 78 6C 66 66 66 7C 00 00 00 00 00 00 00 00 7C   `xlfff|........|
2A40   C6 C0 C0 C6 7C 00 00 00 00 00 1C 0C 0C 3C 6C CC   ....|........<l.
2A50   CC CC 76 00 00 00 00 00 00 00 00 7C C6 FE C0 C6   ..v........|....
2A60   7C 00 00 00 00 00 38 6C 64 60 F0 60 60 60 F0 00   |.....8ld`.```..
2A70   00 00 00 00 00 00 00 76 CC CC CC 7C 0C CC 78 00   .......v...|..x.
2A80   00 00 E0 60 60 6C 76 66 66 66 E6 00 00 00 00 00   ...``lvfff......
2A90   18 18 00 38 18 18 18 18 3C 00 00 00 00 00 06 06   ...8....<.......
2AA0   00 0E 06 06 06 06 66 66 3C 00 00 00 E0 60 60 66   ......ff<....``f
2AB0   6C 78 6C 66 E6 00 00 00 00 00 38 18 18 18 18 18   lxlf......8.....
2AC0   18 18 3C 00 00 00 00 00 00 00 00 EC FE D6 D6 D6   ..<.............
2AD0   C6 00 00 00 00 00 00 00 00 DC 66 66 66 66 66 00   ..........fffff.
2AE0   00 00 00 00 00 00 00 7C C6 C6 C6 C6 7C 00 00 00   .......|....|...
2AF0   00 00 00 00 00 DC 66 66 66 7C 60 60 F0 00 00 00   ......fff|``....
2B00   00 00 00 76 CC CC CC 7C 0C 0C 1E 00 00 00 00 00   ...v...|........
2B10   00 DC 76 66 60 60 F0 00 00 00 00 00 00 00 00 7C   ..vf``.........|
2B20   C6 70 1C C6 7C 00 00 00 00 00 10 30 30 FC 30 30   .p..|......00.00
2B30   30 36 1C 00 00 00 00 00 00 00 00 CC CC CC CC CC   06..............
2B40   76 00 00 00 00 00 00 00 00 66 66 66 66 3C 18 00   v........ffff<..
2B50   00 00 00 00 00 00 00 C6 C6 D6 D6 FE 6C 00 00 00   ............l...
2B60   00 00 00 00 00 C6 6C 38 38 6C C6 00 00 00 00 00   ......l88l......
2B70   00 00 00 C6 C6 C6 C6 7E 06 0C F8 00 00 00 00 00   .......~........
2B80   00 FE CC 18 30 66 FE 00 00 00 00 00 0E 18 18 18   ....0f..........
2B90   70 18 18 18 0E 00 00 00 00 00 18 18 18 18 00 18   p...............
2BA0   18 18 18 00 00 00 00 00 70 18 18 18 0E 18 18 18   ........p.......
2BB0   70 00 00 00 00 00 76 DC 00 00 00 00 00 00 00 00   p.....v.........
2BC0   00 00 00 00 00 00 10 38 6C C6 C6 FE 00 00 00 00   .......8l.......
2BD0   00 00 3C 66 C2 C0 C0 C2 66 3C 0C 06 7C 00 00 00   ..<f....f<..|...
2BE0   CC CC 00 CC CC CC CC CC 76 00 00 00 00 0C 18 30   ........v......0
2BF0   00 7C C6 FE C0 C6 7C 00 00 00 00 10 38 6C 00 78   .|....|.....8l.x
2C00   0C 7C CC CC 76 00 00 00 00 00 CC CC 00 78 0C 7C   .|..v........x.|
2C10   CC CC 76 00 00 00 00 60 30 18 00 78 0C 7C CC CC   ..v....`0..x.|..
2C20   76 00 00 00 00 38 6C 38 00 78 0C 7C CC CC 76 00   v....8l8.x.|..v.
2C30   00 00 00 00 00 00 3C 66 60 66 3C 0C 06 3C 00 00   ......<f`f<..<..
2C40   00 10 38 6C 00 7C C6 FE C0 C6 7C 00 00 00 00 00   ..8l.|....|.....
2C50   CC CC 00 7C C6 FE C0 C6 7C 00 00 00 00 60 30 18   ...|....|....`0.
2C60   00 7C C6 FE C0 C6 7C 00 00 00 00 00 66 66 00 38   .|....|.....ff.8
2C70   18 18 18 18 3C 00 00 00 00 18 3C 66 00 38 18 18   ....<.....<f.8..
2C80   18 18 3C 00 00 00 00 60 30 18 00 38 18 18 18 18   ..<....`0..8....
2C90   3C 00 00 00 00 C6 C6 10 38 6C C6 C6 FE C6 C6 00   <.......8l......
2CA0   00 00 38 6C 38 00 38 6C C6 C6 FE C6 C6 00 00 00   ..8l8.8l........
2CB0   18 30 60 00 FE 66 60 7C 60 66 FE 00 00 00 00 00   .0`..f`|`f......
2CC0   00 00 CC 76 36 7E D8 D8 6E 00 00 00 00 00 3E 6C   ...v6~..n.....>l
2CD0   CC CC FE CC CC CC CE 00 00 00 00 10 38 6C 00 7C   ............8l.|
2CE0   C6 C6 C6 C6 7C 00 00 00 00 00 C6 C6 00 7C C6 C6   ....|........|..
2CF0   C6 C6 7C 00 00 00 00 60 30 18 00 7C C6 C6 C6 C6   ..|....`0..|....
2D00   7C 00 00 00 00 30 78 CC 00 CC CC CC CC CC 76 00   |....0x.......v.
2D10   00 00 00 60 30 18 00 CC CC CC CC CC 76 00 00 00   ...`0.......v...
2D20   00 00 C6 C6 00 C6 C6 C6 C6 7E 06 0C 78 00 00 C6   .........~..x...
2D30   C6 38 6C C6 C6 C6 C6 6C 38 00 00 00 00 C6 C6 00   .8l....l8.......
2D40   C6 C6 C6 C6 C6 C6 7C 00 00 00 00 18 18 3C 66 60   ......|......<f`
2D50   60 66 3C 18 18 00 00 00 00 38 6C 64 60 F0 60 60   `f<......8ld`.``
2D60   60 E6 FC 00 00 00 00 00 66 66 3C 18 7E 18 7E 18   `.......ff<.~.~.
2D70   18 00 00 00 00 F8 CC CC F8 C4 CC DE CC CC C6 00   ................
2D80   00 00 00 0E 1B 18 18 18 7E 18 18 18 18 D8 70 00   ........~.....p.
2D90   00 18 30 60 00 78 0C 7C CC CC 76 00 00 00 00 0C   ..0`.x.|..v.....
2DA0   18 30 00 38 18 18 18 18 3C 00 00 00 00 18 30 60   .0.8....<.....0`
2DB0   00 7C C6 C6 C6 C6 7C 00 00 00 00 18 30 60 00 CC   .|....|.....0`..
2DC0   CC CC CC CC 76 00 00 00 00 00 76 DC 00 DC 66 66   ....v.....v...ff
2DD0   66 66 66 00 00 00 76 DC 00 C6 E6 F6 FE DE CE C6   fff...v.........
2DE0   C6 00 00 00 00 3C 6C 6C 3E 00 7E 00 00 00 00 00   .....<ll>.~.....
2DF0   00 00 00 38 6C 6C 38 00 7C 00 00 00 00 00 00 00   ...8ll8.|.......
2E00   00 00 30 30 00 30 30 60 C6 C6 7C 00 00 00 00 00   ..00.00`..|.....
2E10   00 00 00 00 FE C0 C0 C0 00 00 00 00 00 00 00 00   ................
2E20   00 00 FE 06 06 06 00 00 00 00 00 C0 C0 C6 CC D8   ................
2E30   30 60 DC 86 0C 18 3E 00 00 C0 C0 C6 CC D8 30 66   0`....>.......0f
2E40   CE 9E 3E 06 06 00 00 00 18 18 00 18 18 3C 3C 3C   ..>..........<<<
2E50   18 00 00 00 00 00 00 00 36 6C D8 6C 36 00 00 00   ........6l.l6...
2E60   00 00 00 00 00 00 D8 6C 36 6C D8 00 00 00 00 00   .......l6l......
2E70   11 44 11 44 11 44 11 44 11 44 11 44 11 44 55 AA   .D.D.D.D.D.D.DU.
2E80   55 AA 55 AA 55 AA 55 AA 55 AA 55 AA DD 77 DD 77   U.U.U.U.U.U..w.w
2E90   DD 77 DD 77 DD 77 DD 77 DD 77 18 18 18 18 18 18   .w.w.w.w.w......
2EA0   18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 F8   ................
2EB0   18 18 18 18 18 18 18 18 18 18 18 F8 18 F8 18 18   ................
2EC0   18 18 18 18 36 36 36 36 36 36 36 F6 36 36 36 36   ....6666666.6666
2ED0   36 36 00 00 00 00 00 00 00 FE 36 36 36 36 36 36   66........666666
2EE0   00 00 00 00 00 F8 18 F8 18 18 18 18 18 18 36 36   ..............66
2EF0   36 36 36 F6 06 F6 36 36 36 36 36 36 36 36 36 36   666...6666666666
2F00   36 36 36 36 36 36 36 36 36 36 00 00 00 00 00 FE   6666666666......
2F10   06 F6 36 36 36 36 36 36 36 36 36 36 36 F6 06 FE   ..66666666666...
2F20   00 00 00 00 00 00 36 36 36 36 36 36 36 FE 00 00   ......6666666...
2F30   00 00 00 00 18 18 18 18 18 F8 18 F8 00 00 00 00   ................
2F40   00 00 00 00 00 00 00 00 00 F8 18 18 18 18 18 18   ................
2F50   18 18 18 18 18 18 18 1F 00 00 00 00 00 00 18 18   ................
2F60   18 18 18 18 18 FF 00 00 00 00 00 00 00 00 00 00   ................
2F70   00 00 00 FF 18 18 18 18 18 18 18 18 18 18 18 18   ................
2F80   18 1F 18 18 18 18 18 18 00 00 00 00 00 00 00 FF   ................
2F90   00 00 00 00 00 00 18 18 18 18 18 18 18 FF 18 18   ................
2FA0   18 18 18 18 18 18 18 18 18 1F 18 1F 18 18 18 18   ................
2FB0   18 18 36 36 36 36 36 36 36 37 36 36 36 36 36 36   ..66666667666666
2FC0   36 36 36 36 36 37 30 3F 00 00 00 00 00 00 00 00   6666670?........
2FD0   00 00 00 3F 30 37 36 36 36 36 36 36 36 36 36 36   ...?076666666666
2FE0   36 F7 00 FF 00 00 00 00 00 00 00 00 00 00 00 FF   6...............
2FF0   00 F7 36 36 36 36 36 36 36 36 36 36 36 37 30 37   ..66666666666707
3000   36 36 36 36 36 36 00 00 00 00 00 FF 00 FF 00 00   666666..........
3010   00 00 00 00 36 36 36 36 36 F7 00 F7 36 36 36 36   ....66666...6666
3020   36 36 18 18 18 18 18 FF 00 FF 00 00 00 00 00 00   66..............
3030   36 36 36 36 36 36 36 FF 00 00 00 00 00 00 00 00   6666666.........
3040   00 00 00 FF 00 FF 18 18 18 18 18 18 00 00 00 00   ................
3050   00 00 00 FF 36 36 36 36 36 36 36 36 36 36 36 36   ....666666666666
3060   36 3F 00 00 00 00 00 00 18 18 18 18 18 1F 18 1F   6?..............
3070   00 00 00 00 00 00 00 00 00 00 00 1F 18 1F 18 18   ................
3080   18 18 18 18 00 00 00 00 00 00 00 3F 36 36 36 36   ...........?6666
3090   36 36 36 36 36 36 36 36 36 FF 36 36 36 36 36 36   666666666.666666
30A0   18 18 18 18 18 FF 18 FF 18 18 18 18 18 18 18 18   ................
30B0   18 18 18 18 18 F8 00 00 00 00 00 00 00 00 00 00   ................
30C0   00 00 00 1F 18 18 18 18 18 18 FF FF FF FF FF FF   ................
30D0   FF FF FF FF FF FF FF FF 00 00 00 00 00 00 00 FF   ................
30E0   FF FF FF FF FF FF F0 F0 F0 F0 F0 F0 F0 F0 F0 F0   ................
30F0   F0 F0 F0 F0 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F   ................
3100   0F 0F FF FF FF FF FF FF FF 00 00 00 00 00 00 00   ................
3110   00 00 00 00 00 76 DC D8 D8 DC 76 00 00 00 00 00   .....v....v.....
3120   00 00 7C C6 FC C6 C6 FC C0 C0 40 00 00 00 FE C6   ..|.......@.....
3130   C6 C0 C0 C0 C0 C0 C0 00 00 00 00 00 00 00 FE 6C   ...............l
3140   6C 6C 6C 6C 6C 00 00 00 00 00 FE C6 60 30 18 30   lllll.......`0.0
3150   60 C6 FE 00 00 00 00 00 00 00 00 7E D8 D8 D8 D8   `..........~....
3160   70 00 00 00 00 00 00 00 66 66 66 66 7C 60 60 C0   p.......ffff|``.
3170   00 00 00 00 00 00 76 DC 18 18 18 18 18 00 00 00   ......v.........
3180   00 00 7E 18 3C 66 66 66 3C 18 7E 00 00 00 00 00   ..~.<fff<.~.....
3190   38 6C C6 C6 FE C6 C6 6C 38 00 00 00 00 00 38 6C   8l.....l8.....8l
31A0   C6 C6 C6 6C 6C 6C EE 00 00 00 00 00 1E 30 18 0C   ...lll.......0..
31B0   3E 66 66 66 3C 00 00 00 00 00 00 00 00 7E DB DB   >fff<........~..
31C0   7E 00 00 00 00 00 00 00 03 06 7E DB DB F3 7E 60   ~.........~...~`
31D0   C0 00 00 00 00 00 1C 30 60 60 7C 60 60 30 1C 00   .......0``|``0..
31E0   00 00 00 00 00 7C C6 C6 C6 C6 C6 C6 C6 00 00 00   .....|..........
31F0   00 00 00 FE 00 00 FE 00 00 FE 00 00 00 00 00 00   ................
3200   00 18 18 7E 18 18 00 00 FF 00 00 00 00 00 30 18   ...~..........0.
3210   0C 06 0C 18 30 00 7E 00 00 00 00 00 0C 18 30 60   ....0.~.......0`
3220   30 18 0C 00 7E 00 00 00 00 00 0E 1B 1B 18 18 18   0...~...........
3230   18 18 18 18 18 18 18 18 18 18 18 18 18 18 D8 D8   ................
3240   70 00 00 00 00 00 00 18 18 00 7E 00 18 18 00 00   p.........~.....
3250   00 00 00 00 00 00 76 DC 00 76 DC 00 00 00 00 00   ......v..v......
3260   00 38 6C 6C 38 00 00 00 00 00 00 00 00 00 00 00   .8ll8...........
3270   00 00 00 00 18 18 00 00 00 00 00 00 00 00 00 00   ................
3280   00 00 00 18 00 00 00 00 00 00 00 0F 0C 0C 0C 0C   ................
3290   0C EC 6C 3C 1C 00 00 00 00 D8 6C 6C 6C 6C 6C 00   ..l<......lllll.
32A0   00 00 00 00 00 00 00 70 D8 30 60 C8 F8 00 00 00   .......p.0`.....
32B0   00 00 00 00 00 00 00 00 7C 7C 7C 7C 7C 7C 00 00   ........||||||..
32C0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................


                                          ;* tabulka nˆkter˜ch znak– pro MDA
32d0                 db     1dh
                     db     0,0,0,0,24h,66h,0ffh,66h,24h,0,0,0,0,0
32df                 db     22h
                     db     0,63h,63h,63h,22h,0,0,0,0,0,0,0,0,0


32D0   1D 00 00 00 00 24 66 FF 66 24 00 00 00 00 00 22   .....$f.f$....."
32E0   00 63 63 63 22 00 00 00 00 00 00 00 00 00 2B 00   .ccc".........+.
32F0   00 00 18 18 18 FF 18 18 18 00 00 00 00 2D 00 00   .............-..
3300   00 00 00 00 FF 00 00 00 00 00 00 00 4D 00 00 C3   ............M...
3310   E7 FF DB C3 C3 C3 C3 C3 00 00 00 54 00 00 FF DB   ...........T....
3320   99 18 18 18 18 18 3C 00 00 00 56 00 00 C3 C3 C3   ......<...V.....
3330   C3 C3 C3 66 3C 18 00 00 00 57 00 00 C3 C3 C3 C3   ...f<....W......
3340   DB DB FF 66 66 00 00 00 58 00 00 C3 C3 66 3C 18   ...ff...X....f<.
3350   3C 66 C3 C3 00 00 00 59 00 00 C3 C3 C3 66 3C 18   <f.....Y.....f<.
3360   18 18 3C 00 00 00 5A 00 00 FF C3 86 0C 18 30 61   ..<...Z.......0a
3370   C3 FF 00 00 00 6D 00 00 00 00 00 E6 FF DB DB DB   .....m..........
3380   DB 00 00 00 76 00 00 00 00 00 C3 C3 C3 66 3C 18   ....v........f<.
3390   00 00 00 77 00 00 00 00 00 C3 C3 DB DB FF 66 00   ...w..........f.
33A0   00 00 91 00 00 00 00 6E 3B 1B 7E D8 DC 77 00 00   .......n;.~..w..
33B0   00 9B 00 18 18 7E C3 C0 C0 C3 7E 18 18 00 00 00   .....~....~.....
33C0   9D 00 00 C3 66 3C 18 FF 18 FF 18 18 00 00 00 9E   ....f<..........
33D0   00 FC 66 66 7C 62 66 6F 66 66 F3 00 00 00 F1 00   ..ff|bfoff......
33E0   00 18 18 18 FF 18 18 18 00 FF 00 00 00 F6 00 00   ................
33F0   18 18 00 00 FF 00 00 18 18 00 00 00 00 00 00 00   ................



                                                 ; inicial. font EGA (INT 43h)
                                                 ; 0 a‘ 127 / 8 linek na znak

3400   00 00 00 00 00 00 00 00 7E 81 A5 81 BD 99 81 7E   ........~......~
3410   7E FF DB FF C3 E7 FF 7E 6C FE FE FE 7C 38 10 00   ~......~l...|8..
3420   10 38 7C FE 7C 38 10 00 38 7C 38 FE FE 7C 38 7C   .8|.|8..8|8..|8|
3430   10 10 38 7C FE 7C 38 7C 00 00 18 3C 3C 18 00 00   ..8|.|8|...<<...
3440   FF FF E7 C3 C3 E7 FF FF 00 3C 66 42 42 66 3C 00   .........<fBBf<.
3450   FF C3 99 BD BD 99 C3 FF 0F 07 0F 7D CC CC CC 78   ...........}...x
3460   3C 66 66 66 3C 18 7E 18 3F 33 3F 30 30 70 F0 E0   <fff<.~.?3?00p..
3470   7F 63 7F 63 63 67 E6 C0 99 5A 3C E7 E7 3C 5A 99   cccg...Z<..<Z.
3480   80 E0 F8 FE F8 E0 80 00 02 0E 3E FE 3E 0E 02 00   ..........>.>...
3490   18 3C 7E 18 18 7E 3C 18 66 66 66 66 66 00 66 00   .<~..~<.fffff.f.
34A0   7F DB DB 7B 1B 1B 1B 00 3E 63 38 6C 6C 38 CC 78   ..{....>c8ll8.x
34B0   00 00 00 00 7E 7E 7E 00 18 3C 7E 18 7E 3C 18 FF   ....~~~..<~.~<..
34C0   18 3C 7E 18 18 18 18 00 18 18 18 18 7E 3C 18 00   .<~.........~<..
34D0   00 18 0C FE 0C 18 00 00 00 30 60 FE 60 30 00 00   .........0`.`0..
34E0   00 00 C0 C0 C0 FE 00 00 00 24 66 FF 66 24 00 00   .........$f.f$..
34F0   00 18 3C 7E FF FF 00 00 00 FF FF 7E 3C 18 00 00   ..<~.......~<...
3500   00 00 00 00 00 00 00 00 30 78 78 30 30 00 30 00   ........0xx00.0.
3510   6C 6C 6C 00 00 00 00 00 6C 6C FE 6C FE 6C 6C 00   lll.....ll.l.ll.
3520   30 7C C0 78 0C F8 30 00 00 C6 CC 18 30 66 C6 00   0|.x..0.....0f..
3530   38 6C 38 76 DC CC 76 00 60 60 C0 00 00 00 00 00   8l8v..v.``......
3540   18 30 60 60 60 30 18 00 60 30 18 18 18 30 60 00   .0```0..`0...0`.
3550   00 66 3C FF 3C 66 00 00 00 30 30 FC 30 30 00 00   .f<.<f...00.00..
3560   00 00 00 00 00 30 30 60 00 00 00 FC 00 00 00 00   .....00`........
3570   00 00 00 00 00 30 30 00 06 0C 18 30 60 C0 80 00   .....00....0`...
3580   7C C6 CE DE F6 E6 7C 00 30 70 30 30 30 30 FC 00   |.....|.0p0000..
3590   78 CC 0C 38 60 CC FC 00 78 CC 0C 38 0C CC 78 00   x..8`...x..8..x.
35A0   1C 3C 6C CC FE 0C 1E 00 FC C0 F8 0C 0C CC 78 00   .<l...........x.
35B0   38 60 C0 F8 CC CC 78 00 FC CC 0C 18 30 30 30 00   8`....x.....000.
35C0   78 CC CC 78 CC CC 78 00 78 CC CC 7C 0C 18 70 00   x..x..x.x..|..p.
35D0   00 30 30 00 00 30 30 00 00 30 30 00 00 30 30 60   .00..00..00..00`
35E0   18 30 60 C0 60 30 18 00 00 00 FC 00 00 FC 00 00   .0`.`0..........
35F0   60 30 18 0C 18 30 60 00 78 CC 0C 18 30 00 30 00   `0...0`.x...0.0.
3600   7C C6 DE DE DE C0 78 00 30 78 CC CC FC CC CC 00   |.....x.0x......
3610   FC 66 66 7C 66 66 FC 00 3C 66 C0 C0 C0 66 3C 00   .ff|ff..<f...f<.
3620   F8 6C 66 66 66 6C F8 00 FE 62 68 78 68 62 FE 00   .lfffl...bhxhb..
3630   FE 62 68 78 68 60 F0 00 3C 66 C0 C0 CE 66 3E 00   .bhxh`..<f...f>.
3640   CC CC CC FC CC CC CC 00 78 30 30 30 30 30 78 00   ........x00000x.
3650   1E 0C 0C 0C CC CC 78 00 E6 66 6C 78 6C 66 E6 00   ......x..flxlf..
3660   F0 60 60 60 62 66 FE 00 C6 EE FE FE D6 C6 C6 00   .```bf..........
3670   C6 E6 F6 DE CE C6 C6 00 38 6C C6 C6 C6 6C 38 00   ........8l...l8.
3680   FC 66 66 7C 60 60 F0 00 78 CC CC CC DC 78 1C 00   .ff|``..x....x..
3690   FC 66 66 7C 6C 66 E6 00 78 CC E0 70 1C CC 78 00   .ff|lf..x..p..x.
36A0   FC B4 30 30 30 30 78 00 CC CC CC CC CC CC FC 00   ..0000x.........
36B0   CC CC CC CC CC 78 30 00 C6 C6 C6 D6 FE EE C6 00   .....x0.........
36C0   C6 C6 6C 38 38 6C C6 00 CC CC CC 78 30 30 78 00   ..l88l.....x00x.
36D0   FE C6 8C 18 32 66 FE 00 78 60 60 60 60 60 78 00   ....2f..x`````x.
36E0   C0 60 30 18 0C 06 02 00 78 18 18 18 18 18 78 00   .`0.....x.....x.
36F0   10 38 6C C6 00 00 00 00 00 00 00 00 00 00 00 FF   .8l.............
3700   30 30 18 00 00 00 00 00 00 00 78 0C 7C CC 76 00   00........x.|.v.
3710   E0 60 60 7C 66 66 DC 00 00 00 78 CC C0 CC 78 00   .``|ff....x...x.
3720   1C 0C 0C 7C CC CC 76 00 00 00 78 CC FC C0 78 00   ...|..v...x...x.
3730   38 6C 60 F0 60 60 F0 00 00 00 76 CC CC 7C 0C F8   8l`.``....v..|..
3740   E0 60 6C 76 66 66 E6 00 30 00 70 30 30 30 78 00   .`lvff..0.p000x.
3750   0C 00 0C 0C 0C CC CC 78 E0 60 66 6C 78 6C E6 00   .......x.`flxl..
3760   70 30 30 30 30 30 78 00 00 00 CC FE FE D6 C6 00   p00000x.........
3770   00 00 F8 CC CC CC CC 00 00 00 78 CC CC CC 78 00   ..........x...x.
3780   00 00 DC 66 66 7C 60 F0 00 00 76 CC CC 7C 0C 1E   ...ff|`...v..|..
3790   00 00 DC 76 66 60 F0 00 00 00 7C C0 78 0C F8 00   ...vf`....|.x...
37A0   10 30 7C 30 30 34 18 00 00 00 CC CC CC CC 76 00   .0|004........v.
37B0   00 00 CC CC CC 78 30 00 00 00 C6 D6 FE FE 6C 00   .....x0.......l.
37C0   00 00 C6 6C 38 6C C6 00 00 00 CC CC CC 7C 0C F8   ...l8l.......|..
37D0   00 00 FC 98 30 64 FC 00 1C 30 30 E0 30 30 1C 00   ....0d...00.00..
37E0   18 18 18 00 18 18 18 00 E0 30 30 1C 30 30 E0 00   .........00.00..
37F0   76 DC 00 00 00 00 00 00 00 10 38 6C C6 C6 FE 00   v.........8l....


                                                 ; tabulka znak– EGA (INT 1FH)
                                                 ; 128 a‘ 255 / 8 linek na znak

3800   78 CC C0 CC 78 18 0C 78 00 CC 00 CC CC CC 7E 00   x...x..x......~.
3810   1C 00 78 CC FC C0 78 00 7E C3 3C 06 3E 66 3F 00   ..x...x.~.<.>f?.
3820   CC 00 78 0C 7C CC 7E 00 E0 00 78 0C 7C CC 7E 00   ..x.|.~...x.|.~.
3830   30 30 78 0C 7C CC 7E 00 00 00 78 C0 C0 78 0C 38   00x.|.~...x..x.8
3840   7E C3 3C 66 7E 60 3C 00 CC 00 78 CC FC C0 78 00   ~.<f~`<...x...x.
3850   E0 00 78 CC FC C0 78 00 CC 00 70 30 30 30 78 00   ..x...x...p000x.
3860   7C C6 38 18 18 18 3C 00 E0 00 70 30 30 30 78 00   |.8...<...p000x.
3870   C6 38 6C C6 FE C6 C6 00 30 30 00 78 CC FC CC 00   .8l.....00.x....
3880   1C 00 FC 60 78 60 FC 00 00 00 7F 0C 7F CC 7F 00   ...`x`.......
3890   3E 6C CC FE CC CC CE 00 78 CC 00 78 CC CC 78 00   >l......x..x..x.
38A0   00 CC 00 78 CC CC 78 00 00 E0 00 78 CC CC 78 00   ...x..x....x..x.
38B0   78 CC 00 CC CC CC 7E 00 00 E0 00 CC CC CC 7E 00   x.....~.......~.
38C0   00 CC 00 CC CC 7C 0C F8 C3 18 3C 66 66 3C 18 00   .....|....<ff<..
38D0   CC 00 CC CC CC CC 78 00 18 18 7E C0 C0 7E 18 18   ......x...~..~..
38E0   38 6C 64 F0 60 E6 FC 00 CC CC 78 FC 30 FC 30 30   8ld.`.....x.0.00
38F0   F8 CC CC FA C6 CF C6 C7 0E 1B 18 3C 18 18 D8 70   ...........<...p
3900   1C 00 78 0C 7C CC 7E 00 38 00 70 30 30 30 78 00   ..x.|.~.8.p000x.
3910   00 1C 00 78 CC CC 78 00 00 1C 00 CC CC CC 7E 00   ...x..x.......~.
3920   00 F8 00 F8 CC CC CC 00 FC 00 CC EC FC DC CC 00   ................
3930   3C 6C 6C 3E 00 7E 00 00 38 6C 6C 38 00 7C 00 00   <ll>.~..8ll8.|..
3940   30 00 30 60 C0 CC 78 00 00 00 00 FC C0 C0 00 00   0.0`..x.........
3950   00 00 00 FC 0C 0C 00 00 C3 C6 CC DE 33 66 CC 0F   ............3f..
3960   C3 C6 CC DB 37 6F CF 03 18 18 00 18 18 18 18 00   ....7o..........
3970   00 33 66 CC 66 33 00 00 00 CC 66 33 66 CC 00 00   .3f.f3....f3f...
3980   22 88 22 88 22 88 22 88 55 AA 55 AA 55 AA 55 AA   ".".".".U.U.U.U.
3990   DB 77 DB EE DB 77 DB EE 18 18 18 18 18 18 18 18   .w...w..........
39A0   18 18 18 18 F8 18 18 18 18 18 F8 18 F8 18 18 18   ................
39B0   36 36 36 36 F6 36 36 36 00 00 00 00 FE 36 36 36   6666.666.....666
39C0   00 00 F8 18 F8 18 18 18 36 36 F6 06 F6 36 36 36   ........66...666
39D0   36 36 36 36 36 36 36 36 00 00 FE 06 F6 36 36 36   66666666.....666
39E0   36 36 F6 06 FE 00 00 00 36 36 36 36 FE 00 00 00   66......6666....
39F0   18 18 F8 18 F8 00 00 00 00 00 00 00 F8 18 18 18   ................
3A00   18 18 18 18 1F 00 00 00 18 18 18 18 FF 00 00 00   ................
3A10   00 00 00 00 FF 18 18 18 18 18 18 18 1F 18 18 18   ................
3A20   00 00 00 00 FF 00 00 00 18 18 18 18 FF 18 18 18   ................
3A30   18 18 1F 18 1F 18 18 18 36 36 36 36 37 36 36 36   ........66667666
3A40   36 36 37 30 3F 00 00 00 00 00 3F 30 37 36 36 36   6670?.....?07666
3A50   36 36 F7 00 FF 00 00 00 00 00 FF 00 F7 36 36 36   66...........666
3A60   36 36 37 30 37 36 36 36 00 00 FF 00 FF 00 00 00   66707666........
3A70   36 36 F7 00 F7 36 36 36 18 18 FF 00 FF 00 00 00   66...666........
3A80   36 36 36 36 FF 00 00 00 00 00 FF 00 FF 18 18 18   6666............
3A90   00 00 00 00 FF 36 36 36 36 36 36 36 3F 00 00 00   .....6666666?...
3AA0   18 18 1F 18 1F 00 00 00 00 00 1F 18 1F 18 18 18   ................
3AB0   00 00 00 00 3F 36 36 36 36 36 36 36 FF 36 36 36   ....?6666666.666
3AC0   18 18 FF 18 FF 18 18 18 18 18 18 18 F8 00 00 00   ................
3AD0   00 00 00 00 1F 18 18 18 FF FF FF FF FF FF FF FF   ................
3AE0   00 00 00 00 FF FF FF FF F0 F0 F0 F0 F0 F0 F0 F0   ................
3AF0   0F 0F 0F 0F 0F 0F 0F 0F FF FF FF FF 00 00 00 00   ................
3B00   00 00 76 DC C8 DC 76 00 00 78 CC F8 CC F8 C0 C0   ..v...v..x......
3B10   00 FC CC C0 C0 C0 C0 00 00 FE 6C 6C 6C 6C 6C 00   ..........lllll.
3B20   FC CC 60 30 60 CC FC 00 00 00 7E D8 D8 D8 70 00   ..`0`.....~...p.
3B30   00 66 66 66 66 7C 60 C0 00 76 DC 18 18 18 18 00   .ffff|`..v......
3B40   FC 30 78 CC CC 78 30 FC 38 6C C6 FE C6 6C 38 00   .0x..x0.8l...l8.
3B50   38 6C C6 C6 6C 6C EE 00 1C 30 18 7C CC CC 78 00   8l..ll...0.|..x.
3B60   00 00 7E DB DB 7E 00 00 06 0C 7E DB DB 7E 60 C0   ..~..~....~..~`.
3B70   38 60 C0 F8 C0 60 38 00 78 CC CC CC CC CC CC 00   8`...`8.x.......
3B80   00 FC 00 FC 00 FC 00 00 30 30 FC 30 30 00 FC 00   ........00.00...
3B90   60 30 18 30 60 00 FC 00 18 30 60 30 18 00 FC 00   `0.0`....0`0....
3BA0   0E 1B 1B 18 18 18 18 18 18 18 18 18 18 D8 D8 70   ...............p
3BB0   30 30 00 FC 00 30 30 00 00 76 DC 00 76 DC 00 00   00...00..v..v...
3BC0   38 6C 6C 38 00 00 00 00 00 00 00 18 18 00 00 00   8ll8............
3BD0   00 00 00 00 18 00 00 00 0F 0C 0C 0C EC 6C 3C 1C   .............l<.
3BE0   78 6C 6C 6C 6C 00 00 00 70 18 30 60 78 00 00 00   xllll...p.0`x...
3BF0   00 00 3C 3C 3C 3C 00 00 00 00 00 00 00 00 00 00   ..<<<<..........
3C00   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3C10   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3C20   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3C30   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3C40   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3C50   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3C60   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3C70   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3C80   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3C90   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3CA0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3CB0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3CC0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3CD0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3CE0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3CF0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3D00   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3D10   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3D20   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3D30   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3D40   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3D50   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3D60   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3D70   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3D80   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3D90   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3DA0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3DB0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3DC0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3DD0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3DE0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3DF0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3E00   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3E10   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3E20   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3E30   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3E40   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3E50   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3E60   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3E70   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3E80   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3E90   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3EA0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3EB0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3EC0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3ED0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3EE0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3EF0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3F00   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3F10   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3F20   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3F30   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3F40   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3F50   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3F60   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3F70   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3F80   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3F90   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3FA0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3FB0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3FC0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3FD0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3FE0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
3FF0   FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 50   ...............P
