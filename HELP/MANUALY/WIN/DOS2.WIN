 
+-------------------------------------------------------------------------+
|                                                                         |
|                                                                         |
|                     D   O   S      -      s l u  b y                   |
|                                                                         |
|                                                                         |
+-------------------------------------------------------------------------+
                            (c) Miroslav Nìmeèek


    Sluby modulu operaèního systému DOS se vyvolávají instrukcí INT 21H, v
registru AH je pøitom uloeno èíslo poadované funkce. V dalších registrech
jsou  uloeny  parametry podle poadavkù funkce. Ovlivnìní dalších registrù
je  závislé  na provádìné operaci; obsah registru AL je znièen témìø kadou
funkcí.

Pozn.: Z  dùvodù  sluèitelnosti  se  staršími verzemi DOSu jsou moné ještì
       další dvì monosti volání slueb DOSu:

         1.- Umístit  èíslo  funkce  do  AH  a  provést  vzdálené volání na
             relativní  adresu  0050H  v prefixu programového segmentu PSP.
             Tuto metodu nelze pouít pro verze DOS niší ne 2.0.

         2.- Do  registru  CL  umístit  èíslo  funkce  a  ostatní  registry
             nastavit  podle  funkèních  specifikací. Pak se provede volání
             uvnitø  programového  segmentu  na  pamìové místo 0005H. Toto
             pamìové  místo  obsahuje  vzdálené  volání dispeèera funkce v
             DOS.  Pøi pouití této metody se vdy zruší obsah registru AX.
             Tato  metoda  je pouitelná jen pro volání funkcí 00H a 24H a
             pouívala  se u starších programù typu COM. Pro novì vytvoøené
             programy je nevhodná.

    Pokud  je  u  dané  sluby uveden pøíklad (ukázkovı program), lze tento
pøíklad  pouít  v makroassembleru MASM s tím, e ukázková èást programu se
vèlení  do jednotné struktury programu (tato struktura slouí jako pøíklad,
je  zároveò uloena jako zdrojovı soubor pro nové programy v·C:\ASSEMB\ pod
názvem SOURCE.ASM):

(Pozn.: Pøíklady  jsou  zjednodušeny  vypouštìním  instrukcí  nastavujících
        registry  pøed  kadou  funkcí, nebo zùstávají nastaveny pøedešlou
        funkcí.  Pøi  bìném  psaní  programu je však vhodné tyto instrukce
        psát  dùslednì,  nebo  se  tím sníí chybovost pøi zápisu programu
        nebo pøi jeho pozdìjší modifikaci.)


===========================================================================

COMMENT %
               poznámka - obsahuje popis programu
        %

;--------------------------------------------------------------------------
;                            Segment zásobníku
;--------------------------------------------------------------------------

stack    SEGMENT   stack

         DW        256 DUP(?)               ; zásobník

stack    ENDS

;--------------------------------------------------------------------------
;                            Programovı segment
;--------------------------------------------------------------------------

code     SEGMENT   page
         ASSUME    cs:code,ds:code,ss:stack

start:                                      ; hlavní tìlo programu
         mov       ax,SEG code              ; segment dat=segment programu
         mov       ds,ax                    ; nastavení datového segmentu

         ; ..............................................
         ;  PROGRAM - zde je umístìn program z pøíkladu
         ; ..............................................

         mov       ah,4ch                   ; ukonèení programu
         int       21h

code     ENDS

         END       start               ; startovací adresa programu

===========================================================================



    K pøekladu programu lze pouít následující pøíkazovı soubor:


IF NOT EXIST C:\ASSMEB\SOURCE\%1.ASM COPY C:\ASSEMB\SOURCE.ASM
                                                    C:\ASSMEB\SOURCE\%1.ASM
:START
C:\ASSEMB\EDITOR C:\ASSEMB\SOURCE\%1.ASM
C:\ASSEMB\MASM C:\ASSEMB\SOURCE\%1 /Z;
IF ERRORLEVEL == 1 GOTO START
C:\ASSEMB\LINK %1,C:\ASSEMB\EXEC\%1;
IF ERRORLEVEL == 1 GOTO START
DEL %1.OBJ


    Makroassembler  (MASM.EXE),  spojovací  program  (LINK.EXE) a pøíkazovı
soubor  (ASM.BAT)  jsou umístìny na disku C: v adresáøi C:\ASSEMB. Zdrojovı
text  programu  (text  v bìném ASCII formátu a s rozšíøením jména .ASM) je
uloen  v adresáøi C:\ASSEMB\SOURCE, pøeloenı program je uloen v adresáøi
C:\ASSEMB\EXEC.    Pøeklad    se    spustí   zapsáním   pøíkazového   øádku
C:\ASSEMB>ASM·jméno_programu  (bez udání rozšíøení souboru). Program EDITOR
je  editor  slouící k editaci textu programu. Pokud je vyvolán novı (ještì
neexistující)  soubor  .ASM, pouije se zdrojovı text (uvedenı vıše), kterı
je uloen v adresáøi C:\ASSEMB\ pod jménem SOURCE.ASM.



Seznam systémovıch funkcí DOS:


Funkce 00H ( 0) - pøerušení programu
Funkce 01H ( 1) - vstup znaku z klávesnice s echem
Funkce 02H ( 2) - vıstup znaku
Funkce 03H ( 3) - pomocnı vstup znaku
Funkce 04H ( 4) - pomocnı vıstup znaku
Funkce 05H ( 5) - vıstup znaku na tiskárnu
Funkce 06H ( 6) - pøímı vstup/vıstup znaku na konzolu
Funkce 07H ( 7) - øízenı vstup znaku z konzoly bez echa
Funkce 08H ( 8) - vstup znaku z konzoly bez echa
Funkce 09H ( 9) - tisk øetìzce
Funkce 0AH (10) - vstup textu do bufferu
Funkce 0BH (11) - test stavu standradního vstupu
Funkce 0CH (12) - vymazání vstupního bufferu a provedení funkce klávesnice
Funkce 0DH (13) - reset disku
Funkce 0EH (14) - vıbìr aktivního disku
Funkce 0FH (15) - otevøení souboru s pouitím FCB
Funkce 10H (16) - uzavøení souboru s pouitím FCB
Funkce 11H (17) - nalezení prvního vyhovujícího souboru s pouitím FCB
Funkce 12H (18) - nalezení dalšího vyhovujícího souboru s pouitím FCB
Funkce 13H (19) - zrušení souboru s pouitím FCB
Funkce 14H (20) - sekvenèní ètení ze souboru s pouitím FCB
Funkce 15H (21) - sekvenèní zápis do souboru s pouitím FCB
Funkce 16H (22) - vytvoøení souboru s pouitím FCB
Funkce 17H (23) - pøejmenování souboru s pouitím FCB
Funkce 18H (24) - rezervováno
Funkce 19H (25) - poskytnutí aktivního disku
Funkce 1AH (26) - nastavení adresy diskovıch pøenosù (DTA)
Funkce 1BH (27) - poskytnutí informace FAT pøihlášeného disku
Funkce 1CH (28) - poskytnutí informace FAT specifikovaného disku
Funkce 1DH (29) - rezervováno
Funkce 1EH (30) - rezervováno
Funkce 1FH (31) - rezervováno
Funkce 20H (32) - rezervováno
Funkce 21H (33) - ètení s pøímım pøístupem s pouitím FCB
Funkce 22H (34) - zápis s pøímım pøístupem s pouitím FCB
Funkce 23H (35) - poskytnutí velikosti souboru s pouitím FCB
Funkce 24H (36) - nastavení poloky relativního záznamu s pouitím FCB
Funkce 25H (37) - nastavení vektoru pøerušení
Funkce 26H (38) - vytvoøení programového segmentu
Funkce 27H (39) - ètení bloku s pøímım pøístupem s pouitím FCB
Funkce 28H (40) - zápis bloku s pøímım pøístupem s pouitím FCB
Funkce 29H (41) - rozbor jména souboru
Funkce 2AH (42) - poskytnutí systémového data
Funkce 2BH (43) - nastavení systémového data
Funkce 2CH (44) - poskytnutí systémového èasu
Funkce 2DH (45) - nastavení systémového èasu
Funkce 2EH (46) - nastavení nebo resetování pøepínaèe VERIFY
Funkce 2FH (47) - poskytnutí adresy diskovıch pøenosù (DTA)
Funkce 30H (48) - poskytnutí èísla verze DOS
Funkce 31H (49) - pøerušení a ponechání rezidentním
Funkce 32H (50) - rezervováno
Funkce 33H (51) - poskytnutí nebo nastavení statutu BREAK
Funkce 34H (52) - rezervováno
Funkce 35H (53) - poskytnutí vektoru pøerušení
Funkce 36H (54) - poskytnutí volného místa disku
Funkce 37H (55) - rezervováno
Funkce 38H (56) - poskytnutí nebo nastavení národnostnì závislıch informací
Funkce 39H (57) - vytvoøení adresáøe (MKDIR)
Funkce 3AH (58) - zrušení adresáøe (RMDIR)
Funkce 3BH (59) - zmìna adresáøe (CHDIR)
Funkce 3CH (60) - vytvoøení souboru (CREAT)
Funkce 3DH (61) - otevøení souboru
Funkce 3EH (62) - uzavøení identifikátoru souboru
Funkce 3FH (63) - ètení ze souboru nebo zaøízení s pouitím identif. soub.
Funkce 40H (64) - zápis do souboru nebo zaøízení s pouitím identif. soub.
Funkce 41H (65) - zrušení souboru (UNLINK)
Funkce 42H (66) - pøemístìní ukazatele souboru (LSEEK)
Funkce 43H (67) - poskytnutí nebo nastavení atributù souboru (CHMOD)
Funkce 44H (68) - vstupnì/vıstupní ovládání zaøízení (IOCTL)
Funkce 4400H (68- 0) - IOCTL: poskytnutí informací o zaøízení
Funkce 4401H (68- 1) - IOCTL: nastavení informací o zaøízení
Funkce 4402H (68- 2) - IOCTL: ètení ze znakového zaøízení
Funkce 4403H (68- 3) - IOCTL: zápis na znakové zaøízení
Funkce 4404H (68- 4) - IOCTL: ètení z blokového zaøízení
Funkce 4405H (68- 5) - IOCTL: zápis na blokové zaøízení
Funkce 4406H (68- 6) - IOCTL: poskytnutí vstupního statutu
Funkce 4407H (68- 7) - IOCTL: poskytnutí vıstupního statutu
Funkce 4408H (68- 8) - IOCTL: je zaøízení vımìnné ?               > DOS 3.0
Funkce 4409H (68- 9) - IOCTL: je logické zaøízení dálkové ?       > DOS 3.1
Funkce 440AH (68-10) - IOCTL: je identif. dálkového zaøízení ?    > DOS 3.1
Funkce 440BH (68-11) - IOCTL: zmìna èítaèe opakování pro sdílení  > DOS 3.0
Funkce 440DH (68-13) - IOCTL: generování poadavku IOCTL          > DOS 3.2
Funkce 440EH (68-14) - IOCTL: poskytnutí logického disku          > DOS 3.2
Funkce 440FH (68-15) - IOCTL: nastavení logického disku           > DOS 3.2
Funkce 45H (69) - zdvojení identifikátoru souboru (DUP)
Funkce 46H (70) - nucené zdvojení identifikátoru souboru (FORCDUP)
Funkce 47H (71) - poskytnutí aktivního adresáøe
Funkce 48H (72) - pøidìlení pamìti
Funkce 49H (73) - uvolnìní pøidìlené pamìti
Funkce 4AH (74) - modifikace pøidìlené pamìti (SETBLOCK)
Funkce 4BH (75) - naètení nebo provedení programu (EXEC)
Funkce 4CH (76) - ukonèení procesu (EXIT)
Funkce 4DH (77) - poskytnutí návratového kódu podprocesu (WAIT)
Funkce 4EH (78) - nalezení prvního vyhovujícího souboru (FIND FIRST)
Funkce 4FH (79) - nalezení dalšího vyhovujícího souboru (FIND NEXT)
Funkce 50H (80) - rezervováno
Funkce 51H (81) - rezervováno
Funkce 52H (82) - rezervováno
Funkce 53H (83) - rezervováno
Funkce 54H (84) - poskytnutí informace o nastavení VERIFY
Funkce 55H (85) - rezervováno
Funkce 56H (86) - pøejmenování souboru
Funkce 57H (87) - poskytnutí nebo nastavení data a èasu souboru
Funkce 59H (89) - poskytnutí rozšiøujících chybovıch informací    > DOS 3.0
Funkce 5AH (90) - vytvoøení jedineèného souboru                   > DOS 3.0
Funkce 5BH (91) - vytvoøení nového souboru                        > DOS 3.0
Funkce 5CH (92) - zamknutí/odemknutí pøístupu k souboru           > DOS 3.0
Funkce 5DH (93) - rezervováno
Funkce 5E00H (94-0) - poskytnutí jména zaøízení                   > DOS 3.1
Funkce 5E02H (94-2) - nastavení inicializaèního øetìzce tiskárny  > DOS 3.1
Funkce 5E03H (94-3) - poskytnutí inicializaèního øetìzce tiskárny > DOS 3.1
Funkce 5F02H (95-2) - poskytnutí poloky vıpisu pøesmìrování      > DOS 3.1
Funkce 5F03H (95-3) - pøesmìrování zaøízení                       > DOS 3.1
Funkce 5F04H (95-4) - zrušení pøesmìrování                        > DOS 3.1
Funkce 60H (96) - rezervováno
Funkce 61H (97) - rezervováno
Funkce 62H (98) - poskytnutí adresy prefixu program. segmentu     > DOS 3.0




Rozdìlení funkcí do oblastí:

Systémové informace:

38H - èíslo verze operaèního systému DOS
2AH - systémové datum
2CH - systémovı èas
19H - aktivní disk
47H - aktivní adresáø
38H - národnostnì závislé informace

2FH - souèasná adresa diskovıch pøenosù DTA
62H - souèasná adresa prefixu programového segmentu PSP
35H - ètení hodnoty vektoru pøerušení
4DH - kód ukonèení procesu
59H - rozšiøující chybové informace
44H - ovládání I/O zaøízení (statut zaøízení/souborù)

54H - nastavení pøepínaèe módu VERIFY
33H - nastavení pøepínaèe kontroly Ctrl-Break

37H - nastavení pøepínaèe znakù (QUERY)
34H - adresa statutu pozadí DOS

36H, 1BH, 1CH - velikost disku, volné bajty
32H - podpùrné informace o disku

57H - èas/datum souboru

4EH, 4FH, 11H, 12H - hledání souboru



Znakové vstupy/vıstupy:

01H, 3FH (BX=0) - vstup z klávesnice
08H - vstup z klávesnice (bez echa)
07H - nefiltrovanı vstup z klávesnice (bez echa)
0BH - poskytnutí vstupního statutu
0CH - vymazání vyrovnávací pamìti klávesnice a vstup znaku z klávesnice
0AH, 3FH (BX=0) - vstup øetìzce znakù z klávesnice
06H - vstup a vıstup na konzolu

02H, 40H (BX=1,2) - zobrazení jednoho znaku
09H, 40H (BX=1,2) - zobrazení øetìzce znakù

03H, 3FH (BX=3) - vstup z pøídavného zaøízení (sériovı port)
04H, 40H (BX=3) - vıstup na pøídavné zaøízení (sériovı port)

05H, 40H (BX=4) - vıstup na tiskárnu
INT 2FH - pøepínatelné funkce


Vstupnì/vıstupní operace s pouitím FCB:

(lze vyuít pouze aktivní adresáø)

29H - rozbor popisu souboru v textovém tvaru na tvar FCB
11H, 12H - prohledávání aktivního adresáøe

16H - vytvoøení souboru
0FH - otevøení souboru
10H - uzavøení souboru
13H - zrušení souboru

14H - sekvenèní ètení ze souboru
15H - sekvenèní zápis do souboru

21H - ètení záznamu s pøímım pøístupem
27H - vícenásobné ètení záznamu s pøímım pøístupem
22H - zápis záznamu s pøímım pøístupem
28H - vícenásobnı zápis záznamu s pøímım pøístupem
24H - nastavení poloky FCB relativní záznam


Vstupnì/vıstupní operace s pouitím identifikátoru souboru:

3CH - vytvoøení souboru
5BH - vytvoøení nového souboru (nesmí existovat)
5AH - vytvoøení jedineèného/doèasného souboru

3DH - otevøení souboru
3EH - uzavøení souboru
41H - zrušení souboru

42H - nastavení ukazatele pro ètení/zápis
3FH - ètení ze souboru/zaøízení
40H - zápis do souboru/zaøízení
44H - øízení  vstupnì/vıstupních  zaøízení  IOCTL  (lze  pouít k testování
      konce souboru

45H - duplikování identifikátoru souboru
46H - pøesmìrování I/O identifikátoru souboru


Práce s adresáøi a se soubory:

39H - vytvoøení nového adresáøe
3AH - zrušení adresáøe
3BH - nastavení nového aktivního adresáøe
47H - poskytnutí aktivního adresáøe

0EH - nastavení aktivního disku
19H - poskytnutí aktivního disku

56H, 17H - pøejmenování souboru
57H - nastavení/informace o èasu a data souboru
42H, 23H - informace o velikosti souboru
28H - nastavení velikosti souboru (s pouitím funkce 42H)
43H - zmìna/poskytnutí atributù souboru

5CH - zamèení/odemknutí pøístupu k souboru

4EH, 4FH - hledání souboru podle jména ASCIIZ
11H, 12H - hledání souboru v adresáøi podle FCB

29H - rozklad textu (jména souboru) do poloky FCB


Øízení procesù:

4BH - vykonání synovského procesu
26H - vytvoøení prefixu programového segmentu (PSP)
62H - poskytnutí adresy prefixu programového segmentu (PSP) procesu

31H, INT 27H - ukonèení programu s jeho uchováním v pamìti

00H, INT 20H - tradièní ukonèení programu (kompatibilní)

4CH - ukonèení programu a pøedání vıstupního kódu otcovskému procesu
4DH - poskytnutí vıstupního kódu ukonèeného procesu

INT 23H - pøerušení pomocí kláves <Ctrl>-<Break> (<Ctrl>-C)
INT 24H - pøerušení pøi kritické chybì


Funkce pro ovládání pamìti:

48H - pøidìlení bloku pamìti procesu (nebo urèení nejvìtšího bloku pamìti)
49H - uvolnìní pøidìlenıch blokù pamìti
4AH - zvìtšení/zmìnšení blokù pamìti

INT 12H - navrácení celkové pamìti systému


Doplòující funkce:

1AH - nastavení adresy diskovıch pøenosù DTA
25H - nastavení vektoru pøerušení
0EH - nastavení aktivního disku DOS

5CH - zamèení/odemknutí pøístupu k souborùm
5EH - doplòující funkce pro práci v síti
5FH - pøesmìrování síového zaøízení

0DH - reset disku (vyprázdnìní vyrovnávací pamìti)
29H - rozklad textu na jména souboru v FCB

2BH - nastavení systémového data
2DH - nastavení systémového èasu
57H - poskytnutí èasu/data souboru

2EH - nastavení statutu verifikace
37H - pøepínání znakù QUERY

38H - nastavení aktivní zemì

44H - komunikaèní kanály k ovládání zaøízení





 F u n k c e   0 0 H  ( 0 )  - pøerušení programu

    vstup:    AH = 00H
              CS = adresa segmentu prefixu programového segmentu PSP

    vıstup:   ádnı

    Funkce ukonèuje program a navrací øízení do DOS.

    DOS  pøeruší program, vyprázdní buffery souborù, navrátí obsahy vektorù
INT  22H,  INT  23H  a  INT  24H  z prefixu programového segmentu PSP - tj.
vıstupní  adresy  (vektory)  pro  ukonèení (adr. 0AH), <Ctrl>-<Break> (adr.
0EH)  a kritické chyby (adr. 12H) a pøedá øízení na adresu vektoru ukonèení
programu v PSP (návrat do otcovského procesu).

    Pøed  vyvoláním  sluby  nejdøíve  uzavøete  všechny  soubory. Potom se
pøesvìdète, zda CS obsahuje adresu segmentu PSP.

Pozn.: Tato  funkce  je  volána  pomocí pøerušení INT 20H a pracuje stejnım
       zpùsobem.  Sluba  je  historickım pozùstatkem nemající ádné vıhody
       oproti   funkci  4CH  (ukonèení  programu)  a  zùstává  pouze  kvùli
       sluèitelnosti  se  staršími programy. Proto pouívejte radìji funkci
       4CH, která umoòuje navrátit chybovı kód pouitelnı jinım programem.




 F u n k c e   0 1 H  ( 1 )  - vstup znaku z klávesnice s echem

    vstup:    AH = 01H

    vıstup:   AL = pøeètenı znak ze standardního vstupu

    Funkce ète znak ze standardního vstupního zaøízení (obvykle klávesnice)
a  provede  té  jeho echo (tj. kopírování znaku i na vıstup) na standardní
vıstupní zaøízení (obvykle obrazovka). Funkce èeká na pøíchod znaku

    Pokud je stisknuta klávesa se speciální funkcí (napø. kurzorové klávesy
a  pod.),  navrátí funkce v AL nejdøíve kód 00H; opìtnım voláním funkce lze
pøeèíst orientaèní kód klávesy (viz tabulka kódù kláves).

    Pøi  duplikování  znaku na displej se provádìjí øídící kódy BEL (07H) =
pípnutí, BS (08H) = krok kurzoru zpìt a vymazání posledního znaku, HT (09H)
=  tabelátor,  LF  (0AH) = pøesun na následující øádek, FF (0CH) = vymazání
obrazovky, CR (0DH) = pøechod na zaèátek øádku a pøi nainstalovaném driveru
obrazovky ANSI.SYS té ESC (1BH) = speciální øídící funkce.

    Kombinace  kláves  <Ctrl>-<Break>  nebo  <Ctrl>-C  vygeneruje pøerušení
INT·23H (uivatelské pøerušení).




 F u n k c e   0 2 H  ( 2 )  - vıstup znaku

    vstup:    AH = 02H
              DL = znak k vıstupu

    vıstup:   ádnı

    Funkce vyšle znak uloenı v registru DL na standardní vıstupní zaøízení
(obvykle obrazovka).

Pozn.: Pokud  je  stisknuta  kombinace kláves <Ctrl>-<Break> nebo <Ctrl>-C,
       provede  funkce  pøerušení  INT  23H.  Test  kláves se provádí a po
       zobrazení znaku.

       Pøi  vıstupu  znaku se provádìjí øídící kódy BEL (07H) = pípnutí, BS
       (08H)  =  krok  kurzoru zpìt a vymazání posledního znaku, HT (09H) =
       tabelátor,  LF  (0AH)  =  pøesun  na  následující  øádek, FF (0CH) =
       vymazání  obrazovky,  CR  (0DH)  =  pøechod  na  zaèátek øádku a pøi
       nainstalovaném  driveru obrazovky ANSI.SYS té ESC (1BH) = speciální
       øídící funkce.

       Vıstup zadaného øetìzce textu - viz funkce 09H.

Pøíklad: Následující program pøevede malá písmena na velká a zobrazí je.

         cyklus:   mov       ah,8           ; funkce vstupu znaku z kláv.
                   int       21h            ; vstup znaku z klávesnice
                   cmp       al,27          ; klávesa <Esc>
                   jz        konec          ; ukonèení programu
                   cmp       al,"a"         ; je menší ne "a" ?
                   jl        neprev         ; je menší - nepøevádìt
                   cmp       al,"z"         ; je vìtší ne "z" ?
                   jg        neprev         ; je vìtší ne "z" - nepøevádìt
                   sub       al,20h         ; pøevod malého písm. na velké
         neprev:   mov       ah,2           ; funkce vıstupu na displej
                   mov       dl,al          ; znak k vıstupu na displej
                   int       21h            ; vıstup znaku na displej
                   jmp       cyklus         ; další znak
         konec:                             ; následuje ukonèení programu



 F u n k c e   0 3 H  ( 3 )  - vstup znaku z pøídavného zaøízení

    vstup:    AH = 03H

    vıstup:   AL = pøeètenı znak z pøídavného zaøízení

    Funkce  ète  znak  (èeká  na  jeho  pøíchod) ze standardního pøídavného
zaøízení  AUX.  Standardním  pøídavnım zaøízením (oznaèení AUX) je normálnì
první  sériovı  port  COM1.  Vstup  nepouívá vyrovnávací pamì, není øízen
pøerušením  a  probíhá  formou  èekání  na  pøíchod  znaku.  Pøi zpracování
pøicházejících   znakù   je   proto   nutné,  aby  aplikaèní  program  mezi
jednotlivımi  vstupy  neprovádìl  prodlevy,  nebo by mohlo dojít ke ztrátì
dat.  Mìl by si zajistit vhodnou formou komunikaèního protokolu, aby mu byl
vysílán  pouze  urèitı poèet bajtù, které si nejdøíve ukládá do vyrovnávací
pamìti  a  a  pøijde  pøesnì  definovanı  poèet  bajtù, provede zpracování
pøijatıch  dat  a vyzve protìjší zaøízení k vyslání dalšího balíku dat.

    Pøi  startu systému inicializuje DOS první sériovı port COM1 na hodnotu
2400  baud,  8·datovıch  bitù,  jeden  stop bit, ádná parita. Povelem MODE
(externí pøíkaz operaèního systému) lze tyto hodnoty mìnit.

Pozn.: Pokud  je  detekována  kombinace  kláves  <Ctrl>-<Break> (<Ctrl>-C),
       potom je vygenerováno pøerušení INT 23H.

       Vstup  znaku  není  ukládán  do bufferu a není øízen pøes pøerušení;
       pokud váš program není schopen èíst znaky plnou rychlostí, mohou bıt
       data ztracena.

       Funkce  neumoòuje  monitorování  stavu  komunikaèního portu (zda je
       pøipraven  pøijatı  znak).  Pro  vìtší  kontrolu nad portem pouijte
       pøerušení  INT 14H ROM-BIOSu. Viz té popis adaptéru sériovıch portù
       a pøerušení INT 0CH a INT 0BH.



 F u n k c e   0 4 H  ( 4 )  - vıstup znaku na pøídavné zaøízení

    vstup:    AH = 04H
              DL = znak k vıstupu na pøídavné zaøízení

    vıstup:   ádnı

    Tato  funkce  umoòuje  vıstup  znaku, jeho ASCII hodnota je uloena v
registru DL, na standardní pøídavné zaøízení AUX. Pøitom èeká, a je vyslán
pøedcházející  znak  (tj. a je vyprázdnìn vysílací buffer a a je protìjší
zaøízení pøipraveno pøijmout znak).

    Standardním  pøídavnım  zaøízením  (oznaèení  AUX)  je  normálnì  první
sériovı   port   COM1.  Vıstup  nepouívá  vyrovnávací  pamì,  není  øízen
pøerušením  a  probíhá  formou èekání na vyslání pøedcházejícího znaku. Zda
bude  aplikaèní program ponechávat mezi jednotlivımi vyslanımi znaky mezery
vzniklé  jinımi èinnostmi programu, je vìcí aplikaèního programu a má pouze
vliv  na  zpomalení  pøenosu.  Pouze  pøi  synchronním reimu provozu by se
nemìly objevovat meziznakové mezery.

    Pøi  startu systému inicializuje DOS první sériovı port COM1 na hodnotu
2400  baud,  8·datovıch  bitù,  jeden  stop bit, ádná parita. Povelem MODE
(externí pøíkaz operaèního systému) lze tyto hodnoty mìnit.

Pozn.: Pokud  je  detekována  kombinace  kláves  <Ctrl>-<Break> (<Ctrl>-C),
       potom je vygenerováno pøerušení INT 23H.

       Funkce  neumoòuje  monitorování  stavu komunikaèního portu (zda byl
       vyslán  pøedcházející  znak). Pro vìtší kontrolu nad portem pouijte
       pøerušení  INT 14H ROM-BIOSu. Viz té popis adaptéru sériovıch portù
       a pøerušení INT 0CH a INT 0BH.




 F u n k c e   0 5 H  ( 5 )  - vıstup znaku na tiskárnu

    vstup:    AH = 05H
              DL = znak k vıstupu na tiskárnu

    vıstup:   ádnı

    Funkce  vyšle  znak,  jeho  ASCII hodnota je uloena v registru DL, na
standardní  tiskové  zaøízení  PRN, kterım je normálnì první paralelní port
tiskárny (LPT1).

Pozn.: Pokud  je  zaøízení  (tiskárna)  zaneprázdnìno,  funkce  èeká  a je
       pøipraveno pøijmout znak.

       Povel   operaèního  systému  MODE  umoòuje  pøesmìrovat  standardní
       tiskovı vıstup PRN na sériovı port.

       Pokud  je  detekována  kombinace  kláves  <Ctrl>-<Break> (<Ctrl>-C),
       potom je vygenerováno pøerušení INT 23H.

Pøíklad: Následující program tiskne na tiskárnu øádky ASCII znakù.

                   mov       bl,32          ; poèáteèní znak k tisku
                   mov       ah,5           ; funkce pro tisk znaku
         radek:    mov       cx,80          ; poèet znakù na øádek
                   mov       dl,bl          ; znak k tisku
         znak:     int       21h            ; tisk znaku na tiskárnu
                   inc       dl             ; zvıšení znaku
                   loop      znak           ; další znak na øádku k tisku
                   mov       dl,13          ; znak CR
                   int       21h            ; tisk znaku CR
                   mov       dl,10          ; znak LF
                   int       21h            ; tisk znaku LF
                   inc       bl             ; zvıšení znaku pro další øádek
                   cmp       bl,128-80      ; je ji zakázanı znak ?
                   jl        radek          ; tisk dalšího øádku
                                            ; konec programu



 F u n k c e   0 6 H  ( 6 )  - pøímı vstup/vıstup znaku na konzolu

    vstup:    AH = 06H
              DL = FFH            - vstup znaku z klávesnice (neèeká)
                   jiná hodnota   - znak k vıstupu na displej

    vıstup:   AL = znak z klávesnice (pokud je vstup z klávesnice DL=FFH)
              ZF = (ovlivnìn, pokud je vstup z klávesnice - tj. DL=FFH)
                   0 (NZ) - pøijat znak z klávesnice (AL = znak)
                   1 (ZR) - není pøipraven znak z kávesnice (AL = 0)

    Pokud  je  v  registru  DL  uloena  hodnota  FFH, je provádìn vstup ze
standardního  vstupního  zaøízení  (obvykle  klávesnice), neèeká na pøíchod
znaku.  Funkce  testuje, zda je pøipraven znak ze vstupního zaøízení. Pokud
ano,  je  znak  uloen do registru AL a je vynulován pøíznak nuly ZF. Pokud
není  pøipraven znak, je pøíznak ZF nastaven a obsah registru AL je nulovı.
Pøi vstupu znaku není provádìno echo na vıstupní zaøízení (displej).

    Pokud  je v registru DL uloena jiná hodnota ne FFH, je obsah registru
povaován  za  znak,  kterı  má  bıt vyslán na standardní vıstupní zaøízení
(displej).

    Pokud  je  pøi vstupu znaku navrácena v registru AL nula (a pokud je to
platnı  znak,  tj.  pøíznak ZF je vynulován - tj. platí podmínka NZ), jde o
zvláštní  øídící  znak  (napø.  funkèní  nebo  kurzorová  klávesa).  Druhım
vyvoláním   této  funkce  je  navrácena  druhá  èást  speciálního  znaku  -
orientaèní kód klávesy (viz tabulku kódù kláves).

    Funkce neprovádí detekci kombinace kláves <Ctrl>-<Break> (<Ctrl>-C).

    Pøi  vıstupu  znaku  se  provádìjí  øídící kódy BEL (07H) = pípnutí, BS
(08H)  =  krok  kurzoru  zpìt  a  vymazání  posledního  znaku,  HT  (09H) =
tabelátor,  LF  (0AH)  =  pøesun  na následující øádek, FF (0CH) = vymazání
obrazovky, CR (0DH) = pøechod na zaèátek øádku a pøi nainstalovaném driveru
obrazovky ANSI.SYS té ESC (1BH) = speciální øídící funkce.

Pøíklad: Následující pøíklad vypisuje na obrazovce kódy kláves v HEX tvaru.
         Pokud  je  stisknuta  speciální klávesa (generuje první bajt = 0),
         zobrazí  se  nejdøíve  znak  "*" a potom její orientaèní kód v HEX
         tvaru. Ukonèení programu je moné pomocí klávesy <Esc>.

         cyklus:  mov       ah,6            ; funkce vstupu znaku z konzoly
                  mov       dl,0ffh
                  int       21h             ; vstup znaku z konzoly
                  jz        cyklus          ; nebyl zadán ádnı znak (èeká)
                  test      al,al           ; test - je AL = 0 ?
                  jnz       cykl2           ; AL není = 0
                  mov       dl,'*'          ; oznaèení rozšíøeného kódu
                  jmp       short cykl3     ; tisk prefixu "*"
         cykl2:   cmp       al,27           ; je znak <Esc> ?
                  jz        konec           ; konec programu
                  call      bajt            ; tisk bajtu v AL v HEX tvaru
                  mov       dl,13           ; znak CR
                  int       21h             ; tisk znaku CR
                  mov       dl,10           ; znak LF
         cykl3:   int       21h             ; tisk znaku LF
                  jmp       short cyklus
                                            ; podprogram tisku bajtu HEX
         bajt:    push      ax              ; znak k vıstupu
                  ror       al,1            ; rotace AL o 4 bity vpravo
                  ror       al,1
                  ror       al,1
                  ror       al,1
                  call      hex             ; tisk znaku HEX
                  pop       ax              ; návrat znaku k tisku
         hex:     and       al,0fh          ; niší tetráda znaku
                  add       al,90h          ; pøevod na znak HEX
                  daa
                  adc       al,40h
                  daa
                  mov       ah,6            ; funkce pro vıstup znaku
                  mov       dl,al           ; znak k vıstupu na konzolu
                  int       21h             ; vıstup znaku na konzolu
                  ret
         konec:                             ; konec programu




 F u n k c e   0 7 H  ( 7 )  - øízenı vstup znaku z konzoly bez echa

    vstup:    AH = 07H

    vıstup:   AL = znak ze standardního vstupního zaøízení

    Funkce  èeká  na  pøíchod  znaku  se  standardního  vstupního  zaøízení
(obvykle   konzola).   Neprovádí   echo   a   nekontroluje   zadání  kláves
<Ctrl>-<Break>  (<Ctrl>-C)  -  pøi  zadání  kombinace kláves <Ctrl>-<Break>
(<Ctrl>-C) navrátí hodnotu kódu 03H.

    Pokud  je pøi vstupu znaku navrácena v registru AL nula, jde o zvláštní
øídící  znak  (napø. funkèní nebo kurzorová klávesa). Druhım vyvoláním této
funkce  je  navrácena druhá èást speciálního znaku - orientaèní kód klávesy
(viz tabulku kódù kláves).

    Pouijte funkci DOS 0BH k testování vstupního statutu.



 F u n k c e   0 8 H  ( 8 )  - vstup znaku z konzoly bez echa

    vstup:    AH = 08H

    vıstup:   AL = znak z konzoly

    Funkce  èeká  na  pøíchod  znaku  se  standardního  vstupního  zaøízení
(obvykle   konzola).   Neprovádí   echo,   kontroluje  však  zadání  kláves
<Ctrl>-<Break> (<Ctrl>-C).

    Pokud  je pøi vstupu znaku navrácena v registru AL nula, jde o zvláštní
øídící  znak  (napø. funkèní nebo kurzorová klávesa). Druhım vyvoláním této
funkce  je  navrácena druhá èást speciálního znaku - orientaèní kód klávesy
(viz tabulku kódù kláves).

Pozn.: Jedinı  rozdíl mezi touto funkcí a funkcí 07H je ten, e tato funkce
       provádí  kontrolu zadání kombinace kláves <Ctrl>-<Break> (<Ctrl>-C),
       pøi detekci této kombinace kláves provede pøerušení INT 23H.




 F u n k c e   0 9 H  ( 9 )  - tisk øetìzce

    vstup:    AH = 09H
              DS:DX = ukazatel na textovı øetìzec ukonèenı znakem $

    vıstup:   ádnı

    Funkce  vyšle  zadanı  øetìzec  znakù  na standardní vıstupní zaøízení.
Øetìzec  musí  bıt  ukonèen  znakem  $ (symbol dolaru). Tento znak není ji
zobrazen.  Funkce  není  tedy  vhodná pro zobrazení øetìzcù, které obsahují
symbol  dolaru  $,  všechny ostatní znaky, vèetnì øídících, jsou zobrazeny.
K·vıstupu  textu  vèetnì  znaku  dolaru  $  mùete  pouít  funkci  DOS 40H
(s·identifikátorem souboru BX=0), která umoòuje vıstup textu zadané délky.

    Pøi  vıstupu  znaku  se  provádìjí  øídící kódy BEL (07H) = pípnutí, BS
(08H)  =  krok  kurzoru  zpìt  a  vymazání  posledního  znaku,  HT  (09H) =
tabelátor,  LF  (0AH)  =  pøesun  na následující øádek, FF (0CH) = vymazání
obrazovky, CR (0DH) = pøechod na zaèátek øádku a pøi nainstalovaném driveru
obrazovky ANSI.SYS té ESC (1BH) = speciální øídící funkce. Normální zpùsob
odøádkování  textu  (tj. pøechod na novı øádek) je vyslání dvojice øídících
kódù CR (0DH) a LF (0AH).

    Funkce   provádí   kontrolu   zadání  kombinace  kláves  <Ctrl>-<Break>
(<Ctrl>-C), pøi detekci této kombinace kláves provede pøerušení INT 23H.

Pøíklad: Tento pøíklad vytiskne na obrazovce jednoduchı obrazec.

                   mov       dx,offset text ; text k tisku
                   mov       cx,10          ; poèet øádkù k tisku
                   mov       ah,9           ; funkce tisku øetìzce
         cyklus:   int       21h            ; tisk øetìzce od adresy DS:DX
                   inc       dx             ; zvıšení ukazatele øetìzce
                   loop      cyklus         ; další øádek k tisku
                   mov       ah,4ch         ; ukonèení programu
                   int       21h

         text      db        '0123456789',13,10,'$'   ; tisknutı øetìzec




 F u n k c e   0 A H  ( 1 0 ) - vstup textu ze vstupního zaøízení

    vstup:    AH = 0AH
              DS:DX = ukazatel  na  vstupní  vyrovnávací pamì

    vıstup:   ádnı (návrat informací ve vstupním bufferu)
              (navráceno AL = ukonèovací znak 0DH)

    Funkce  ète  øetìzec  znakù  ze  standardního  vstupního zaøízení a po
zadání  klávesy  <Enter>  (znak  s kódem 0DH = 13) nebo po zaplnìní vstupní
vorovnávací  pamìti  (tj.  je zadán poèet znakù MAX-1, kde MAX je maximální
poèet  znakù  nastavenı  v  prvním  bajtu vyrovnávací pamìti). Pøi zadávání
znakù  ze  vstupního  zaøízení  (klávesnice) provádí echo znakù na vıstupní
zaøízení  (displej).  Znaky  (vèetnì ukonèovacího znaku <Enter> = 0DH) jsou
ukládány do bufferu DS:DX poèínaje offsetem 02H (tøetí bajt).

    Struktura vstupního bufferu textu:

         offset 00H (1.bajt): (hodnota  1  a 254) maximální poèet znakù ve
                              vyrovnávací  pamìti  vèetnì  znaku CR (0DH) -
                              tuto  hodnotu  musí  uivatel  nastavit  pøed
                              vyvoláním funkce.
         offset 01H (2.bajt): skuteènı  poèet zadanıch znakù textu bez CR -
                              tato hodnota je nastavena funkcí
         offset 02H (3.bajt): vyrovnávací   pamì;  musí  bıt  alespoò  tak
                              dlouhá, jak udává 1.bajt.

    Maximální  poèet  zadanıch znakù je omezen velikostí vstupního bufferu,
která  je  udána  prvním  bajtem vstupního bufferu DS:DX (max. 255 zadanıch
znakù vèetnì CR). Tuto hodnotu nastavuje uivatel pøed vyvoláním funkce.

    Pøi návratu je v bufferu DS:DX na offsetu 1 (tj. druhı bajt vyrovnávací
pamìti)  navrácen  poèet  platnıch znakù, které byly zaznamenány do bufferu
(bez koncového znaku CR - 0DH). Text je vdy ukonèen znakem CR

    Funkce   provádí   kontrolu   zadání  kombinace  kláves  <Ctrl>-<Break>
(<Ctrl>-C), pøi detekci této kombinace provede pøerušení INT 23H.

Pozn.: Bìjem  zadávání  textu  pomocí  této  funkce  jsou aktivní editovací
       povely  DOS.  Znaky  obsaené  v  bufferu  (vèetnì bajtu délky) pøed
       voláním   funkce  jsou  pouity  jako  doèasné  a  povely  DOS  mají
       následující  úèinek: Klávesa <Esc> zobrazí znak \ a obnovuje editaci
       (navrátí  ji  do pùvodního stavu), <F3> zobrazí celı doèasnì uloenı
       text  a  po  konec, <F5> zobrazí znak @ a uloí souèasnı øádek jako
       doèasnı  (tj.  lze  jej editovat), klávesy <-- a --> ruší a obnovují
       znak z doèasného textu atd.

       Pokud  se  buffer  naplní  do kapacity bez jednoho bajtu, DOS odmítá
       všechny  zadávané  znaky  kromì  ukonèovací  klávesy  <Enter> (resp.
       nìkterıch povelù editoru), ozıvá se zvukovı signál chyby.



 F u n k c e   0 B H  ( 1 1 ) - test stavu standardního vstupu

    vstup:    AH = 0BH

    vıstup:   AL = FFH  - je pøipraven znak ze vstupního zaøízení
                   00H  - není pøipraven znak ze vstupního zaøízení

    Funkce  kontroluje,  zda  je  pøipraven  znak ze standardního vstupního
zaøízení  (konzoly).  Mùe bıt pouita ke kontrole pøipravenosti znaku pøed
vstupem znaku z konzoly, kterı èeká na zadání znaku (funkce 01H, 07H, 08H).

    Funkce   provádí   kontrolu   zadání  kombinace  kláves  <Ctrl>-<Break>
(<Ctrl>-C),  pøi  detekci  této  kombinace  provede pøerušení INT 23H. Tato
funkce   je  nejvhodnìjší  metodou  k  testování  zadání  kombinace  kláves
<Ctrl>-<Break>  (<Ctrl>-C)  pøi  dlouhıch vıpoètech programu které normálnì
neprovádìjí ádné vstupnì/vıstupní operace, nebo nemá ádné další vedlejší
úèinky.




 F u n k c e   0 C H  ( 1 2 ) - vymazání vstup. bufferu a provedení funkce

    vstup:    AH = 0CH
              AL = funkce, která se má provést (01H, 06H, 07H, 08H, 0AH)
                   jakákoliv jiná hodnota - neprovádí se další zpracování

    vıstup:   AL = zadanı znak (pokud vztaná funkce nebyla 0AH)
                 = 0, pokud nebyla v AL ádná funkce klávesnice

    Funkce  vymae všechny znaky ze vstupní vyrovnávací pamìti znakù, potom
provede specifikovanou funkci vstupu (èíslo funkce v registru AL). Pouijte
tuto  funkci  pokud  si  chcete  bıt  jisti,  e program pøijme novı znak z
klávesnice ani by pouil znaky zadané bìhem døívìjších operací. Obvykle se
tato  funkce  pouívá  napø. pøi ohlášení chybového stavu a èekání na další
volby uivatele.

Pozn.: Pøi  zadání  funkce  06H  nemusí provádìt funkce pouze vstup znaku z
       klávesnice,  ale  mùe  provést  i vıstup znaku na vıstupní zaøízení
       (viz detaily funkce 06H).

       Pokud  chcete  vynulovat  vstupní  buffer  bez  provedení  jakékoliv
       operace (bez ètení znaku), zadejte funkci AL = 06H a DL = 0FFH (test
       pøipravenosti znaku z klávesnice).




 F u n k c e   0 D H  ( 1 3 ) - reset disku

    vstup:    AH = 0DH

    vıstup:   ádnı

    Funkce  vyprázdní  všechny  vyrovnávací  pamìti  souborù,  soubory však
neuzavírá.  Zapisuje  modifikované  vyrovnávací  pamìti  na  disk  a oznaèí
všechny  vnitøní  vyrovnávací  pamìti  jako volné. K zajištìní uloení zmìn
poloky  souboru  v adresáøi pouijte pøed vyvoláním této funkce nìkterou z
funkcí  pro  uzavøení souboru (10H nebo 3EH). Funkce se nemusí vyvolat pøed
vımìnou  disku,  jestlie  všechny  soubory,  v  nich došlo ke zmìnì, byly
uzavøeny. Obvykle se tato funkce pouívá k zajištìní známého stavu systému.
Tuto funkci by mìly volat programy obsluhující <Ctrl>-<Break>.




 F u n k c e   0 E H  ( 1 4 ) - vıbìr aktivního disku

    vstup:    AH = 0EH
              DL = èíslo aktivního disku (0 = A, 1 = B atd.)

    vıstup:   AL = poèet logickıch diskù v systému

    Funkce nastaví aktivní disk a navrátí poèet diskù v systému libovolného
typu, vèetnì pevnıch diskù a logickıch diskù.

Pozn.: Disketová  jednotka  v  jednodisketovém  systému  se poèítá jako dva
       logické disky A: a B:.

       DOS  verze  3.x  a  pozdìjší  verze  hlásí  5 logickıch diskù, pokud
       neobsahuje CONFIG.SYS jiné pøiøazení pomocí LASTDRIVE.

       K  urèení  poètu  fyzickıch  disketovıch jednotek v systému pouijte
       pøerušení  INT  11H  (17).  K  urèení  poètu pevnıch diskù v systému
       pouijte pøerušení INT 13H (19)/funkci 08H.

       Pouijte  funkci  DOS  19H  (poskytnutí  aktivního  disku), pokud se
       chcete pøesvìdèit o správnosti operace.




 F u n k c e   0 F H  ( 1 5 ) - otevøení souboru s pouitím FCB

    vstup:    AH = 0FH
              DS:DX = ukazatel na neotevøenı FCB souboru

    vıstup:   AL = 00H - soubor úspìšnì otevøen (a FCB správnì vyplnìn)
                   FFH - soubor nenalezen nebo jej nelze otevøít

    Funkce  otevøe existující soubor s pouitím FCB souboru. DS:DX obsahuje
adresu  neotevøeného  øídícího  bloku  FCB.  Jmenovanı  soubor  se  hledá v
aktivním  adresáøi aktivního disku nebo disku specifikovaného v poloce FCB
(tj.  první  bajt  FCB:  0=aktivní  disk; 1=A; 2=B; ...). Nalezne-li se pro
soubor  vyhovující adresáøová poloka, AL vrátí hodnotu 0, soubor se otevøe
v  kompatibilním pøístupovém módu (viz funkce DOS 3DH - otevøení souboru) a
FCB se vyplní následovnì:

    - Je-li  kód  diskové  jednotky 0 (implicitní disk), zmìní se pøíslušná
      poloka FCB na aktivní pouitı disk (1=A, 2=B, atd.).

    - Poloka aktivní blok se vynuluje.

    - Délka záznamu se nastaví na sytémovou implicitní hodnotu 128 (80H).

    - Délka  souboru,  datum  a èas posledního zápisu do souboru se nastaví
      podle adresáøové poloky.

    Pøed  provedením sekvenèní diskové operace se souborem se musí nastavit
poloka  aktivní záznam. Pøed provedením diskové operace s pøímım pøístupem
se  souborem  se  musí  nastavit  poloka  relativní  záznam. Nevyhovuje-li
implicitní  délka  záznamu  128  bajtù, je nutno ji nastavit na poadovanou
délku pøed provedením následující diskové operace.




 F u n k c e   1 0 H  ( 1 6 ) - uzavøení souboru s pouitím FCB

    vstup:    AH = 10H
              DS:DX = ukazatel na otevøenı FCB souboru

    vıstup:   AL = 00H - soubor úspìšnì uzavøen
                   FFH - soubor nenalezen


    Funkce  uzavøe  soubor  a  uloí jeho adresáøovou poloku do adresáøe s
pouitím FCB. Tato funkce se musí vyvolat po provedenıch zmìnách v souboru,
aby se aktualizovala adresáøová poloka.

    Poloka  adresáøe  musí bıt na svém pùvodním místì v souèasném aktivním
adresáøi a disku, z kterého byl soubor otevøen.

    Je-li  pro  soubor  nalezena  odpovídající adresáøová poloka, umístìní
souboru  se  porovná  s  odpovídajícími polokami v FCB. Pokud je to nutné,
aktualizuje  se adresáøová poloka podle FCB a vyrovnávací pamì souboru se
vyprázdní. AL vrátí hodnotu 0.

Pozn.: Pokud  uzavíráte soubor na disketì, DOS se snaí nejdøíve urèit, zda
       byla  v disketové jednotce vymìnìna disketa. Pokud ano, navrací v AL
       hodnotu  0FFH.  Urèování  vımìny disket není spolehlivé v døívìjších
       verzích  DOS  ne  3.0;  pouití  této  funkce  v DOS 2.x pøi vımìnì
       diskety mùe mít za následek znièení obsahu diskety.



 F u n k c e   1 1 H  ( 1 7 ) - nalezení prvního souboru s pouitím FCB

    vstup:    AH = 11H
              DS:DX = ukazatel na neotevøenı FCB souboru

    vıstup:   AL = 00H - soubor nalezen (a DTA vyplnìna)
                   FFH - ádnı soubor nenalezen

    Funkce  hledá  v  aktivním  adresáøi  první vyhovující soubor. DS:DX je
adresa  neotevøeného FCB, kterı mùe obsahovat konvenèní znaky (tj. * a ?).
K  prohledávání skrytıch nebo systémovıch souborù musí DX ukazovat na první
bajt rozšíøeného FCB.
 
Pozn.: Pøedpokládané  pouití  této sluby je ovládání souborù obsahujících
       maskovací znaky "?" ve svém jménì (univerzální znak - na této pozici
       mùe bıt uveden jakıkoliv znak). Tato funkce zahájí porces hledání a
       funkce  12H  (18)  pokraèuje  v  hledání  následujících vyhovujících
       souborù.

       Funkci  29H  (rozloené  jméno  souboru)  lze  pouít  pro vytváøení
       neotevøeného FCB souboru v pøípravì pro hledání.

       Pokud  je  soubor nalezen, vytvoøí se na souèasné adrese pro diskové
       pøenosy   (DTA)   neotevøenı   FCB   stejného  typu  (normální  nebo
       rozšíøenı).  Pøed  voláním této funkce je potøeba se pøesvìdèit, zda
       je dostatek místa rezervovaného na DTA pro CFB; pokud není, je nutno
       nastavit pomocí funkce 1AH novou adresu DTA.

       Pokud funkce hledání pouívá rozšíøenı FCB (FCBE), je FCBE uloen na
       adrese  DTA s nastavenım bitem identifikátoru (offset -7) na hodnotu
       0FFH.

       Rozsah  hledání mùete øídit zadáním bajtu atributù v rozšíøeném FCB
       (offset  -1).  Pokud  je bajt atributù nastaven na 00H, hledá funkce
       pouze  normální soubory (tj. mohou mít nastaven pouze atribut "pouze
       ètení"  a/nebo  "archivní"). Pokud je v bajtu atributu specifikována
       nìjaká  kombinace  atributù "skrytı soubor", "systémovı soubor" nebo
       "adresáø",  budou  se  vyhledávat  normální  soubory  a také všechny
       soubory  s  tìmito  atributy. Pokud je v bajtu atributù specifikován
       atribut   "návìští  disku",  bude  funkce  hledat  pouze  poloku  s
       atributem  "návìští  disku".  Atributy  "pouze  ètení"  a "archivní"
       nemají vliv na hledání.

         Struktura bajtu atributù souboru:
        +-+-+-+-+-+-+-+-+
        |7 6 5 4 3 2 1 0|
        +++++++++++++++++ bit
         | | | | | | | +-> 0 (  1): pouze ètení souboru (Read-only "R/O")
         | | | | | | +---> 1 (  2): skrytı soubor (Hidden "HID")
         | | | | | +-----> 2 (  4): systémovı soubor (System "SYS")
         | | | | +-------> 3 (  8): návìští disku (Volume Label "VOL")
         | | | +---------> 4 ( 16): adresáø (Directory "DIR")
         | | +-----------> 5 ( 32): archivní soubor (Archive "ARC")
         | +-------------> 6 ( 64): rezervováno (musí bıt nastaven na 0)
         +---------------> 7 (128): rezervováno (musí bıt nastaven na 0)

            - bliší popis atributù viz "Adresáøová poloka"

       FCB  jsou pozùstatky z DOS 1. Je vıhodnìjší pouít k hledání souborù
       funkce 4EH a 4FH.




 F u n k c e   1 2 H  ( 1 8 ) - nalezení dalšího souboru s pouitím FCB

    vstup:    AH = 12H
              DS:DX = ukazatel  na  neotevøenı FCB souboru specifikovanı ve
                      funkci 11H nebo 12H

    vıstup:   AL = 00H - další soubor nalezen
                   FFH - soubor nenalezen

    Funkce  hledá  v  aktivním  adresáøi  další  vyhovující  soubor.  DS:DX
obsahuje adresu FCB specifikovaného v pøedchozím hledání pomocí funkce 11H.
Funkce  12H  se  pouívá  po  funkci  11H  (vyhledání  prvního vyhovujícího
souboru) k nalezení dalších vyhovujících adresáøovıch poloek.

Varování: Informace  potøebné  funkcí  12H  jsou  znièeny  jakoukoliv jinou
          operací  pouívající  vytváøení  FCB  souboru  (jako napø. funkce
          11H).  Proto,  pokud chcete hledat více souborù a provádìt v nich
          té  vstupnì/vıstupní  operace, musíte uloit informace k hledání
          tak, e uloíte FCB.


Pøíklad: Následující  pøíklad  provádí  vıpis souborù aktivního adresáøe na
         aktivním  disku (podobnì jako pøíkaz DIR) na obrazovku a to v pìti
         sloupcích.

              mov       ah,1ah              ; funkce nastavení DTA
              mov       dx,offset buffer    ; adresa bufferu jako DTA
              int       21h                 ; nastavení adresy DTA
              mov       ah,11h              ; funkce nalezení první poloky
              mov       dx,offset fcb       ; adresa FCB
              int       21h                 ; nalezení první poloky FCB
              inc       al                  ; je AL=FFH ? (tj. nenalezen)
              mov       dx,offset neni      ; textchybového hlášení
              jz        konec1              ; není soubor v adresáøi
    vypis:    mov       si,offset buffer+1  ; adresa FCB nalezeného souboru
              mov       cx,8                ; poèet znakù jména
              mov       ah,2                ; funkce vıstupu znaku
    jmeno:    mov       dl,[si]             ; znak jména souboru k tisku
              int       21h                 ; tisk znaku na displej
              inc       si                  ; další znak jména souboru
              loop      jmeno               ; další znak jména
              mov       dl,"."              ; oddìlovací znak teèky
              int       21h                 ; tisk oddìlovací teèku
              mov       cx,3                ; poèet znakù rozšíøení souboru
    typ:      mov       dl,[si]             ; znak typu souboru k tisku
              int       21h                 ; tisk znaku typu souboru
              inc       si                  ; další znak typu souboru
              loop      typ                 ; tisk dalšího znaku typu
              mov       dl," "              ; oddìlovací mezera
              int       21h                 ; tisk 4 oddìlovacích mezer
              int       21h
              int       21h
              int       21h
              mov       ah,12h              ; funkce vyhledání dalšího s.
              mov       dx,offset fcb       ; adresa FCB
              int       21h                 ; nalezení dalšího souboru
              inc       al                  ; je AL=FFH ? (tj. nenalezen)
              jnz       vypis               ; je další soubor
              mov       dx,offset tiskcr    ; odøádkování textu
    konec1:   mov       ah,9                ; funkce tisku textu
              int       21h                 ; tisk textu
              jmp       konec               ; konec programu

    neni      db        'V adresáøi není ádnı soubor.'
    tiskcr    db        13,10,'$'
    fcb       db        0,"???????????"
              db        25 dup (0)
    buffer    db        128 dup (0)

    konec:                                      ; konec programu




 F u n k c e   1 3 H  ( 1 9 ) - zrušení souboru s pouitím FCB

    vstup:    AH = 13H
              DS:DX = ukazatel na neotevøenı FCB souboru

    vıstup:   AL = 00H - soubor nalezen a zrušen
                   FFH - soubor nenalezen

    Funkce  zruší  všechny  soubory  s  aktivním  adresáøi,  které  splòují
podmínky dané FCB souboru.

   Pøi práci v síti vyaduje tato funkce pøístupová práva vytváøení CREATE.

Pozn.: Specifikace  souboru  mùe obsahovat znaky "?" nahrazující jakıkoliv
       znak ve specifikaci jména souboru.

       Soubory read-only nebudou touto funkcí zrušeny.





 F u n k c e   1 4 H  ( 2 0 ) - sekvenèní ètení ze souboru s pouitím FCB

    vstup:    AH = 14H
              DS:DX = ukazatel na otevøenı FCB

    vıstup:   AL = 00H - ètení probìhlo úspìšnì
                   01H - nalezen konec souboru, ádná data nepøeètena
                   02H - prostor DTA pøíliš malı (nebo pøelom segmentu)
                   03H - nalezen konec souboru, pøeètena èást dat

    Funkce  ète  sekvenènì  následující záznam souboru do bufferu na adrese
DTA,  po  ètení  inkrementuje  ukazatele v FCB souboru na další záznam (tj.
inkrementuje aktivní blok a aktivní záznam). Pøed vyvoláním funkce musí bıt
v FCB nastaveny poloky aktivní blok a aktivní záznam.

    Pøi práci v síti vyaduje tato funkce pøístupová práva ètení READ.

Pozn.: Èísko  sekvenèního  záznamu  je  odvozeno  z  hodnot aktivního bloku
       (offset  0CH)  a  aktivního záznamu (offset 20H) v FCB souboru. Tyto
       poloky  FCB  jsou  automaticky  zaznamenány po operaci ètení. Poèet
       ètenıch bajtù je pouit z poloky velikosti záznamu na offsetu 0EH v
       FCB.

       Data  jsou ètena do bufferu na adrese oznaèené jako Adresa diskového
       pøenosu  DTA.  Pokud by pøenos dat mohl zpùsobit pøeteèení segmentu,
       je vygenerována chyba 2.

       Pokud  je  nalezen konec souboru ještì pøed naètením celého záznamu,
       je zbytek záznamu doplnìn nulami a do plné velikosti záznamu.

Pøíklad: Následující  program  vypíše  na obrazovku z aktivního adresáøe na
         aktivním  disku  textovı  soubor  DIRINFO  (pokud existuje), kterı
         obsahuje  informace o nastaveném adresáøi (tento informaèní soubor
         pouívá té Norton Commander).

              mov       ah,1AH              ; funkce nastavení DTA
              mov       dx,offset buffer    ; adresa bufferu
              int       21h                 ; nastavení adresy DTA
              mov       ah,0fh              ; funkce otevøení souboru
              mov       dx,offset fcb       ; adresa fcb
              int       21h                 ; otevøení souboru
              inc       al                  ; je AL = FFH ? (tj. nenalezen)
              jz        konec               ; konec programu
              mov       [fcb+14],1          ; nastavení délky záznamu na 1
    cteni:    mov       dx,offset fcb       ; adresa fcb
              mov       ah,14h              ; funkce sekvenèního ètení
              int       21h                 ; sekvenèní ètení záznamu
              or        al,al               ; je správné ètení ?
              jnz       zavri               ; konec - uzavreni souboru
              mov       dl,[buffer]         ; pøeètenı znak
              cmp       dl,1ah              ; je znak konce souboru ?
              je        zavri               ; konec souboru - uzavøi
              mov       ah,2                ; funkce vıstupu znaku
              int       21h                 ; zobrazení znaku
              jmp       short cteni         ; další znak ze souboru
    zavri:    mov       ah,10h              ; funkce uzavøení souboru
              mov       dx,offset fcb       ; adresa fcb
              int       21h                 ; uzavøení souboru
              jmp       short konec         ; konec programu

    fcb       db        0,"DIRINFO    "     ; poloka FCB souboru
              db        25 dup (0)
    buffer    db        1 dup (?)           ; zásobník 1 znaku

    konec:                                  ; konec programu





 F u n k c e   1 5 H  ( 2 1 ) - sekvenèní zápis do souboru s pouitím FCB

    vstup:    AH = 15H
              DS:DX = ukazatel na otevøenı FCB

    vıstup:   AL = 00H - zápis probìhl úspìšnì
                   01H - disk je plnı
                   02H - prostor DTA pøíliš malı (nebo pøelom segmentu)

    Funkce zapisuje sekvenènì data z bufferu na adrese DTA do následujícího
záznamu  souboru,  po  zápisu inkrementuje ukazatele v FCB souboru na další
záznam (tj. inkrementuje aktivní blok a aktivní záznam).

    Pøi práci v síti vyaduje tato funkce pøístupová práva zápisu WRITE.

Pozn.: Èísko  sekvenèního  záznamu  je  odvozeno  z  hodnot aktivního bloku
       (offset  0CH)  a  aktivního záznamu (offset 20H) v FCB souboru. Tyto
       poloky  FCB  jsou  automaticky zaznamenány po operaci zápisu. Poèet
       zapisovanıch  bajtù je pouit z poloky velikosti záznamu na offsetu
       0EH v FCB.

       Data  jsou  zapisována  na  disk  z  bufferu na adrese oznaèené jako
       Adresa  diskového  pøenosu  DTA.  Pokud  by pøenos dat mohl zpùsobit
       pøeteèení segmentu, je vygenerována chyba 2.

       Pokud zapisovaná data nevyplní zapisovanı sektor, DOS ukládá data do
       bufferu pro evenuální zápis pokud jsou data v bufferu nashromádìna.

       Pokud  má specifikovanı soubor nastaven atribut ochrany proti zápisu
       Read-Only, zápis se neprovede.

Pøíklad: Program  zde  uvedenı  odstraòuje tabelátory z textového souboru a
         nahrazuje  je  odpovídajícím  poètem  mezer.  Pøevádìnı  soubor se
         zadává  pøi  vyvolání  programu  jako  parametr za jménem programu
         (pouívá  se  poloka  FCB  na adrese 005CH v prefixu programového
         segmentu).  Soubor  musí  bıt v aktivním adresáøi (v aktivním nebo
         uvedeném  disku).  Jako  vıstupní  soubor  se  (pro  jednoduchost)
         vytvoøí  soubor  stejnì  pojmenovanı  jako  zdrojovı soubor, ale s
         oznaèením typu $$$.

                                            ; program pouívá FCB souboru
                                            ; na adrese ES:005CH
         mov       ax,es                    ; datovı segment
         mov       ds,ax                    ; datovı segment
         mov       ax,cs                    ; segment programu
         mov       es,ax                    ; segment programu
         mov       si,5ch                   ; zdrojová adresa
         mov       di,offset fcb            ; cílová adresa
         mov       cx,12                    ; poèet znakù jména
         rep       movsb                    ; pøenos jména souboru
         mov       si,5ch                   ; zdrojová adresa FCB
         mov       di,offset fcbout         ; vıstupní soubor
         mov       cx,9                     ; délka - jen jméno
         rep       movsb                    ; pøenos jména souboru
         mov       ax,cs                    ; segment programu
         mov       ds,ax                    ; segment programu
         mov       dx,offset buffer         ; buffer znaku souboru
         mov       ah,1ah                   ; funkce nastavení adresy DTA
         int       21h                      ; nastavení adresy DTA
         mov       dx,offset fcb            ; adresa FCB souboru k pøevodu
         mov       ah,0fh                   ; funkce pro otevøení souboru
         int       21h                      ; otevøení souboru
         inc       al                       ; byl soubor nalezen ?
         jz        hlaseni                  ; chybové hlášení
         mov       word ptr [fcb+14],1      ; délka záznamu = 1 znak
         mov       ah,16h                   ; funkce vytvoøení souboru
         mov       dx,offset fcbout         ; vıstupní soubor
         int       21h                      ; vytvoøení souboru
         inc       al                       ; je volné místo ?
         jz        hlaseni                  ; není místo v adresáøi
         mov       word ptr [fcbout+14],1   ; délka záznamu = 1 znak
prevod:  mov       ah,14h                   ; funkce sekvenèního ètení
         mov       dx,offset fcb            ; adresa fcb souboru
         int       21h                      ; ètení znaku ze souboru
         or        al,al                    ; je chyba ?
         jnz       zavri                    ; konec - uzavøi soubor
         mov       al,[buffer]              ; znak ze souboru
         mov       cx,1                     ; poèet znakù k zápisu
         cmp       al,0ah                   ; znak LF ?
         je        zapis                    ; zápis znaku LF
         cmp       al,0dh                   ; je znak CR ?
         jne       nenicr                   ; není znak CR
         mov       word ptr [pozice],0      ; vynulování pozice
         jmp       short zapis              ; zápis znaku
nenicr:  inc       word ptr [pozice]        ; zvıšení pozice
         cmp       al,9                     ; znak tabelátoru ?
         jne       zapis                    ; není - zápis znaku
         dec       word ptr [pozice]        ; návrat pozice
         mov       ax,[pozice]              ; pozice znaku
         and       ax,0fff8h                ; nastavení na pøedchozí tabel.
         add       ax,8                     ; nastavení na další tabelátor
         mov       bx,ax                    ; úschova nové pozice
         sub       ax,[pozice]              ; poèet znakù k tabelaci
         mov       [pozice],bx              ; nová pozice
         mov       cx,ax                    ; poèet vloenıch mezer
         mov       al,' '                   ; oddìlovací znak mezery
zapis:   mov       [buffer],al              ; znak k zápisu do souboru
         mov       dx,offset fcbout         ; vıstupní soubor
         mov       ah,15h                   ; funkce zápisu znaku
znak:    int       21h                      ; zápis znaku
         or        al,al                    ; je chyba ?
         jnz       hlaseni                  ; chyba - hlášení chyby
         loop      znak                     ; zápis dalšího znaku
         jmp       short prevod             ; další znak k pøevodu
zavri:   mov       ah,10h                   ; funkce uzavøení souboru
         mov       dx,offset fcb            ; adresa fcb
         int       21h                      ; uzavøení souboru
         mov       dx,offset fcbout         ; záloní fcb
         int       21h
         jmp       short konec
hlaseni: mov       dx,offset chyba
         mov       ah,9
         int       21h
         jmp       short konec

chyba    db        'Chyba !',13,10,'$'      ; chybové hlášení
pozice   dw        0                        ; èítaè pozice na øádku
buffer   db        1                        ; buffer znaku
fcbout   db        0,'        $$$'          ; vıstupní soubor
         db        25 dup (?)
fcb      db        0,'           '          ; pøevádìnı soubor
         db        25 dup (?)
konec:                                      ; konec programu





 F u n k c e   1 6 H  ( 2 2 ) - vytvoøení souboru s pouitím FCB

    vstup:    AH = 16H
              DS:DX = ukazatel na neotevøenı FCB souboru

    vıstup:   AL = 00H - soubor úspìšnì vytvoøen
                   FFH - soubor nevytvoøen (plnı adresáø)

    Funkce  vytvoøí a otevøe novı soubor s pouitím FCB souboru nebo otevøe
ji existující soubor s tím, e jej zkrátí na nulovou délku.

   Pøi práci v síti vyaduje tato funkce pøístupová práva vytváøení CREATE.

Pozn.: Pouitím  rozšíøeného  FCB  mùete  pøiøadit  souboru  pøi  otevøení
       speciální atributy.

       Otevøenému  souboru  je pøiøazena nulová délka. Proto se tato funkce
       pouívá k otevøení vıstupního souboru, zatímco funkce 0FH se pouívá
       k otevøení souboru ke ètení.

       Tato  funkce je pozùstatkem z DOS v1.0. Vıhodnìjší je pouít novìjší
       funkci k vytvoøení souboru, jako je napø. funkce 3CH.



 F u n k c e   1 7 H  ( 2 3 ) - pøejmenování souboru s pouitím FCB

    vstup:    AH = 17H
              DS:DX = ukazatel na FCB, kterı má bıt modifikován

    vıstup:   AL = 00H - operace probìhla úspìšnì
                   FFH - operace  neúspìšná (poloka nenalezena nebo cílovı
                         soubor ji existuje)

   Pøi práci v síti vyaduje tato funkce pøístupová práva vytváøení CREATE.

    Funkce  mìní  jména  všech  souborù podle zadané specifikace v aktivním
adresáøi  na druhá specifikovaná jména. Specifikace nového jména souboru je
umístìna  v  FCB šest bajtù od konce prvního jména (tj. na offsetu 11H=17 v
FCB).

Pozn.: V  prvním  i  druhém  jménì souboru lze pouít znaky "?" nahrazující
       jakıkoliv  znak  (v  druhém jménì má znak "?" ten vıznam, e znak na
       odpovídající pozici jména nebude zmìnìn).

       Funkce  nepøejménuje soubor na jméno, které v adresáøi ji existuje;
       v tom pøípadì se funkce pøeruší a navrátí AL = FFH.

       Soubory  s  nastavenou  ochranou  proti  zápisu  nelze  touto funkcí
       pøejmenovat.



 F u n k c e   1 8 H  ( 2 4 ) - rezervováno




 F u n k c e   1 9 H  ( 2 5 ) - poskytnutí aktivního disku

    vstup:    AH = 19H

    vıstup:   AL = èíslo aktivního disku (0 = A, 1 = B, atd.)

    Funkce navrátí èíslo aktivního disku.

Pozn.: Èíslo  disku  navrácené  touto  funkcí  je o 1 menší ne èísla diskù
       uvádìná  v jinıch funkcích (napø. FCB souboru); mnoho funkcí pouívá
       0 k oznaèení aktivního disku.




 F u n k c e   1 A H  ( 2 6 ) - nastavení adresy diskového pøenosu (DTA)

    vstup:    AH = 1AH
              DS:DX = nová adresa diskovıch pøenosù DTA

    vıstup:   ádnı

    Adresa   diskového  pøenosu  DTA  (Disk  Transfer  Address)  je  adresa
vyrovnávací  pamìti,  do  které  jsou  ukládána  (nebo z ní ètena) data pøi
diskovém  pøenosu  ze  souboru  (do  souboru).  Diskové  pøenosy se nemohou
pøepisovat  z  konce  segmentu  na  zaèátek,  ani nemohou pøetéct do jiného
segmentu.  Proto  sluby  pro  pøenosy  dat  v tìchto pøípadech hlásí chybu
nedostaèující velikosti prostoru DTA.

Pozn.: Pokud není nastavena DTA jinak, pouívá DOS jako aktivní DTA prostor
       o  délce  128  bajtù  na offsetu 80H v prefixu programového segmentu
       (PSP).

       Rezervujte  dostateènı prostor bufferu; pokud DOS zjistí, e by data
       pøi pøenosu pøetekla pøes okraj segmentu, abortuje diskovı pøenos.

       Tato  funkce  se  pouívá  s operacemi ètení a zápisu pomocí FCB a s
       operacemi  pro  nalezení prvního a následujícího souboru pouívající
       FCB.



 F u n k c e   1 B H  ( 2 7 ) - poskytnutí informací FAT aktivního disku

    vstup:    AH = 1BH

    vıstup:   AL = poèet sektorù na blok
              CX = velikost sektoru v bajtech
              DX = celkovı poèet blokù disku
              DS:BX = ukazatel na bajt popisovaèe média (identifikátor FAT)

    znièené registry: DS

    Funkce  navrací  charakteristiku  média  a  bajt  popisovaèe  média pro
aktivní disk (bajt popisovaèe média specifikuje typ diskové jednotky).

    Bajt popisovaèe média (identifikaèní bajt FAT):

    Bajt popisovaèe média je omezen na hodnoty F0H a FFH.
 
 +-------+---------------------------------------------------+
 |  FFH  |    oboustranná disketa 5 1/4", 8 sektorù          |
 +-------+---------------------------------------------------+
 |  FEH  |    jednostranná disketa 5 1/4", 8 sektorù nebo    |
 |       |    jednostranná disketa 8", 26 sektorù nebo       |
 |       |    jednostranná disketa 8", 8 sektorù             |
 +-------+---------------------------------------------------+
 |  FDH  |    oboustranná disketa 5 1/4", 9 sektorù nebo     |
 |       |    jednostranná disketa 8", 26 sektorù            |
 +-------+---------------------------------------------------+
 |  FCH  |    jednostranná disketa, 9 sektorù                |
 +-------+---------------------------------------------------+
 |  F9H  |    oboustranná disketa 5 1/4", 15 sektorù         |
 |       |    oboustranná disketa 3 1/2", 9 sektorù          |
 +-------+---------------------------------------------------+
 |  F8H  |    pevnı disk                                     |
 +-------+---------------------------------------------------+
 |  F0H  |    oboustranná disketa 3 1/2", 18 sektorù nebo    |
 |       |    jinı nedefinovatelnı typ média                 |
 +-------+---------------------------------------------------+

    Další  informace  o typu média obdríte pomocí pøerušení INT 25H, které
umoòuje ètení bloku parametrù BIOS (BPB) ze zavádìcího sektoru disku.

Pozn.: Tato funkce mìní hodnotu registru DS, proto ji pøed vyvoláním funkce
       uschovejte pomocí PUSH DS.




 F u n k c e   1 C H  ( 2 8 ) - poskytnutí informací FAT specifik. disku

    vstup:    AH = 1CH
              DL = èíslo disku (0 = aktivní, 1 = A, 2 = B, atd.)

    vıstup:   AL = poèet sektorù na blok
              CX = velikost sektoru v bajtech
              DX = celkovı poèet blokù disku
              DS:BX = ukazatel na bajt popisovaèe média (identifikátor FAT)

    znièené registry: DS

    Funkce  navrací  charakteristiku  média  a  bajt  popisovaèe  média pro
aktivní disk (bajt popisovaèe média specifikuje typ diskové jednotky).

    Bajt popisovaèe média (identifikaèní bajt FAT):

    Bajt popisovaèe média je omezen na hodnoty F0H a FFH.
  
 +-------+---------------------------------------------------+
 |  FFH  |    oboustranná disketa 5 1/4", 8 sektorù          |
 +-------+---------------------------------------------------+
 |  FEH  |    jednostranná disketa 5 1/4", 8 sektorù nebo    |
 |       |    jednostranná disketa 8", 26 sektorù nebo       |
 |       |    jednostranná disketa 8", 8 sektorù             |
 +-------+---------------------------------------------------+
 |  FDH  |    oboustranná disketa 5 1/4", 9 sektorù nebo     |
 |       |    jednostranná disketa 8", 26 sektorù            |
 +-------+---------------------------------------------------+
 |  FCH  |    jednostranná disketa, 9 sektorù                |
 +-------+---------------------------------------------------+
 |  F9H  |    oboustranná disketa 5 1/4", 15 sektorù         |
 |       |    oboustranná disketa 3 1/2", 9 sektorù          |
 +-------+---------------------------------------------------+
 |  F8H  |    pevnı disk                                     |
 +-------+---------------------------------------------------+
 |  F0H  |    oboustranná disketa 3 1/2", 18 sektorù nebo    |
 |       |    jinı nedefinovatelnı typ média                 |
 +-------+---------------------------------------------------+

    Další  informace  o typu média obdríte pomocí pøerušení INT 25H, které
umoòuje ètení bloku parametrù BIOS (BPB) ze zavádìcího sektoru disku.

Pozn.: Tato funkce mìní hodnotu registru DS, proto ji pøed vyvoláním funkce
       uschovejte pomocí PUSH DS.




 F u n k c e   1 D H  ( 2 9 ) - rezervováno




 F u n k c e   1 E H  ( 3 0 ) - rezervováno




 F u n k c e   1 F H  ( 3 1 ) - rezervováno




 F u n k c e   2 0 H  ( 3 2 ) - rezervováno




 F u n k c e   2 1 H  ( 3 3 ) - ètení s pøímım pøístupem s pouitím FCB

    vstup:    AH = 21H
              DS:DX = ukazatel na otevøenı FCB

    vıstup:   AL = 00H - ètení probìhlo úspìšnì
                   01H - nalezen konec souboru, ádná data nepøeètena
                   02H - prostor DTA pøíliš malı (pøelom segmentu)
                   03H - nalezen konec souboru, pøeètena èást dat

    Funkce  ète  specifikovanı  záznam  souboru  do  bufferu na adrese DTA.
Záznam  je  specifikován  v  FCB nastavením èísla náhodného záznamu (offset
21H)  a  velikostí  záznamu  (offset 0EH), z tìchto údajù je odvozeno èíslo
bloku se záznamem a èíslo záznamu v bloku.

    Pøi práci v síti vyaduje tato funkce pøístupová práva ètení READ.

Pozn.: Poloka  náhodného  záznamu  není  po této operaci uloena. Proto je
       nutné,  aby  program  nastavil  poloku  náhodného záznamu vdy pøed
       vyvoláním  této  funkce.  Funkce  27H, která je obdobou této funkce,
       ukládá  automaticky  poloku  náhodného záznamu (funkce 27H mùe té
       èíst záznam vícenásobnì).

       Data  jsou ètena do bufferu na adrese oznaèené jako Adresa diskového
       pøenosu  DTA.  Pokud by pøenos dat mohl zpùsobit pøeteèení segmentu,
       je vygenerována chyba 2.

       Pokud  je  nalezen konec souboru ještì pøed naètením celého záznamu,
       je zbytek záznamu doplnìn nulami a do plné velikosti záznamu.





 F u n k c e   2 2 H  ( 3 4 ) - zápis s pøímım pøístupem s pouitím FCB

    vstup:    AH = 22H
              DS:DX = ukazatel na otevøenı FCB

    vıstup:   AL = 00H - zápis probìhl úspìšnì
                   01H - disk je plnı
                   02H - prostor DTA pøíliš malı (pøelom segmentu)

    Funkce  zapisuje  specifikovanı  záznam  z  bufferu  na  adrese  DTA do
souboru. Záznam je specifikován èíslem náhodného záznamu (offset 21H v FCB)
a  velikostí  záznamu  (offset 0EH v FCB). Aktivní blok a aktivní záznam v
bloku jsou odvozeny z èísla náhodného záznamu a velikosti záznamu.

    Pøi práci v síti vyaduje tato funkce pøístupová práva zápisu WRITE.

Pozn.: Poloka  náhodného  záznamu  není  po této operaci uloena. Proto je
       nutné,  aby  program  nastavil  poloku  náhodného záznamu vdy pøed
       vyvoláním  této  funkce.  Funkce  28H, která je obdobou této funkce,
       ukládá  automaticky  poloku  náhodného záznamu (funkce 28H mùe té
       zapisovat záznam vícenásobnì).

       Data  jsou  zapisována  z  bufferu  na  adrese  oznaèené jako Adresa
       diskového  pøenosu  DTA. Pokud by pøenos dat mohl zpùsobit pøeteèení
       segmentu, je vygenerována chyba 2.

       Pokud  je  nalezen konec souboru ještì pøed naètením celého záznamu,
       je zbytek záznamu doplnìn nulami a do plné velikosti záznamu.

       Pokud  má specifikovanı soubor nastaven atribut ochrany proti zápisu
       Read-Only, zápis se neprovede.

       Je-li  délka  záznamu  menší  ne  sektor  (512  bajtù), zapisují se
       záznamy  do  vyrovnávací  pamìti  dokud není k zápisu pøipraven celı
       sektor.





 F u n k c e   2 3 H  ( 3 5 ) - poskytnutí velikosti souboru s pouitím FCB

    vstup:    AH = 23H
              DS:DX = ukazatel na neotevøenı FCB

    vıstup:   AL = 00H - pokud byl poadovanı soubor nalezen
                   FFH - pokud nebyl nalezen ádnı vyhovující soubor

    Funkce hlásí velikost souboru jako poèet záznamù (zaokrouhleno nahoru).
Poèet záznamù je navracen v poloce FCB relativní záznam (offset 21H).

Pozn.: Tato  funkce  má  stejnı  úèinek,  jakoby  bylo poadováno nastavení
       ukazatele  relativního  záznamu  na  konec souboru, pøíští operace s
       pøímım  pøístupem  by  probíhala  za  konec souboru (novı záznam pøi
       zápisu).

       Pøed  voláním  funkce  musíte  nastavit  poloku  velikosti  záznamu
       (offset  0EH)  v FCB. Pokud chcete urèit velikost souboru v bajtech,
       mastavte poloku velikosti záznamu na hodnotu 1.

       K   urèení   velikosti   souboru  s  pouitím  funkcí  pouívajících
       identifikátory  souboru  pouijte  funkci  LSEEK (funkce 42H), která
       nastaví ukazatel na konec souboru.





 F u n k c e   2 4 H   ( 3 6 ) - nastavení relativ. záznamu s pouitím FCB

    vstup:    AH = 24H
              DS:DX = ukazatel na neotevøenı FCB

    vıstup:   ádnı

    Funkce  nastaví poloku relativního záznamu v FCB tak, aby souhlasila s
nastavením poloek aktivního bloku a aktivního záznamu v FCB.

Pozn.: Tato  funkce usnadòuje pøepínání ze sekvenèních operací na operace s
       pøímım  pøístupem.  Zpìtné  pøepnutí  je  moné tím zpùsobem, e pøi
       operacích  s  pøímım  pøístupem  DOS  automaticky  nastavuje poloky
       aktivního bloku a aktivního záznamu v FCB.





 F u n k c e   2 5 H   ( 3 7 ) - nastavení vektoru pøerušení

    vstup:    AH = 25H
              AL = èíslo pøerušení
              DS:DX = adresa nového ovladaèe pøerušení

    vıstup:   ádnı

Pozn.: Pøed  voláním  funkce  25H  si  mùete  vyádat  informaci  o adrese
       souèasného  ovladaèe  pøerušení  (pomocí  funkce  35H),  aby byl váš
       program  schopen  navrátit  pùvodní  adresu  ovladaèe  pøerušení pøi
       ukonèení  programu.  Toto  je  preferovaná cesta k nastavení vektoru
       pøerušení. Nepouívejte nastavení adresy pøerušení pøímo v pamìti !





 F u n k c e   2 6 H   ( 3 8 ) - vytvoøení programového segmentu

    vstup:    AH = 26H
              DX = adresa segmentu nového prefixu programového segmentu
              CS:0 = prefix program. segmentu, z kterého se zkopírují inf.

    vıstup:   ádnı

    Funkce  vytvoøí  novı  prefix  programového  segmentu  (PSP),  aby byly
votvoøeny podmínky k oddìlenému naètení podprogramu a jeho spuštìní. PSP na
zaèátku segmentu souèasného kódu programu se zkopíruje do prvních 256 bajtù
nového  segmentu  specifikovaného  v  registru  DX.  Novı  PSP  se uloí se
souèasnım   nastavením   vektorù  pøerušení  INT·22h,  INT·23H  a  INT·24H.
Informace  o  velikosti  pamìti na relativní adrese 06H nového PSP se uloí
souhlasnì podle skuteèného stavu volné pamìti.

Pozn.: Tato  funkce  je  u  verzí  DOS  2.0 a vyšších nahrazena funkcí EXEC
       (funkce 4BH); tato funkce by nemìla bıt pouívána.




 F u n k c e   2 7 H   ( 3 9 ) - ètení bloku s pøímım pøístupem s pou. FCB

    vstup:    AH = 27H
              CX = poèet záznamù ke ètení
              DS:DX = ukazatel na otevøenı FCB

    vıstup:   AL = 00H - ètení probìhlo úspìšnì
                   01H - nalezen konec souboru, poslední záznam vcelku
                   02H - prostor DTA pøíliš malı (pøelom segmentu)
                   03H - nalezen konec souboru, pøeètena èást dat
              CX = poèet skuteènì pøeètenıch záznamù

    Funkce  ète  jeden  nebo  více  záznamù  do  pamìti na souèasnou adresu
diskovıch  pøenosù  DTA.  Poèet záznamù specifikuje registr CX. Je-li poèet
záznamù  nastaven  na  0,  ukonèí  se funkce bez ètení jakéhokoliv záznamu.
Ètení  zaèíná na relativní adrese záznamu (offset 21H). Velikost záznamù je
specifikována polokou velikosti záznamu (offset 0EH). Poloky aktivní blok
a  aktivní  záznam  se  nastaví  odpovídajícím zpùsobem k poloce relativní
záznam.

    Pøi práci v síti vyaduje tato funkce pøístupová práva ètení READ.

Pozn.: Pouijte  funkci 1AH k nastavení adresy diskovıch pøenosù DTA. Pokud
       by  pøenos  dat  mohl  zpùsobit  pøeteèení segmentu, je vygenerována
       chyba 2.

       Pokud  je  nalezen konec souboru ještì pøed naètením celého záznamu,
       je zbytek záznamu doplnìn nulami a do plné velikosti záznamu.

       Po  naètení  poadovaného  záznamu  uloí  tato funkce novou hodnotu
       poloky  relativního záznamu a poloky aktivní blok a aktivní záznam
       tak,  e  ukazují  na  novı záznam. Funkce 21H je jednodušší obmìnou
       této funkce, kromì toho, e funkce 21H neukládá automaticky poslednì
       jmenované  tøi  poloky  a  mùe  èíst  pouze  jeden záznam na jedno
       volání.





 F u n k c e   2 8 H   ( 4 0 ) - zápis bloku s pøímım pøístupem s pou. FCB

    vstup:    AH = 28H
              CX = poèet záznamù k zápisu
              DS:DX = ukazatel na otevøenı FCB

    vıstup:   AL = 00H - zápis probìhl úspìšnì
                   01H - disk je plnı
                   02H - prostor DTA pøíliš malı (pøelom segmentu)
              CX = poèet zapsanıch záznamù

    Funkce  zapisuje  jeden  nebo více záznamù ze souèasné adresy diskovıch
pøenosù  DTA na disk. Poèet záznamù specifikuje registr CX. Zápis zaèíná na
relativní  adrese  záznamu  (offset 21H). Velikost záznamù je specifikována
polokou  velikosti  záznamu  (offset  0EH). Poloky aktivní blok a aktivní
záznam se nastaví odpovídajícím zpùsobem k poloce relativní záznam.

    Pøi práci v síti vyaduje tato funkce pøístupová práva zápisu WRITE.

Pozn.: Pouijte  funkci 1AH k nastavení adresy diskovıch pøenosù DTA. Pokud
       by  pøenos  dat  mohl  zpùsobit  pøeteèení segmentu, je vygenerována
       chyba 2.

       Pokud  zapisovanı záznam nezaplní celı sektor (512 Bajtù), DOS uloí
       data do vyrovnávací pamìti a uloí sektor a po jeho naplnìní (resp.
       a ve chvíli, kdy je poadován pøístup na jinı sektor ne kterı je v
       pamìti).

       Pokud  specifikovanı soubor má nastaven atribut "pouze ètení", zápis
       se neprovede.

       Pokud  specifikujete  hodnotu  v  CX  =  0  (poèet  záznamù), funkce
       nezapíše   ádnı  záznam,  avšak  zkrátí  délku  souboru  na  pozici
       specifikovanou  èíslem  relativního záznamu. Tato funkce se pouívá,
       pokud  chcete logicky zrušit záznamy za koncem souboru a uvolnit tak
       místo na disku.

       Po  zápisu  poadovaného  záznamu  uloí  tato  funkce novou hodnotu
       poloky  relativního záznamu a poloky aktivní blok a aktivní záznam
       tak,  e  ukazují  na  novı záznam. Funkce 22H je jednodušší obmìnou
       této funkce, kromì toho, e funkce 22H neukládá automaticky poslednì
       jmenované  tøi  poloky a mùe zapisovat pouze jeden záznam na jedno
       volání.




 F u n k c e   2 9 H   ( 4 1 ) - rozbor jména souboru

    vstup:    AH = 29H
              DS:SI = ukazatel na øetìzec, kterı má bıt rozebrán
              ES:DI = ukazatel na neotevøenou poloku FCB
              AL = parametry rozboru:
                   bit 0 - zkoumání od posledního oddìl. znaku (ingorován)
                       1 - identifikaèní  bajt  disku  v FCB je modifikován
                           pouze  pokud  je  disk specifikován v pøíkazovém
                           øádku
                       2 - jméno  souboru v FCB je modifikováno pouze pokud
                           je  jméno  souboru  specifikováno  v  pøíkazovém
                           øádku
                       3 - rozšíøení  jména  souboru  v FCB je modifikováno
                           pouze   pokud   je   rozšíøení   jména   souboru
                           specifikováno v pøíkazovém øádku
                       4-7 ignorovány

    vıstup:   AL = FFH - funkce neprobìhla úspìšnì
                   00H - funkce úspìšná, nenalezeny ádné maskovací znaky
                   01H - funkce úspìšná, nalezeny maskovací znaky (?,*)
              DS:SI = první bajt po øetìzci, kterı se rozebíral
              ES:DI = novı neotevøenı FCB

    Funkce  29H  provádí  rozbor  pøíkazového øádku pro specifikaci souboru
pomocí  formy d:JMÉNO_SOUBORU.TYP. Pokud je nalezeno jméno souboru, vytvoøí
se  FCB.  Jinak  funkce  navrací v AL hodnotu FFH. Funkce umoòuje programu
nastavit  aktivní  disk,  jméno  souboru  a rozšíøení (typ) jména souboru a
ponechat na uivateli, aby zmìnil tyto aktivní hodnoty.

Pozn.: DS:SI ukazuje na lokaci øetìzce specifikace souboru, jeho rozbor má
       bıt  proveden  (text  z pøíkazového øádku). ES:DI ukazuje na lokaci,
       kde  bude  vytvoøen  novı FCB. V niší tetrádì registru AL (tj. jeho
       niší ètyøi bity) jsou specifikovány parametry pro rozbor:

         - bit 0: Pokud  je  nastaven  na  1, hledá se jméno souboru i pøes
                  poèáteèní  oddìlovací znaky souborù (napø. mezera). Pokud
                  je  nastaven  na  0, pøedpokládá se, e jméno specifikace
                  souboru zaèíná na prvním bajtu pøíkazového øádku.

         - bit 1: Pokud je nastaven na 1, nastaví funkce bajt disku pouze v
                  pøípadì, e povelovı øádek obsahuje specifikaci disku. To
                  umoòuje programu definovat svùj vlastní implicitní disk.
                  Pokud je nastaven na 0, je disk nastavem na specifikovanı
                  disk nebo na implicitní disk (hodnota 0).

         - bit 2: Pokud  je nastaven na 1, zmìní funkce jméno souboru v FCB
                  pouze  v  pøípadì,  e  nalezne  platné  jméno  souboru v
                  pøíkazovém  øádku.  To  umoòuje  programu  nastavit  své
                  implicitní    jméno    souboru,   které   mùe   uivatel
                  pøedefinovat. Pokud je bit nastaven na 0 a není v øetìzci
                  specifikováno  jméno souboru, nastaví se jméno souboru na
                  8 mezer.

         - bit 3: Pokud  je  nastaven  na  1,  zmìní funkce rozšíøení jména
                  souboru   v  FCB  pouze  v  pøípadì,  e  nalezne  platné
                  rozšíøení  jména souboru v pøíkazovém øádku. Pokud je bit
                  nastaven  na  0  a  není  v  øetìzci  specifikováno jméno
                  souboru, nastaví se jméno souboru na 3 mezery.


       Pokud  funkce  nalezne  ve  specifikaci jména souboru maskovací znak
       "*",  nahradí  zbytek  jména  souboru  nebo  rozšíøení jména souboru
       maskovacími znaky "?". Pokud je zbytek rozboru úspìšnı, navrátí v AL
       hodnotu   01H   informující   program,   e   musí   pouít   funkce
       nalezni_první/nalezni_další (tj. funkce 11H a 12H).

       Pokud  operace  neprobìhne  úspìšnì,  navrátí AL hodnotu FFH a druhı
       bajt FCB (ES:DI+1) bude prázdnı.

       Funkce  29H  nemùe  pracovat  s  popisem cest souborù. Soubory jsou
       popsány  pouze  ve  tvaru d:jméno.typ (d=oznaèení disku; jméno=jméno
       souboru; typ=typ souboru, rozšíøení jména souboru).

       Jako oddìlovaèe jména souboru se pouívají znaky:
         : . ; , = + / " [ ] < > | mezera tabelátor

       Ukonèovací  znaky  jména  souboru  zahrnují všechny oddìlovací znaky
       plus  jakıkoliv  øídící  znak  (tj. znak s kódem menším ne 20H=32).
       Jméno souboru nemùe obsahovat ukonèovací znak jména souboru.




 F u n k c e   2 A H   ( 4 2 ) - poskytnutí systémového data

    vstup:    AH = 2AH

    vıstup:   AL = den v tıdnu (0 - 6; 0 = nedìle)
              CX = rok (1980 - 2099)
              DH = mìsíc (1 - 12)
              DL = den (1 - 31)

Pozn.: Pøíruèky  k  DOS 2.00 a 2.10 nesrávnì uvádí, e funkce 2CH navrací v
       registru AL den v tıdnu.

       Èíselné údaje jsou v binární formì.




 F u n k c e   2 B H   ( 4 3 ) - nastavení systémového data

    vstup:    AH = 2BH
              CX = rok (1980 - 2099)
              DH = mìsíc (1 - 12)
              DL = den (1 - 31)

    vıstup:   AL = 00H - bylo zadáno správné datum
                   FFH - bylo zadáno neplatné datum

Pozn.: Èíselné údaje jsou v binární formì.




 F u n k c e   2 C H   ( 4 4 ) - poskytnutí systémového èasu

    vstup:    AH = 2CH

    vıstup:   CH = hodina (0 - 23)
              CL = minuta (0 - 59)
              DH = sekunda (0 - 59)
              DL = setina sekundy (0 - 99)

Pozn.: V   mnoha   systémech   je   poloka  setiny  sekundy  (registr  DL)
       zaokrouhlována po èástech 1/18.2 sekundy.

       V  nìkterıch systémech, jejich hodiny neumoòují provádìt krokování
       po setinách sekundy, mùe bıt hodnota v DL nedefinovatelná.

       Èíselné údaje jsou v binární formì.




 F u n k c e   2 D H   ( 4 5 ) - nastavení systémového èasu

    vstup:    AH = 2CH
              CH = hodina (0 - 23)
              CL = minuta (0 - 59)
              DH = sekunda (0 - 59)
              DL = setina sekundy (0 - 99)

    vıstup:   AL = 00H - bylo zadán správnı èas
                   FFH - bylo zadán neplatnı èas

Pozn.: Èíselné údaje jsou v binární formì.





 F u n k c e   2 E H   ( 4 6 ) - zapnutí nebo vypnutí pøepínaèe VERIFY

    vstup:    AH = 2EH
              AL = 00H - vypnutí pøepínaèe VERIFY
                   01H - zapnutí pøepínaèe VERIFY
              DL = 00H

    vıstup:   ádnı

    Funkce  2EH  umoòuje  zapnout  nebo  vypnout pøepínaè VERIFY. Pokud je
pøepínaè  VERIFY  zapnut  (AL  = 01H), ète DOS bajty kontrolního souètu CRC
(Cyclic  Redundancy  Check) právì zapisovanıch dat a ovìøuje, zda jsou data
správnì  zapsána.  Nastavení  tohoto  pøepínaèe  tedy  nezpùsobí  ovìøování
správnosti  zápisu  dat  kontrolním  ètením  dat  po zápisu (a porovnáním s
pùvodními  daty),  provádí  pouze  kontrolu  èitelnosti  dat pomocí ovìøení
kontrolního  souètu. Tento pøepínaè je vhodné zapnout pøi zápisu kritickıch
dat  na  disk,  v  bìném provozu je vhodnìjší jej vypnout, nebo zpomaluje
provádìní diskovıch operací.

Pozn.: U verzí DOS 1 a 2 musí bıt DL nastaven pøed voláním funkce na 0.

       Síové disky nepodporují funkci pro verifikaci dat.

       K  zjištìní  stavu  pøepínaèe VERIFY pouijte funkci 54H (poskytnutí
       nastavení pøepínaèe VERIFY).





 F u n k c e   2 F H   ( 4 7 ) - poskytnutí adresy diskovıch pøenosù (DTA)

    vstup:    AH = 2FH

    vıstup:   ES:BX = adresa souèasnì nastavené adresy DTA

Pozn.: Pokud  není  pouita  funkce 1AH (nastavení adresy diskovıch pøenosù
       DTA),  je automaticky nastavena jako DTA vyrovnávací pamì na adrese
       80H v prefixu programového segmentu PSP a o délce 128 bajtù.





 F u n k c e   3 0 H   ( 4 8 ) - poskytnutí èísla verze DOS

    vstup:    AH = 30H

    vıstup:   AL = hlavní èíslo verze operaèního systému DOS
              AH = doplòkové èíslo verze operaèního systému DOS

Pozn.: DOS verze 1.x navrací v AL hodnotu 00H.

       Je  tøeba  si uvìdomit, e napø. verze 2.1 je uloena jako 02H (2) a
       0AH (10), tj. jako 2.10 a ne jako 02H a 01H (= 2.01).

Pøíklad: Pokud  je  tato  funkce  vyvolána  napø.  pod  DOS 2.11, v AL bude
         navrácena hodnota 02H a v AH bude hodnota 0BH (= 11).





 F u n k c e   3 1 H   ( 4 9 ) - ukonèení procesu a jeho uchování v pamìti

    vstup:    AH = 31H
              AL = návratovı kód
              DX = velikost rezidentní èásti (v odstavcích)

    vıstup:   neexistuje návrat

    Funkce  pøeruší  právì  probíhající  proces, avšak ponechá jeho urèitou
èást  rezidentnì  v  pamìti. Funkce 31H je rozšíøením pøerušení DOS INT 27H
(pøerušení  s  uchováním  kódu  programu v pamìti); umoòuje dvì doplòující
funkce:  umoòuje  ponechat  v  pamìti  rezidentnì  více ne 64K a umoòuje
navrátit nadøazenému procesu návratovı kód.

Pozn.: Tato   funkce   neuvolòuje   ádnou  pamì,  která  byla  pøemístìna
       pøerušenım procesem pomocí funkce 48H (pøidìlení pamìti).

       Nadøazenı  proces  mùe  obdret  návratovı  kód pøerušeného procesu
       pomocí  funkce  4DH  nebo v pøíkazovém souboru DOS testováním pomocí
       funkce ERRORLEVEL.

       Otevøené soubory nejsou touto funkcí uzavøeny.




 F u n k c e   3 2 H   ( 5 0 ) - rezervováno



 F u n k c e   3 3 H   ( 5 1 ) - poskytnutí nebo nastavení statutu BREAK

    vstup:    AH = 33H
              AL = 00H - poskytnutí statutu BREAK
                   01H - nastavení statutu BREAK
              DL = 00H - vypnutí pøíznaku BREAK (pouze pøi AL = 01H)
                   01H - zapnutí pøíznaku BREAK (pouze pøi AL = 01H)

    vıstup:   DL = 00H - BREAK je vypnut (pouze pøi AL = 00H)
                   01H - BREAK je zapnut (pouze pøi AL = 00H)

    Operaèní  systém  DOS verze 2.00 a pozdìjší umoòuje rozšíøit provádìní
kontroly  stisku  kombinace kláves <Ctrl>-<Break> (<Ctrl>-C) kromì vstupù a
vıstupù  na  konzolu  (tj.  funkce  01H  - 0CH) také na testování pøi všech
ostatních  vstupnì/vıstupních  operacích.  K  zapnutí  kontroly  pøi  všech
vstupnì/vıstupních operacích slouí tato funkce 33H.

Pozn.: Standardní  nastavení  kontroly <Ctrl>-<Break> (<Ctrl>-C) je vypnutı
       stav,  tj. kontrola se provádí pouze pøi operacích vstupu/vıstupu na
       konzolu.

       Stav  pøepínaèe  BREAK lze nastavovat z pøíkazového øádku DOS pomocí
       povelu BREAK ON nebo BREAK OFF.

       Programy,  které  pouívají  volání  funkcí  06H  nebo  07H ke ètení
       kombinace  kláves <Ctrl>-<Break> (<Ctrl>-C) jako dat, musí zajistit,
       aby byl pøepínaè BREAK vypnut.




 F u n k c e   3 4 H   ( 5 2 ) - rezervováno




 F u n k c e   3 5 H   ( 5 3 ) - poskytnutí vektoru pøerušení

    vstup:    AH = 35H
              AL = èíslo pøerušení

    vıstup:   ES:BX = ukazatel na obsluhu pøerušení

    Funkce navrací adresu obsluného programu pro poadované pøerušení.

Pozn.: Po  volání funkce 35H mùete nastavit novou adresu vektoru pøerušení
       pomocí  funkce  25H.  Toto  je  preferovaná  cesta  ke ètení vektoru
       pøerušení, programy by nemìly získávat vektor pøerušení pøímo ètením
       tabulky vektorù.





 F u n k c e   3 6 H   ( 5 4 ) - poskytnutí volného místa disku

    vstup:    AH = 36H
              DL = èíslo disku (0=aktivní disk, 1=A, 2=B, atd.)

    vıstup:   AX = poèet sektorù na alokaèní blok
                   (FFFFH = neplatná specifikace disku)
              BX = poèet volnıch alokaèních blokù disku
              CX = poèet bajtù na sektor
              DX = celkovı poèet alokaèních blokù na disku

    Funkce  navrací poèet volnıch alokaèních blokù disku a jiné informace o
disku podobnì jako funkce 1BH a 1CH se tøemi odlišnostmi:

    - navrací poèet volnıch blokù (namísto tabulky popisovaèe média)
    - nevrací ukazatel na popisovací bajt média
    - navrací chybovı kód, pokud je specifikovanı disk neplatnı





 F u n k c e   3 7 H   ( 5 5 ) - rezervováno

    nastavení  oddìlovacího znaku parametrù pøíkazu (viz povel SWITCHAR pro
souboru CONFIG.SYS).



 F u n k c e   3 8 H   ( 5 6 ) - poskytnutí/nastavení národnost. informací

    vstup:    AH = 38H
              AL = 00H - souèasnì nastavená zemì (implicitní zemì)
                 = kód zemì (> DOS 2.01)
                 = FFH - kód zemì > 255 je uloen v registru BX (> DOS3.00)
              BX = 16-bitovı kód zemì (pokud je AL = FFH) (> DOS 3.00)
              DS:DX = ukazatel na vyrovnávací pamì (32 resp. 34 bajtù)
              DX = FFFFH pro nastavení kódu zemì v AL resp. BX (> DOS 3.00)

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   02H (2) - soubor nenalezen (není tabulka pro spec. zemi)
              BX = kód zemì (pokud je zadán AL = 0)
              naplní tab. na adrese DS:DX národnostnì závislımi informacemi

    Funkce  navrací  (pokud  je  v  DS:DX  ukazatel  na  vyrovnávací pamì)
národnostnì  závislé informace pro implicitní zemi (AL = 00H; v AL resp. BX
pøitom  navrací  kód  zemì)  nebo  pro specifikovanou zemi (AL = kód zemì -
pouze  verze  DOS  > 2.01) nebo umoòuje specifikovat novou implicitní zemi
(pokud  je  DX  =  FFFFH; v AL resp. v BX je nastaven novı kód zemì - pouze
verze  DOS  > 3.00 - nebo je AL=FFH a kód zemì je uloen v BX). Normálnì je
kód zemì nastaven v souboru CONFIG.SYS pøíkazem COUNTRY.

    Pro  kódy  zemì  vìtší  ne 254 (FDH) zadejte v registru AL hodnotu FFH
(255) a kód zemì uveïte v registru BX (pouze verze DOS > 3.00).

    Informace  navrácená  na  adrese  DS:DX  pro  DOS  verze  3.00  a vyšší
(34-bajtová tabulka) má následující strukturu:
 
+------------+-------+---------------------------------------------------+
|   offset   | bajtù |         vıznam                                    |
+------------+-------+---------------------------------------------------+
|  00H ( 0)  |   2   |    formát data (viz následující tabulka)          |
|  02H ( 2)  |   5   |    znak mìny (øetìzec ASCIIZ)                     |
|  07H ( 7)  |   2   |    oddìlovaè tisícù (øetìzec ASCIIZ)              |
|  09H ( 9)  |   2   |    oddìlovaè desetinnıch míst (øetìzec ASCIIZ)    |
|  0BH (11)  |   2   |    oddìlovaè data (øetìzec ASCIIZ)                |
|  0DH (13)  |   2   |    oddìlovaè èasu (øetìzec ASCIIZ)                |
|  0FH (15)  |   1   |    formát mìny (viz dále uvedená tabulka)         |
|  10H (16)  |   1   |    poèet vıznamnıch desetinnıch èíslic v mìnì     |
|  11H (17)  |   1   |    formát èasu (bit0=0 - 12 hod; bit0=1 - 24 hod) |
|  12H (18)  |   4   |    ukazatel na FAR porceduru, která provádí       |
|            |       |      pøíp. mapování znakù pro specifikovanou zemi |
|  16H (22)  |   2   |    oddìlovaè seznamu dat (øetìzec ASCIIZ)         |
|  18H (24)  |  10   |    rezervováno                                    |
+------------+-------+---------------------------------------------------+

Moné formáty data:
  +------------+----------+--------------------------------+
  |   hodnota  |   zemì   |    formát zobrazení data       |
  +------------+----------+----------+----------+----------+
  |   00H (0)  |   USA    |  mìsíc   |   den    |   rok    |
  |   01H (1)  |  Evropa  |   den    |  mìsíc   |   rok    |
  |   02H (2)  | Japonsko |   rok    |  mìsíc   |   den    |
  +------------+----------+----------+----------+----------+

Hodnota poloky formátu mìny:
  +------------+---------------------------------------------------------+
  |   hodnota  |            vıznam                                       |
  +------------+---------------------------------------------------------+
  |   00H (0)  | symbol mìny pøedchází hodnotu; mezi symbolem a hodnotou |
  |            | není ádná mezera                                       |
  |   01H (1)  | symbol mìny následuje za hodnotou; mezi symbolem a      |
  |            | hodnotou není ádná mezera                              |
  |   02H (2)  | symbol mìny pøedchází pøed hodnotou; mezi symbolem a    |
  |            | hodnotou je jedna mezera                                |
  |   03H (3)  | symbol mìny následuje za hodnotou; mezi symbolem a      |
  |            | hodnotou je jedna mezera                                |
  |   04H (4)  | symbol mìny nahrazuje oddìlovaè desetinnıch míst (pouze |
  |            | DOS verze 3.2 a vyšší)                                  |
  +------------+---------------------------------------------------------+

    Rutina mapování znakù DOS (CaseMap), její adresa (jako segment:offset)
se  navrací  s  národnostnì závislımi informacemi, pøevádí znaky s hodnotou
80H  a  FFH  na  jejich  ekvivalenty velkıch písmen. K pouití této rutiny
umístìte  nejdøíve  mapovanı  znak  do registru AL. Potom proveïte vzdálené
volání  FAR  CALL  na  tuto  rutinu. V registru AL bude navrácen velkı znak
ekvivalentní  mapovanému  znaku. Napø. povel DOS SORT pouívá tuto rutinu k
pøiøazení  kódu "A" a "a" znakùm ï, ä, Ï, , Ä, Á,  a á (tyto znaky jsou v
standardní tabulce znakù IBM zobrazovány jako národní verze znakù A).

    Informace  navrácená  na  adrese  DS:DX  pro DOS verze 2.x (32-bajtová
tabulka) má následující strukturu:
 
+------------+-------+---------------------------------------------------+
|   offset   | bajtù |         vıznam                                    |
+------------+-------+---------------------------------------------------+
|  00H ( 0)  |   2   |    formát data a èasu (viz následující tabulka)   |
|  02H ( 2)  |   ?   |    znak mìny (øetìzec ASCIIZ)                     |
|   ?H ( ?)  |   ?   |    oddìlovaè tisícù (øetìzec ASCIIZ)              |
|   ?H ( ?)  |   ?   |    oddìlovaè desetinnıch míst (øetìzec ASCIIZ)    |
|   ?H ( ?)  |   ?   |    rezervováno (doplnìk do 32 bajtù)              |
+------------+-------+---------------------------------------------------+
   - øetìzce následují ihned za sebou

Moné formáty data a èasu:
  +------------+----------+-----------------+------------------------+
  |   hodnota  |   zemì   |  zobrazení data |     zobrazení èasu     |
  +------------+----------+-----------------+------------------------+
  |   00H (0)  |   USA    |  mìsíc/den/rok  |  hodina:minuta:sekunda |
  |   01H (1)  |  Evropa  |  den/mìsíc/rok  |  hodina:minuta:sekunda |
  |   02H (2)  | Japonsko |  rok:mìsíc:den  |  hodina:minuta:sekunda |
  +------------+----------+-----------------+------------------------+


         Kódy zemí:
+-----------+--------------+------+--------+-----------+----------------+-+
|  kód zemì |     zemì     | kláv.|  datum |   èas     |     mìna       |d|
+-----------+--------------+------+--------+-----------+----------------+-+
|  3DH ( 61)|Austrálie     |      |DD-MM-RR|13:00:00   |   $1,000.00    |,|
|  20H ( 32)|Belgie        |      |DD/MM/RR|13:00:00   |    1 000,00 F  |;|
|0352H (850)|Èeskoslovensko|keybCS|DD.MM.RR|13.00.00   |    1 000,00 Kès|;|
|  2DH ( 45)|Dánsko        |      |DD/MM/RR|13.00:00   |    1.000,00 DKR|;|
|0166H (358)|Finsko        |      |DD-MM-RR|13:00:00   |    1 000,00 MK |;|
|  21H ( 33)|Francie       |keybFR|DD/MM/RR|13:00:00   |    1 000,00 F  |;|
|  27H ( 39)|Itálie        |keybIT|DD/MM/RR|13:00:00   |    1.000,Lit.  |;|
|03CCH (972)|Izrael        |      |DD/MM/RR|13:00:00   |  Ö 1,000.00    |,|
|  02H (  2)|Kanada        |      |RR-MM-DD|13:00:00   |    1 000,00 $  |;|
|0311H (785)|Middle East   |      |DD/MM/RR|01:00:00 PM|    1.000,000 $ |;|
|  31H ( 49)|Nìmecko       |keybGR|DD.MM.RR|13.00.00   |  DM1.000,00    |;|
|  1FH ( 31)|Nizozemsko    |      |DD-MM-RR|13:00:00   |   1.000,00    |;|
|  2FH ( 47)|Norsko        |      |DD/MM/RR|13.00.00   | KR 1.000,00    |;|
|015FH (351)|Portugalsko   |      |DD/MM/RR|13:00:00   |    1.000$00    |;|
|  22H ( 34)|Španìlsko     |keybSP|DD/MM/RR|13:00:00   |    1.000,00 Ø  |;|
|  2CH ( 44)|Spojené král. |keybUK|DD-MM-RR|13:00:00   |   ¼1,000.00    |,|
|  01H (  1)|Spojené státy |      |MM-DD-RR|01:00:00 PM|   $1,000.00    |,|
|  2EH ( 46)|Švédsko       |      |RR-MM-DD|13.00.00   |SEK 1.000,00    |;|
|  29H ( 41)|Švıcarsko     |      |DD.MM.RR|13.00.00   | Fr 1,000.00    |,|
+-----------+--------------+------+--------+-----------+----------------+-+
 d = oddìlovaè vıpisu dat

Pozn.: Verze operaèního systému DOS 2.00 nemìla tuto funkci plnì obsazenou,
       poskytovala  pouze národnostnì závislì informace pro implicitní zemi
       (s  omezenou  tabulkou).  Verze  DOS  2.01  ji  umoòuje poskytnutí
       národnostních informací i o jinıch zemích. Verze > DOS 3.00 umoòuje
       pouívat  èísla  kódù zemí vìtší ne 255 a nastavovat implicitní kód
       zemì.






 F u n k c e   3 9 H   ( 5 7 ) - vytvoøení adresáøe (MKDIR)

    vstup:    AH = 39H
              DS:DX = ukazatel na jméno adresáøe k vytvoøení (øet. ASCIIZ)

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   03H - cesta nenalezena
                   05H - poadavek odmítnut nebo adresáø ji existuje

    Funkce  39H  (MKDIR)  vytváøí  podadresáø, jeho cesta je specifikována
pomocí  øetìzce  ASCIIZ  na  adrese  DS:DX.  Délka øetìzce je omezena na 64
znakù.  Pokud funkce není schopna vytvoøit adresáø, nastaví pøíznak pøenosu
CF a navrátí chybovı kód v registru AX.

   Pøi práci v síti vyaduje tato funkce pøístupová práva vytváøení CREATE.

Pozn.: Jméno adresáøe mùe obsahovat oznaèení disku.

       Pokud nìkterı z adresáøù v cestì neexistuje, adresáø se nevytvoøí.

       Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).




 F u n k c e   3 A H   ( 5 8 ) - zrušení adresáøe (RMDIR)

    vstup:    AH = 3AH
              DS:DX = ukazatel na jméno adresáøe k zrušení (øetìzec ASCIIZ)

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   03H ( 3) - cesta nenalezena
                   05H ( 5) - poadavek odmítnut (adresáø není prázdnı)
                   10H (16) - nelze zrušit aktivní adresáø

    Funkce 3AH (RMDIR) ruší podadresáø, jeho cesta je specifikována pomocí
øetìzce ASCIIZ na adrese DS:DX. Délka øetìzce je omezena na 64 znakù. Pokud
funkce  není  schopna  zrušit adresáø, nastaví pøíznak pøenosu CF a navrátí
chybovı kód v registru AX.

   Pøi práci v síti vyaduje tato funkce pøístupová práva vytváøení CREATE.

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).





 F u n k c e   3 B H   ( 5 9 ) - zmìna adresáøe (CHDIR)

    vstup:    AH = 3BH
              DS:DX = ukazatel na jméno nového adresáøe (øetìzec ASCIIZ)

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   03H ( 3) - cesta nenalezena

    Funkce  3BH  (CHDIR) zmìní aktivní adresáø na novı adresáø, jeho cesta
je  specifikována  pomocí  øetìzce ASCIIZ na adrese DS:DX. Délka øetìzce je
omezena na 64 znakù. Pokud funkce není schopna nalézt novı adresáø, nastaví
pøíznak  pøenosu  CF a navrátí chybovı kód v registru AX (a adresáø zùstane
nezmìnìn).

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Oznaèení  nové  cesty  mùe obsahovat oznaèení disku (zmìní se cesta
       pro danı disk).





 F u n k c e   3 C H   ( 6 0 ) - vytvoøení souboru (CREAT)

    vstup:    AH = 3CH
              CX = atributy souboru
              DS:DX = ukazatel na jméno nového souboru (øetìzec ASCIIZ)

    vıstup:   AX = identifikátor souboru (pokud není CF nastaven)
                 = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   03H ( 3) - cesta nenalezena
                   04H ( 4) - není  volnı  ádnı identifikátor souboru (tj.
                              je otevøeno pøíliš mnoho souborù)
                   05H ( 5) - poadavek  odmítnut  (soubor má ochranu proti
                              zápisu nebo je základní adresáø plnı)

    Funkce  3CH  otevøe soubor, jeho jméno je specifikováno pomocí øetìzce
ASCIIZ  na  adrese DS:DX. Pokud soubor ještì neexistuje, vytvoøí jej. Pokud
soubor  se specifikovanım jménem ji existuje, zkrátí jej na nulovou délku,
tj.  zruší všechna stará data ze souboru (!). Soubor je otevøen pro ètení i
zápis.

   Pøi práci v síti vyaduje tato funkce pøístupová práva vytváøení CREATE.

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Oznaèení  nové  cesty  mùe obsahovat oznaèení disku (zmìní se cesta
       pro danı disk).

       Registr CX specifikuje atributy vytváøeného souboru:
         +----------+-------------------------------+
         |    CX    | specifikované atributy        |
         +----------+-------------------------------+
         |  00H (0) | normální soubor               |
         |  01H (1) | soubor pouze pro ètení (R/O)  |
         |  02H (2) | skrytı soubor (HID)           |
         |  04H (4) | systémovı soubor              |
         +----------+-------------------------------+
         - souètem hodnot mùete atributy kombinovat (blíe viz "Adresáøová
           poloka")

       Informace mùe bıt zapisována i do souboru vytvoøeného v módu "pouze
       ètení".  Ovšem  pøi  pouití  této  funkce  k  otevøení existujícího
       souboru s nastavenım pøíznakem "pouze ètení" bude generována chyba.

       Ke zmìnì atributù souboru lze pouít funkci CHMOD (43H).




 F u n k c e   3 D H   ( 6 1 ) - otevøení souboru

    vstup:    AH = 3DH
              AL = mód otevøení
              DS:DX = ukazatel na jméno souboru (øetìzec ASCIIZ)

    vıstup:   AX = identifikátor souboru (pokud není CF nastaven)
                 = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H ( 1) - neplatné èíslo funkce
                   02H ( 2) - soubor nenalezen
                   03H ( 3) - cesta nenalezena
                   04H ( 4) - není   volnı   ádnı   identifikátor  souboru
                              (pøíliš mnoho otevøenıch souborù)
                   05H ( 5) - poadavek  odmítnut
                   0CH (12) - mód otevøení neplatnı

    Funkce  3DH  otevøe  soubor  (a  pøiøadí mu identifikaèní slovo), jeho
jméno  je  specifikováno  pomocí  øetìzce ASCIIZ na adrese DS:DX s pouitím
bajtu  "mód  otevøení"  k  urèení,  jakım  zpùsobem bude provádìn k souboru
pøístup.  Funkce otevøe jakıkoliv existující soubor vèetnì skrytıch souborù
a nastaví velikost záznamu na 1·bajt.

Kódování módù otevøení v AL:
 +---+---+---+---+---+---+---+---+-----------------+---------------------+
 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |  mód otevøení   |       poznámka      |
 +---+---+---+---+---+---+---+---+-----------------+---------------------+
 | . | . | . | . | . | A | A | A |  mód pøístupu   | pøístup ètení/zápis |
 | . | . | . | . | R | . | . | . |  rezervováno    | vdy 0              |
 | . | S | S | S | . | . | . | . |  mód sdílení    | v DOS 2 musí bıt 0  |
 | I | . | . | . | . | . | . | . |  pøíznak podílu | v DOS 2 musí bıt 0  |
 +---+---+---+---+---+---+---+---+-----------------+---------------------+

Mód pøístupu (nejniší tøi bity registru AL):
 +---+---+---+-----+---------------------------------------+
 | 2 | 1 | 0 | hex |             mód pøístupu              |
 +---+---+---+-----+---------------------------------------+
 | 0 | 0 | 0 |  0  |  pøístup pouze ke ètení souboru       |
 | 0 | 0 | 1 |  1  |  pøístup pouze k zápisu do souboru    |
 | 0 | 1 | 0 |  2  |  pøístup ke ètení i zápisu do souboru |
 +---+---+---+-----+---------------------------------------+

Mód sdílení (bity 4, 5 a 6 registru AL) - pouze DOS 3.0 a vyšší:

    Tyto  bity  øídí zpùsob, jakım mohou ostatní uivatelé v síti otevøít a
pouívat soubor pokud jej otevøete. Jsou povolená následující nastavení:

 +---+---+---+-----+------------------------------+
 | 6 | 5 | 4 | hex |         mód sdílení          |
 +---+---+---+-----+------------------------------+
 | 0 | 0 | 0 |  0  |  kompatibilní mód            |
 | 0 | 0 | 1 |  1  |  zamítnutí módu ètení/zápis  |
 | 0 | 1 | 0 |  2  |  zamítnutí módu pouze zápis  |
 | 0 | 1 | 1 |  3  |  zamítnutí módu pouze ètení  |
 | 1 | 0 | 0 |  4  |  nezamítnut ádnı mód        |
 +---+---+---+-----+------------------------------+

Pøíznak podílu (bit 7 registru AL) - pouze DOS 3.0 a vyšší:

    Pøíznak  podílu  (bit  7)  specifikuje,  zda se budou podílet podøazené
procesy  na  pouívání  tohoto  souboru.  Pokud  je  bit  7 vynulován, mají
podøazené  procesy  automaticky  pøístup  k  tomuto souboru. Pokud je bit 7
nastaven,  soubor  se  automaticky neovolòuje pro podøízenı proces. Avšak ,
jako  jakıkoliv  jinı  proces,  mùe  poadovat pøístup k souboru podøízenı
proces na bázi sdílení.

 +---+------------------------------------------+
 | 7 |              pøíznak podílu              |
 +---+------------------------------------------+
 | 0 |  na souboru se podílí podøízenı proces   |
 | 1 |  podøízenı proces se na souboru nepodílí |
 +---+------------------------------------------+

Zpøístupnìní otevøeného souboru podøazenım procesùm:

    Je-li  soubor  jednou  otevøen hlavním procesem, je zpøístupnìní tohoto
souboru  jinım  procesùm  urèeno  módem sdílením i módem pøístupu pùvodního
procesu,  stejnì  tak  jako  módem  sdílením  a  módem pøístupu podøazeného
procesu.

    1.- Soubor  je  poprvé  otevøen  v kompatibilním módu sdílení, pokud je
        otevøen:

         - pøes funkce pouívající FCB
         - pøes funkce vyadující práva vytváøení CREATE
         - pøes volanou funkci, ve které je kompatibilní mód specifikován

        Soubor  v  kompatibilním  módu  mùe  bıt  otevøen  jedním procesem
        libovolnìkrát,  pokud  soubor  není  dosud  otevøen  pod nìkterım z
        ostatních ètyø módù sdílení. Avšak pokud má soubor nastaven atribut
        "pouze  ètení"  a  je  v  souèasnosti  otevøen  v  módu  sdílení se
        zamítnutím  zápisu,  mùe  bıt tento soubor otevøen v kompatibilním
        módu s pøístupem ètení.

    2.- Soubor je otevøen v jednom z jinıch módù sdílení.

+---------------------------------+--------------------------------------+
| soubor je poprvé otevøen v módu | mùe bıt opakovanì otevøen v módu    |
+---------------------------------+--------------------------------------+
| zamítnutí módu "ètení/zápis",   | nemùe bıt opakovanì otevøen         |
| pøístup "pouze ètení"           |                                      |
|    (AL = X0010000)              |                                      |
+---------------------------------+--------------------------------------+
| zamítnutí módu "ètení/zápis",   | nemùe bıt opakovanì otevøen         |
| pøístup "pouze zápis"           |                                      |
|    (AL = X0010001)              |                                      |
+---------------------------------+--------------------------------------+
| zamítnutí módu "ètení/zápis",   | nemùe bıt opakovanì otevøen         |
| pøístup "ètení/zápis"           |                                      |
|    (AL = X0010010)              |                                      |
+---------------------------------+--------------------------------------+
| zamítnutí módu "zápis",         | zamítnutí módu "zápis", pouze ètení  |
| pøístup "pouze ètení",          |       (AL = X0100000)                |
|    (AL = X0100000)              | nezamítnut ádnı mód, pouze ètení    |
|                                 |       (AL - X1000000)                |
+---------------------------------+--------------------------------------+
| zamítnutí módu "zápis",         | zamítnutí módu "ètení", pouze ètení  |
| pøístup "pouze zápis",          |       (AL = X0110000)                |
|    (AL = X0100001)              | nezamítnut ádnı mód, pouze ètení    |
|                                 |       (AL = X1000000)                |
+---------------------------------+--------------------------------------+
| zamítnutí módu "zápis",         | nezamítnut ádnı mód, pouze ètení    |
| pøístup "ètení/zápis"           |       (AL = X1000000)                |
|    (AL = X0100010)              |                                      |
+---------------------------------+--------------------------------------+
| zamítnutí módu "ètení",         | zamítnutí módu "zápis", pouze zápis  |
| pøístup "pouze ètení",          |       (AL = X0100001)                |
|    (AL = X0110000)              | nezamítnut ádnı mód, pouze zápis    |
|                                 |       (AL - X1000001)                |
+---------------------------------+--------------------------------------+
| zamítnutí módu "ètení",         | zamítnutí módu "ètení", pouze zápis  |
| pøístup "pouze zápis",          |       (AL = X0110001)                |
|    (AL = X0110001)              | nezamítnut ádnı mód, pouze zápis    |
|                                 |       (AL - X1000001)                |
+---------------------------------+--------------------------------------+
| zamítnutí módu "ètení",         | nezamítnut ádnı mód, pouze zápis    |
| pøístup "ètení/zápis"           |       (AL = X1000001)                |
|    (AL = X0110010)              |                                      |
+---------------------------------+--------------------------------------+
| nezamítnut ádnı mód,           | zamítnutí módu "zápis", pouze ètení  |
| pøístup "pouze ètení"           |       (AL = X0100000)                |
|    (AL = X1000000)              | zamítnutí módu "zápis", pouze zápis  |
|                                 |       (AL = X0100001)                |
|                                 | zamítnutí módu "zápis", ètení/zápis  |
|                                 |       (AL = X0100010)                |
|                                 | nezamítnut ádnı mód, pouze ètení    |
|                                 |       (AL = X1000000)                |
|                                 | nezamítnut ádnı mód, pouze zápis    |
|                                 |       (AL = X1000001)                |
|                                 | nezamítnut ádnı mód, ètení/zápis    |
|                                 |       (AL = X1000010)                |
+---------------------------------+--------------------------------------+
| nezamítnut ádnı mód,           | zamítnutí módu "ètení", pouze ètení  |
| pøístup "pouze zápis"           |       (AL = X0110000)                |
|    (AL = X1000001)              | zamítnutí módu "ètení", pouze zápis  |
|                                 |       (AL = X0110001)                |
|                                 | zamítnutí módu "ètení", ètení/zápis  |
|                                 |       (AL = X0110010)                |
|                                 | nezamítnut ádnı mód, pouze ètení    |
|                                 |       (AL = X1000000)                |
|                                 | nezamítnut ádnı mód, pouze zápis    |
|                                 |       (AL = X1000001)                |
|                                 | nezamítnut ádnı mód, ètení/zápis    |
|                                 |       (AL = X1000010)                |
+---------------------------------+--------------------------------------+
| nezamítnut ádnı mód,           | ádné zamítnutí, pouze ètení         |
| pøístup "ètení/zápis"           |       (AL = X1000000)                |
|    (AL = X1000010)              | ádné zamítnutí, pouze zápis         |
|                                 |       (AL = X1000001)                |
|                                 | ádné zamítnutí, ètení/zápis         |
|                                 |       (AL = X1000010)                |
+---------------------------------+--------------------------------------+


Pozn.: Soubory  konèící  dvojteèkou  (zaøízení)  nelze  voláním této funkce
       otevøít.

       Pro  módy  sdílení  musí bıt pro tuto funkci, aby pracovala, naètena
       obsluha sdílení souborù.

       Podøízené  procesy, které se podílejí na souborech, se také podílejí
       na jejich omezeních sdílení a pøístupù.



 F u n k c e   3 E H   ( 6 2 ) - uzavøení identifikátoru souboru

    vstup:    AH = 3EH
              BX = identifikátor souboru

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   06H (6) - neplatnı identifikátor souboru

    Funkce  3EH  vyprázdní  vyrovnávací pamì souboru, uzavøe soubor, zruší
identifikátor souboru a uloí informace do adresáøe.

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).





 F u n k c e   3 F H   ( 6 3 ) - ètení ze soub./zaøíz. s pouitím id. soub.

    vstup:    AH = 3FH
              BX = identifikátor souboru
              CX = poèet bajtù, které mají bıt pøeèteny
              DS:DX = adresa vyrovnávací pamìti, kam jsou data uloena

    vıstup:   AX = poèet skuteènì pøeètenıch bajtù (CF=0)
                 = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   05H (5) - poadavek odmítnut
                   06H (6) - neplatnı identifikátor souboru

    Funkce ète data ze souboru nebo zaøízení, jeho identifikátor je uloen
v  registru  BX,  do  pamìti od adresy DS:DX. Data jsou ètena od polohy, na
kterou  ukazuje  ukazatel  souboru.  Ukazatel  souboru  se  zvıší  o  poèet
pøeètenıch bajtù.

    Pøi práci v síti vyaduje tato funkce pøístupová práva ètení READ.

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Pokud  není pøíznak  pøenosu  CF   nastaven  a registr AX = 0, potom
       ukazatel souboru byl nastaven na konec souboru.

       Pokud  není  pøíznak  pøenosu CF nastaven a poèet pøeètenıch bajtù v
       registru  AX je menší ne poadovanı poèet bajtù (registr CX), potom
       funkce pøi ètení narazila na konec souboru.

       Pomocí  funkce  42H  mùete  pøed  ètením pøemístit ukazatel souboru
       jinam, èím mùete èíst data z kteréhokoliv místa v souboru.

       Pokud je specifikována klávesnice, ète tato funkce buï specifikovanı
       poèet bajtù nebo všechny bajty a po pøíští znak CR (klávesa Return,
       Enter),  je-li  poèet  menší.  (pokud je poèet specifikovanıch bajtù
       alespoò o dvì vìtší ne poèet zadanıch znakù, bude jako poslední dva
       znaky  navrácen  pár  CR/LF  (kódy  0DH,  0AH) a bude poèítán za dva
       bajt.)






 F u n k c e   4 0 H   ( 6 4 ) - zápis do soub./zaø. s pouitím ident.soub.

    vstup:    AH = 40H
              BX = identifikátor souboru
              CX = poèet bajtù, které mají bıt zapsány
              DS:DX = adresa vyrovnávací pamìti, odkud jsou data zapisována

    vıstup:   AX = poèet skuteènì zapsanıch bajtù (CF=0)
                 = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   05H (5) - poadavek odmítnut
                   06H (6) - neplatnı identifikátor souboru

    Funkce zapisuje data z pamìti od adresy DS:DX do souboru nebo zaøízení,
jeho  identifikátor  je  uloen  v  registru  BX.  Data jsou zapisována od
polohy,  na  kterou  ukazuje  ukazatel souboru. Ukazatel souboru se zvıší o
poèet zapsanıch bajtù.

    Pøi práci v síti vyaduje tato funkce pøístupová práva zápisu WRITE.

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Pokud  se  zaplní disk, není navrácen ádnı chybovı kód (tj. CF není
       nastaven)   avšak   je  zapsáno  ménì  bajtù  ne  bylo  poadováno.
       Kontrolujte   proto   po   návratu  z  funkce  vznik  této  situtace
       testováním,  zda  není  obsah registru AX menší ne poadovanı poèet
       bajtù v CX.

       Pomocí  funkce  42H  mùete  pøed zápisem pøemístit ukazatel souboru
       jinam, èím mùete zapisovat data do kteréhokoliv místa v souboru.

       Soubor  mùete  zkrátit tak, e pøesunete ukazatel souboru na pozici
       nového  konce  souboru  (pomocí funkce 42H) a vyvoláte tuto funkci s
       nastavenım nulovım poètem bajtù k zápisu (CX = 0).

       Pokus  o  zápis  do souboru oznaèeného jako "pouze ètení" vygeneruje
       chybovı kód 5 "poadavek odmítnut".





 F u n k c e   4 1 H   ( 6 5 ) - zrušení souboru (UNLINK)

    vstup:    AH = 41H
              DS:DX = ukazatel na jméno souboru (øetìzec ASCIIZ)

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   02H (2) - soubor nenalezen
                   03H (3) - cesta nenalezena
                   05H (5) - poadavek odmítnut (soubor je R/O)

    Funkce   41H   zruší  poloku  adresáøe  pro  soubor,  jeho  jméno  je
specifikováno  pomocí  øetìzce ASCIIZ na adrese DS:DX. Ve specifikaci cesty
(jména souboru) nelze pouít (na rozdíl od funkce 13H) nahrazovací znaky (?
a *).

   Pøi práci v síti vyaduje tato funkce pøístupová práva vytváøení CREATE.

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Ke  zrušení  souboru  oznaèeného  atributem  "pouze  ètení" nejdøíve
       zrušte tento atribut pomocí funkce 43H.




 F u n k c e   4 2 H   ( 6 6 ) - pøemístìní ukazatele souboru (LSEEK)

    vstup:    AH = 42H
              BX = identifikátor souboru
              CX:DX = novı offset v bajtech (32-bitové celé èíslo se znam.)
              AL = kód módu
                   00H (0) - pøesunutí  ukazatele  souboru  CX:DX  bajtù od
                             zaèátku souboru
                   01H (1) - pøesunutí  ukazatele  souboru o CX:DX bajtù od
                             souèasné pozice
                   02H (2) - pøesunutí  ukazatele  souboru o CX:DX bajtù od
                             konce souboru

    vıstup:   DX:AX = nová pozice ukazatele souboru (32-bit.èíslo se znam.)
              nebo AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H (1) - neplatnı kód módu
                   06H (6) - neplatnı identifikátor souboru

    Funkce  zmìní  logickou  pozici  ukazatele  pro operace ètení/zápis pro
specifikovanı  soubor  zvıšením  nebo  sníením  hodnoty ukazatele souboru.
Offset,  kterı se pøièítá k ukazateli souboru se pøedává v registrovém páru
CX:DX  jako  32-bitové celé èíslo se znaménkem; vıznamnìjší èást offsetu je
uloena  v  registru  CX.  Kód  módu,  specifikovanı v AL, indikuje, zda se
offset  uloenı v CX:DX vztahuje k zaèátku souboru (mód 0), souèasné pozici
ukazatele souboru (mód 1) nebo ke konci souboru (mód 2).

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Nezávisle  na tom, kterı mód je v AL specifikován, pozitivní hodnota
       offsetu  v  CX:DX  zpùsobí  vdy zvıšení hodnoty ukazatele souboru a
       negativní  zpùsobí sníení hodnoty. Proto v módu 2 pozitivní hodnota
       offsetu CX:DX zpùsobí pøesunutí ukazatele souboru za konec souboru.

       Chcete-li  pøesunout  ukazatel  na  konec souboru nebo zjistit délku
       souboru, pouijte kód módu 2 a offset CX:DX = 0

       Ukazatel  souboru  je moné pøesunout na pozici leící pøed zaèátkem
       souboru  nebo  za  koncem  souboru. Pøesunutí ukazatele pøed zaèátek
       souboru  sice  nezpùsobí  hlášení  chyby,  avšak  bude chybná pøíští
       operace ètení nebo zápisu.

       Soubor  mùe  bıt  rozšíøen  pøesunutím  ukazatele  souboru za konec
       souboru a zápisem jednoho nebo více bajtù dat na tuto novou pozici.

       Soubor mùe bıt zkrácen pøesunutím ukazatele souboru na novou pozici
       poadovaného  konce souboru a provedením operace zápisu (funkce 40H)
       s nastavenım nulovım poètem bajtù k zápisu (CX = 0).





 F u n k c e   4 3 H   ( 6 7 ) - poskytnutí/nastavení atrib. soub. (CHMOD)

    vstup:    AH = 43H
              AL = 00H (0) - poskytnutí atributù souboru
                   01H (1) - nastavení atributù souboru
              CX = poadované atributy (pouze pokud je AL=01H - nastavení)
              DS:DX = ukazatel na specifikaci souboru (øetìzec ASCIIZ)

    vıstup:   CX = atributy souboru (pokud je AL=00H - poskytnutí atributù)
              AX = kód chyby (pokud je CF = 1) - viz funkce DOS 59H
                   01H (1) - neplatnı kód funkce
                   02H (2) - soubor nenalezen
                   03H (3) - cesta nenalezena
                   05H (5) - poadavek odmítnut

    Funkce  navrací  nebo  nastavuje  bajt atributù souboru specifikovaného
souboru.  K  urèení souèasnıch atributù ulote do registru AL hodnotu 00H -
atributy  budou  navráceny  v  registru  CX. K nastavení atributù ulote do
registru AL hodnotu 01H a do registru CX poadované atributy.

    Pokud  je  poadována  jiná zmìna ne archivního bitu pøi práci v síti,
jsou poadována pøístupová práva pro vytváøení (CREATE).

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Registr CX specifikuje atributy souboru tímto zpùsobem:
           +-----------+---------------------------------+
           |    CX     |   specifikovanı atribut         |
           +-----------+---------------------------------+
           |    00H    |   normální soubor               |
           |    01H    |   pouze ètení souboru (R/O)     |
           |    02H    |   skrytı soubor (HID)           |
           |    04H    |   systémovı soubor (SYS)        |
           |    20H    |   archivní soubor (ARC)         |
           +-----------+---------------------------------+
           - souètem tìchto hodnot lze atributy kombinovat

       Nastavení  jinıch  bitù  ne  které  jsou  uvedeny vygeneruje chybu.
       Atribut  adresáøe  nelze  zmìnit  ,  avšak mùete pøidat nebo zrušit
       ostatní bity bajtu atributù adresáøe. Staèí, kdy pomocí této funkce
       specifikujete bajt atributù mající nastaveny všechny poadované bity
       pro adresáø kromì bitu 4 (adresáøovı bit).





 F u n k c e   4 4 H   ( 6 8 ) - vstupnì/vıstupní ovládání zaøízení (IOCTL)

    vstup:    AH = 44H
              AL = podfunkce
              BX = identifikátor souboru nebo zaøízení
         nebo BL = èíslo disku (je-li AL = 4,5: 0 = aktivní; 1 = A; atd.)
              CX = poèet bajtù, které mají bıt pøeèteny nebo zapsány
              DS:DX = data nebo adresa vyrovnávací pamìti

    vıstup:   podle podfunkce

    Pøi práci v síti nejsou podfunkce 4400H a 4408H podporovány.

    Funkce  44H  (IOCTL)  je  soubor  podfunkcí (16 podfunkcí v DOS 3.3, 10
podfunkcí  v DOS 3.0, 8 podfunkcí v DOS 2), které slouí k vımìnì informací
mezi  aplikaèním  programem  a  zaøízením  (nebo souborem). Pouze podfunkce
4400H,  4406H  a  4407H  jsou definovány pro soubory. Ve všech pøípadech je
poadovaná podfunkce urèena obsahem registru AL:
 
+----------+--------------------------------------------------------------+
|    AL    |                        podfunkce                             |
+----------+--------------------------------------------------------------+
| 00H ( 0) | poskytnutí informací o zaøízení (navráceno v DX)             |
| 01H ( 1) | nastavení informací o zaøízení (z DX; DH musí bıt 0)         |
| 02H ( 2) | ètení bajtù z øídícího kanálu zaøízení do pamìti na          |
|          | adresu DS:DX (znakové zaøízení)                              |
| 03H ( 3) | zápis bajtù z pamìti na adrese DS:DX do øídícího             |
|          | kanálu zaøízení (znakové zaøízení)                           |
| 04H ( 4) | ètení bajtù z øídícího kanálu zaøízení do pamìti na          |
|          | adresu DS:DX (blokové zaøízení)                              |
| 05H ( 5) | zápis bajtù z pamìti na adrese DS:DX do øídícího             |
|          | kanálu zaøízení (blokové zaøízení)                           |
| 06H ( 6) | poskytnutí vstupního statutu zaøízení                        |
| 07H ( 7) | poskytnutí vıstupního statutu zaøízení                       |
| 08H ( 8) | je blokové zaøízení vımìnné ? (> DOS 3.0)                    |
| 09H ( 9) | je logické zaøízení lokální nebo dálkové ? (> DOS 3.1)       |
| 0AH (10) | je identifikátor lokální nebo dálkovı ? (> DOS 3.1)          |
| 0BH (11) | zmìna èítaèe opakování sdílení (> DOS 3.0)                   |
| 0DH (13) | generování poadavku IOCTL pro blokové zaøízení (> DOS 3.2)  |
| 0EH (14) | poskytnutí logického disku (> DOS 3.2)                       |
| 0FH (15) | nastavení oznaèení logického disku (> DOS 3.2)               |
+----------+--------------------------------------------------------------+

    Jednotlivé  podfunkce  jsou  dále  pospány  podrobnìji  jako samostatné
funkce 44xxH.

Pozn.: Pro soubory jsou definovány pouze podfunkce 4400H, 4406H a 4407H.

       Podfunkce  4400H  a  4408H nejsou podporovány v síovıch zaøízeních.
       Podfunkce  440BH  vyadují sdílení souboru, které se naète do pamìti
       pomocí povelu SHARE.





 F u n k c e   4 4 0 0 H   ( 6 8 - 0 ) - IOCTL: poskytnutí inf. o zaøízení

    vstup:    AH = 44H
              AL = 00H
              BX = identifikátor zaøízení nebo souboru

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
              DX = informace o zaøízení

    Podfunkce 4400H navrací v DX informace o zaøízení. Bit 7 registru DX je
nastaven na 1, pokud je kanálem znakové zaøízení, a je nastaven na 0, pokud
je kanálem blokové zaøízení (diskovı soubor).

    DX pro znakové zaøízení (bit 7 registru DX = 1):
   +------+--------------------------------------------------------------+
   |  bit |                          popis                               |
   +------+--------------------------------------------------------------+
   |   0  |   nastaven, pokud je vstupním zaøízením standardní konzola   |
   |   1  |   nastaven, pokud je vıstupním zaøízením standardní konzola  |
   |   2  |   nastaven, pokud jde o nulové zaøízení                      |
   |   3  |   nastaven, pokud jsou zaøízením hodiny                      |
   |   4  |   nastaven, pokud se jedná o speciální zaøízení              |
   |   5  |   nastaven pro binární mód, nulován pro ASCII mód            |
   |   6  |   nulován, pokud je na vstupu konec souboru (EOF)            |
   |   7  |   nastaven pro indikaci, e se jedná o zaøízení              |
   | 8-13 |   rezervováno                                                |
   |  14  |   nastaven, pokud je mono zaøízení ovládat øídícím øetìzcem |
   |      |   pøes funkce 4402H, 4403H                                   |
   |  15  |   rezervováno                                                |
   +------+--------------------------------------------------------------+

    DX pro blokové zaøízení (bit 7 registru DX = 0):
   +------+--------------------------------------------------------------+
   |  bit |                         popis                                |
   +------+--------------------------------------------------------------+
   |  0-5 |   èíslo blokového zaøízení (A = 0; B = 1; atd.)              |
   |   6  |   nastaven, pokud bylo do kanálu zapisováno                  |
   |   7  |   nulován pro indikaci, e se jedná o blokové zaøízení       |
   | 8-13 |   rezervováno                                                |
   |  14  |   nastaven, pokud je mono zaøízení ovládat øídícím øetìzcem |
   |      |   pøes funkce 4404H a 4405H                                  |
   |  15  |   rezervováno                                                |
   +------+--------------------------------------------------------------+

Pozn.: Stav je definován v okamiku volání systému. Pozdìji, kdy je øízení
       vráceno ze systému, uivateli vrácenı stav ji nemusí pøesnì odráet
       skuteènı okamitı stav zaøízení nebo souboru.



 F u n k c e   4 4 0 1 H   ( 6 8 - 1 ) - IOCTL: nastavení inf. o zaøízení

    vstup:    AH = 44H
              AL = 01H
              BX = identifikátor zaøízení nebo souboru
              DH = 00H
              DL = informace o zaøízení

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H

    Podfunkce 4401H nastavuje informace o zaøízení podle obsahu reg. DX.

   +------+--------------------------------------------------------------+
   |  bit |                          popis                               |
   +------+--------------------------------------------------------------+
   |   0  |   nastaven, pokud je vstupním zaøízením standardní konzola   |
   |   1  |   nastaven, pokud je vıstupním zaøízením standardní konzola  |
   |   2  |   nastaven, pokud jde o nulové zaøízení                      |
   |   3  |   nastaven, pokud jsou zaøízením hodiny                      |
   |   4  |   rezervováno                                                |
   |   5  |   nastaven pro binární mód, nulován pro ASCII mód            |
   |   6  |   nulován, pokud je na vstupu konec souboru (EOF)            |
   |   7  |   nastaven pro indikaci, e se jedná o zaøízení              |
   | 8-15 |   musí bıt 0                                                 |
   +------+--------------------------------------------------------------+

Pozn.: Podfunkce není podporována pro diskové soubory (bloková zaøízení).





 F u n k c e   4 4 0 2 H   ( 6 8 - 2 ) - IOCTL: ètení ze znakového zaøízení

    vstup:    AH = 44H
              AL = 02H
              BX = identifikátor zaøízení
              CX = poèet bajtù, které mají bıt pøeèteny
              DS:DX = data nebo adresa vyrovnávací pamìti

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H (1) - zaøízení nepodporuje øídící øetìzce

    Podfunkce  4402H  ète  CX  datovıch  bajtù  z øídícího kanálu znakového
zaøízení  buï  do  registru  DS:DX nebo do pamìti od adresy DS:DX. Jak jsou
data  ètena  je  definováno driverem zaøízení. Data mohou bıt ètena pouze v
pøípadì, e zaøízení mùe provádìt øídící øetìzce.




 F u n k c e   4 4 0 3 H   ( 6 8 - 3 ) - IOCTL: zápis na znakové zaøízení

    vstup:    AH = 44H
              AL = 03H
              BX = identifikátor zaøízení
              CX = poèet bajtù, které mají bıt zapsány
              DS:DX = data nebo adresa vyrovnávací pamìti

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H (1) - zaøízení nepodporuje øídící øetìzce

    Podfunkce  4403H zapisuje CX datovıch bajtù buï z registru DS:DX nebo z
pamìti  od  adresy  DS:DX na øídící kanál znakového zaøízení. Jak jsou data
zapisována je definováno driverem zaøízení. Data mohou bıt zapisována pouze
v pøípadì, e zaøízení mùe provádìt øídící øetìzce.





 F u n k c e   4 4 0 4 H   ( 6 8 - 4 ) - IOCTL: ètení z blokového zaøízení

    vstup:    AH = 44H
              AL = 04H
              BL = èíslo disku (0 = aktivní disk; 1 = A; 2 = B; atd.)
              CX = poèet bajtù, které mají bıt pøeèteny
              DS:DX = data nebo adresa vyrovnávací pamìti

    vıstup:   AX = poèet pøeètenıch bajtù  (pokud je CF = 0)
                 = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H (1) - zaøízení nepodporuje øídící øetìzce
                   05H (5) - disk je neplatnı

    Podfunkce  4404H  ète  CX  datovıch  bajtù  z øídícího kanálu blokového
zaøízení  buï  do  registru  DS:DX nebo do pamìti od adresy DS:DX. Jak jsou
data  ètena  je  definováno driverem zaøízení. Data mohou bıt ètena pouze v
pøípadì, e zaøízení mùe provádìt øídící øetìzce.





 F u n k c e   4 4 0 5 H   ( 6 8 - 5 ) - IOCTL: zápis na blokové zaøízení

    vstup:    AH = 44H
              AL = 03H
              BL = èíslo disku (0 = aktivní disk; 1 = A; 2 = B; atd.)
              CX = poèet bajtù, které mají bıt zapsány
              DS:DX = data nebo adresa vyrovnávací pamìti

    vıstup:   AX = poèet zapsanıch bajtù  (pokud je CF = 0)
                 = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H (1) - zaøízení nepodporuje øídící øetìzce
                   05H (5) - disk je neplatnı

    Podfunkce  4405H zapisuje CX datovıch bajtù buï z registru DS:DX nebo z
pamìti  od  adresy  DS:DX na øídící kanál blokového zaøízení. Jak jsou data
zapisována je definováno driverem zaøízení. Data mohou bıt zapisována pouze
v pøípadì, e zaøízení mùe provádìt øídící øetìzce.




 F u n k c e   4 4 0 6 H   ( 6 8 - 6 ) - IOCTL: poskytnutí vstup. statutu

    vstup:    AH = 44H
              AL = 06H
              BX = identifikátor souboru nebo zaøízení

    vıstup:   AL = FFH - ne je konec souboru/pokud je zaøízení pøipraveno
              AL = 00H - dosaeno konce souboru/zaøízení není pøipraveno

    Podfunkce  hlásí  vstupní  statut zaøízení nebo souboru. AL navrací buï
hodnotu  FFH  (zaøízení  pøipraveno  nebo  není  ještì  konec souboru) nebo
hodnotu 00H (zaøízení nepøipraveno nebo dosaeno konce souboru).




 F u n k c e   4 4 0 7 H   ( 6 8 - 7 ) - IOCTL: poskytnutí vıstup. statutu

    vstup:    AH = 44H
              AL = 07H
              BX = identifikátor souboru nebo zaøízení

    vıstup:   AL = FFH - ne je konec souboru/pokud je zaøízení pøipraveno
              AL = 00H - dosaeno konce souboru/zaøízení není pøipraveno

    Podfunkce  hlásí  vıstupní statut zaøízení nebo souboru. AL navrací buï
hodnotu  FFH  (zaøízení  pøipraveno  nebo  není  ještì  konec souboru) nebo
hodnotu 00H (zaøízení nepøipraveno nebo dosaeno konce souboru).




 F u n k c e   4 4 0 8 H   ( 6 8 - 8 ) - IOCTL: je zaøízení vımìnné ?

    vstup:    AH = 44H
              AL = 08H
              BL = èíslo disku (0=aktivní; 1=A; atd.)

    vıstup:   AX = 00H - zaøízení je vımìnné
                   01H - zaøízení je pevné
                   0FH - neplatná specifikace disku
                   chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                        01H - je síové zaøízení

    Tato  podfunkce (pouze DOS 3.0 a vyšší verze) indikuje, zda má zaøízení
vımìnné  médium  (jako  je  prunı  disk  nebo vımìnnı kartovı pevnı disk).
Hodnota  00H  registru  AX  znamená,  e  zaøízení  je vımìnné. Hodnota 01H
registru AX znamená, e jde o pevné zaøízení. Pokud je v BL zadána neplatná
specifikace disku, navrací v registru AX chybovı kód 0FH.




 F u n k c e   4 4 0 9 H   ( 6 8 - 9 ) - IOCTL: je log. zaøízení dálkové ?

    vstup:    AH = 44H
              AL = 09H
              BL = èíslo disku (0=aktivní; 1=A; atd.)

    vıstup:   DX = bit 12: 0 - zaøízení je lokální
                           1 - zaøízení je dálkové

    Podfunkce  (pouze DOS 3.1 a vyšší verze) umoòuje urèit, zda je blokové
zaøízení  (specifikované  v BL) pøidrueno k síovému adresáøi. Pro lokální
zaøízení  navrací DX slovo atributù ze záhlaví zaøízení s vynulovanım bitem
12; pro dálková zaøízení navrací DX toto slovo s nastavenım bitem 12.




 F u n k c e   4 4 0 A H   ( 6 8 - 1 0 ) - IOCTL:je ident. dálk. zaøízení ?

    vstup:    AH = 44H
              AL = 0AH
              BX = identifikátor zaøízení

    vıstup:   AX = bit 15: 0 - zaøízení je lokální
                           1 - zaøízení je dálkové

    Podfunkce  (pouze  DOS  3.1  a  vyšší  verze)  umoòuje  urèit,  zda je
identifikátor  zaøízení  (specifikovanı  v  BX)  pro  lokální  nebo dálkové
zaøízení.  Pro  lokální  identifikátor navrací DX slovo atributù ze záhlaví
zaøízení s vynulovanım bitem 15; pro dálková zaøízení navrací DX toto slovo
s nastavenım bitem 15.




 F u n k c e   4 4 0 B H   ( 6 8 - 1 1 ) - IOCTL: èítaè opakování sdílení

    vstup:    AH = 44H
              AL = 0BH
              CX = poèet, kolikrát bude provádìna smyèka prodlevy
              DX = poèet opakování

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H

    Podfunkce  (pouze  pro  DOS 3.0 a vyšší) nastavuje dva parametry, které
pouívá  DOS  k pokusùm o øešení konfliktù pøi sdílení souborù. Specifikuje
v  registru  DX  poèet opakování a v registru CX poèet èasovıch prodlev mezi
jednotlivımi  prùchody  pøi  opakování pokusù o pøístup. Standardní hodnota
nastavení  jsou  3  opakování  a  1  èasová  prodleva.  Pøed  pouitím této
podfunkce musí bıt naèten v pamìti pøíkaz SHARE.




 F u n k c e   4 4 0 D H   ( 6 8 - 1 3 ) - IOCTL:generování poadavku IOCTL

    vstup:    AH = 44H
              AL = 0DH
              BL = èíslo disku (0=aktivní; 1=A; atd.)
              CH = 08H (hlavní kód)
              CL = vedlejší kód:
                        40H - nastavení parametrù zaøízení
                        60H - poskytnutí parametrù zaøízení
                        41H - zápis stopy na logické zaøízení
                        61H - ètení stopy z logického zaøízení
                        42H - formátování a verifikace stopy na log. zaø.
                        62H - verifikace stopy logického zaøízení
              DS:DX = ukazatel na blok parametrù

    Tato  podfunkce (pouze DOS 3.2 a vyšší verze) umoòuje øízení blokového
zaøízení na nízké úrovni.




 F u n k c e   4 4 0 E H   ( 6 8 - 1 4 ) - IOCTL:poskytnutí logického disku

    vstup:    AH = 44H
              AL = 0EH
              BL = èíslo disku (0=aktivní; 1=A; atd.)

    vıstup:   AL = 00H pokud je blok. zaøízení pøiøazen pouze jeden znak
                 = onaèení disku pouívané jako poslední (1=A, atd.)
              AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H

    Podfunkce  (pouze  DOS  verze  3.2  a  vyšší)  navrací  oznaèení  disku
pouívané jako nejposlednìjší pro blokové zaøízení, které má více ne jedno
oznaèení   (logickı  disk).  Napøíklad  prunı  disk  v  systému  s  jednou
mechanikou  mùe  bıt  popsán buï jako A: nebo jako B:. Tato funkce oznámí,
zda má blokové zaøízení více ne jedno oznaèení, a pokud tomu tak je, které
oznaèení  zaøízení  bylo  pouito  jako  nejposlednìjší  (to umoòuje napø.
oznámit  uivateli,  aby  vymìnil  diskety  v mechanice, pokud je v systému
poadován pøístup na jinou disketu, ne která byla dosud pouívána).




 F u n k c e   4 4 0 F H   ( 6 8 - 1 5 ) - IOCTL: nastavení logického disku

    vstup:    AH = 44H
              AL = 0FH
              BL = èíslo disku (0=aktivní; 1=A; atd.)

    vıstup:   AL = 00H pokud je blok. zaøízení pøiøazen pouze jeden znak
                 = nejvyšší onaèení blokového zaøízení (1=A, atd.)
              AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H

    Podfunkce  (pouze  DOS  verze  3.2  a  vyšší)  nastavuje oznaèení disku
pouívané jako nejposlednìjší pro blokové zaøízení, které má více ne jedno
oznaèení   (logickı  disk).  Napøíklad  prunı  disk  v  systému  s  jednou
mechanikou  mùe  bıt  popsán buï jako A: nebo jako B:. Tato funkce oznámí,
zda  má  blokové  zaøízení  více  ne  jedno oznaèení, a pokud tomu tak je,
nastaví oznaèení zaøízení jako nejposlednìjší.

Pozn.: Pokud  pouijete vstupnì/vıstupní operaci pouívající oznaèení disku
       jiné  ne  nejposlednìji  pouívané (u disku, kterı má více moností
       oznaèení),  zobrazí DOS hlášení "Insert diskette for..." oznamující,
       e  má uivatel vloit novou disketu, která pøísluší jiné poadované
       logické  jednotce,  ne  s  kterou  byla  jako  s poslední provádìna
       disková   operace.   Hlášení   mùete  odstranit  nastavením  nového
       logického  disku  pomocí  této  funkce  pøed  další vstupnì/vıstupní
       operací.




 F u n k c e   4 5 H   ( 6 9 ) - zdvojení identifikátoru souboru (DUP)

    vstup:    AH = 45H
              BX = identifikátor souboru

    vıstup:   AX = zduplikovanı identifikátor souboru (pokud je CF = 0)
                 = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                        04H - není   volnı   ádnı   identifikátor  souboru
                              (pøíliš mnoho otevøenıch souborù)
                        06H - neplatnı identifikátor souboru

    Funkce   vytvoøí   novı   identifikátor   souboru   zduplikováním   ji
existujícího   identifikátoru   otevøeného   souboru  nebo  zaøízení.  Novı
identifikátor sdílí existující ukazatel souboru.

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Pøesunutí  ukazatele  souboru  jednoho identifikátoru souboru pomocí
       READ,  WRITE  nebo  LSEEK  zpùsobí  pøesunutí  ukazatele  i  druhého
       identifikátoru   souboru.   Avšak  uzavøení  jednoho  identifikátoru
       nezpùsobí uzavøení jiného identifikátoru souboru.

       Zduplikováním identifikátoru souboru a jeho opìtnım uzavøením mùete
       umístit  soubor  z  vyrovnávací  pamìti  na  disk  a uloit adresáø;
       pùvodní   identifikátor  pøitom  zùstává  i  nadále  otevøen,  take
       nemusíte soubor znovu otevírat, co je èasovì nároèná operace.





 F u n k c e   4 6 H   ( 7 0 ) - nucené zdvojení identif. souboru (FORCDUP)

    vstup:    AH = 46H
              BX = první identifikátor souboru
              CX = identifikátor souboru, kterı má bıt zmìnìn

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                        04H - není   volnı   ádnı   identifikátor  souboru
                              (otevøeno pøíliš mnoho souborù)
                        06H - neplatnı identifikátor souboru

    Funkce   zpùsobí,   e   druhı   identifikátor  (v  CX)  bude  nastaven
odpovídajícím  zpùsobem na stejnı soubor a stejnou pozici ukazatele souboru
jako  první  identifikátor  (v  BX).  Oba  identifikátory  pøitom  musí ji
existovat. Pokud se druhı identifikátor vztahuje k otevøenému souboru, bude
soubor  nejdøíve  uzavøen  a potom teprve bude nastaven druhı identifikátor
stejnì jako první.

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Pøesunutí  ukazatele  souboru  jednoho identifikátoru souboru pomocí
       READ,  WRITE  nebo  LSEEK  zpùsobí  pøesunutí  ukazatele  i  druhého
       identifikátoru   souboru.   Avšak  uzavøení  jednoho  identifikátoru
       nezpùsobí uzavøení jiného identifikátoru souboru.

       Tato  funkce  je  pouitelná  pro pøesmìrování. Napø. k pøesmìrování
       standardního  vıstupu  (pøeddefinovaného  jako  identifikátor  1) na
       soubor  umístìte  do  CX  hodnotu  1  a do BX umístìte identifikátor
       souboru, na kterı má bıt pøesmìrován vıstup.




 F u n k c e   4 7 H   ( 7 1 ) - poskytnutí aktivního adresáøe

    vstup:    AH = 47H
              DL = èíslo disku (0=aktivní; 1=A; atd.)
              DS:SI = ukazatel na 64-bajtovou vyrovnávací pamì

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   0FH (15) - neplatná specifikace disku

    Funkce  navrací  plné  oznaèení cesty aktivního adresáøe kromì oznaèení
disku  a  inicializaèního  znaku  lomítka  jako  øetìzec  ASCIIZ uloenı ve
vyrovnávací pamìti od adresy DS:SI.

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Oznaèení  cesty  mùe  bıt  dlouhé  a 63 bajtù (bez inicializaèního
       znaku  lomítka)  plus  ukonèující  nulovı  bajt.  Pokud  je aktivním
       adresáøem  základní  adresáø  disku  (tzv. koøennı adresáø), navrací
       funkce  nulovı øetìzec ASCIIZ (tzn. e první bajt vyrovnávací pamìti
       obsahuje nulu).

       V  nìkterıch  verzích  pøedcházejících  verzi DOS 3.0 mohlo oznaèení
       cesty  adresáøe  obsahovat  èleny  delší ne 12 znakù pouívané jako
       omezení  pro  jména  souborù. Napø. pokud pod DOS 2.0 uivatel zadal
       pøíkaz  "cd  \jmenoadresare\podadr" a pøitom existuje cesta adresáøe
       "\jmenoadr\podadr",  navrátí  tato  funkce  "\jmenoadresare\podadr".
       Tato  cesta  je navrácena v malıch písmenech a obsahuje pøíliš mnoho
       znakù.  DOS  3.0  a  vyšší vdy vrací správné jméno cesty ve velkıch
       písmenech - v tomto pøípadì "JMENOADR\PODADR".




 F u n k c e   4 8 H   ( 7 2 ) - pøidìlení pamìti

    vstup:    AH = 48H
              BX = poèet odstavcù pamìti, která má bıt pøidìlena

    vıstup:   AX = adresa segmentu pøidìlené pamìti (pokud CF = 0)
                 = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   07H (7) - øídící blok pamìti znièen
                   08H (8) - nepostaèující pamì
              BX = velikost nejdelšího volného bloku (pokud je CF = 1)

    Funkce  48H dynamicky pøidìluje pamì v násobcích po 16 bajtech (tj. po
odstavcích).  Velikost  èásteènì pøidìlené pamìti (pokud pamì nedostaèuje)
je  navrácena  pøi chybì 08H v registru BX (v odstavcích). Pokud je operace
úspìšná,  ukazuje AX:0000H na zaèátek pøidìleného bloku pamìti (AX obsahuje
adresu segmentu; offset je vdy 0000H).



Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Pokud  nastavíte  pøed  voláním  funkce BX=FFFFH, mùete tuto funkci
       pouít  k  zjištìní,  jak velká èást pamìti je volná (je navrácena v
       registru  BX).  To vyvolá chybu, kterou však mùete ignorovat, nebo
       DOS nemùe pøidìlit pamì vìtší ne 640K.




 F u n k c e   4 9 H   ( 7 3 ) - uvolnìní pøidìlené pamìti

    vstup:    AH = 49H
              ES = adresa segmentu pamìti, která má bıt uvolnìna

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   07H (7) - øídící blok pamìti znièen
                   09H (9) - neplatná adresa bloku pamìti

    Funkce  49H  navrátí  do  DOS pamì, která byla pøidìlena pomocí funkce
48H.  ES  ukazuje na adresu segmentu bloku, kterı je navracen; je to stejná
hodnota jako ta, kterou navrátila funkce 48H v registru AX.

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).




 F u n k c e   4 A H   ( 7 4 ) - modifikace pøidìlení pamìti (SETBLOCK)

    vstup:    AH = 4AH
              BX = nová velikost bloku pamìti (v odstavcích)
              ES = adresa segmentu bloku pamìti, kterı je modifikován

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   07H (7) - øídící blok pamìti je znièen
                   08H (8) - nepostaèující pamì
                   09H (9) - neplatná adresa bloku

    Funkce  umoòuje  zvìtšit nebo zmenšit velikost bloku pamìti, kterı byl
pøidìlen  funkcí  48H.  ES  obsahuje  adresu  segmentu  bloku pamìti, jeho
velikost  má  bıt  zmìnìna. BX obsahuje novou velikost bloku (v odstavcích,
tj. v násobcích 16 bajtù).

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).



 F u n k c e   4 B H   ( 7 5 ) - naètení nebo provedení programu (EXEC)

    vstup:    AH = 4BH
              AL = 00H - naètení programu a jeho start
                   03H - naètení programu, avšak nebude odstartován
              DS:DX = ukazatel  na  øetìzec  ASCIIZ  specifikující oznaèení
                      cesty k podprogramu
              ES:BX = ukazatel na blok parametrù

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H ( 1) - neplatné èíslo funkce
                   02H ( 2) - soubor nenalezen
                   03H ( 3) - cesta nenalezena
                   05H ( 5) - poadavek odmítnut
                   08H ( 8) - nepostaèující pamì
                   0AH (10) - neplatné prostøedí
                   0BH (11) - neplatnı formát

    Funkce mìní všechny registry.

    Funkce  4BH  umoòuje  programu  zavést  podprogram z disku do pamìti a
(pokud je to poadováno) spustit jej. Pøi zavedení programu se z otcovského
procesu  zduplikují  do  synovského  procesu  všechny  otevøené  soubory  a
prostøedí  procesu - to umoòuje, aby otcovskı proces pøesmìroval podle své
potøeby  napø.  vstupní  a  vıstupní zaøízení a potom vyvolal mapø. tøídící
program.

    Pokud  je  v  AL  zadána  hodnota  00H,  podprogram se naète do pamìti,
vytvoøí  se  jeho prefix programového segmentu PSP a program se odstartuje.
Vektory ukonèení a obsluhy Ctrl-Break se nastaví na adresu instrukce, která
následuje za voláním této funkce EXEC v hlavním programu, take po ukonèení
podprogramu  z  disku  se øízení navrátí do hlavního programu, jakoby šlo o
volání bìného podprogramu.

    Pokud  je  v  AL  zadána  hodnota  03H,  podprogram se naète z disku do
pamìti,  nevytvoøí  se  však  prefix  programového  segmentu  PSP,  ani  se
podprogram  automaticky  nespustí, avšak hlavní program mùe do podprogramu
vskoèit pøímo.

    Do registrového páru DS:DX ulote ukazatel na øetìzec ASCIIZ obsahující
oznaèení  disku,  cesty  a  jméno souboru, kterı se má zavést do pamìti. Do
registrù  ES:BX ulote ukazatel na blok parametrù, které specifikují bliší
podmínky pro provedení podprogramu. Blok parametrù má tuto strukturu:

    Pro podfunkci 00H (naèti a spusti):
+----------+------------------+-----------------------------------------+
|  offset  | velikost (bajtù) |                 popis                   |
+----------+------------------+-----------------------------------------+
| 00H ( 0) |        2         | adresa segmentu øetìzcù prostøedí       |
| 02H ( 2) |        4         | segment a offset pøíkazového øádku      |
| 06H ( 6) |        4         | segment a offset prvního aktivního FCB  |
| 0AH (10) |        4         | segment a offset druhého aktivního FCB  |
+----------+------------------+-----------------------------------------+

    Pro podfunkci 03H (naèti ale nespouštìj):
+----------+------------------+-----------------------------------------+
|  offset  | velikost (bajtù) |                 popis                   |
+----------+------------------+-----------------------------------------+
| 00H ( 0) |        2         | adresa segmentu kam bude soubor naèten  |
| 02H ( 2) |        2         | relokaèní faktor programu (aplikuje se  |
|          |                  |     pouze pro formáty programù EXE)     |
+----------+------------------+-----------------------------------------+

Prostøedí: Øetìzce  prostøedí,  které  musí  bıt  seøazeny  po  odstavcích,
           obsahují  posloupnosti  øetìzcù ASCIIZ následované bajtem 00H po
           všech   øetìzcích.   Kadı   øetìzec  ASCIIZ  má  typicky  formu
           parametr=hodnota. Celkovı øetìzec prostøedí musí bıt svou délkou
           menší  ne  32K. Pokud je segment pro øetìzec prostøedí nastaven
           na   00H,  sdílí  podprogram  prostøedí  programu,  kterı  tento
           podprogram vyvolal.

           Podprogram  vdy  pøijímá  kopii  øetìzce prostøedí, take ádná
           zmìna  provedená v prostøedí podprogramu se neodrazí v prostøedí
           hlavního programu.

Soubory:   Pokud  je  podprogram  naèten  do  pamìti  a  vykonáván, všechny
           otevøené  identifikátory  souborù  se  uvolní pro podprogram. To
           znamená, e volající program mùe pøesmìrovat standardní vstup a
           vıstup  pro  podprogram. Nejsou uvolnìny pro podprogram pouze ty
           identifikátory  souborù,  které byly otevøeny s nastavenım bitem
           pøíznaku podílu (bit 7 registru AL - viz funkce 3DH).

Pamì:     Pøed  pouitím  funkce  4BH  musíte  uvolnit dostatek pamìti pro
           naètení podprogramu resp. pro jeho provoz (voz funkce 4AH).

Varování:  Tato  funkce  mìní  všechny  registry vèetnì registru zásobníku.
           Proto  pøed  voláním  podprogramu  ulote  registry  SS  a SP do
           promìnnıch  (tj.  na  urèitá  pamìová  místa)  uvnitø  hlavního
           programu  a  po návratu z podprogramu nejdøíve navrate tyto dva
           registry a potom teprve mùete opìt pouívat zásobník.

Pozn.:     Funkce EXEC volá zavádìcí èást COMMAND.COM k zavedení programu.




 F u n k c e   4 C H   ( 7 6 ) - ukonèení procesu (EXIT)

    vstup:    AH = 4CH
              AL = návratovı kód

    vıstup:   ádnı - neexistuje návrat

    Tato  funkce  je  správná  metoda  ukonèení  programu v DOS verze 2.0 a
vyšší.  Funkce  uzavøe  všechny  soubory  a navrátí øízení zpìt do hlavního
(otcovského)  procesu  (obvykle  COMMAND.COM).  Pøitom  lze  v  registru AL
specifikovat  návratovı  kód,  kterı  slouí hlavnímu procesu k informaci o
èinnosti ukonèeného procesu.

Pozn.: Návratovı  kód mùe bıt testován pomocí funkce 4DH nebo v pøíkazovém
       souboru systému pomocí pøíkazu ERRORLEVEL.

       Tato  metoda  ukonèení  procesu je vıhodnìjší ne pøerušení INT·20H,
       nebo CS nemusí obsahovat adresu prefixu záhlaví programu PSP.

Pøíklad: Následující krátkı program je velmi uiteènou malièkostí pøi práci
         v  operaèním  systému. Umoòuje vìtvit uivatelské volby v systému
         podle zadání z klávesnice. Program èeká na znak z klávesnice (znak
         se nezobrazuje, tato èinnost se ponechává na pøíkazovém souboru) a
         pokud  je  to  písmeno,  navrátí kód odpovídající poøadovému èíslu
         písmene (A=0, ..., Z=25) nezávisle na tom, zda jde o velké èi malé
         písmeno.  Dále  je uveden krátkı pøíkazovı soubor ukazující zpùsob
         práce s tímto programem (program je zde pojmenován PISMENO.EXE).

         cyklus:   mov       ah,8
                   int       21h            ; èekání na zadání znaku
                   sub       al,"A"         ; odeètení znaku "A"
                   jc        cyklus         ; menší ne "A"
                   cmp       al,27
                   jl        konec          ; je platnı znak
                   sub       al,32          ; korekce malıch písmen
                   jc        cyklus         ; není malé písmeno
                   cmp       al,26          ; je písmeno ?
                   jg        cyklus         ; není malé písmeno
         konec:    mov       ah,4ch
                   int       21h            ; ukonèení programu

Pøíklad povelového souboru:

         echo off
         echo Zadejte vaši volbu (ANO/NE)
         :start
         PISMENO.EXE
         if errorlevel == 14 goto start
         if errorlevel == 13 goto ne
         if errorlevel == 1 goto start
         echo ANO !
         goto start
         :ne
         echo NE !
         goto start




 F u n k c e   4 D H   ( 7 7 ) - poskytnutí návrat. kódu podprocesu (WAIT)

    vstup:    AH = 4DH

    vıstup:   AX = návratovı kód

    Funkce  poskytne návratovı kód procesu, kterı byl ukonèen pomocí funkce
4CH  (EXIT)  nebo funkce 31H (pøerušení a ponechání rezidentním). Návratovı
kód  se  skládá  ze  dvou  èástí: AL obsahuje návratovı kód, kterı nastavil
pøerušení  proces;  AH  obsahuje zpùsob, jakım byl podproces ukonèen.

    Moné hodnoty registru AH jsou:
   +---------+----------------------------------------------------------+
   | 00H (0) | normální pøerušení                                       |
   | 01H (1) | pøerušení klávesami <Ctrl>-<Break> (<Ctrl>-C)            |
   | 02H (2) | pøerušení z DOS z dùvodu kritické chyby zaøízení         |
   | 03H (3) | pøerušení funkcí 31H (pøerušení a ponechání rezidentním) |
   +---------+----------------------------------------------------------+





 F u n k c e   4 E H   ( 7 8 ) - nalezení 1.vyhovujícího soub. (FIND FIRST)

    vstup:    AH = 4EH
              CX = atributy souboru
              DS:DX = ukazatel na specifikaci souboru (øetìzec ASCIIZ)

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   02H ( 2) - soubor nenalezen
                   03H ( 3) - cesta nenalezena
                   12H (18) - nelze nalézt další soubory

    Funkce  nalezne  první  soubor,  kterı vyhovuje specifikaci (udané jako
øetìzec  ASCIIZ na adrese DS:DX). Specifikace mùe obsahovat oznaèení disku
a cestu, jméno souboru mùe obsahovat maskovací znaky (* a ?).

    Funkce  navrací  informace  v  43-bajtové  oblasti pamìti na adrese DTA
(adresa diskovıch pøenosù). Informace jsou formátovany takto:
+----------+----------+--------------------------------------------------+
|  offset  | velikost |             popis                                |
+----------+----------+--------------------------------------------------+
| 00H ( 0) |    21    | pouívá DOS pro funkci 4FH (nalezení dalšího)    |
| 15H (21) |     1    | atributy nalezeného souboru                      |
| 16H (22) |     2    | èas posledního záznamu souboru                   |
| 18H (24) |     2    | datum posledního záznamu souboru                 |
| 1AH (26) |     4    | velikost souboru v bajtech                       |
| 1EH (30) |    13    | jméno souboru a rozšíøení jména souboru (ASCIIZ) |
+----------+----------+--------------------------------------------------+

    Jméno  souboru  a  rozšíøení  jména  souboru  jsou hlášeny v konvenèním
tvaru,  s  vymazanımi  mezerami a s teèkou mezi jménem souboru a rozšíøením
jména souboru. Pokud soubor neobsahuje ádné rozšíøení jména souboru, teèka
je potlaèena.

Pozn.: Další  vyhovující  soubor  mùete hledat pomocí funkce 4FH (nalezení
       dalšího vyhovujícího souboru).

       Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Adresu diskovıch pøenosù (DTA) mùete nastavit pomocí funkce 1AH.

       Rozsah  hledání  mùete øídit zadáním bajtu atributù do registru CX.
       Pokud  je  CX  nastaven  na 00H, hledá funkce pouze normální soubory
       (tj.   mohou   mít  nastaven  pouze  atribut  "pouze  ètení"  a/nebo
       "archivní").  Pokud  je v CX specifikována nìjaká kombinace atributù
       "skrytı   soubor",  "systémovı  soubor"  nebo  "adresáø",  budou  se
       vyhledávat   normální  soubory  a  také  všechny  soubory  s  tìmito
       atributy.  Pokud  je v CX specifikován atribut "návìští disku", bude
       funkce  hledat  pouze  poloku s atributem "návìští disku". Atributy
       "pouze ètení" a "archivní" nemají vliv na hledání.

         Struktura bajtu atributù souboru:
        +-+-+-+-+-+-+-+-+
        |7 6 5 4 3 2 1 0|
        +++++++++++++++++ bit
         | | | | | | | +-> 0 (  1): pouze ètení souboru (Read-only "R/O")
         | | | | | | +---> 1 (  2): skrytı soubor (Hidden "HID")
         | | | | | +-----> 2 (  4): systémovı soubor (System "SYS")
         | | | | +-------> 3 (  8): návìští disku (Volume Label "VOL")
         | | | +---------> 4 ( 16): adresáø (Directory "DIR")
         | | +-----------> 5 ( 32): archivní soubor (Archive "ARC")
         | +-------------> 6 ( 64): rezervováno (musí bıt nastaven na 0)
         +---------------> 7 (128): rezervováno (musí bıt nastaven na 0)

            - bliší popis atributù viz "Adresáøová poloka"

       Èas  posledního záznamu udává èas, kdy byl soubor naposledy vytvoøen
       nebo  aktualizován.  Hodina,  minuta  a sekunda jsou zapsány ve dvou
       bajtech takto:

        15  14  13  12  11  10   9   8      7   6   5   4   3   2   1   0
       +---+---+---+---+---+---+---+---+  +---+---+---+---+---+---+---+---+
       | H | H | H | H | H | M | M | M |  | M | M | M | S | S | S | S | S |
       +---+---+---+---+---+---+---+---+  +---+---+---+---+---+---+---+---+
        |                 | |                        | |                 |
        +- hodina (0-23) -+ +---- minuta (0-59) -----+ +- sekunda (0-58) +
                                                      (údaj se vynásobí 2*)

       Datum  posledního  záznamu  udává  den,  kdy  byl  soubor  naposledy
       vytvoøen  nebo  aktualizován.  Rok, mìsíc a den jsou zapsány ve dvou
       bajtech takto:

        15  14  13  12  11  10   9   8      7   6   5   4   3   2   1   0
       +---+---+---+---+---+---+---+---+  +---+---+---+---+---+---+---+---+
       | R | R | R | R | R | R | R | M |  | M | M | M | D | D | D | D | D |
       +---+---+---+---+---+---+---+---+  +---+---+---+---+---+---+---+---+
        |                         | |                | |                 |
        +--- rok (1980 a 2099) --+ +- mìsíc (1-12) -+ +--- den (1-31) --+
         (k údaji se pøiète 1980)




 F u n k c e   4 F H   ( 7 9 ) - nalezení dalšího vyhov.souboru (FIND NEXT)

    vstup:    AH = 4FH

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   12H (18) - nejsou ádné další vyhovující soubory

    Funkce  pokraèuje  v  hledání  dalšího  souboru,  kterı se zaèal hledat
pomocí  funkce  4EH  (nalezení  první  vyhovujícího souboru). Informace pro
hledání  souboru  se  pøedá z funkce 4EH v 43-bajtové poloce na adrese DTA
(adresa diskovıch pøenosù). Informace pro hledání má tuto strukturu:

+----------+----------+--------------------------------------------------+
|  offset  | velikost |             popis                                |
+----------+----------+--------------------------------------------------+
| 00H ( 0) |    21    | pouívá DOS pro proces nalezení dalšího souboru  |
| 15H (21) |     1    | atributy nalezeného souboru                      |
| 16H (22) |     2    | èas posledního záznamu souboru                   |
| 18H (24) |     2    | datum posledního záznamu souboru                 |
| 1AH (26) |     4    | velikost souboru v bajtech                       |
| 1EH (30) |    13    | jméno souboru a rozšíøení jména souboru (ASCIIZ) |
+----------+----------+--------------------------------------------------+

    Jméno  souboru  a  rozšíøení  jména  souboru  jsou hlášeny v konvenèním
tvaru,  s  vymazanımi  mezerami a s teèkou mezi jménem souboru a rozšíøením
jména souboru. Pokud soubor neobsahuje ádné rozšíøení jména souboru, teèka
je potlaèena.

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Pro  nalezení  prvního vyhovujícího souboru pouijte funkci 4EH, kde
       jsou té podrobnìji popsány jednotlivé poloky informaèního pole.



 F u n k c e   5 0 H   ( 8 0 ) - rezervováno

 F u n k c e   5 1 H   ( 8 1 ) - rezervováno

 F u n k c e   5 2 H   ( 8 2 ) - rezervováno

 F u n k c e   5 3 H   ( 8 3 ) - rezervováno



 F u n k c e   5 4 H   ( 8 4 ) - poskytnutí informace o nastavení VERIFY

    vstup:    AH = 54H

    vıstup:   AL = 00H - pøepínaè VERIFY je vypnut
                   01H - pøepínaè VERIFY je zapnut

    Funkce  54H navrací v registru AL informaci o souèasném stavu nastavení
systémového  pøepínaèe VERIFY. Pøízak VERIFY lze nastavit pomocí funkce 2EH
nebo  pomocí  povelu  VERIFY  ON  nebo OFF. Pokud je pøepínaè VERIFY zapnut
(ON), provádí se pøi diskovıch operacích ovìøování zapsanıch dat kontrolním
ètením (nikoliv však porovnáním se zapisovanımi daty).




 F u n k c e   5 5 H   ( 8 5 ) - rezervováno



 F u n k c e   5 6 H   ( 8 6 ) - pøejmenování souboru

    vstup:    AH = 56H
              DS:DX = ukazatel na øetìzec ASCIIZ obsahující pùvodní cestu a
                      jméno souboru
              ES:DI = ukazatel  na  øetìzec ASCIIZ obsahující novou cestu a
                      jméno souboru

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   02H ( 2) - soubor nenalezen
                   03H ( 3) - cesta nenalezena
                   05H ( 5) - poadavek odmítnut
                   11H (17) - není stejné zaøízení

    Funkce  pøejmenuje  soubor,  pøemístí jej do jiného adresáøe na stejném
disku nebo jej pøejmenuje i pøemístí.

   Pøi práci v síti vyaduje tato funkce pøístupová práva vytváøení CREATE.

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Pokud  je  v popisu nového souboru obsaeno oznaèení disku, musí bıt
       toto oznaèení shodné s oznaèením disku v popisu pùvodního souboru.

       Jméno souboru nemùe obsahovat maskovací znaky (? a *).




 F u n k c e   5 7 H   ( 8 7 ) - poskytnutí/nastavení data a èasu souboru

    vstup:    AH = 57H
              AL = 00H - poskytnutí data a èasu souboru
                   01H - nastavení data a èasu souboru
              BX = identifikátor souboru
              CX = èas (pouze je-li AL = 01H - nastavení)
              DX = datum (pouze je-li AL = 01H - nastavení)

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H (1) - neplatné èíslo funkce v AL
                   06H (6) - neplatnı identifikátor souboru
              CX = èas (pouze je-li AL = 00H - poskytnutí)
              DX = datum (pouze je-li AL = 00H - poskytnutí)

    Funkce  navrací  nebo  nastavuje datum a èas posledního zápisu souboru,
kterı byl otevøen pomocí identifikátoru souboru (napø. pomocí funkce 3DH).

    Datum a èas jsou definovány následujícím zpùsobem:

               DX (datum) = (rok-1980)*512 + mìsíc*32 + den

       15  14  13  12  11  10   9   8       7   6   5   4   3   2   1   0
      +---+---+---+---+---+---+---+---+   +---+---+---+---+---+---+---+---+
      | R | R | R | R | R | R | R | M |   | M | M | M | D | D | D | D | D |
      +---+---+---+---+---+---+---+---+   +---+---+---+---+---+---+---+---+
       |                         | |                 | |                 |
       +--- rok (1980 a 2099) --+ +-- mìsíc (1-12) -+ +--- den (1-31) --+
      (k údaji se pøiète hodnota 1980)


               CX (èas) = hodina*2048 + minuta*32 + sekunda/2

       15  14  13  12  11  10   9   8       7   6   5   4   3   2   1   0
      +---+---+---+---+---+---+---+---+   +---+---+---+---+---+---+---+---+
      | H | H | H | H | H | M | M | M |   | M | M | M | S | S | S | S | S |
      +---+---+---+---+---+---+---+---+   +---+---+---+---+---+---+---+---+
       |                 | |                         | |                 |
       +- hodina (0-23) -+ +----- minuta (0-59) -----+ +- sekunda (0-58) +
                                                     (údaj je vynásoben 2*)




 F u n k c e   5 9 H   ( 8 9 ) - poskytnutí rozšíøenıch chybovıch informací

    vstup:    AH = 59H
              BX = 0000H pro DOS 3.00 a vyšší

    vıstup:   AX = rozšiøující chybovı kód
              BH = tøída chyby
              BL = návrh další akce
              CH = umístìní chyby (zdroj chyby)

    znièené registry: CL, DX, SI, DI, ES a DS

    Funkce  59H navrací detailnìjší diagnostické informace o vzniklé chybì.
Tato  funkce  mùe  bıt  pouita  zevnitø obsluhy kritické chyby (pøerušení
INT·24H),  po  volání  funkce  DOS  která  hlásí  chybu nastavením pøíznaku
pøenosu  CF  nebo  po  operaci  se  souborem  s  pouitím  FCB, která hlásí
návratovı kód FFH. Tato funkce je moná pouze pro DOS 3.00 a vyšší.

    Všechny  funkce  pracující s FCB (tj. chybové kódy navracené v DOS 1.x)
navrací  chybovı  kód  operace v registru AL - pøi bezchybné funkci navrátí
kód  0,  pøi  chybì navrátí kód 0FFH. Ostatní funkce hlásí chybu nastavením
pøíznaku  pøenosu  CF  a  umístìním  chybového  kódu  do  registru  AX (viz
následující  tabulka). DOS 2.x navrací chybové kódy 01H - 12H (18). Pod DOS
3.x  je  lepší  volat  tuto  funkci 59H, pomocí ní lze obdret podrobnìjší
informace o chybách.

    Chyby  13H  (19)  a  1FH (31) odpovídají chybám 00H a 0CH, které jsou
pøedávány  v  registru  DI pøi vyvolání pøerušení INT 24H (obsluha kritické
chyby).

    Hodnoty navrácené v registru AX (rozšíøenı chybovı kód):
 
+----------+--------------------------------------------------------------+
|   Kód    |                       Vıznam                                 |
+----------+--------------------------------------------------------------+
| 00H ( 0) | ádná chyba                                                  |
| 01H ( 1) | neplatné èíslo funkce                                        |
| 02H ( 2) | soubor nenalezen                                             |
| 03H ( 3) | cesta nenalezena                                             |
| 04H ( 4) | otevøeno pøíliš mnoho souborù (není volnı ident.s.)          |
| 05H ( 5) | poadavek odmítnut                                           |
| 06H ( 6) | neplatnı identifikátor souboru                               |
| 07H ( 7) | øídící blok pamìti znièen                                    |
| 08H ( 8) | nepostaèující pamì                                          |
| 09H ( 9) | neplatná adresa bloku pamìti                                 |
| 0AH (10) | neplatné prostøedí                                           |
| 0BH (11) | neplatnı formát                                              |
| 0CH (12) | neplatnı pøístupovı kód                                      |
| 0DH (13) | neplatná data                                                |
| 0EH (14) | rezervováno                                                  |
| 0FH (15) | neplatná specifikace disku                                   |
| 10H (16) | pokus o zrušení aktivního adresáøe                           |
| 11H (17) | není stejné zaøízení                                         |
| 12H (18) | nejsou ádné další soubory                                   |
+----------+--------------------------------------------------------------+
| 13H (19) | pokus o zápis na disk chránìnı proti zápisu    INT 24H/00H   |
| 14H (20) | neznámá jednotka                               INT 24H/01H   |
| 15H (21) | disková mechanika není pøipravena              INT 24H/02H   |
| 16H (22) | neznámı povel                                  INT 24H/03H   |
| 17H (23) | chyba dat disku (kontrolní souèet CRC)         INT 24H/04H   |
| 18H (24) | chybná délka struktury poadavku               INT 24H/05H   |
| 19H (25) | chyba vystavení disku                          INT 24H/06H   |
| 1AH (26) | neznámı typ média                              INT 24H/07H   |
| 1BH (27) | sektor nenalezen                               INT 24H/08H   |
| 1CH (28) | v tiskárnì není papír                          INT 24H/09H   |
| 1DH (29) | operace zápisu byla chybná                     INT 24H/0AH   |
| 1EH (30) | operace ètení byla chybná                      INT 24H/0BH   |
| 1FH (31) | celková chyba                                  INT 24H/0CH   |
+----------+--------------------------------------------------------------+
| 20H (32) | porušení sdílení souborù                                     |
| 21H (33) | porušení uzamykání souborù                                   |
| 22H (34) | neplatná vımìna disku                                        |
| 23H (35) | øídící blok souboru FCB nepøístupnı (pøíliš mnoho FCB)       |
| 24H (36) | pøeteèení vyrovnávací pamìti pro sdílení                     |
| 25H - 31H| rezervováno                                                  |
| 32H (50) | poadavek pro práci v síti není podporován                   |
| 33H (51) | vzdálenı poèítaè nepøijímá                                   |
| 34H (52) | zdvojené síové jméno                                        |
| 35H (53) | síové jméno nenalezeno                                      |
| 36H (54) | sí zaneprázdnìna                                            |
| 37H (55) | síové zaøízení ji nadále neexistuje                        |
| 38H (56) | omezení povelu síového BIOSu pøekroèeno                     |
| 39H (57) | chyba hardware adaptéru pro práci v síti                     |
| 3AH (58) | nesprávná odpovìï ze sítì                                    |
| 3BH (59) | neoèekávaná chyba síì                                       |
| 3CH (60) | nekompatibilní adaptér pro dálkové pøenosy                   |
| 3DH (61) | tisková fronta plná                                          |
| 3EH (62) | není dostatek volného místa pro tištìnı soubor               |
| 3FH (63) | tištìnı soubor byl zrušen                                    |
| 40H (64) | síové jméno bylo zrušeno                                    |
| 41H (65) | poadavek odmítnut                                           |
| 42H (66) | typ síového zaøízení nesprávnı                              |
| 43H (67) | síové jméno nenalezeno                                      |
| 44H (68) | pøekroèeno omezení síového jména                            |
| 45H (69) | pøekroèeno omezení citlivosti síového BIOSu                 |
| 46H (70) | doèasná pauza                                                |
| 47H (71) | poadavek pro práci v síti nepøijat                          |
| 48H (72) | pauza tiskového nebo diskového pøesmìrování                  |
| 49H - 4FH| rezervováno                                                  |
| 50H (80) | soubor ji existuje                                          |
| 51H (81) | rezervováno                                                  |
| 52H (82) | nelze vytvoøit poloku adresáøe                              |
| 53H (83) | chyba - pøerušení pro obsluhu kritické chyby INT 24H         |
| 54H (84) | pøíliš mnoho pøesmìrování                                    |
| 55H (85) | zdvojené pøesmìrování                                        |
| 56H (86) | neplatné heslo                                               |
| 57H (87) | neplatnı parametr                                            |
| 58H (88) | chyba zaøízení pro práci v síti                              |
+----------+--------------------------------------------------------------+

    Hodnoty navrácené v registru BH (tøída chyby):
 
+----------+--------------------------------------------------------------+
|   Kód    |                       Vıznam                                 |
+----------+--------------------------------------------------------------+
| 01H ( 1) | pøekroèeno pøesmìrování (nejsou FCB, pamì, kanály, ident.)  |
| 02H ( 2) | doèasná situace; zkuste opìt pozdìji (napø. uzamèenı soubor) |
| 03H ( 3) | problémy oprávnìní (musíte mít vyšší pøístupová práva)       |
| 04H ( 4) | vnitøní chyba v systémovém software (chyba v DOS)            |
| 05H ( 5) | chyba hardware                                               |
| 06H ( 6) | chyba systému; tj. špatnı nebo chybí CONFIG.SYS              |
| 07H ( 7) | chyba aplikaèního programu (chybná informace do DOS atd.)    |
| 08H ( 8) | poadovanı prvek nenalezen                                   |
| 09H ( 9) | chybnı formát (tj. nerozpoznatelnı disk nebo soubor)         |
| 0AH (10) | prvek vnitønì uzamèen                                        |
| 0BH (11) | chyba média (tj. chyba CRC, špatnı disk)                     |
| 0CH (12) | prvek ji existuje                                           |
| 0DH (13) | jiné chyby (neklasifikované)                                 |
+----------+--------------------------------------------------------------+

    Hondoty navrácené v registru BL (návrh další akce):
 
+----------+--------------------------------------------------------------+
|   Kód    |                       Vıznam                                 |
+----------+--------------------------------------------------------------+
| 01H ( 1) | zkuste nìkolikrát (a pak se zeptejte uivatele, co dál)      |
| 02H ( 2) | zkuste   opìt  (nìkolikrát)  po  pøestávce,  potom  zobrazte |
|          | uivateli nabídku k pokraèování nebo k abortování procesu    |
| 03H ( 3) | poádejte uivatele o opravení vstupu, potom opakujte        |
| 04H ( 4) | øádnì pøerušte; uzavøete soubory a potom ukonèete aplikaci   |
| 05H ( 5) | pøímo pøerušte; nepokoušejte se ji uzavøít soubory          |
| 06H ( 6) | ignorujte                                                    |
| 07H ( 7) | poádejte  uivatele,  aby  nìco udìlal (jako vloit správnı |
|          | disk) a potom operaci opakujte                               |
+----------+--------------------------------------------------------------+

    Hodnoty navrácené v registru CH (umístìní chyby, zdroj chyby):
 
+----------+--------------------------------------------------------------+
|   Kód    |                       Vıznam                                 |
+----------+--------------------------------------------------------------+
| 01H ( 1) | neznámı zdroj chyby                                          |
| 02H ( 2) | blokové zaøízení (tj. disk)                                  |
| 03H ( 3) | komunikaèní sí                                              |
| 04H ( 4) | znakové zaøízení, sériové zaøízení                           |
| 05H ( 5) | pamì                                                        |
+----------+--------------------------------------------------------------+




 F u n k c e   5 A H   ( 9 0 ) - vytvoøení jedineèného souboru

    vstup:    AH = 5AH
              CX = atributy souboru
              DS:DX = ukazatel na cestu konèící znakem \ (øetìzec ASCIIZ)

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   03H (3) - cesta nenalezena
                   05H (5) - poadavek odmítnut
              DS:DX = ukazatel na jméno souboru (øetìzec ASCIIZ)

    Funkce 5AH vytvoøí ve specifikovaném adresáøi jedineènı soubor a otevøe
jej  v  kompatibilním  módu s pøístupem "ètení/zápis". Tato funkce se èasto
pouívá k vytvoøení doèasnıch souborù, avšak DOS pøi ukonèení programu tyto
soubory automaticky neruší. Tato sluba je moná pouze v DOS 3.0 a vyšším.

   Pøi práci v síti vyaduje tato funkce pøístupová práva vytváøení CREATE.

Pozn.: Jméno cesty k adresáøi musí konèit znakem obráceného lomítka "\".

       Rezervujte  za  øetìzcem oznaèení cesty 13 bajtù tak, aby DOS mohl k
       cestì pøipojit jméno novì vytvoøeného souboru.



 F u n k c e   5 B H   ( 9 1 ) - vytvoøení nového souboru

    vstup:    AH = 5BH
              CX = atributy souboru
              DS:DX = ukazatel na oznaèení souboru (øetìzec ASCIIZ)

    vıstup:   AX = identifikátor souboru
                 = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   03H (3) - cesta nenalezena
                   04H (4) - není volnı ádnı identifikátor souboru
                   05H (5) - poadavek odmítnut
                   80H (128) - soubor ji existuje

    Tato  funkce  vytvoøí  soubor podle specifikovaného oznaèení souboru za
podmínky,  e  tento  soubor dosud neexistuje. Tato funkce je moná pouze v
DOS 3.0 a vyšším.

   Pøi práci v síti vyaduje tato funkce pøístupová práva vytváøení CREATE.

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Tato  funkce  je identická funkci 3CH (vytvoøení souboru) v pøípadì,
       e  vytváøenı  soubor  dosud  ještì  neexistuje.  Pokud  soubor  ji
       existuje,  ohlásí  tato  funkce  chybu,  zatímco  funkce 3CH v tomto
       pøípadì  zkrátí  existující  soubor  na  nulovou  délku  a potom jej
       otevøe.




 F u n k c e   5 C H   ( 9 2 ) - zamknutí/odemknutí pøístupu k souboru

    vstup:    AH = 5CH
              AL = 00H - uzamèení souboru
                   01H - odemknutí souboru
              BX = identifikátor souboru
              CX = relativní adresa zaèátku oblasti (vyšší slovo)
              DX = relativní adresa zaèátku oblasti (niší slovo)
              SI = délka oblasti (vyšší slovo)
              DI = délka oblasti (niší slovo)

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H ( 1) - neplatnı kód funkce
                   06H ( 6) - neplatnı identifikátor souboru
                   21H (33) - porušení   uzamèení   souboru  (specifikovaná
                              oblast je ji uzamèena nebo je ji odemèena)

    Tato  funkce  se  pouívá k uzamèení nebo odemèení vybrané èásti disku,
èím  zabraòuje  nebo  umoòuje  pøístup  k  této oblasti jinım procesùm ve
víceúlohovém  reimu  nebo v prostøedí sítì. Tato funkce je moná pouze pro
DOS 3.00 a vyšší.

Pozn.: Registry  CX  a DX spoleènì (jako 4-bajtové celé èíslo bez znaménka)
       urèují  relativní  adresu  (offset;  v  bajtech)  od zaèátku souboru
       oblasti  uvnitø  souboru,  která  má  bıt  uzamèena  nebo odemknuta;
       registry  SI  a DI spoleènì (jako 4-bajtové celé èíslo bez znaménka)
       specifikují délku této chránìné oblasti.

       Pøerušení  procesu,  kterı má otevøené soubory s uzamèenımi oblastmi
       nebo  uzavøení  souboru s uzavøenou oblastí bude mít nedefinovatelné
       následky.  Pokud  váš  program  mùe  bıt  pøerušen pomocí pøerušení
       INT·23H  nebo INT·24H, musíte pøed pøerušením programu zajistit, aby
       všechny zámky byly odemèeny.

       Operace  odemknutí  musí  specifikovat pøesnì stejnou oblast souboru
       jako uzamykací operace.

       Podøízené procesy (tj. proces vytvoøenı voláním funkce EXEC) nesdílí
       pøístup  k  oblastem  souboru,  které  byly  uzamèeny jeho otcovskım
       procesem.

       Pouijte tuto funkci v následujících módech souboru:
        mód sdílení se zamítnutím ètení
        mód sdílení bez ádného zamítnutí
        mód sdílení se zamítnutím zápisu, soubor je otevøen pro ètení/zápis
        mód sdílení se zamítnutím zápisu, soubor je otevøen pouze pro zápis




 F u n k c e   5 D H   ( 9 3 ) - rezervováno



 F u n k c e   5 E 0 0 H   ( 9 4 - 0 ) - poskytnutí jména zaøízení

    vstup:    AH = 5EH
              AL = 00H (èíslo podfunkce)
              DS:DX = ukazatel  na  vyrovnávací  pamì (16 bajtù), kde bude
                      navráceno jméno poèítaèe
    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H (1) - program obsluhy pro práci v síti není naèten
              CH = 00H (0) - jméno není definováno
                   není 00H (0) - jméno je definováno
              CL = èíslo jména NETBIOS (doplnìk BIOS pro práci v síti)
                   (pokud není CH = 0)
              DS:DX = ukazatel na jméno poèítaèe (øetìzec ASCIIZ)

    V  systémech vybavenıch prostøedky pro práci v síti IBM PC Network nebo
Microsoft Networks navrací tato funkce jméno lokálního poèítaèe. Toto jméno
navrací  jako  øetìzec ASCIIZ, kterı je doplnìn mezerami na délku 15 znakù.
Tato  funkce  je  moná  pouze  pro DOS 3.10 a vyšší a vyaduje, aby bìely
programy IBM PC Network nebo Microsoft Networks.

Pozn.: Pokud  nebylo  jméno  nikdy definováno, CH navrací 00H a obsah CL je
       nedefinovanı.  V opaèném pøípadì navrací CL èíslo jména NETBIOS (tj.
       doplòující èást k BIOS poèítaèe, která umoòuje práci v síti).




 F u n k c e   5 E 0 2 H   ( 9 4 - 2 ) - nastavení inicial.øetìzce tiskárny

    vstup:    AH = 5EH
              AL = 02H (podfunkce)
              BX = index vıpisu pøesmìrování
              CX = délka øetìzce pro nastavení (maximálnì 64 bajtù)
              DS:SI = ukazatel  na vyrovnávací pamì obsahující øetìzec pro
                      nastavení tiskárny

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H (1) - program obsluhy pro práci v síti není naèten

    Tato  podfunkce  funkce  5EH  umoòuje  jednotlivım  uivatelùm  v síti
specifikovat  jejich  vlastní  øetìzec  pro  nastavení tiskárny pøi sdílení
tiskárny.  Tento  øetìzec  nastavení  tiskárny bude vyslán na tiskárnu vdy
pøed  tiskem jednotlivıch souborù uivatele. Tato funkce je moná pouze pro
DOS  3.10  a  vyšší  a  vyaduje,  aby  bìely programy IBM PC Network nebo
Microsoft Networks.

Dùleité: Vzhledem  k  tomu,  e  hodnota  indexu pøesmìrování se mùe mezi
          dobou prohlíení vıpisu pøesmìrování a dobou ukonèení této funkce
          mìnit,  je  vhodné  volat  tuto  funkci  bezprostøednì za voláním
          funkce  5F02H  (poskytnutí  poloky  vıpisu pøesmìrování). (zmìnu
          poloky  vıpisu  pøesmìrování  mùe  zpùsobit volání funkce 5F03H
          (pøesmìrování    zaøízení)    nebo    funkce    5F04H    (zrušení
          pøesmìrování).)

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Tato  funkce  je  volána  s  indexem  vıpisu pøesmìrování v BX; tato
       hodnota  indexu  mùe  bıt  urèena  voláním funkce 5F02H (poskytnutí
       poloky vıpisu pøesmìrování).

       Nastavovací øetìzec nesmí bıt delší ne 64 bajtù.




 F u n k c e   5 E 0 3 H   ( 9 4 - 3 ) - poskytnutí inic. øetìzce tiskárny

    vstup:    AH = 5EH
              AL = 03H (podfunkce)
              BX = index vıpisu pøesmìrování
              ES:DI = ukazatel na 64-bajtovou vyrovnávací pamì

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H (1) - program obsluhy pro práci v síti není naèten

    Tato   funkce  navrací  inicializaèní  øetìzec  pro  nastavení  sdílené
tiskárny  lokálního uivatele. Funkce je moná pouze pro DOS 3.10 a vyšší a
vyaduje, aby bìely programy IBM PC Network nebo Microsoft Networks.

Dùleité: Vzhledem  k  tomu,  e  hodnota  indexu pøesmìrování se mùe mezi
          dobou prohlíení vıpisu pøesmìrování a dobou ukonèení této funkce
          mìnit,  je  vhodné  volat  tuto  funkci  bezprostøednì za voláním
          funkce  5F02H  (poskytnutí  poloky  vıpisu pøesmìrování). (zmìnu
          poloky  vıpisu  pøesmìrování  mùe  zpùsobit volání funkce 5F03H
          (pøesmìrování    zaøízení)    nebo    funkce    5F04H    (zrušení
          pøesmìrování).)

Pozn.: Pouijte  funkci 59H k získání rozšíøeného chybového kódu (DOS 3.0 a
       vyšší).

       Tato  funkce  je  volána  s  indexem  vıpisu pøesmìrování v BX; tato
       hodnota  indexu  mùe  bıt  urèena  voláním funkce 5F02H (poskytnutí
       poloky vıpisu pøesmìrování).

       Nastavovací øetìzec nesmí bıt delší ne 64 bajtù.





 F u n k c e   5 F 0 2 H   ( 9 5 - 2 ) - poskytnutí poloky vıpisu pøesmìr.

    vstup:    AH = 5FH
              AL = 02H
              BX = index pro vıpis pøesmìrování
              DS:SI = ukazatel na 128-bajtovou vyrovnávací pamì obsahující
                      jméno lokálního zaøízení
              ES:DI = ukazatel na 128-bajtovou vyrovnávací pamì obsahující
                      jméno pro práci v síti

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H ( 1) - program pro obsluhu práce v síti není naèten
                   12H (18) - není více souborù
              BH = pøíznak stavu zaøízení
                   bit 0 = 0 - zaøízení platí
                           1 - zaøízení neplatí
              BL = typ zaøízení (3=tiskárna; 4=mechanika disku)
              CX = parametr uloenı funkcí 5F03H

    znièené registry: DX a BP

    Tato  funkce  navrací poloku vıpisu pøesmìrování v síti. Vıpis samotnı
se  vytváøí  pomocí  podfunkce  5F03H. Funkce je moná pouze pro DOS 3.10 a
vyšší  a  vyaduje,  aby  bìely  programy  IBM  PC  Network nebo Microsoft
Networks.

    Pøi  volání  podfunkce  5F02H  umístìte  do registru BX hodnotu indexu,
kterou  si pøejete ovìøit. V 16-bajtové oblasti na kterou ukazuje pár DS:SI
bude  navráceno  jméno lokálního zaøízení, jeho jméno pro práci v síti bude
navráceno v páru ES:DI. BL navrátí kód tyou zaøízení (3 pro tiskárnu, 4 pro
mechaniku  disku)  a  CX  navrátí  parametr (specifikovanı pomocí podfunkce
5F03H).

    Pokud  chcete  získat vıpis všech zaøízení pro práci v síti, provádìjte
tuto  funkci  opakovanì,  poèínaje  indexem (BX) nastavenım na 00H, hodnotu
indexu  v  BX  postupnì zvìtšujte o 1 a bude registr AX hlásit chybovı kód
12H (18).



 F u n k c e   5 F 0 3 H   ( 9 5 - 3 ) - pøesmìrování zaøízení

    vstup:    AH = 5FH
              AL = 03H
              BL = typ zaøízení (3=tiskárna, 4=disková mechanika)
              CX = uloenı parametr (všechny hodnoty kromì 0 jsou rezerv.)
              DS:SI = ukazatel na øetìzec ASCIIZ obsahující jméno lokálního
                      zaøízení
              ES:DI = ukazatel na øetìzec ASCIIZ obsahující cestu pro práci
                      v síti následovanou øetìzcem ASCIIZ obsahujícím heslo

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H
                   01H (1) - program pro obsluhu práce v síti není naèten
                   03H (3) - cesta nenalezena
                   05H (5) - poadavek odmítnut
                   08H (8) - nepostaèující pamì

    Funkce  5F03H umoòuje pøesmìrovat vstup/vıstup z lokální tiskárny nebo
diskové  mechaniky  na  síové  zaøízení.  Mùete  také  ovládat  pøístup k
síovému  zaøízení  pouitím  hesla.  Funkce  je moná pouze pro DOS 3.10 a
vyšší  a  vyaduje,  aby  bìely  programy  IBM  PC  Network nebo Microsoft
Networks.

Pozn.: Volejte   tuto   funkci  s  nastavenım  kódem  typu  zaøízení  v  BL
       (3=tiskárna,  4=disková  mechanika)  a  s  0  v CX. Pár DS:SI by mìl
       ukazovat na jméno zaøízení, které si pøejete pøesmìrovat a pár ES:DI
       by  mìl  ukazovat  na  øetìzec  ASCIIZ  udávající  jméno  pøíjmového
       síového  zaøízení.  Jméno  síového  zaøízení  musí bıt následováno
       druhım øetìzcem ASCIIZ specifikujícím heslo. Heslo mùe bıt dlouhé 0
       a  8  znakù; nechcete-li specifikovat ádné heslo, pouijte øetìzec
       ASCIIZ s nulovou délkou (prvním bajtem je bajt 0).

       Pokud  je  pøesmìrovávanım zaøízením tiskárna, jsou pøijatelná jména
       PRN, LPT1, LPT2 a LPT3. Pokud je pøesmìrovávanım zaøízením mechanika
       disku,  mìl byt zdrojovı øetìzec ASCIIZ obsahovat písmeno oznaèující
       disk následované dvojteèkou.

       Zdrojovı  øetìzec  mùe bıt i nulovı; v tomto pøípadì se DOS pokouší
       provést pøístup na jméno síového zaøízení se specifikovanım heslem.




 F u n k c e   5 F 0 4 H   ( 9 5 - 4 ) - zrušení pøesmìrování

    vstup:    AH = 5FH
              AL = 04H
              DS:SI = ukazatel  na øetìzec ASCIIZ specifikující buï lokální
                      zaøízení,  jeho  pøesmìrování  má  bıt zrušeno, nebo
                      jemu pøiøazené jméno síového zaøízenó.

    vıstup:   AX = chybovı kód (pokud je CF = 1) - viz funkce DOS 59H

    Tato funkce ruší døíve nastavená pøesmìrování na síová zaøízení. DS:SI
ukazuje  na  jméno zaøízení, jeho pøesmìrování má bıt zrušeno, to mùe bıt
buï  jméno  tiskárny (PRN, LPT1, LPT2 nebo LPT3), oznaèení disku nebo jméno
síového zaøízení (v posledním pøípadì by mìl bıt øetìzec ASCIIZ oznaèující
jméno  síového  zaøízení  následován druhım øetìzcem, kterı obsahuje heslo
spojené  s rušením). Funkce je moná pouze pro DOS 3.10 a vyšší a vyaduje,
aby bìely programy IBM PC Network nebo Microsoft Networks.





 F u n k c e   6 0 H   ( 9 6 ) - rezervováno



 F u n k c e   6 1 H   ( 9 7 ) - rezervováno




 F u n k c e   6 2 H   ( 9 8 ) - poskytnutí adresy prefixu program.segmentu

    vstup:    AH = 62H

    vıstup:   BX = segment prefixu programového segmentu PSP

    Funkce  navrací  v BX adresu segmentu prefixu programového segmentu PSP
souèasného procesu (tj. program, kterı právì probíhá). Tato funkce je moná
pouze pro DOS 3.00 a vyšší.
