**************************************************************************
ASM.HLP                                                            ASM.HLP


                                Obsah


     Kapitola 1  —vod do programovac¡ho jazyka assembler             5
        Hlavn¡ v˜hoda - rychlost a p©¡m‚ ©¡zen¡  . . . . . . . . . . 6
        Rodina mikroprocesor– 80286/80386  . . . . . . . . . . . . . 7
        Co budete schopni zvl dnout ihned po p©e‡ten¡ t‚to knihy . . 8
        Co tato kniha p©edpokl d  o v s  . . . . . . . . . . . . . . 8

     Kapitola 2  €¡seln‚ soustavy                                    9
        Bin rn¡ ‡¡sla  . . . . . . . . . . . . . . . . . . . . . . . 9
        Bin rn¡ se‡¡t n¡ a ode‡¡t n¡ . . . . . . . . . . . . . . .  11
        Datov˜ typ BYTE  . . . . . . . . . . . . . . . . . . . . .  12
        Datov˜ typ CHARACTER . . . . . . . . . . . . . . . . . . .  12
        €¡sla se znam‚nkem . . . . . . . . . . . . . . . . . . . .  13
        Dvojkov˜ doplnˆk (two's complement)  . . . . . . . . . . .  14
        Roz¨¡©en¡ znam‚nkov‚ho bitu  . . . . . . . . . . . . . . .  15
        Hexadecim ln¡ ‡¡sla  . . . . . . . . . . . . . . . . . . .  16
        Slova (words)  . . . . . . . . . . . . . . . . . . . . . .  17
        Dvouslova (doublewords)  . . . . . . . . . . . . . . . . .  18
        Nestandardn¡ pole bit– . . . . . . . . . . . . . . . . . .  19
        Bin rn¡ operace  . . . . . . . . . . . . . . . . . . . . .  20

     Kapitola 3  Adresovac¡ techniky                                23
        Bezprost©edn¡ adresov n¡ . . . . . . . . . . . . . . . . .  23
        Registrov‚ adresov n¡  . . . . . . . . . . . . . . . . . .  24
        P©¡m‚ adresov n¡ . . . . . . . . . . . . . . . . . . . . .  24
        Registrov‚ nep©¡m‚ adresov n¡  . . . . . . . . . . . . . .  25
        B zov‚ relativn¡ adresov n¡  . . . . . . . . . . . . . . .  26
        P©¡m‚ indexov‚ adresov n¡  . . . . . . . . . . . . . . . .  27
        B zov‚ indexov‚ adresov n¡ . . . . . . . . . . . . . . . .  27
        Extenze u 80386  . . . . . . . . . . . . . . . . . . . . .  28

     Kapitola 4  Programovac¡ styl                                  29
              Pole jm‚na (n vˆ¨t¡) . . . . . . . . . . . . . . . .  29

     Kapitola 5  —vod do assembleru                                 35
        Strojov˜ k¢d versus jazyk symbolick˜ch instrukc¡ . . . . .  36
        Typick˜ proces p©i v˜stavbˆ program– v assembleru  . . . .  37
        Programov  re‘ie . . . . . . . . . . . . . . . . . . . . .  39

     Kapitola 6  ARCHITEKTURA : REGISTRY, Pž‹ZNAKY A INSTRUKCE      43
        Mikroprocesor 80286  . . . . . . . . . . . . . . . . . . .  43
        Z kladn¡ architektura  . . . . . . . . . . . . . . . . . .  43
        Segmentov‚ registry  . . . . . . . . . . . . . . . . . . .  44
        Indexov‚ a b zov‚ registry. Registry ukazatele . . . . . .  44
        ž¡dic¡ registry a registry stavu (FLAGS) . . . . . . . . .  45
        Registr adresy instrukce (instruction pointer) . . . . . .  46
        Stavov‚ slovo procesoru (machine status word ) . . . . . .  46



                                     i 




        Mikroprocesor 80386  . . . . . . . . . . . . . . . . . . .  46
        Datov‚ typy 80386  . . . . . . . . . . . . . . . . . . . .  47
        Adresov n¡ operand– u 80386  . . . . . . . . . . . . . . .  47
        V˜po‡et efektivn¡ adresy u 80386 . . . . . . . . . . . . .  47
        Prov dˆn¡ k¢du mikroprocesoru 8086 na 80386  . . . . . . .  47
        Z kladn¡ architektura ‡ipu 80386 . . . . . . . . . . . . .  48
        Soubor v¨eobecn˜ch registr–  . . . . . . . . . . . . . . .  48
        Segmentov‚ registry  . . . . . . . . . . . . . . . . . . .  48
        Registr adresy instrukce a EFLAGS  . . . . . . . . . . . .  49
        ž¡dic¡ registry  . . . . . . . . . . . . . . . . . . . . .  49
        Registry syst‚mov˜ch adres . . . . . . . . . . . . . . . .  50
        Ladic¡ a trasovac¡ registry  . . . . . . . . . . . . . . .  50
        Zpracov n¡ v˜jime‡n˜ch stav– u 80286/80386 . . . . . . . .  50

     Kapitola 7  Instruk‡n¡ soubor mikroprocesor– 80286/80386       53
           AAA (80286/80386) . . . . . . . . . . . . . . . . . . .  53
           AAD (80286/80386) . . . . . . . . . . . . . . . . . . .  53
           AAM (80286/80386) . . . . . . . . . . . . . . . . . . .  54
           AAS (80286/80386) . . . . . . . . . . . . . . . . . . .  55
           ADC (80286/80386) . . . . . . . . . . . . . . . . . . .  55
           ADD (80286/80386) . . . . . . . . . . . . . . . . . . .  56
           AND (80286/80386) . . . . . . . . . . . . . . . . . . .  57
           ARPL (80286/80386)  . . . . . . . . . . . . . . . . . .  58
           BOUND (80286/80386) . . . . . . . . . . . . . . . . . .  59
           CALL (80286/80386)  . . . . . . . . . . . . . . . . . .  59
           CBW (80286/80386) . . . . . . . . . . . . . . . . . . .  61
           CLC (80286/80386) . . . . . . . . . . . . . . . . . . .  61
           CLD (80286/80386) . . . . . . . . . . . . . . . . . . .  62
           CLI (80286/80386) . . . . . . . . . . . . . . . . . . .  62
           CLTS (80286/80386)  . . . . . . . . . . . . . . . . . .  63
           CMC (80286/80386) . . . . . . . . . . . . . . . . . . .  63
           CMP (80286/80386) . . . . . . . . . . . . . . . . . . .  64
           CMPS/CMPSB/CMPSW (80286/80386)  . . . . . . . . . . . .  65
           CWD (80286/80386) . . . . . . . . . . . . . . . . . . .  66
           DAA (80286/80386) . . . . . . . . . . . . . . . . . . .  66
           DAS (80286/80386) . . . . . . . . . . . . . . . . . . .  67
           DEC (80286/80386) . . . . . . . . . . . . . . . . . . .  68
           DIV (80286/80386) . . . . . . . . . . . . . . . . . . .  68
           ENTER (80286/80386) . . . . . . . . . . . . . . . . . .  69
           HLT (80286/80386) . . . . . . . . . . . . . . . . . . .  70
           IDIV (80286/80386)  . . . . . . . . . . . . . . . . . .  71
           IMUL (80286/80386)  . . . . . . . . . . . . . . . . . .  72
           IN (80286/80386)  . . . . . . . . . . . . . . . . . . .  73
           INC (80286/80386) . . . . . . . . . . . . . . . . . . .  74
           INS/INSB/INSW (80286/80386) . . . . . . . . . . . . . .  74
           INT/INTO (80286/80386)  . . . . . . . . . . . . . . . .  76
           IRET (80286/80386)  . . . . . . . . . . . . . . . . . .  77
           J(podm¡nka) (80286/80386) . . . . . . . . . . . . . . .  77
           JMP (80286/80386) . . . . . . . . . . . . . . . . . . .  79
           LAHF (80286/80386)  . . . . . . . . . . . . . . . . . .  80
           LAR (80286/80386) . . . . . . . . . . . . . . . . . . .  81
           LSS/LFS/LGS (80386), LDS/LES (80286/80386)  . . . . . .  81
           LEA (80286/80386) . . . . . . . . . . . . . . . . . . .  82
           LEAVE (80286/80386) . . . . . . . . . . . . . . . . . .  83
           LGDT/LIDT (80286/80386) . . . . . . . . . . . . . . . .  83
           LLDT (80286/80386)  . . . . . . . . . . . . . . . . . .  84



                                    ii 




           LMSW (80286/80386)  . . . . . . . . . . . . . . . . . .  85
           LOCK (80386)  . . . . . . . . . . . . . . . . . . . . .  86
           LODS/LODSW/LODSB (80286/80386)  . . . . . . . . . . . .  87
           LOOP (80286/80386)  . . . . . . . . . . . . . . . . . .  87
           LSL (80286/80386) . . . . . . . . . . . . . . . . . . .  88
           LTR (80286/80386) . . . . . . . . . . . . . . . . . . .  89
           MOV (80286/80386) . . . . . . . . . . . . . . . . . . .  90
           MOVS/MOVSB/MOVSW (80286/80386)  . . . . . . . . . . . .  91
           MOVZX/MOVSX (80286/80386) . . . . . . . . . . . . . . .  92
           MUL (80286/80386) . . . . . . . . . . . . . . . . . . .  92
           NEG (80286/80386) . . . . . . . . . . . . . . . . . . .  93
           NOP (80286/80386) . . . . . . . . . . . . . . . . . . .  94
           NOT (80286/80386) . . . . . . . . . . . . . . . . . . .  95
           OR (80286/80386)  . . . . . . . . . . . . . . . . . . .  95
           OUT (80286/80386) . . . . . . . . . . . . . . . . . . .  96
           OUTS/OUTSB/OUTSW (80286/80386)  . . . . . . . . . . . .  96
           POP (80286/80386) . . . . . . . . . . . . . . . . . . .  97
           POPA (80286/80386)  . . . . . . . . . . . . . . . . . .  98
           POPF (80286/80386)  . . . . . . . . . . . . . . . . . .  99
           PUSH (80286/80386)  . . . . . . . . . . . . . . . . . . 100
           PUSHA (80286/80386) . . . . . . . . . . . . . . . . . . 100
           PUSHF (80286/80386) . . . . . . . . . . . . . . . . . . 101
           RCL/RCR/ROL/ROR (80286/80386) . . . . . . . . . . . . . 102
           REP/REPZ/REPE/PEPNE/REPNZ (80286/80386) . . . . . . . . 103
           RET (80286/80386) . . . . . . . . . . . . . . . . . . . 104
           SAHF (80286/80386)  . . . . . . . . . . . . . . . . . . 105
           SAL/SAR/SHL/SHR (80286/80386) . . . . . . . . . . . . . 105
           SBB (80286/80386) . . . . . . . . . . . . . . . . . . . 107
           SCAS/SCASB/SCASW (80286/80386)  . . . . . . . . . . . . 107
           SGDT/SIDT (80286/80386) . . . . . . . . . . . . . . . . 108
           SLDT (80286/80386)  . . . . . . . . . . . . . . . . . . 109
           SMSW (80286/80386)  . . . . . . . . . . . . . . . . . . 109
           STC (80286/80386) . . . . . . . . . . . . . . . . . . . 110
           STD (80286/80386) . . . . . . . . . . . . . . . . . . . 110
           STI (80286/80386) . . . . . . . . . . . . . . . . . . . 111
           STOS/STOSB/STOSW (80286/80386)  . . . . . . . . . . . . 111
           STR (80286/80386) . . . . . . . . . . . . . . . . . . . 112
           SUB (80286/80386) . . . . . . . . . . . . . . . . . . . 113
           TEST (80286/80386)  . . . . . . . . . . . . . . . . . . 114
           VERR/VERW (80286/80386) . . . . . . . . . . . . . . . . 114
           WAIT (80286/80386)  . . . . . . . . . . . . . . . . . . 115
           XCHG (80286/80386)  . . . . . . . . . . . . . . . . . . 115
           XLAT (80286/80386)  . . . . . . . . . . . . . . . . . . 116
           XOR (80286/80386) . . . . . . . . . . . . . . . . . . . 117

     Kapitola 8  Speci ln¡ instrukce 80386                         119
           IBTS  . . . . . . . . . . . . . . . . . . . . . . . . . 119
           MOV CRn . . . . . . . . . . . . . . . . . . . . . . . . 119
           MOV DRn . . . . . . . . . . . . . . . . . . . . . . . . 120
           MOV TRn . . . . . . . . . . . . . . . . . . . . . . . . 121
           SETcond.  . . . . . . . . . . . . . . . . . . . . . . . 121
           SHLD/SHRD . . . . . . . . . . . . . . . . . . . . . . . 123
           XBTS  . . . . . . . . . . . . . . . . . . . . . . . . . 124






                                    iii 




     Kapitola 9  P©¡klady program– v assembleru                    125

     Appendix A  Re ln˜ a privilegovan˜ m¢d 80286(80386)           131
              Literatura . . . . . . . . . . . . . . . . . . . . . 132



konec OBSAHU                                                       ASM.HLP
**************************************************************************


                               Obr zky


     Figure 2.1: Bity a byty jednoho slova . . . . . . . . . . . . .18
     Figure 3.1: P©¡m‚ adresov n¡  . . . . . . . . . . . . . . . . .25
     Figure 3.2: Nep©¡m‚ registrov‚ adresov n¡ . . . . . . . . . . .25
     Figure 3.3: B zov‚ relativn¡ adresov n¡ . . . . . . . . . . . .26
     Figure 3.4: B zov‚ indexov‚ adresov n¡  . . . . . . . . . . . .28


**************************************************************************

                               Tabulky


     Table 2.1: Dekadick , bin rn¡ a hexadecim ln¡ reprezentace
                ‡¡sel  . . . . . . . . . . . . . . . . . . . . . . .16
     Table 6.1: V˜jimky v privilegovan‚m m¢du 80286  . . . . . . . .51



                                    vii 

**************************************************************************




                           ASSEMBLER 80286/80386
 


                                   - 2 - 



                                   —vod



   Tato p©¡ru‡ka je koncipov na tak, aby splnila t©i c¡le:

   1.  uv‚st V s do svˆta mocn‚ho programov n¡  v  assembleru vyu‘¡vaj¡c¡ho
       mikroprocesor 80386/80286

   2.  nau‡it  V s,  jak  ps t  jednoduch‚  a  sou‡asnˆ  mocn‚  programy  v
       assembleru, a

   3.  poslou‘it jako referen‡n¡  p©¡ru‡ka  jak  souboru  instrukc¡,  tak i
       uk zkov˜ch program–


   Assembler  80386/80286  je  velice   mocnou   extenz¡   star¨¡ch  jazyk–
strojov˜ch instrukc¡, zejm‚na assembler– rodiny po‡¡ta‡– 8088/8086. Je to v
prv‚  ©adˆ  d–sledek  toho, ‘e v¨ichni  ‡lenov‚  rodiny  INTEL  80xxx  jsou
kompatibiln¡  zdola  nahoru.  Z kladn¡ instrukce a rysy  jazyka  jsou  tedy
spole‡n‚ prvn¡m mikroprocesor–m  i  t‚to posledn¡ s‚rii. Budouc¡ verze DOSu
poskytnou mo‘nosti  p©¡stupu i k "vy¨¨¡m" vlastnostem programov n¡, jako je
nap©. programov n¡ v chr nˆn‚m re‘imu  (protected mode): to ov¨em povede ke
zvˆt¨en¡ rozd¡l– mezi star¨¡mi a novˆj¨¡mi verzemi assembler–.

   Assembler  je mocn˜ jazyk poskytuj¡c¡ program torovi absolutn¡  kontrolu
nad po‡¡ta‡em. Jazyky vy¨¨¡ £rovnˆ (jako je PASCAL, Ada,  FORTRAN  a  jin‚)
ponech vaj¡ program tora  zcela  na  pospas  libov–li  autor–  kompil toru.
Jestli‘e autor u‘ivatelsk‚ho programu pou‘ije  nap©.  adapt‚r  na  hry jako
za©¡zen¡, k nˆmu‘ se jeho program obrac¡, pak je v¨e v  po© dku, kompil tor
s t¡m "po‡¡t ". Pokud ale nevyu‘ijete tˆchto nab¡zen˜ch mo‘nost¡, co  pak ?
V  assembleru m–‘ete ps t sv‚ vlastn¡  u‘ivatelsk‚  programy  nebo  dokonce
vyu‘¡vat velice efektivn¡ch slu‘eb  BIOSu,  kter‚  poskytuje  p©¡mo v˜robce
po‡¡ta‡e. V podstatˆ je velk  vˆt¨ina program– psan˜ch v assembleru u‘¡v na
coby z platy (patches) na vy¨¨¡ programovac¡ jazyky : tyto z platy se sna‘¡
dodefinovat ve  vy¨¨¡m programovac¡m jazyku to, co auto©i kompil toru mo‘n 
p©ehl‚dli.

   Tato  kniha  vysvˆtluje  programov n¡  na  p©¡kladech  -  na kompletn¡ch
p©¡kladech : s ka‘d˜m programem je k dispozici listing se  v¨emi nezbytn˜mi
pozn mkami. Jin˜mi slovy -  jestli‘e  zap¡¨ete program p©esnˆ tak, jak je v
tomto manu lu uveden, ur‡itˆ spr vnˆ pobˆ‘¡. Nenaleznete zde ‘ dn‚ zkr cen‚
p©¡klady nebo ‡ ste‡n‚ v˜pisy,  kter‚  by  mˆly  u¨et©it m¡sto. Na¨im c¡lem
bylo u ka‘d‚ho p©¡kladu vysvˆtlit a dokumentovat jej tak, aby usnadnil va¨e
studium jednotliv˜ch  instrukc¡ a programovac¡ho stylu, aŸ ji‘ jste nov ‡ek
nebo zku¨en˜ program tor.





                                   - 3 - 



                                   - 4 - 




                            K a p i t o l a   1

                  —vod do programovac¡ho jazyka assembler


   Studium programovac¡ho jazyka nejni‘¨¡  £rovnˆ  -  assembleru - m–‘e b˜t
jedn¡m z  nejvdˆ‡nˆj¨¡ch  a  technicky  nejinspirativnˆj¨¡ch  ‡innost¡,  ke
kter˜m se softwareov˜ specialista odhodl . Jakmile m te  p©¡slu¨n‚ n stroje
a  v¡te,  jak  zkombinovat  vy¨¨¡   programovac¡   jazyk   s  nejr–znˆj¨¡mi
hardwareov˜mi konfiguracemi  va¨eho  po‡¡ta‡e,  jste  opravdu  p nem  sv‚ho
stroje. Subtiln¡ ovl d n¡ periferi¡ a spr va pamˆti,  efektivnost program–,
rychlost  a  ochrana  dat  -  to  v¨e  ‡ek   na  program tora  tvo©¡c¡ho  v
assembleru. Nicm‚nˆ zvl dnut¡ assembleru vy‘aduje  zku¨enosti  a  smysl pro
detaily.

   I kdy‘ jste zainteresov n ve specializovan‚ oblasti  v˜voje programov‚ho
vybaven¡,  assembler  se   stane  va¨¡m  druh˜m  nejmocnˆj¨¡m  vyjad©ovac¡m
jazykem.   Proto‘e  assembler  umo‘¤uje  program torovi  p©¡m˜  p©¡stup   k
registr–m, pamˆti a jedine‡n‚mu svˆtu bitovˆ orientovan˜ch instrukc¡, ‡asto
p©edstavuje jedinou mo‘nost ©e¨it softwareov‚  probl‚my  le‘¡c¡  mimo dosah
prost©edk– vy¨¨¡ho programovac¡ho jazyka.

   Program v asembleru bude  produkovat  nejrychleji  interpretovan˜ c¡lov˜
program, proto‘e obch z¡  pou‘it¡ kompil toru vy¨¨¡ho programovac¡ho jazyka
(PASCAL, PL/I, C apod.). Tato v˜hodn  rychlost ov¨em nen¡ zadarmo.

   Program to©i v assembleru mus¡ vˆnovat svou pozornost  detail–m. Program
v assembleru ©¡d¡ mikroprocesor v jeho "vlastn¡m" jazyce, bez kompil tor– a
jeho kontroln¡ch prost©edk–.  V˜sledkem tˆchto velice element rn¡ch operac¡
vykon van˜ch na £rovni  assembleru  je  to,  ‘e  jedna  str nka  programu v
assembleru je t‚mˆ© nesrovnateln  s  esoterickou  sofistikou  jedn‚ str nky
programu  ve  vy¨¨¡m  programovac¡m jazyce. Z tohoto  d–vodu  nen¡  vˆt¨ina
vˆt¨¡ch program– ps na  v  assembleru. ( V˜jimkou jsou softwareov‚ projekty
financovan‚ vˆt¨¡mi spole‡nostmi,  kter‚  jsou  ochotn‚  platit  zna‡n˜ ‡as
nutn˜ k naps n¡ extr‚mnˆ rychl‚ho a efektivn¡ho aplika‡n¡ho programu).

   Jestli‘e  "hovo©¡me"  strojov˜m jazykem, vy‘aduje  to  porozumˆn¡  mnoha
koncept–m zcela ciz¡m vy¨¨¡m programovac¡m  jazyk–m.  Program tor  v jazyce
assembler mus¡  uva‘ovat segmentaci pamˆti. Tam, kde pou‘¡v  p©¡m‚ho ©¡zen¡
p©¡stupu k  opera‡n¡ pamˆti, je t©eba prov dˆt velice delik tn¡ rozhodnut¡.
Kde by mˆla b˜t uchov na data programu a kde program samotn˜ ? Je zapot©eb¡
z sobn¡ku ? Jesli‘e ano, v jak‚ ‡ sti pamˆti by mˆl  b˜t  um¡stˆn ? Pe‡liv 
rozhodnut¡ se t˜kaj¡ tak‚ alokace  pamˆti pro jednotliv  data (byty, slova,
dvouslova atp.) i typu techto  dat (©etˆzce, statick‚ a dynamick‚ promˆnn‚,
data v pevn‚ a pohybliv‚ © dov‚ ‡ rce atp.). Stejnˆ detailn¡  rozhodnut¡ se
t˜kaj¡  dat  zpracov van˜ch koprocesory 80287/80387,  p©¡stupu  k  obrazov‚
pamˆti monitor–, k tisk rn m apod. Mnoh‚ z uveden˜ch aspekt– jsou jedine‡n‚
pr vˆ p©i vytv ©en¡ program– v assembleru.





                                   - 5 - 




---------------------------------------------------------------------------
Hlavn¡ v˜hoda - rychlost a p©¡m‚ ©¡zen¡
---------------------------------------------------------------------------


   Jednou  z hlavn¡ch v˜hod assembleru je skvˆl   rychlost,  s  jakou  jsou
programy  vykon v ny.  Program  v  assembleru  je  jen  symbolick˜m obrazem
v˜sledn‚ho strojov‚ho  k¢du  -  lze  ©¡ci,  ‘e  program ve strojov‚m k¢du a
assemblerovsk˜   program  jsou  isomorfn¡  syst‚my.  Instrukce  na   £rovni
strojov‚ho k¢du jsou pak vykon v ny v mikrosekundov˜ch ‡asech.

   Interprety, jako nap©.  interprety  BASICu  ‡i  APL,  analyzuj¡ zdrojov˜
program  a  prov dˆj¡  -  © dek  po  © dku  -  translaci do strojov‚ho k¢du
po‡¡ta‡e,   volaj¡ce  p©itom  celou  ©adu  vestavˆn˜ch  podprogram–.   Tyto
podprogramy  byly   p©edem   naps ny   a   predestinov ny   pro   konkr‚tn¡
mikroprocesor.   Proto‘e  je  bˆhem  vykon v n¡  programu  nezbytn‚   znovu
vy‡¡slovat  v˜razy  a  prov dˆt  o¨et©ov n¡  chyb,  je  vykon v n¡ takov‚ho
programu velice pomal‚.

   Kompil tory, jako nap©. kompil tory PASCALu,  PL/I  nebo  FORTRANu, ‡tou
zdrojov˜ program  a transformuj¡ jej do sekvence opera‡n¡ch k¢d– (p©esnˆji:
instrukc¡), kter‚ mikroprocesor  bude vykon vat p©¡mo. Kompilovan‚ programy
jsou tedy rychlej¨¡ ne‘ interpretovan˜ zdrojov˜ program, proto‘e p©eklad je
prov dˆn jen jednou.

   Kompilovan‚ programy v¨ak maj¡ jednu nev˜hodu: kompil tor mus¡ zajistit,
‘e  zkompilovan˜  program  bude  prov dˆt  zna‡n‚  mno‘stv¡  operac¡ 'vy¨¨¡
£rovnˆ' -  nap©. spolupracovat s periferiemi, syst‚mem soubor– atp. Zm¡nˆn‚
operace  zp–sobuj¡,  ‘e  kompilovan˜ program je ‡asto zna‡nˆ rozs hl˜ i p©i
nevelk‚m zdrojov‚m programu. Tak  nap©.  kompilovan˜  program v BASICu m–‘e
zabrat snadno 33 Kbyte  opera‡n¡  (a tedy i diskov‚) pamˆti, p©i‡em‘ tiskne
jen p r znak–  na  termin l.  Stejn˜  program psan˜ v assembleru by zab¡ral
nap©. jen 10 KByte, t.j. jen t©etinu pamˆŸov‚ho prostoru.

   Pod¡vejme se nyn¡ je¨tˆ  na  druhou  hlavn¡  v˜hodu program– zapsan˜ch v
assembleru. Bez assembleru by byl u‘ivatel  omezen  jen na to, co mu nab¡z¡
"profesion ln¡"  programy.  Nap©.  jestli‘e  nˆkdo nap¡¨e aplika‡n¡ program
zpracov vaj¡c¡  vysoce  kritick   data  a  jeho  u‘ivatel  je osoba  s  jen
‡ ste‡n˜m  zasvˆcen¡m  do   po‡¡ta‡ov‚  problematiky,  bude  velice  vhodn‚
zabr nit takov‚mu u‘ivateli ve stisknut¡  kl ves  CTRL-ALT-DEL,  kter‚ m–‘e
data  zcela zni‡it. Inhibice t‚to akce m–‘e b˜t  zaji¨tˆna  jen  na  £rovni
assembleru.

   Assemblery  umo‘¤uj¡  softwareov˜m odborn¡k–m pru‘n˜  styk  s  opera‡n¡m
syst‚mem a  poskytuj¡ jim mo‘nost p©¡m‚ho ©¡zen¡ vstup/v˜stupn¡ch operac¡ s
periferiemi (disky, tisk rny, diskety aj.). Aplika‡n¡ program tor mus¡ tak‚
‡asto  p©¡mo komunikovat s opera‡n¡m syst‚mem.  Takov‚  programy  pak  jsou
obvykle ps ny v assembleru.











                                   - 6 - 




---------------------------------------------------------------------------
Rodina mikroprocesor– 80286/80386
---------------------------------------------------------------------------


   Prvn¡  integrovan˜  obvod  (IO)  byl   vyvinut   v   ¨edes t˜ch  letech.
Integrovan˜ obvod prudce redukoval velikost kapacitor–, diod  a tranzistor–
a v¨echny je umistil na plochu pl tku z ‡ist‚ho k©em¡ku. Deset  let pozdˆji
vyvinul INTEL sv–j prvn¡ mikroprocesorov˜ ‡ip, INTEL 8008. V roce 1974 byla
vyvinuta   druh    generace    mikroprocesorov˜ch    ‡ip–,   reprezentovan 
mikroprocesorem 8080. Tento obvod nab¡dl u‘ivateli  v¨eobecn‚  mo‘nosti. Ve
stejn‚ dobˆ konkurence vrhla na  rychle se roz¨i©uj¡c¡ trhy dal¨¡ produkty,
nap©¡klad mikroprocesor ZILOG Z-80.

   T©et¡ generace mikroprocesor– n sledovala hned po ‡ty©ech letech. V roce
1978 vyvinula firma INTEL  mikroprocesor  8086.  A‡koliv tento ‡ip vykazuje
jist‚ rysy  kompatibility se sv˜m "p©edkem", 8080, m  mnohem avantgardnˆj¨¡
design, s mnoha nov˜mi  rysy.  INTEL  tak‚  vyvinul mikroprocesor 8088 jako
variantu  ‡ipu  8086.  Mikroprocesor 8088 umo‘nil o nˆco jednodu¨¨¡ n vrh a
zahrnul  kompatibilitu  s  bˆ‘n˜mi   I/O   za©¡zen¡mi.   Architekturou  byl
mikroprocesor 8088 jedn¡m z nejpokrokovˆj¨¡ch mikroprocesor–  t‚  doby. Mˆl
takov‚ kvality, ‘e jej  firma  IBM pou‘ila za z kladn¡ stavebn¡ element sv‚
nov‚ ©ady osobn¡ch po‡¡ta‡–.

   Ve  stejn‚  dobˆ  se  objevil  i  "bratranec"  mikroprocesor– 8088/8086:
matematick˜ koprocesor  8087. Tento numerick˜ procesor by ur‡en k realizaci
rychl˜ch v˜po‡t– v pohybliv‚ © dov‚ ‡ rce.

   INTEL v¨ak nez–stal jen  u  sv˜ch  star˜ch  £spˆch–. Uprost©ed roku 1984
ohl sila  tato  spole‡nost  dal¨¡  technologick˜ skok: mikroprocesor 80286.
Tato centr ln¡ jednotka nov‚  generace  byla  navr‘ena zejm‚na pro aplikace
vy‘aduj¡c¡ vysokou v˜konnost. Mikroprocesor 80286, jsa dol–  kompatibiln¡ s
8086/8088, tˆ‘¡ z v˜hod takov˜ch progres¡vn¡ch rys– po‡¡ta‡– t©et¡ a ‡tvrt‚
generace,  jakou  jsou  spr va pamˆti, mechanismy ochrany,  spr va  £loh  a
podpora virtu ln¡  pamˆti.  V¨echny  zm¡nˆn‚  vlastnosti  zaji¨Ÿuje  jedin˜
VLSI-‡ip,    kter˜   poskytuje   u‘ivateli   mikropo‡¡ta‡e   v˜po‡etn¡    a
architektur ln¡ potenci minipo‡¡ta‡e.

   Mikroprocesor  80286  je  zdola  nahoru  kompatibiln¡  s  8086/8088 d¡ky
spole‡n‚  mno‘inˆ  instrukc¡   a  adresov˜ch  m¢d–.  Z kladn¡  architektura
podporuje  vy¨¨¡  programovac¡  jazyky jako PASCAL, PL/M a C, proto‘e n vrh
souboru registr– je p©¡hodn˜ pro k¢d generovan˜ kompil torem.

   Mikroprocesor 80286 podporuje  ©adu  mocn˜ch  datov˜ch  typ–,  jako jsou
nap©. ©etˆzce, form ty v BCD k¢du  a  v pohybliv‚ © dov‚ ‡ rce. N vrh 80286
tak‚ podporuje efektivn¡  adresov n¡ takov˜ch komplexn¡ch datov˜ch struktur
jako jsou statick /dynamick  pole, z znamy a pole uvnit© z znam–.

   PamˆŸov  architektura 80286 podporuje techniky modul rn¡ho programov n¡,
kter‚  softwareov‚mu  specialistovi   umo‘¤uj¡  dˆlit  pamˆt  do  segment–.
Segmentov n¡ pamˆti poskytuje krat¨¡ k¢d, proto‘e reference uvnit© segmentu
mohou  b˜t krat¨¡. Paradigma segmentace samo  o  sobˆ  podporuje  efektivn¡
implementaci d–mysln‚ spr vy pamˆti - nap©. techniku virtualizace a ochrany
pamˆti. Mikroprocesor 80286 tak‚ poskytuje velk˜ adresov˜ prostor k podpo©e
sou‡asn˜ch aplika‡n¡ch po‘adavk–. Fyzick  pamˆŸ sest v  a‘ z  16  MByte RAM
nebo  ROM.  Tento  obrovsk˜   adresov˜   prostor   umo‘¤uje  mikroprocesoru



                                   - 7 - 




ponech vat v  pamˆti sou‡asnˆ nˆkolik rozs hl˜ch program– a jejich datov˜ch
struktur, ‡¡m‘ je k nim umo‘nˆn rychl˜ p©¡stup.

   Pro  aplikace  s  dynamicky  se  mˆn¡c¡mi  po‘adavky  na opera‡n¡  pamˆŸ
(multiu‘ivatelsk‚  syst‚my)  d v   80286  ka‘d‚mu  u‘ivateli  a‘   1  GByte
virtu ln¡ho  adresov‚ho prostoru. Rozs hl˜ adresov˜ prostor t‚mˆ©  vylu‡uje
omezen¡ na velikost nebo po‡et program–, kter‚ mohou b˜t ‡ st¡ syst‚mu.

   INTEL  80286  je  ur‡en  k   podpo©e   multiu‘ivatelsk‚ho   prost©ed¡  a
multiprogramov˜ch   re‘im–  v   re ln‚m   ‡ase.   Mikropo‡¡ta‡ov‚   syst‚my
obsluhuj¡c¡ ‡ty©i ‡i pˆt u‘ivatel– sou‡asnˆ mohou nyn¡  expandovat  tak, ‘e
podpo©¡ t©ikr t tolik u‘ivatel–, a syst‚my pracuj¡c¡ v  re ln‚m  ‡ase budou
m¡t odezvy asi ¨estinov‚ ve srovn n¡ s d©¡vˆj¨¡m stavem.

   Posledn¡ (dosud) ‡len rodiny mikroprocesor– firmy INTEL je mikroprocesor
80386. Jeho 32-bitov   extern¡  datov   sbˆrnice  m–‘e  adresovat  a‘  4 GB
opera‡n¡ pamˆti.



---------------------------------------------------------------------------
Co budete schopni zvl dnout ihned po p©e‡ten¡ t‚to knihy
---------------------------------------------------------------------------


   Po  p©e‡ten¡  textu  a vyzkou¨en¡ program– z¡sk te  solidn¡  znalosti  o
vnit©n¡  architektu©e  80286/80386.  Budete  velice  d–kladnˆ  sezn meni  s
instruk‡n¡m souborem a se strukturou  registr–  mikroprocesoru  a  s jejich
pou‘¡v n¡m. Pot‚, co  se  nau‡¡te assembler, pochop¡te, jak po‡¡ta‡ pracuje
na  t‚ nejz kladnˆj¨¡ £rovni (ozna‡ovan‚ t‚‘  jako  strojov )  a  pochop¡te
v˜hody a nev˜hody programov n¡ v assembleru.



---------------------------------------------------------------------------
Co tato kniha p©edpokl d  o v s
---------------------------------------------------------------------------


   Tato  kniha  p©edpokl d ,  ‘e ji‘ zn te nˆkter˜  z  roz¨¡©en˜ch  vy¨¨¡ch
programovac¡ch jazyk–, jako jsou nap©.  PASCAL nebo BASIC. Nebudeme se v¨ak
nikterak sna‘it o vyu‡ov n¡ tˆmto  jazyk–m.  Znalost  hexadecim ln¡ ‡¡seln‚
soustavy  je vhodn , nikoliv v¨ak bezpodm¡ne‡nˆ nutn  -  tot‚‘  plat¡  i  o
znalostech logick˜ch operac¡ AND, NAND,  OR,  NOR,  XOR,  SHIFT LEFT/RIGHT,
ROTATE, COMPLEMENT atd.














                                   - 8 - 










                            K a p i t o l a   2

                             €¡seln‚ soustavy


   Porozumnˆn¡  tomu, jak po‡¡ta‡ uchov v  informaci,  je  do  zna‡n‚  m¡ry
kritick‚ pro pochopen¡ programov n¡ na  £rovni  assembleru.  Jak  jsou data
reprezentov na vnit©nˆ v po‡¡ta‡iú? Jeliko‘ je po‡¡ta‡ elektrick‚ za©¡zen¡,
"rozum¡" jen £rovn¡m napˆt¡. Specificky vˆt¨ina  mikroprocesor–  je z visl 
na  p©¡tomnosti ‡i nep©¡tomnosti dvou spolehlivˆ rozli¨iteln˜ch  napˆŸov˜ch
£rovn¡.  M–‘eme  tyto  £rovnˆ  pova‘ovat  za  charakteristiky  zapnut¡ nebo
vypnut¡, za 1 nebo 0. Dvojice 0/1 je ozna‡ov na tak‚ jako bit.

   Lid‚ od prapo‡ tku pou‘¡vali des¡tkovou ‡¡selnou soustavu,  proto‘e maj¡
deset prst–. Po‡¡ta‡e "rozum¡" pouze dvˆma odli¨n˜m stav–m, reprezentovan˜m
symboly 0 a 1. To p©irozenˆ vede ke  komunika‡n¡m  probl‚m–m  mezi  lidmi a
po‡¡ta‡i.  V˜voj  r–zn˜ch  symbolick˜ch  k¢d–  byl  p©¡m˜m  d–sledkem  t‚to
jazykov‚ neslu‡itelnosti.

   K¢d ASCII  (American  Standard  Code  for  Information  Interchange) byl
navr‘en proto, aby byl s to reprezentovat v¨echny  symboly  kter‚ v¨eobecnˆ
spojujeme  s  kl vesnic¡  psac¡ho  stroje.  Nˆkolik  ‡¡seln˜ch   k¢d–  bylo
vytvo©eno k tomu. aby reprezentovaly  ‡¡seln‚ hodnoty v takov‚ formˆ, kter‚
po‡¡ta‡  rozum¡.  Dvojkov˜ dopl¤kov˜ k¢d  umo‘¤uje  po‡¡ta‡i  reprezentovat
kladn   i  z porn   cel   ‡¡sla.  Jeden z nejd–le‘itˆj¨¡ch  ‡¡seln˜ch  k¢d–
pot©ebn˜ch  pro  praxi  program tora  v  assembleru  je  k¢d hexadecim ln¡.
Hexadecim ln¡ z pis zlep¨uje ‡itelnost informac¡ reprezentovan˜ch v bin rn¡
podobˆ aŸ jde ji‘ o data, instrukce nebo adresy v pamˆti.



---------------------------------------------------------------------------
Bin rn¡ ‡¡sla
---------------------------------------------------------------------------


   Na¨e  dekadick    ‡¡seln   soustava  m   sv‚  jm‚no  od  deseti  (deka-)
jednotliv˜ch ‡¡slic 0,1,...,9, kter‚ jsou  jedin˜mi  p©¡pustn˜mi  znaky pro
z pis (cel‚ho) dekadick‚ho ‡¡sla. Bin rn¡  soustava  m   jen  dva p©¡pustn‚
symboly - 0 a 1. M–‘e se zd t, ‘e je  to  pro  z pis  velk˜ch  ‡¡sel  po‡et
symbol– naprosto nedostate‡n˜. Snadno v¨ak nahl‚dnete, ‘e  z kladn¡ princip
bin rn¡ soustavy je nˆco, co u‘ d vno zn te.

   Nejprve  se  pod¡vejme  na nˆjak‚ dekadick‚  ‡¡slo  -  ©eknˆme  1024.  V
z kladn¡  ¨kole  jsme  se u‡ili, ‘e toto ‡¡slo m  4  jednotky,  2  des¡tky,
‘ dnou stovku a jednu  tis¡covku.  To  je  vlastnˆ vyj d©en¡ v hov‚ ‡¡seln‚
reprezentace ‡¡sla 1024. Tak jak se pohybujete zprava  doleva  po ‡¡slic¡ch
dan‚ho  ‡¡sla,  zvˆt¨uje  se v ha ka‘d‚ dal¨¡ ‡¡slice. Na¨e dekadick‚ ‡¡slo
(tedy ‡¡slo v soustavˆ o z kladu 10) si m–‘eme myslet v n sleduj¡c¡m tvaru




                                   - 9 - 




 1   0   2   4
 -   -   -   -    7   0
 |   |   |   +--- 4 x 10 =      4 (bit LSB)
 |   |   |              1
 |   |   +------- 2 x 10 =     20
 |   |                  2
 |   +----------- 0 x 10 =    000
 |                      3
 +--------------- 0 x 10 =   1000 (bit MSB)
                             ====
                             1024



   Konverzi  jsme  provedli  vyn soben¡m  ka‘d‚  ‡¡slice  v  ‡¡sle z kladem
soustavy, kter˜ byl umocnˆn na odpov¡daj¡c¡ exponent. Exponent se zvy¨uje o
1 s ka‘dou dal¨¡ ‡¡slic¡ p©i postupu vy‡¡slov n¡ od bitu LSB po bit MSB.

   Stejn˜  postup  zachov me  i p©i konverzi ‡¡sla zapsan‚ho v jin‚ ‡¡seln‚
soustavˆ,  nap©.  ve  dvojkov‚.  Mˆjme  tedy  t©eba  bin rn¡ ‡¡slo  1010  a
konvertujme jej do des¡tkov‚ soustavy:

 1   0   1   0
 -   -   -   -          0
 |   |   |   +--- 0 x  2 =      0 (bit LSB)
 |   |   |              1
 |   |   +------- 1 x  2 =      2
 |   |                  2
 |   +----------- 0 x  2 =      0
 |                      3
 +--------------- 1 x  2 =      8 (bit MSB)
                             ====
                               10



   V tomto p©¡padˆ jsme u‘ili z kladu soustavy 2. P©eveden¡  ‡¡sla  z  jin‚
‡¡seln‚ soustavy  do dekadick‚ je velice jednoduch‚: prostˆ zmˆn¡me hodnotu
z kladu, algoritmus p©evodu z–stane stejn˜.

   Vidˆli  jsme,  jak  snadn‚ je p©ev‚st dvojkov‚ ‡¡slo na ‡¡slo dekadick‚.
Opa‡n˜ p©evod - z dekadick‚ soustavy do dvojkov‚ -  je  rovnˆ‘  jednoduch˜:
ode‡teme jen mocniny ‡¡sla  2  od ‡¡sla, kter‚ m  b˜t konvertov no. žeknˆme
nap©.,  ‘e chceme p©ev‚st dekadick‚ ‡¡slo 11  na  ‡¡slo  dvojkov‚.  Za‡neme
ode‡ten¡m 2x2x2=8 od 11. Dostaneme zbytek 3. Ode‡ten¡ dal¨¡ mocniny z kladu
2X2=4 prov‚st nelze, ale ode‡ten¡ dal¨¡ mocniny z kladu 2  d v   zbytek  1.
Nakonec ode‡teme posledn¡ mocninu z kladu 2, t.j. 1, a dostaneme  zbytek 0.
Cel˜ postup n m d v  konverzi dekadicky 11 = dvojkovˆ 1011.

   Jednodu¨¨¡ metodou vhodnou i pro  velk   dvojkov   ‡¡sla  je n sleduj¡c¡
postup. Je tvo©en s‚ri¡ opakovan˜ch dˆlen¡, p©i‡em‘ z klad soustavy, do n¡‘
se p©ev d¡, je dˆlitelem, a p©ev dˆn‚ ‡¡slo je dˆlencem. P©evod dekadick‚ho
‡¡sla 50 do bin rn¡ soustavy vypad  takto:






                                  - 10 - 




---------------------------------------------------------------------------
     Dˆlenec    Dˆlitel  V˜sledek    Zbytek     ---->     V˜sledek:
---------------------------------------------------------------------------
       50          2       25          0         |
       25          2       12          1         |         110010
       12          2        6          0         |
        6          2        3          0         |
        3          2        1          1         |
        1          2        0          1         |
---------------------------------------------------------------------------



   Tuto metodu m–‘ete pou‘¡t  pro  p©evod  dekadick‚ho  ‡¡sla do soustavy o
jak‚mkoliv z kladu. Nap©. p©i  p©evodu  ‡¡sla  428 do ¨estn ctkov‚ soustavy
jednodu¨e polo‘¡te dˆlenec=428, dˆlitel=16.



---------------------------------------------------------------------------
Bin rn¡ se‡¡t n¡ a ode‡¡t n¡
---------------------------------------------------------------------------


   Bin rn¡ se‡¡t n¡ a ode‡¡t n¡ jsou  identick‚  s  dekadick˜m  se‡¡t n¡m a
ode‡¡t n¡m,  vyjma  toho,  ‘e generujeme p©enos nebo  v˜p–j‡ku  p©i  ur‡it‚
mocninˆ ‡¡sla 2, a ne ‡¡sla 10. Uveƒme stru‡nˆ dva p©¡klady:

    25
+   85
------
   110

   V tomto p©¡kladˆ p©i se‡¡t n¡ dvou ‡¡slic 5 generujeme p©enos do dal¨¡ho
© du, t.j. do stovek, p©i‡ten¡m 1 k dal¨¡mu sloupci


   Bin rn¡ se‡¡t n¡ tedy bude vypadat takto:

   1010 (10)
+  0011 (3)
-----------
   1101 (13)

Zde 0+1  d v   v˜sledek  1,  p©enos 0. 1+1 d v  sou‡et 2 (bin rnˆ 10), tedy
v˜sledek 0, p©enos 1 - p©enos p©i‡teme k dal¨¡mu © du

   Bin rn¡  ode‡¡t n¡  u‘¡v  stejn˜ch princip–  jako  ode‡¡t n¡  dekadick‚.
Jedin˜m  rozd¡lem  je, ‘e p©i generov n¡ v˜p–j‡ky  z  vy¨¨¡ho  © du  je  na
ur‡itou mocninu umocnˆn z klad 2, nikoliv z klad 10.









                                  - 11 - 




      534
   -  251
   ------
      283

   Jedni‡ku ode‡teme od 4 bez obt¡‘¡. P©i ode‡¡t n¡ ‡¡sla 5 od 3 pot©ebujeme v¨ak vytvo©it v˜p–j‡ku z dal¨¡ho © du, t.j. ze stovek. To pak umo‘n¡ ode‡¡st 50 od 130.

   Bin rn¡ ode‡¡t n¡ tedy bude vypadat takto:

      1010
   -  0110
   -------
      0101

P©i ode‡ten¡ 0 od 1 v bitu LSB net©eba v˜p–j‡ky. Ve t©et¡m sloupci v¨ak pot©ebujeme v˜p–j‡ku 2x2x2 = 8. Tak dostaneme ve 3. sloupci 1 a v˜sledek ode‡¡t n¡ je 0101.



---------------------------------------------------------------------------
Datov˜ typ BYTE
---------------------------------------------------------------------------


   Je¨tˆ ne‘ budeme pokra‡ovat v  diskusi  o  r–zn˜ch  ‡¡seln˜ch syst‚mech,
mus¡me p©ipomenout, jak vlastnˆ ‡¡sla uchov v  po‡¡ta‡ ve sv˜ch technick˜ch
prost©edc¡ch  (pamˆtech).  Architektura   po‡¡ta‡e  toti‘  do  zna‡n‚  m¡ry
determinuje form t a rozsah jak program–, tak i dat.

   U  mikroprocesoru  80286  je  pamˆŸov‚  m¡sto  posloupnost¡   osmi  bit–
ozna‡ovan˜ch jako byte. Pozice bit– jsou ‡¡slov ny od bitu LSB (m  ‡¡slo 0)
po  bit  MSB  (m    ‡¡slo   7).  Dal¨¡  obr zek  ukazuje  nˆkolik  po  sobˆ
n sleduj¡c¡ch pamˆŸov˜ch m¡st, z nich‘  ka‘d‚  obsahuje  jeden  byte nˆjak‚
informace. Tato informace  m–‘e  b˜t  strojovou  instrukc¡,  adresou jin‚ho
pamˆŸov‚ho m¡sta nebo ‡¡slem ‡i znakem.

   Ka‘d˜  byte m–‘e ve sv˜ch osmi  bitech  reprezentovat  256  jednotliv˜ch
stav–. To tedy umo‘¤uje zobrazit v jednom byte kladn  ‡¡sla 0 a‘ 255. Jeden
byte  m–‘e tak‚ nab˜vat hodnoty jednoho znaku  ASCII.  Slovo  je  technick˜
pojem, ozna‡uj¡c¡ spojen¡  bit–  do jedn‚ informa‡n¡ jednotky pamˆti. Slovo
m–‘e  b˜t dlouh‚ 8, 16 nebo 32 bit– (pop©. i v¡ce nebo m‚nˆ podle  aplikace
po‡¡ta‡e). V architektu©e 80286 je slovo  dlouh‚  16 bit–, u 80386 m  slovo
d‚lku 32 bit–.



---------------------------------------------------------------------------
Datov˜ typ CHARACTER
---------------------------------------------------------------------------


   Osmice bit– v jednom  byte  nemus¡ reprezentovat jen ‡¡sla. K¢d ASCII je
sedmibitov˜ k¢d  umo‘¤uj¡c¡ reprezentaci p¡smen i ‡¡slic v pamˆti po‡¡ta‡e.
Ka‘d‚mu p¡smenu, ‡¡slici  nebo  speci ln¡mu (©¡dic¡mu) znaku je t¡mto k¢dem
p©i©azena bin rn¡ reprezentace na 7 bitech v jednom  byte.  Sedmibitov˜ k¢d
m–‘e reprezentovat 128 jednotliv˜ch symbol–.  Osm˜, zb˜vaj¡c¡ bit v byte je
nˆkdy vyu‘¡v n ke kontrole p©i p©enosu dat (paritn¡  bit).  Nˆkte©¡ v˜robci



                                  - 12 - 




pamˆt¡  ROM  vyu‘¡vaj¡  osm‚ho bitu k zaveden¡  roz¨¡©en‚ho  souboru  znak–
(extended  character   set).   P©id n¡m   jedin‚ho   bitu   tak   dos hneme
zdvojn soben¡ po‡tu jednozna‡nˆ reprezentovateln˜ch znak– na  256.  To d v 
mo‘nost zobrazen¡ speci ln¡ch znak– v jin˜ch jazyc¡ch (francouzsk‚ accents,
‡esk  diakritick   znam‚nka),  matematick˜ch  symbol–  a  velmi  d–le‘it˜ch
grafick˜ch symbol–.


     (MSB)                             (LSB)
         ÚÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄ¿
   1000  ³   ³   ³   ³   ³   ³   ³   ³   ³
         ÀÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÙ
           7   6   5   4   3   2   1   0
                       .
                       .
                       .
         ÚÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄ¿
   0011  ³ 0 ³ 1 ³ 1 ³ 1 ³ 0 ³ 0 ³ 1 ³ 0 ³
         ÀÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÙ
         ÚÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄ¿
   0010  ³ 1 ³ 1 ³ 0 ³ 1 ³ 1 ³ 0 ³ 0 ³ 0 ³
         ÀÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÙ

         ÚÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄÂÄÄÄ¿
   0001  ³ 1 ³ 0 ³ 1 ³ 0 ³ 1 ³ 1 ³ 0 ³ 0 ³
         ÀÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÁÄÄÄÙ



---------------------------------------------------------------------------
€¡sla se znam‚nkem
---------------------------------------------------------------------------


   Pod¡vejme se  bl¡‘e na reprezentaci cel˜ch ‡¡sel u mikroprocesoru 80286.
Jestli‘e pou‘ijeme  v¨ech osm bit– k reprezentaci kladn˜ch ‡¡sel, dostaneme
rozsah 0 - 255 (00000000 - 11111111). Po p©i‡ten¡ 1  k  ‡¡slu 255 dost v me
opˆt nulu.

   Reprezentace cel˜ch ‡¡sel  kladn˜ch  i  z porn˜ch  je  tedy kompromisem,
proto‘e mus¡me nˆjak indikovat znam‚nko ‡¡sla, na co‘ n m sta‡¡  jeden bit.
Ponech me-li bit ‡. 7  k  reprezentaci  znam‚nka, dost v me rozsah kladn˜ch
‡¡sel 0-127. K¢d– pou‘iteln˜ch k  reprezentaci z porn˜ch ‡¡sel je cel  ©ada
a nˆkter‚ z nich si uk ‘eme.

   Nejjednodu¨¨¡ reprezentac¡ je pou‘it¡  bitu  ‡. 7 (MSB) na znam‚nko: 0 v
MSB k¢duje kladn‚ ‡¡slo, jedni‡ka v MSB ‡¡slo z porn‚. Nap©¡klad:

   0000 0101   ozna‡uje +5
   1000 0101   ozna‡uje -5


   Co ale s hodnotou 0 ? Teoreticky bychom mˆli:

   0000 0000   pro hodnotu +0
   1000 0000   pro hodnotu -0



                                  - 13 - 




   Jak  v s jistˆ napadne, pot©ebovali bychom  teƒ  tak‚  nov   aritmetick 
pravidla pro z kladn¡ operace se‡¡t n¡  a ode‡¡t n¡. Nap©¡klad prvn¡ z nich
by specifikovalo, ‘e hodnota 0 bude v‘dy zobrazena jako "kladn " nula: 0000
0000.  Proto‘e  po‡et  bit–  ur‡en˜ch  k  reprezentaci  hodnoty  ‡¡sla  byl
redukov n na 7, m–‘eme hovo©it jen o hodnot ch mezi 0 a + nebo - 127.
N sleduj¡c¡ p©¡klad ode‡¡t n¡

   1111 1110 +0
-  0000 0010 +1
   1111 1111 -127


v¨ak  ned v   spr vn˜  v˜sledek.  Abychom  mohli prov dˆt operace  s  takto
reprezentovan˜mi ‡¡sly,  pot©ebujeme  ve  skute‡nosti  symbol  1111  1111 k
reprezentaci ‡¡sla -1. Dal¨¡ p©¡klad ukazuje zase jin˜ zp–sob ode‡¡t n¡:

   1111 1110 -2
-  0000 0010 +2
   1111 1100 -4


   Kdybyste si udˆlali konverzi ‡¡sla  1111 1100 p©edpokl daj¡ce, ‘e MSB je
rezervov n pro znam‚nko, dostali byste  hodnotu  -124.  Pro‡  tedy v˜sledek
na¨eho druh‚ho ode‡¡t n¡ byl -4 ? ‡tˆte d le a uvid¡te ...



---------------------------------------------------------------------------
Dvojkov˜ doplnˆk (two's complement)
---------------------------------------------------------------------------


   Aby operace se‡¡t n¡  a  ode‡¡t n¡  pracovaly  spr vnˆ  p©i reprezentaci
‡¡sel navr‘en‚ v p©edchoz¡m odstavci, je t©eba reprezentovat  ‡¡sla  v tzv.
dvojkov‚m dopl¤kov‚m k¢du. P©¡klady  pr vˆ  diskutovan‚  vedou  k pochopen¡
pot©eby reprezentovat kladn  a z porn  ‡¡sla n sleduj¡c¡m zp–sobem:

   0000 0100   +4
   0000 0011   +3
   0000 0010   +2
   0000 0001   +1
   0000 0000    0
   1111 1111   -1
   1111 1110   -2
   1111 1101   -3
   1111 1100   -4



   V¨imnˆte  si, ‘e toto k¢dov n¡ ponech v  sedm˜  bit  (MSB)  na  znam‚nko
‡¡sla. Po proveden¡  operace  se‡¡t n¡  nebo  ode‡¡t n¡  se  dvˆma  ‡¡sly k
dvojkov‚m dopl¤kov‚m k¢du je v˜sledek tak‚ v tomto k¢du. Nap©¡klad:

   0000 0100   +4
+  1111 1101   -3
------------



                                  - 14 - 




1) 0000 0001   +1 (Generovan˜ p©enos ignorujeme)


   Vytvo©en¡ reprezentace z porn‚ho ‡¡sla ve dvojkov‚m  dopl¤ku  je snadn‚:
sta‡¡ invertovat ka‘d˜ bit ‡¡sla a k takto vytvo©en‚mu  ‡¡slu  p©i‡¡st  +1.
N sleduj¡c¡ p©¡klad to ukazuje na z¡sk n¡ reprezentace ‡¡sla -5

   0000 0101   +5
   1111 1010   (Invertujeme jednotliv‚ bity)
+  0000 0001   (P©i‡teme +1)
   ------------
   1111 1011   -5



   Zpˆtn  konverze je stejnˆ tak snadn :  uka‘me  si ji na p©evodu ‡¡sla -4
do jeho kladn‚ hodnoty 4:

   1111 1100   -4
   0000 0011   (Invertujeme jednotliv‚ bity)
+  0000 0001   (P©i‡teme +1)
------------
   0000 0100   +4




---------------------------------------------------------------------------
Roz¨¡©en¡ znam‚nkov‚ho bitu
---------------------------------------------------------------------------


   Proto‘e vnit©n¡ registry  80286  maj¡  ¨¡©ku  16  bit–  a  ¨¡©ka jednoho
pamˆŸov‚ho  m¡sta  je  jen 8 bit–, je docela mo‘n‚, ‘e budete pot©ebovat ve
va¨em programu se‡¡st dvˆ ‡¡sla o r–zn˜ch ¨¡©k ch.  Nap©¡klad  m–‘ete cht¡t
se‡¡st  osmibitov‚   ‡¡slo   ve   dvojkov‚m   doplnkov‚m   k¢du   s  ‡¡slem
¨estn ctibitov˜m, ulo‘en˜m ve stejn‚m datov‚m form tu:

             0000 0101  +5
+  1111 1111 1111 1101  -3
----------------------


   Zde jsme jednodu¨e p©ipojili 0000 0000 k bitu MSB ‡¡sla +5. Co se stane,
kdy‘ bude osmibitov‚ ‡¡slo z porn‚ ?

             1111 1111  -1
+  0000 0000 0000 0100  +4
----------------------


   Jeliko‘ bylo osmibitov‚  ‡¡slo  z porn‚, p©ipojili bychom osm jedni‡ek k
bitu  MSB  ‡¡sla  -1 : 1111 1111. Obecn‚ pravidlo pro roz¨¡©en¡ znam‚nka je
tedy  prost‚:  p©ipoj¡me  osm jedni‡ek nebo nul k bitu MSB u krat¨¡ho ‡¡sla
p©esnˆ podle znam‚nka "prodlu‘ovan‚ho"  ‡¡sla.  Roz¨¡©en¡  znam‚nka  u dvou
osmibitov˜ch ‡¡sel by n m tedy dalo



                                  - 15 - 




   0000 0000 0000 0101  (16-ti bitov  reprezentace +5)
   1111 1111 1111 1111  (16-ti bitov  reprezentace -1)



---------------------------------------------------------------------------
Hexadecim ln¡ ‡¡sla
---------------------------------------------------------------------------


   Hexadecim ln¡ ‡¡seln   soustava dostala sv‚ jm‚no z 16- ti jednozna‡n˜ch
symbol–,  kter‚  tvo©¡  mno‘inu  jej¡ch  ‡¡slic.  Hexadecim ln¡  ‡¡sla jsou
u‘ite‡n   p©i  ‡ten¡  nebo  psan¡  program–   v   assembleru,  prohled v n¡
pamˆŸov˜ch dump–  atp.,  proto‘e  ka‘dou  ‡tve©ici  bit–  nahrazuj¡ jedin˜m
hexadecim ln¡m  symbolem. Hexadecim ln¡ ‡¡sla obsahuj¡ symboly  0  a‘  9  a
p¡smena A,B,C,D,E,F. N sleduj¡c¡ tabulka  ukazuje  vztah  mezi dekadick˜mi,
bin rn¡mi a hexadecim ln¡mi ‡¡sly.


      Tab. 2.1: Dekadick , bin rn¡ a hexadecim ln¡ reprezentace ‡¡sel

          --------------------------------------------------
          Dekadicky      Bin rnˆ          Hexadecim lnˆ
          --------------------------------------------------
           0             0000             0
           1             0001             1
           2             0010             2
           3             0011             3
           4             0100             4
           5             0101             5
           6             0110             6
           7             0111             7
           8             1000             8
           9             1001             9
          10             1010             A
          11             1011             B
          12             1100             C
          13             1101             D
          14             1110             E
          15             1111             F
          --------------------------------------------------

   U‘ite‡nost hexadecim ln¡ch ‡¡sel vid¡me na n sleduj¡c¡m p©¡kladˆ:

     10010110        --->      96
     11100011        --->      E3
     10101011        --->      AB
     00101100        --->      2C


   €¡sla  vpravo  jsou  mnohem l‚pe ‡iteln  a  kontrolovateln   ne‘  jejich
dvojkov‚  reprezentace  nalevo.  Konverze  ‡¡sla bin rn¡ho do hexadecim ln¡
soustavy je velice snadn : za‡¡n me od bitu LSB a postupnˆ smˆrem  doleva k
bitu  MSB  nahrazujeme  skupiny   ‡ty©   po   sobˆ  jdouc¡ch  bit–  jedinou
hexadecim ln¡ ‡¡slic¡.




                                  - 16 - 




   Konverze  ‡¡sla  z  hexadecim ln¡  soustavy  do  soustavy  dekadick‚  je
analogick   ji‘  diskutovan‚  konverzi   ‡¡sla   bin rn¡ho   na  dekadick‚.
N sleduj¡c¡ p©¡klad osvˆtluje tuto  konverzi  na  ‡¡sle  FACE, kter‚ m  b˜t
p©evedeno do hexadecim ln¡ soustavy:

 F   A   C   E
 -   -   -   -      0
 |   |   |   +--- 14 x 16 =  14
 |   |   |               1
 |   |   +------- 12 x 16  =   192
 |   |                   2
 |   +----------- 10 x 16  =  2560
 |                       3
 +--------------- 15 x 16  = 61400
                             =====
                             64206


   €¡slo FACE reprezentovan‚ bin rnˆ vypad  takto:

   1111101011001110

a  reprezentovan‚  ve  dvou po sobˆ jdouc¡ch  pamˆŸov˜ch  m¡stech  (bytech)
takto:

   11111010 11001110 .



---------------------------------------------------------------------------
Slova (words)
---------------------------------------------------------------------------


   Ponˆvad‘ 80286 je ¨estn ctibitov˜ procesor  a  pracuje  nejefektivnˆji s
¨estn ctibitov˜mi £daji, vytvo©¡me  slo‘en¡m  dvou byt– jedno slovo, jak je
patrn‚ z n sleduj¡c¡ho obr zku.






















                                  - 17 - 




                    Obr. 2.1: Bity a byty jednoho slova


(LSB)               S L O V O                (MSB)
ÚÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄ¿
³  ³  ³  ³  ³  ³  ³  ³  ³  ³  ³  ³  ³  ³  ³  ³  ³
ÀÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÙ
 15 14 13 12 11 10  9  8  7  6  5  4  3  2  1  0


       HORN‹ BYTE               DOLN‹ BYTE
ÚÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄ¿ÚÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄ¿
³  ³  ³  ³  ³  ³  ³  ³  ³³  ³  ³  ³  ³  ³  ³  ³  ³
ÀÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÙÀÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÙ
 15 14  ........... 7  8  7   6 ...........  1  0


        byte MSB                byte LSB
 (Most Significant Byte)  (Least Significant Byte)


   Vytvo©en¡  slova  n m  umo‘n¡   p©ekro‡it   hranici   hodnoty   255  (FF
hexadecim lnˆ,  FFH)  a  pracovat  s   ‡¡sly  a‘  do  hodnoty  65535  (FFFF
hexadecim lnˆ, FFFFH). Assembler skute‡nˆ uchov v  a zpracov v   cel  ‡¡sla
jako slova.

   P©i uchov v n¡ cel‚ho  ‡¡sla  o  velikosti  slova v pamˆti jsou jeho dva
byte um¡stˆny v opa‡n‚m po©ad¡. Byte  LSB  je um¡stˆn na ni‘¨¡ adrese, byte
MSB na vy¨¨¡ adrese pamˆti. Nap©¡klad uchov n¡ hodnoty 3456H  v  pamˆti  by
vypadalo takto:

   Adresa pamˆti     Hodnota
   -------------     -------
   0000 0001            34H
   0000 0000            56H


   Ve  vˆt¨inˆ  p©¡pad–  se  program tor  v  jazyce  symbolick˜ch instrukc¡
nestar  o pravidla um¡sŸov n¡  sv˜ch  operand–  v pamˆti. V¨echny instrukce
pracuj¡c¡ s pamˆt¡ "rozum¡" form tu dat,  je‘  se maj¡ do pamˆti um¡stit, a
zaji¨Ÿuj¡  v¨echny nezbytn‚ p©esuny. Program tor si  v¨ak  mus¡  b˜t  dob©e
vˆdom˜  popsan‚  metody  ukl d n¡  jednotliv˜ch  byte  p©i  trasov n¡ sv‚ho
programu a  p©i zkoum n¡ v˜pis– pamˆti. Mikroprocesor zpracov v  v‘dy 16-ti
bitov‚ slovo, ne dva osmibitov‚ byte.



---------------------------------------------------------------------------
Dvouslova (doublewords)
---------------------------------------------------------------------------


   Dvouslovo je ¨irok‚ 32  bit–,  jak ji‘ jeho n zev napov¡d . Dvouslovo je
slo‘eno ze dvou p©ilehl˜ch slov na po sobˆ jdouc¡ch adres ch.  Dvouslovo je
velice  v˜znamn˜  datov˜  form t,  proto‘e  dovoluje  mikroprocesoru  80286
adresovat v¡ce ne‘ 1 mili¢n byte pamˆti. Z tohoto d–vodu bude program tor v



                                  - 18 - 




jazyce  symbolick˜ch instrukc¡ mikroprocesoru 80286 pracovat s  32-bitov˜mi
dvouslovy jako s ukazateli  na  data  v pamˆti. Dvaat©icetibitov‚ dvouslovo
tak‚  umo‘¤uje,  aby  aritmetick‚  operace  s  v˜hodou  vyu‘¡valy  dvojitou
p©esnost  v˜po‡t– - v dvouslovˆ je mo‘n‚ uchov vat  velice  mal   i  velice
velk  ‡¡sla cel  i desetinn .

   Dvouslova jsou uchov v na  v  uspo© d n¡  podobn‚m  uchov n¡  slov. Tedy
ni‘¨¡   slovo   dvouslova   je   ukl d no   na  ni‘¨¡  adresu   v   pamˆti.
Dvaat©icetibitov‚ slovo je uchov v no  jako  posloupnost  4  byte, po‡¡naje
bytem LSB a  kon‡e  bytem  MSB.  €¡slo  12345678H by bylo v pamˆti uchov no
takto:

   Adresa pamˆti     Hodnota
   -------------     -------
   0000 0011            12    (MSB) \
   0000 0010            34           > slovo 16 bit–
                                    /              \
                                                    >dvou-
                                    \              / slovo
   0000 0001            56           > slovo 16 bit–
   0000 0000            78    (LSB) /



---------------------------------------------------------------------------
Nestandardn¡ pole bit–
---------------------------------------------------------------------------


   Vˆt¨ina dat, se kter˜mi se  setk v   program tor  v  jazyce symbolick˜ch
instrukc¡, spad  do  dvou  skupin  definovan˜ch  v  p©edchoz¡ch odstavc¡ch.
Existuj¡ v¨ak  i v˜jimky. Nap©. n vrh ©i PC-DOSu nechtˆli pl˜tvat pamˆŸov˜m
prostorem a rozhodli se uchov vat  datov˜  £daj  /den-mˆs¡c-rok/  v jedin‚m
¨estn ctibitov‚m  slovˆ. Vˆnovali tak 7 bit– pro £daj o roce (‡¡sla od 0 do
128  reprezentuj¡  po  p©i‡ten¡  z kladu  1980  rok),  na  £daj o mˆs¡ci je
zapot©eb¡ rozsahu 1-12, sta‡¡ tedy 4 bity. Maxim ln¡ po‡et dn– v  mˆs¡ci je
31,  sta‡¡  tedy  5  bit–  k  reprezentaci  £daje  o  dnu  v  mˆs¡ci.  Jin 
nestandardn¡  bitov   pole  se  u‘¡vaj¡  nap©. v aplikac¡ch  s  po‡¡ta‡ovou
grafikou. Zde m–‘e jedin˜ bit  reprezentovat bod na obrazovce monitoru. Je-
li bit  nulov˜,  m   bod  tmavou  barvu  (nesv¡t¡). Jedni‡ka v takov‚m bitu
signalizuje, ‘e bod m  b˜t rozsv¡cen. Toto zobrazen¡ bod–  na  displeji  se
v¨ak m–‘e po‡¡ta‡ od po‡¡ta‡e mˆnit. Nap©. co kdy‘ chceme indikovat, ‘e bod
na  displeji  m   b˜t  rozsv¡cen  ur‡itou  barvou  ? P©idˆl¡me-li  bodu  na
obrazovce nyn¡ dva  bity,  je  mo‘n‚  popsat rozsv¡cen¡ ‡i zhasnut¡ bodu ve
t©ech r–zn˜ch barv ch. V¨echny tyto nestandardn¡ bitov‚  konfigurace musej¡
b˜t pe‡livˆ zv ‘eny p©i ukl d n¡,  zpracov n¡ a p©¡stupu k bin rn¡m £daj–m.
Je¨tˆ vˆt¨¡ pozor mus¡me d vat p©i rozboru bin rn¡ch v˜pis– pamˆti (dump–).












                                  - 19 - 




---------------------------------------------------------------------------
Bin rn¡ operace
---------------------------------------------------------------------------


   P©i  bli‘¨¡m  rozboru mikropo‡¡ta‡em prov dˆn‚ho  s‡¡t n¡  ‡i  ode‡¡t n¡
neobjev¡me  nic  jin‚ho  ne‘ opakovan‚ s‚rie bitov˜ch  porovn n¡.  Je  sice
pravdou,  ‘e  centr ln¡  jednotka  mikroprocesoru obsahuje r–zn‚ "se‡¡tac¡"
obvody;  lze  v  kone‡n‚ instanci ©¡ci, ‘e i tyto obvody pracuj¡ na z kladˆ
srovn v n¡  dat  bit  po  bitu.  Tato  bitov   srovn n¡ p©edstavuj¡  velice
jednoduch˜ proces, neboŸ p©i srovn n¡ dvou bit– m–‘eme dostat jen t©i mo‘n‚
kombinace bitov˜ch p r–: oba bity mohou b˜t nulov‚, oba jedni‡kov‚  nebo je
jen jeden z  bit–  jedni‡kov˜.  Jednoduch   s‚rie  sest vaj¡c¡  se  z pr vˆ
popsan˜ch  opakovanˆ prov dˆn˜ch srovn n¡ je z kladem se‡¡t n¡,  ode‡¡t n¡,
n soben¡ i  dˆlen¡. V p©¡padˆ se‡¡t n¡ jsou aplikov na n sleduj¡c¡ pravidla
po‡¡naje od bitu LSB (Least Significant Bit = bit s nejmen¨¡ vahou):
- Se‡ten¡ dvou bit– nastav¡ p©¡znak SUM do nuly p©i obou bitech nulov˜ch
- Je-li jeden ze se‡¡tan˜ch bit– jedni‡kov˜, m  p©¡znak SUM hodnotu 1
- Je-li hodnota obou bit– 1, je p©¡znak SUM nastaven na hodnotu 0 a p©¡znak
CARRY (p©enos) na hodnotu 1

   Tento proces je p©i se‡¡t n¡  opakov n s ka‘d˜m n sleduj¡c¡m bitem (tedy
s bity  o  postupnˆ  rostouc¡  v ze),  p©i‡em‘  je t©eba p©i ka‘d‚ sekvenci
pravidel uva‘ovat p©edchoz¡ p©enos. Z kladn¡ jednotka si  uchov v  historii
v¨ech individu ln¡ch sekvenc¡ srovn n¡ ve  sv‚  vnit©n¡  pracovn¡  pamˆti a
v˜sledek cel‚ho procesu pak  vypad   jako  bin rn¡ se‡¡t n¡. Ve skute‡nosti
tento proces nen¡ nic jin‚ho ne‘ opakov n¡ operac¡ bitov˜ch srovn n¡.

   A‡koliv  je  centr ln¡ jednotka technicky  predestinov na  k  vykon v n¡
takov˜ch  operac¡,  jako  je  se‡¡t n¡,  ode‡¡t n¡, n soben¡ a  dˆlen¡,  m 
program tor  pracuj¡c¡ v assembleru mo‘nost p©¡stupu  i  k  jin˜m  operac¡m
bitov‚ho srovn n¡. Tyto operace zahrnuj¡ logick‚ AND, OR,  XOR,  SHIFT LEFT
(posun vlevo), SHIFT RIGHT (posun  vpravo),  ROTATE  LEFT  (rotace doleva),
ROTATE RIGHT (rotace vpravo)  a  COMPLEMENT  (doplnˆk). U logick˜ch operac¡
AND,OR a COMPLEMENT je vhodn‚  pokl dat  hodnoty  bit–  1  a  0  za logick‚
hodnoty true a false.  Logick   operace AND srovn v  dva bity. Je-li jejich
hodnota jedni‡kov , je v˜sledek tak‚  jedni‡ka. V¨imnˆme si, ‘e v˜sledek je
odli¨n˜ od operace bin rn¡ho se‡¡t n¡, kdy srovn n¡ dvou  bit–  vy£stilo ve
v˜sledek SUM=0 a CARRY=1.

   LOGICK SOU€IN AND
       Bit ‡. 0  Bit ‡. 1  V˜sledek
          0         0         0
          0         1         0
          1         0         0
          1         1         1

   Operace AND je velmi ‡asto pou‘¡v na k v˜bˆru  ‡i  "maskov n¡" nˆkter˜ch
skupin bit– ve slovˆ/bytu. Jeden p©¡klad takov‚ho vyu‘it¡ m–‘eme nal‚zt p©i
dekadick‚m n soben¡ ‡i dˆlen¡:  je  zapot©eb¡  vynulovat  4 bity s nejvy¨¨¡
vahou p©edt¡m, ne‘ operaci n soben¡ nebo dˆlen¡ provedeme nad dvˆma ‡¡sly v
nesbalen‚m tvaru. To lze velice lehce prov‚st logick˜m sou‡inem nesbalen‚ho
dekadick‚ho ‡¡sla s hodnotou 0000 1111:






                                  - 20 - 




         1010 0011
   AND   0000 1111   (maska)
   ---------------
         0000 0011

   Operace logick‚ho sou‡tu OR srovn v  dva bity a vyd v  v˜sledek 1, je-li
alespo¤  jeden  bit   jedni‡kov˜.   Operace  OR  je  u‘ite‡n   k  nastaven¡
specifick˜ch pozic¡ do hodnoty 1.

   LOGICK SOU€ET OR
       Bit ‡. 0  Bit ‡. 1  V˜sledek
          0         0         0
          0         1         1
          1         0         1
          1         1         1


   Nap©¡klad  chceme-li  nastavit  bit  MSB  (Most Significant Bit = bit  s
nejvˆt¨¡  vahou) na hodnotu 1, m–‘eme v  p©¡padˆ  8-bitov‚ho  slova  pou‘¡t
operaci OR nad t¡mto ‡¡slem a hodnotou 1000 0000:

      0001 1010
   OR 1000 0000
   ------------
      1001 1010


   Operace  EXCLUSIVE  OR  srovn v  dva bity a vrac¡ jako v˜sledek jedni‡ku
jen v p©¡padˆ, ‘e jsou oba srovn van‚ bity r–zn‚. Tato logick  operace m–‘e
b˜t velice u‘ite‡n  v p©¡padˆ, ‘e je nutn‚ vytvo©it komplement specifick˜ch
bit– ve slovˆ/bytu, t©eba v grafick˜ch aplikac¡ch.

   EXKLUZ‹VN‹ LOGICK SOU€ET XOR
       Bit ‡. 0  Bit ‡. 1  V˜sledek
          0         0         0
          0         1         1
          1         0         1
          1         1         0

   V n sleduj¡c¡m p©¡kladˆ jsou prost©edn¡  ‡ty©i  bity  osmibitov‚ho ‡¡sla
invertov ny oprac¡ EXCLUSIVE OR s hodnotou 0011 1100:

         1010 0110
   XOR   0011 1100
   ---------------
         1001 1010


   Operaci  exkluz¡vn¡ho  logick‚ho  sou‡tu XOR lze s v˜hodou pou‘¡t tak‚ k
nulov n¡ pamˆŸov‚ho m¡sta m¡sto instrukce MOV (nap©. XOR AX,AX nuluje AX).

   Operace SHIFT LEFT/RIGHT,  ROTATE  LEFT/RIGHT a COMPLEMENT pracuj¡ jen s
jedn¡m operandem. Instrukce SHIFT  poskytuje  elegantn¡  metodu  pro velice
rychl‚  n soben¡  nebo  dˆlen¡  ‡¡sla  dvˆma. Tato metoda  nejen  poskytuje
v˜sledek velice rychle,  ale  je  hlavnˆ  v˜hodn  u po‡¡ta‡–, kter‚ ve sv‚m
instruk‡n¡m souboru nemaj¡ realizov ny operace dˆlen¡ a n soben¡  a  kdy je



                                  - 21 - 




tyto operace nutno  zabezpe‡it  programovˆ.  Jestli‘e  uva‘ujeme  ‡¡sla bez
znam‚nka, pak posun ‡¡sla o jednu pozici doleva a dozazen¡ hodnoty 0 do LSB
m  za n sledek vyn soben¡ ‡¡sla dvˆma:

   SHL   0100 0001   (dekadicky 65)
   ---------------
         1000 0010   (dekadicky 130)

 Jestli‘e chceme podˆlit ‡¡slo bez znam‚nka dvˆma, pak sta‡¡p osuv  o jednu
pozici doprava a dosazen¡ hodnoty 0 do MSB:

   SHR   0000 1010   (dekadicky 10)
   ---------------
         0000 0101   (dekadicky 5)


   Instrukce  ROTATE  umo‘¤uje  p©eskupovat bity v ‡¡sle.  Podobnˆ  jako  u
operace SHIFT  je  mo‘n‚  rotovat  doprava  ‡i  doleva (ve smˆru RIGHT nebo
LEFT). Na rozd¡l od operace SHIFT, kdy je nejkrajnˆj¨¡ bit  v‘dy "ztracen",
operace ROTATE p©esunuje  "vypad vaj¡c¡"  bit na voln‚ m¡sto vznikaj¡c¡ p©i
rotaci na druh‚m konci ‡¡sla:

   ROR   0000 1111   (rotace doprava)
   ---------------
         1000 0111
   ROL   0000 1111   (rotace doprava)
   ---------------
         0001 1110































                                  - 22 - 










                            K a p i t o l a   3

                            Adresovac¡ techniky


   Instrukce mikroprocesoru 80286/80386 obsahuje nejen informace o operaci,
kter   m   b˜t  provedena,  ale  sou‡asnˆ  v  sobˆ nese i informaci o  typu
zpracov van˜ch  operand–  a  o  jejich  lokalizaci v pamˆti.  Existuje  osm
z kladn¡ch adresovac¡ch mod–:

   1.  Bezprost©edn¡ adresov n¡ (immediate addressing)

   2.  Registrov‚ adresov n¡ (register addressing)

   3.  P©¡m‚ adresov n¡ (direct addressing)

   4.  Registrov‚ nep©¡m‚ adresov n¡ (register indirect addressing)

   5.  B zov n¡ (based addressing)

   6.  P©¡m‚ registrov‚ adresov n¡ (direct indexed addressing)

   7.  B zovan‚ indexov‚ adresov n¡ s p©em¡stˆn¡m nebo bez p©em¡stˆn¡ (base
       indexed addressing with or without displacement)

   8.  Extenze pro 80386



---------------------------------------------------------------------------
Bezprost©edn¡ adresov n¡
---------------------------------------------------------------------------


   Mikroprocesor dek¢duje adresovac¡ m¢d  podle  syntaxe  z pisu instrukce.
Nap©¡klad u instrukce

   MOV AH,00
   MOV AL,04

je  hodnota  operandu  um¡stˆna p©¡mo uvnit© instrukce  -  bezprost©ednˆ  v
instrukci.   Registr   AH   je  nulov n  (hodnotou  00)  a  registr  AL  je
inicializov n na hodnotu 0000 0100  bin rnˆ. Je t©eba p©ipomenout, ‘e 80386
akceptuje i operandy dlouh‚ 32 bit–. N sleduj¡c¡ p©¡klad  p©esouv   16 bit–
dlouh˜ zdrojov˜ operand  do  registru AX (ka‘d˜ hexadecim ln¡ p©¡m˜ operand
mus¡ za‡¡nat ‡¡slic¡ 0) :

   MOV AX,0FFFFH





                                  - 23 - 




---------------------------------------------------------------------------
Registrov‚ adresov n¡
---------------------------------------------------------------------------


   U registrov‚ho adresov n¡  je  hodnota zdrojov‚ho operandu ji‘ ulo‘ena v
nˆkter‚m z  vnit©n¡ch  v¨eobecn˜ch  (general)  registr–  80286/80386.  Tato
hodnota    m–‘e    b˜t    osmibitov ,    ¨estn ctibitov    nebo   u   80386
dvaat©icetibitov .  Mikroprocesor  interpretuje  d‚lku operandu podle jm‚na
registru. Nap©¡klad:

   MOV DS,AX

   Tento zp–sob registrov‚ho adresov n¡ ©¡k  mikroprocesoru, aby vzal 16-ti
bitov˜ obsah zdrojov‚ho operandu - registru A (cel˜ AX) - a p©esunul jej do
16-ti bitov‚ho registru DS. Tento zp–sob adresov n¡ lze aplikovat i na 8-mi
bitov˜ zdrojov˜ operand :

   MOV DL,AL

   Z  uv dˆn˜ch  osmi  adresovac¡ch  m¢d–  vy‘aduj¡   registrov‚   a  p©¡m‚
adresov n¡  nejm‚nˆ  strojov˜ch  takt–.  Jeliko‘  data  operand–  jsou  ji‘
zahrnuty v  instrukci  samotn‚,  nen¡  zapot©eb¡  ‘ dn˜ch  ‡asovˆ n ro‡n˜ch
p©¡stup– do hlavn¡ pamˆti, abychom hodnoty operand– z¡skali.

   Dal¨¡ popisovan‚ adresovac¡ m¢dy vy‘aduj¡ v¡ce strojov˜ch takt–, proto‘e
mikroprocesor mus¡ spo‡¡tat adresu  operandu  na  z kladˆ  adresy segmentu,
offsetu (posunut¡) v  segmentu  a  ‡asto  i  obsahu  indexov‚ho  a b zov‚ho
registru. Takto z¡skan  adresa je ozna‡ov na jako efektivn¡ adresa operandu
(effective address, EA).



---------------------------------------------------------------------------
P©¡m‚ adresov n¡
---------------------------------------------------------------------------


   U p©¡m‚ho adresov n¡ je offset  operandu v segmentu (t.j. jeho relativn¡
vzd lenost  od  po‡ tku  segmentu)  obsa‘en  v registru jako  16-ti  bitov 
hodnota. Tento  offset je p©i‡ten k posunut‚mu obsahu datov‚ho segmentov‚ho
registru  DS  a  hodnotou  tohoto  sou‡tu  je  20-ti bitov   adresa  (pokud
pracujeme  v  re ln‚m  m¢du)  EA,  kter  je ji‘ fyzickou adresou  operandu.
Vˆt¨inou je operandem p©¡m‚ho adresov n¡ n vˆ¨t¡.

   Nap©¡klad  instrukce  MOV  AX,MYDATA  na  obr zku  3-1.   po‘aduje,  aby
mikroprocesor naplnil registr AX obsahem pamˆŸov‚ho m¡sta, na kter‚ ukazuje
adresa spojen  s  n vˆ¨t¡m  MYDATA. V¨imnˆte si, jak mikroprocesor uchov v 
ni‘¨¡ byte operandu na ni‘¨¡ adrese a vy¨¨¡ byte na vy¨¨¡ adrese.










                                  - 24 - 




                        Obr. 3.1: P©¡m‚ adresov n¡

     Instrukce MOV     MOV AX,MYDATA          0005
                                              0004
     Registr AX        1111111100000000       0003    FF
     po provedeni                             0002    00      MYDATA
     instrukce MOV                            0001
                                              0000
                                              adresy



---------------------------------------------------------------------------
Registrov‚ nep©¡m‚ adresov n¡
---------------------------------------------------------------------------


   U  nep©¡m‚ho  registrov‚ho  adresov n¡  je  -  nam¡sto  reference adresy
zdrojov‚ho operandu prost©ednictv¡m n vˆ¨t¡ -  hodnota  operandu  z¡sk na z
offsetu ulo‘en‚ho v jednom z  n sleduj¡c¡ch registr–: SI (source index), DI
(destination index), BX (base register)  nebo  (za  ur‡it˜ch  okolnost¡) BP
(base pointer).

   Mikroprocesor   rozpozn    nep©¡m‚   registrov‚  adresov n¡  ze  syntaxe
instrukce.  Ozna‡en¡  zdrojov‚ho  operandu je v hranat˜ch  z vork ch  [  ].
Nap©¡klad na dal¨¡m obr zku bude instrukce spr vnˆ provedena jen v p©¡padˆ,
‘e registr BX byl p©edem  naplnˆn hodnotou ur‡uj¡c¡ offset pamˆŸov‚ho m¡sta
MYDATA. To m–‘e b˜t provedeno nap©¡klad oper torem OFFSET takto:

   MOV BX,OFFSET MYDATA
nebo je mo‘n‚ vyu‘¡t instrukce LEA (Load Effective Address):

   LEA BX,MYDATA

                  Obr. 3.2: Nep©¡m‚ registrov‚ adresov n¡

                       MOV AX,[BX]            0005
                                              0004
                                              0003    FF
                  BX   0000000000000010       0002    00      MYDATA
                                              0001
                  AX   1111111100000000       0000
                                              adresy

   Registrov‚ nep©¡m‚ adresov n¡ lze pou‘¡t k odkaz–m na data uchov van  ve
form tu  tabulky.  P©¡stup  k jednotliv˜m polo‘k m takov‚  tabulky  se  pak
zefektivn¡ - m¡sto pomˆrnˆ ‡asovˆ  zna‡nˆ n ro‡n˜ch operac¡ v˜bˆru adresy z
pamˆti a pak  v˜bˆru  operandu  z  t‚to  adresy  prov d¡  mikroprocesor jen
inkrementaci b zov‚ho registru a v˜bˆr operandu z takto vznikl‚ adresy.










                                  - 25 - 




---------------------------------------------------------------------------
B zov‚ relativn¡ adresov n¡
---------------------------------------------------------------------------


   Efektivn¡ adresa operandu je u b zov‚ho  relativn¡ho  adresov n¡ z¡sk na
jako sou‡et hodnoty p©em¡stˆn¡ (displacement)  a  obsahu  b zov‚ho registru
(BP  nebo  BX).  P©em¡stˆn¡  je  uva‘ov no vzhledem k  vybran‚mu  segmentu.
Implicitn¡m segmentov˜m registrem je  v  p©¡padˆ  BP  registr SS, v p©¡padˆ
b zov‚ho registru BX je j¡m DS. Toto implicitn¡  ur‡en¡  se  d   ve vˆt¨inˆ
p©¡pad– zmˆnit p©edponou  segment:  (segment  overriding),  tedy  nap©. mov
ax,es:[bp] p©esune do  registru  ax  slovo  z  offsetu o hodnotˆ [bp] a pro
vytvo©en¡  horn¡  ‡ sti  adresy operandu p©esouvan‚ho do ax je vzat registr
es.  B zov‚  relativn¡  adresov n¡  se   ‡asto   pou‘¡v    ke  zp©¡stupnˆn¡
komplexn¡ch datov˜ch struktur (nap©. z znam–).  B zov˜  registr  ukazuje na
za‡ tek struktury  (b zi), a jednotliv‚ polo‘ky z znamu jsou vyb¡r ny podle
hodnoty p©em¡stˆn¡. Zmˆna hodnoty p©em¡stˆn¡ m  za n sledek p©¡stup k jin˜m
polo‘k m uvnit© z znamu. Zp©¡stupnˆn¡ stejn‚  polo‘ky  v  r–zn˜ch z znamech
lze jednodu¨e dos hnout zmˆnou obsahu b zov‚ho registru.

   Na p©¡kladˆ uv dˆn‚m na  dal¨¡m  obr zku  obsahuje adresa MESGE1 ©etˆzec
znak–.  Instrukce  LEA  napln¡  registr  BX  offsetem.  P©¡stup k  ‡tvrt‚mu
elementu MESGE1 je zaji¨tˆn p©i‡ten¡m  b zov‚ adresy (v registru BX) MESGE1
k p©em¡stˆn¡ (m  hodnotu +4) uvnit© ©etˆzce.

                   Obr. 3.3: B zov‚ relativn¡ adresov n¡

     MESGE1            DB 'ASSEMBLY LANGUAGE IS FAST','$'
     MESGE2            DB 'AND EFFICIENT','$'
                                              datov˜ segment
     LEA BX,MESGE1                            0009    4C    L
                                              0008    20    mezera
                                              0007    59    Y
     MOV AL,[BX]+4                            0006    4C    L
                                              0005    42    B
     BX 0000000000000000                      0004    4D    M
     AL 4D                                    0003    45    E
                                              0002    53    S
                                              0001    53    S
                                              0000    41    A     MESGE1

   Assembler  rozpozn  n sleduj¡c¡ t©i zp–soby z pisu b zov‚ho  relativn¡ho
adresov n¡:

   LEA [BX]+4
   LEA 4[BX]
   LEA [BX+4]


   Prvn¡ z pis je neju‘¡vanˆj¨¡; p©em¡stˆn¡ nicm‚nˆ m–‘e  p©edch zet b zov˜
registr nebo m–‘e  b˜t  zahrnuto v hranat˜ch z vork ch. Adresov n¡ element–
struktury MESGE1 by mˆlo b˜t  prov dˆno  inkrementac¡  p©em¡stˆn¡,  a zmˆna
struktury  by mˆla b˜t provedena zmˆnou b zov‚  adresy  (BX),  t©eba  touto
instrukc¡:

   LEA BX,MESGE2 .



                                  - 26 - 




---------------------------------------------------------------------------
P©¡m‚ indexov‚ adresov n¡
---------------------------------------------------------------------------


   U p©¡m‚ho indexov‚ho adresov n¡ je offset operandu vypo‡¡t n jako sou‡et
p©em¡stˆn¡ vzhledem k indexregistru (SI nebo DI) uvnit© vybran‚ho segmentu.
€asto je tohoto typu adresov n¡  pou‘¡v no k p©¡stupu k prvk–m (statick‚ho)
pole. Hodnota p©em¡stˆn¡ lokalizuje  za‡ tek  pole,  a hodnota uchov van  v
indexregistru  lokalizuje  konkr‚tn¡  prvek  pole.  Na  rozd¡l  od z znam–,
jejich‘ jednotliv‚ polo‘ky mohou m¡t promˆnnou d‚lku i typ, jsou prvky pole
homogenn¡. Jeliko‘ jsou tedy prvky  pole stejn‚ho typu a velikosti, pr–chod
polem je jen ot zkou systematick‚ inkrementace  a  dekrementace p©em¡stˆn¡.
Nap©¡klad:

   MOV SI,4
   MOV AL,ARAY1[SI]     ; vybereme 4. prvek ARAY1

   Je  v¨ak  zapot©eb¡  d vat pozor na to, abychom vybrali spr vnou hodnotu
p©em¡stˆn¡ vzhledem k typu  prvk–  pole. Pr vˆ uv dˆn˜ p©¡klad by zavedl do
registru AL ‡tvrtou hodnotu pole ARAY1. Stejn˜ p©¡kaz by naplnil registr AX
hodnotou prvku pole ARAY1:

   MOV AX,ARAY1[SI]

Tentokr t by v¨ak hodnota prvku pole musela b˜t ¨estn ctibitov .



---------------------------------------------------------------------------
B zov‚ indexov‚ adresov n¡
---------------------------------------------------------------------------


   U b zov‚ho indexov‚ho adresov n¡ je operand lokalizov n uvnit© vybran‚ho
segmentu  a  na  offsetu  ur‡en‚m  sou‡tem  obsah–  b zov‚ho, indexov‚ho  a
pop©¡padˆ i  hodnoty  p©em¡stˆn¡.  Nen¡-li  p©em¡stˆn¡  zahrnuto,  je tento
zp–sob adresov n¡ nej‡astˆji pou‘it k p©¡stupu k element–m dynamick‚ho pole
(t.j.  pole,   jeho‘  po‡ te‡n¡  adresa  se  m–‘e  mˆnit  bˆhem  vykon v n¡
programu).  Zahrnut¡  p©em¡stˆn¡ umo‘¤uje p©¡stup  k  individu ln¡m  prvk–m
pole, kter‚ m–‘e b˜t polo‘kou uvnit© nap©. z znamu.


















                                  - 27 - 




                   Obr. 3.4: B zov‚ indexov‚ adresov n¡

     MOV AX, ELEMENT[BX][DI]          0025
                                      0024   FO
     BX = 0000                        0023   BF
     DI = 0020                        0022   90
                                      0021
                                      0020
                                             Z znam 3
                                      0015
                                      0014
                                      0013
                                      0012
                                      0011
                                      0010
                                             Z znam 2
                                      0005
                                      0004
                                      0003
                                      0002
     AX = F0BF                        0001
                                      0000   MYDATA
                                             Z znam 1

   V tomto p©¡padˆ (viz  p©ede¨l˜  obr zek)  by  b zov˜ registr ukazoval na
za‡ tek z znamu, p©em¡stˆn¡ (uchov van‚ v DI) by  reprezentovalo vzd lenost
od po‡ tku z znamu k po‡ tku pole uvnit© z znamu a hodnota p©em¡stˆn¡ prvku
pole by byla  obsa‘ena  v promˆnn‚ ELEMENT. P©edpokl dejme hodnotu ELEMENTu
3.

   Na p©¡kladˆ na  dal¨¡m  obr zku  je  po‡ te‡n¡ (b zov ) adresa 0000 a je
um¡stˆna  v  registru  BX. Polo‘ka t©et¡ho  z znamu  (kter   je  polem)  m 
p©em¡stˆn¡  0020, je‘ je uchov no v DI. T©et¡  prvek  pole  je  zp©¡stupnˆn
p©em¡stˆn¡m obsa‘en˜m v promˆnn‚ ELEMENT inicializovan‚ na hodnotu 3.



---------------------------------------------------------------------------
Extenze u 80386
---------------------------------------------------------------------------


   Dvaat©icetibitov‚ adresn¡  m¢dy jsou roz¨¡©eny v tom smyslu, ‘e dovoluj¡
pou‘it¡  libovoln‚ho  registru  jako  b zov‚ho  ‡i  indexov‚ho.  Tyto  m¢dy
po‘aduj¡, aby v b zov‚m a indexov‚m registru (pokud  jsou  pou‘¡v ny), byly
validn¡   32-bitov‚  hodnoty.  V¨echny  instrukce  ¨estn ctibitov‚ho   m¢du
"o©ez vaj¡" nejvy¨¨¡ch  16  bit–  dvaat©icetibitov‚ho  registru  a  hodnoty
nejvy¨¨¡ch bit– jsou tedy ignorov ny.











                                  - 28 - 










                            K a p i t o l a   4

                             Programovac¡ styl


   Program v assembleru  je  s‚ri¡ p©¡mo provediteln˜ch p©¡kaz–, kter‚ jsou
instrukcemi z kladn¡ jednotky  po‡¡ta‡e.  Symbolick   mnemonika,  v  n¡‘ je
program  v assembleru zaps n, se naz˜v  zdrojov˜  program.  Tak  jako  jin‚
jazyky i assembler m  svou p©esnˆ definovanou syntax.

Ka‘d˜ p©¡kaz v assembleru je slo‘en ze ‡ty© pol¡:

   1.  Pole jm‚na

   2.  Pole operace

   3.  Pole operandu

   4.  Pole pozn mek


Pole jm‚na (n vˆ¨t¡)

   Pole "jm‚na", ‡asto  ozna‡ovan‚  tak‚ jako pole n vˆ¨t¡, p©i©azuje pr vˆ
referovan‚ adrese pamˆti symbolick‚ jm‚no. Toto  symbolick‚  jm‚no umo‘¤uje
program toru  obracet   se  na  tuto  adresu  jm‚nem  a  eliminuje  nutnost
pamatov n¡  adres   v  ‡¡seln‚m  tvaru.  Notace  je  zvl ¨tˆ  u‘ite‡n   p©i
generov n¡  p©em¡stiteln‚ho  (relokatibiln¡ho)  c¡lov‚ho programu. Pou‘it¡m
symbolick˜ch referenc¡ program tor umo‘¤uje spojovac¡mu  programu (linkeru)
nal‚zt  m¡sto,  na  kter‚ bude c¡lov˜ program v assembleru zaveden. V¨echny
reference  na  instrukce  se  pak  mohou  automaticky  mˆnit s  mˆn¡c¡m  se
um¡stˆn¡m  programu  v  pamˆti.  I  kdy‘ je mo‘n‚ pojmenovat (t.j.  opat©it
n vˆ¨t¡m)  ka‘dou  instrukci,  pole  n vˆ¨t¡  je obvykle vyu‘¡v no  pro  ty
instrukce, je‘  jsou referov ny v definic¡ch dat, konstant, segment–, cykl–
a vol n¡ podprogram–.


   Jm‚no (n vˆ¨t¡) mus¡ za‡¡nat p¡smenem a m–‘e m¡t a‘ 31 znak–, v‡etnˆ

    -  v¨ech p¡smen A - Z

    -  v¨ech ‡¡slic 0 - 9

    -  speci ln¡ch symbol– _ $ . ? @ %

   P©i  v˜bˆru  jm‚na  mus¡me  db t  jist‚ opatrnosti. Nelze  pou‘¡t  jm‚na
stejn‚ho s rezervovan˜m slovem assembleru nebo  stejn‚ho  s assemblerovskou
direktivou (viz d le). Jestli‘e  jm‚no  m   obsahovat  te‡ku (.), pak te‡ka
mus¡ b˜t prvn¡m znakem jm‚na.




                                  - 29 - 




   Promˆnn‚

   Jm‚no promˆnn‚ reprezentuje pamˆŸov‚ m¡sto, je‘  je  p©¡stupn‚ programu:
obsah  tohoto pamˆŸov‚ho m¡sta se m–‘e  mˆnit  bˆhem  vykon v n¡  programu.
Definice promˆnn‚ zahrnuje  informaci  o  adrese  pamˆŸov‚ho  m¡sta (adrese
promˆnn‚), typu promˆnn‚ a jej¡  velikosti. Promˆnn‚ lze u‘¡t jako operandy
v jednoduch˜ch, indexovan˜ch nebo strukturovan˜ch form ch.

   N vˆ¨t¡

   Jm‚na pou‘it  k ozna‡en¡ procesorem provediteln˜ch instrukc¡ aplika‡n¡ho
programu jsou ozna‡ov na  jako  relativn¡  (code-relative).  Jm‚no  (nebo v
tomto p©¡padˆ n vˆ¨t¡) m  t©i  atributy: adresu segmentu, offset segmentu a
deskriptor  NEAR  nebo  FAR.  Z kladn¡  jednotka  m–‘e  adresovat konkr‚tn¡
n vˆ¨t¡  dvˆma  zp–soby.  Je-li  n vˆ¨t¡,  je‘  m   b˜t referov no,  uvnit©
stejn‚ho programov‚ho segmentu  (code  segment),  je  k  lokalizaci p©¡kazu
ozna‡en‚ho n vˆ¨t¡m  zapot©eb¡ jen offset segmentu. V tomto p©¡padˆ ©¡k me,
‘e n vˆ¨t¡ je  typu  NEAR.  Ke  specifikaci n vˆ¨t¡ typu NEAR sta‡¡ um¡stit
dvojte‡ku  (:) bezprost©ednˆ za jm‚no nebo  pou‘¡t  pseudooperaci  LABEL  s
atributem NEAR

   LOOP:
   COUNT LABEL NEAR

   Druh˜ zp–sob pro adresaci  n vˆ¨t¡  pot©ebuje  adresu segmentu i hodnotu
offsetu.  To  je  p©¡pad,  kdy  referovan˜  p©¡kaz  assembleru nen¡  uvnit©
stejn‚ho programov‚ho segmentuú-úv takov‚m  p©¡padˆ  je  n vˆ¨t¡ definov no
jako FAR:

   MYCODE LABEL FAR

   V pr vˆ uk zan‚m p©¡kladˆ je  pseudooperace  LABEL  pou‘ita  s atributem
FAR. Atribut FAR lze u‘¡t tak‚ p©i referenci  symbol–  pomoc¡ pseudooperac¡
EQU, PROC a EXTRN :

   TEN EQU FAR 10
   PRNTIT PROC FAR
   EXTRN RANDM:FAR

   Konstanty

   Jm‚ny je mo‘n‚ ozna‡it tak‚  pamˆŸov   m¡sta  obsahuj¡c¡  hodnoty jednou
nastaven‚  a  nemˆn¡c¡  se  bˆhem  vykon v n¡  programu.  Tato  jen  jednou
inicializovan  pamˆŸov  m¡sta se naz˜vaj¡ konstanty a mohou b˜t osmi typ–.

1. Bin rn¡ konstanty.

   Bin rn¡ konstanty obsahuj¡ posloupnosti jedni‡ek a nul a jejich definice
je ukon‡ena p¡smenem B. Nap©¡klad:

   EIGHT EQU 00001000B

2. Dekadick‚ konstanty.






                                  - 30 - 




   Dekadick‚ konstanty obsahuj¡ posloupnost dekadick˜ch  ‡¡slic  0  a‘  9 a
jsou nepovinnˆ zakon‡ov ny  p¡smenem  D. Posloupnost ‡¡sel je pova‘ov na za
dekadickou  konstantu,  dokud   nen¡  explicitnˆ  provedena  zmˆna  z kladu
pseudooperac¡ RADIX. Zde je p©¡klad dekadick‚ konstanty:

   FORTY EQU 40D

3. Hexadecim ln¡ konstanty.

   Obsahuj¡ posloupnosti hexadecim ln¡ch ‡¡slic 0-9  a  A-F.  Definice mus¡
b˜t zakon‡ena v‘dy p¡smenem H. Prvn¡ znak mus¡  b˜t  jednou  z  ‡¡slic 0-9.
Prvn¡  znak  ©¡k  p©eklada‡i assembleru, ‘e jm‚no  je  ‡¡slem  a  ne  t©eba
n vˆ¨t¡m nebo promˆnnou. Jestli‘e  hexadecim ln¡  ‡¡slo  za‡¡n   nˆkter˜m z
p¡smen  A-F,  je  t©eba  p©ipojit  p©ed nejlevˆj¨¡ p¡smeno nulu (0),  kter 
odstran¡  nejednozna‡nost  p©i   p©ekladu.  Hexadecim ln¡  ‡¡slo  m–‘e  b˜t
definov no t©eba takto:

   FIFTY EQU   32H
   HEXNM EQU   0FFH

   Ve druh‚ definici je nula p©ipojena p©ed nejlevˆj¨¡ ‡¡slici k odstranˆn¡
nejednozna‡nosti definice.

4. Oktalov‚ konstanty.

   Skl daj¡ se z ‡¡slic 0-7 a ukon‡eny jsou p¡smenem O nebo Q.
   Nap©¡klad:

   SIX EQU 6O (nebo 6Q)

5. Znakov‚ konstanty

   Znakov‚ konstanty mohou  obsahovat  libovoln‚  ASCII  znaky  uzav©en‚ do
jednoduch˜ch nebo dvojit˜ch uvozovek. Jesli‘e znakov  konstanta m  v¡ce ne‘
dva znaky, je t©eba pou‘¡t pseudooperace DB (define byte). Jestli‘e ©etˆzec
znak– obsahuje pouze jeden nebo  dva znaky, pak m–‘eme pou‘¡t pseudooperace
DD, DQ, DT nebo DW. Nap©¡klad:

   INITL DD 'B'
   NAME DB '80286 ASSEMBLER'

6. Data v plovouc¡ © dov‚ ‡ rce (floating point)

   Tento datov˜ typ reprezentuje hodnoty  v dekadick‚ vˆdeck‚ notaci a nen¡
podporov n assemblerem IBM Small Assembler.
Nap©¡klad:

   SINE DD 0.332E-1

7. Hexadecim ln¡ ‡¡sla real

   Hexadecim ln¡ ‡¡slo real je konstantou, kter  obsahuje ‡¡slice 0 a‘  9 a
p¡smena A a‘ F, n sledovan‚ p¡smenem R. Jako u hexadecim ln¡ konstanty mus¡
b˜t  prvn¡  ‡¡slice nˆkter˜ ze symbol– 0  -  9.  Konstanta  mus¡  obsahovat
celkov‚ po‡et ‡¡slic rovn˜ 8, 16,  nebo  20,  pokud nen¡ prvn¡ ‡¡slice 0. V




                                  - 31 - 




takov‚m p©¡padˆ mus¡ b˜t celkov˜ po‡et ‡¡slic o jednu vˆt¨¡, t.j. 9,17 nebo
21. Tento datov˜ typ tak‚ nen¡ podporov n IBM Small Assemblerem. Nap©¡klad:

   HRNUM DD 0FAB12345R

8. Pseudoinstrukce EQU

   N vˆ¨t¡ v poli jm‚na  m–‘e  b˜t p©i©azena hodnota v˜razu v poli operand–
pou‘it¡m  symbolu  EQU  nebo  pou‘it¡m  znam‚nka rovnosti =.  Pou‘it¡m  EQU
p©i©ad¡me promˆnn‚ hodnotu,  kter   se v pr–bˆhu vykon v n¡ programu nem–‘e
mˆnit. Pou‘ijeme-li oper toru = (to  je  tak‚  pseudoinstrukce  !), hodnota
konstanty se m–‘e bˆhem vykon v n¡ programu mˆnit. Nap©¡klad:

   SCRADD EQU [BP+16]
   BASNUM = 1980

   V prvn¡m  p©¡kladˆ  je  symbol  SCRADD  substituov n  nam¡sto indexov‚ho
v˜razu [BP+16]. Podobnˆ BASNUM m–‘e b˜t pou‘¡v no nam¡sto ‡¡sla 1980. Nav¡c
teƒ m–‘e b˜t symbolu  BASNUM  p©i©azena  nov   hodnota v pr–bˆhu vykon v n¡
programu.


   Jm‚na segment–

   Jm‚no  segmentu je uvedeno v poli  jm‚na  deklarace  segmentu.  P©¡klad:
MYCODE SEGMENT PARA 'CODE'

   Pole operace

   Pole   operace   obsahuje   mnemonickou   zkratku   skute‡n‚   instrukce
mikroprocesoru. Mnemonick  zkratka je dlouh  dva a‘ ¨est p¡smen a p©ipom¡n 
anglick˜  n zev  instrukce.  Pou‘it¡  mnemoniky  vytv ©¡  k¢d  mnohem  l‚pe
srozumiteln˜  a  £rove¤  mnemonick˜ch k¢d– je v podstatˆ isomorfn¡ s £rovn¡
strojov˜ch  instrukc¡  (zobrazen¡  do  strojov‚  £rovnˆ  prov d¡  konverzn¡
tabulka). Operace  uveden   v  poli  operace  m–‘e  reprezentovat strojovou
instrukci, makroinstrukci nebo psudooperaci (pseudoinstrukci). Nap©¡klad:

   INITIAL MOV AX,0H

   INITIAL je zde  n vˆ¨t¡  a  MOV  operace. Po poli operace n sleduje pole
operand–. Ka‘d  operace nejenom  ©¡k   assembleru,  co  m  udˆlat, ale tak‚
specifikuje po‡et operand– a jejich typ.

   Operace  m–‘e  obsahovat  odkaz  na  makro.  Takov   reference instruuje
assembler, aby zpracoval p©eddefinovanou sekvenci instrukc¡. Assembler tedy
generuje  zdrojov‚  instrukce  stejnˆ  jako  by byly zaps ny  ve  zdrojov‚m
programu jako jeho ‡ st. Nap©¡klad:

   DOS_INT MACRO SERVICE_ID

   Tato operace ©¡k   assembleru,  ‘e n sleduj¡c¡ k¢d je ‡ st makrodefinice
MACRO.  Pseudooperace (tak‚: pseudoinstrukce) obvykle neprodukuj¡  strojov‚
instrukce, ale ©¡d¡ assembler tak, aby prov dˆl ur‡it‚  operace  na datech,
v˜pisech o p©ekladu a makrodefinic¡ch.





                                  - 32 - 




   Pole operandu

   Pole operandu obsahuje  data,  kter   maj¡  b˜t  zpracov v na instrukc¡.
Jestli‘e instrukce vy‘aduje jen jeden  nebo dva operandy, jsou od instrukce
oddˆleny alespo¤ jednou  mezerou.  Jestli‘e m  instrukce operandy dva, jsou
od  sebe  oddˆleny  ‡ rkou  (,).  Nˆkter‚  operace  v¨ak v–bec  nepot©ebuj¡
operandy.

   Jakmile operace  pot©ebuje dva operandy, je prvn¡ operand naz˜v n c¡lov˜
a  druh˜  zdrojov˜.  P©¡kladem  operac¡  vy‘aduj¡c¡ch  dva   operandy  jsou
instrukce p©esunu dat, registrov‚ instrukce aj. Nap©¡klad:

   MOV AX,8

je p©¡kladem bezprost©edn¡ho operandu. Zde  dojde  k  naplnˆn¡  registru AX
‡¡slem 8.

   Pole pozn mek

   Pole pozn mek je posledn¡ pole  a ‡asto to neju‘ite‡nˆj¨¡. Pole pozn mek
d v  prostor pro intern¡ koment ©e  a  dokumentaci  k  programu. Pozn mkov‚
© dky jsou assemblerem ignorov ny a  jsou u‘ite‡n‚ jen ve v˜pisu zdrojov‚ho
programu. Je-li operace opat©ena  pozn mkou,  je  t©eba um¡stit pozn mku a‘
alespo¤ jednu mezeru  za  posledn¡m  polem  operace  a  za‡¡nat  symbolem ;
(st©edn¡k).  Smyslem  pou‘it¡  pozn mek  je  popsat  ty   ‡ sti  zdrojov‚ho
programu, kter‚ nejsou bezprost©ednˆ srozumiteln‚. Nap©¡klad:

   MOV AH,45H ; parametr pro ‡ten¡ znaku

   Jak lze vidˆt z uveden‚ho p©¡kladu, pozn mka pom h  pochopit, pro‡ je do
registru AH zavedena hodnota 45H. V tomto p©¡padˆ jde o parametr p©eru¨en¡,
kter‚mu odpov¡d  ur‡it  operace BIOSu.


   P©¡nos programov n¡ v assembleru

   V po‡ tc¡ch  programov n¡ byly ve¨ker‚ programy ps ny ve strojov‚m k¢du.
Instrukce  byly  ps ny  v  hexadecim ln¡m  nebo bin rn¡m tvaru a pak  p©¡mo
dekodov ny technick˜mi prost©edky. Jak  programy  rostly  co do velikosti a
slo‘itosti, zv˜¨il se pronikavˆ  ‡as  pot©ebn˜ k v˜voji a ladˆn¡ softwaru a
vznikla pot©eba nov˜ch, produktivnˆj¨¡ch metod k vytv ©en¡ program–.

   Assembler byl pr vˆ takovou  metodou.  Byl  jazykem l‚pe srozumiteln˜m a
pochopiteln˜m.  Automaticky udr‘oval  ©adu  (zd nlivˆ  nekone‡nou)  detail–
inherentn¡ch programu ve strojov‚m k¢du. Neobsahoval nutnou  re‘ii typickou
pro vy¨¨¡ programovac¡  jazyky  a generoval programy, kter‚ byly vykon v ny
velice rychle.

   P©¡klad programu v assembleru

   Uvedeme p©¡klad p©elo‘en‚ho programu v assembleru.  Prav   strana na¨eho
programu obsahuje assemblerovsk˜ zdrojov˜ k¢d, kter˜ lze snadno  ‡¡st  a je
dob©e dokumentov n. Spolu s t¡mto zdrojov˜m textem je na lev‚ stranˆ uveden
i strojov˜ ekvivalent symbolick‚ho z pisu.  Je  vidˆt,  ‘e  pro nezku¨en‚ho
program tora je assemblerovsk˜ program extr‚mnˆ "za¨ifrovan˜".




                                  - 33 - 




Microsoft MACRO Assembler Version 5.0             Page 1-1

                                                  09-19-88
     1                    page ,132
     2                    ;Pro procesory 8086/80386
     3                    ;program ilustruje
     4                    ;hexadecimalni secitani
     5
     6 0000               STACK   SEGMENT PARA STACK
     7 0000 40            [ DB 64 DUP ('MYSTACK ')
     8                      4D 59 53 54
     9                      41 43 48 20
     10                           ]
     11
     12 0200              STACK   ENDS
     13
     14 0000              MYCODE  SEGMENT PARA 'CODE'
     15 0000              MYPROC  PROC FAR ;
     16                   ASSUME  CS:MYCODE,SS:STACK
     17 0000 1E           PUSH    DS
     18 0001 2B C0        SUB     AX,AX
     19 0003 50           PUSH    AX
     20
     21 ;NASLEDUJE SOUCET TRI CISEL (BEZPROSTREDNI ADRESOVANI)
     22 0004 B0 23        MOV     AL,23H  ;PRVNI CISLO
     23 0006 04 0A        ADD     AL,0AH  ;PRICTI 0AH K REG. AL
     24 0008 04 10        ADD     AL,10H  ;PRICTI 10H K REG. AL
     25                   ;KONEC PRIKLADU SECITANI,VYSLEDEK V REGISTRU AL
     26
     27 000A C0           RET             ; PREDEJ RIZENI DOSU
     28 000B              MYPROC  ENDP    ; KONEC PROCEDURY
     29 000B              MYCODE  ENDS    ; KONEC SEGMENTU
     30
     31                   END             ; KONEC PROGRAMU V ASSEMBLERU



   Prvn¡  sloupe‡ek,  ‡¡sla  od  1  do  31,  jsou   ‡¡sla   © dk–  vkl dan 
assemblerem.  Druh˜ sloupe‡ek obsahuje skute‡n‚ adresy  pamˆti,  v  n¡‘  je
p©elo‘en   mnemonick  operace (instrukce) ulo‘ena. Jsou to  ¨estn ctibitov‚
adresy reprezentovan‚ v hexadecim ln¡m form tu.  T©et¡  a  ‡tvrt˜ sloupe‡ek
obsahuj¡ skute‡n˜ tvar strojov‚ho k¢du, kter˜ odpov¡d   mnemonick‚ operaci.
Tyto sloupe‡ky se mˆn¡ podle typu instrukce a po‡tu jej¡ch operand–.

   Zb˜vaj¡c¡ sloupe‡ky ji‘ odpov¡daj¡ popsan˜m pol¡m zdrojov‚ho  programu v
assembleru: pole jm‚na, operace, operandu a pozn mky. ž dky 2 a‘ 4, 21 a 25
obsahuj¡  jen  pozn mky.  V dal¨¡ch ‡ stech  t‚to  knihy  se  nau‡¡me  ps t
programy respektuj¡c¡ tvar nazna‡en˜ v na¨em p©¡kladˆ.











                                  - 34 - 










                            K a p i t o l a   5

                            —vod do assembleru


   V t‚to kapitole budeme  podrobnˆ  diskutovat o tom, co assembler je, na‡
je  pot©eba  a  co  vlastnˆ  dˆl .  Prozkoum me  podobn‚  i  rozd¡ln‚  rysy
assembleru  a  kompil toru  vy¨¨¡ho  programovac¡ho  jazyka.  Na  uk zkov‚m
programu budeme demonstrovat, jak vytv ©et, p©ekl dat a spou¨tˆt jednoduch˜
assemblerovsk˜ program.

   Program SAMPLE.ASM je pou‘it jako  model  programu  k  demonstraci v¨ech
nezbytn˜ch sou‡ st¡ assemblerovsk‚ho programu.  Dal¨¡  detaily  t˜kaj¡c¡ se
instruk‡n¡ho souboru 80286/80386 lze nal‚zt v kapitole n sleduj¡c¡.

   Assembler  je po‡¡ta‡ov˜ program vytvo©en˜ tak,  aby  dovedl  ‡¡st  text
zapsan˜  podle  jist˜ch  syntaktick˜ch  pravidel,  tzv.  zdrojov˜  program.
Zdrojov˜ program je zaps n v anglick˜ch zkratk ch, kter‚  se  ozna‡uj¡ jako
mnemonika. Assembler akceptuje tuto mnemoniku  a p©ev d¡ ji na bin rn¡ nuly
a jedni‡ky, kter‚ jedin‚  jsou  p©irozen˜m  jazykem  mikroprocesoru. Takov 
p©elo‘en  verze zdrojov‚ho programu se naz˜v  strojov˜ k¢d (program).

   Ka‘d   mnemonika  je  smyslupln   zkratka p©¡kazu reprezentuj¡c¡ho jednu
skute‡nou  strojovou  instrukci.  Mnemonika  (t‚mˆ© v‘dy) odpov¡d  skute‡n‚
instrukci po‡¡ta‡e. Mnemonika je to, co ‡in¡ program v assembleru ‡iteln˜m,
lehce  vytvo©iteln˜m  a  trasovateln˜m.  P©¡m˜  vztah  mezi   mnemonikou  a
strojovou  instrukc¡ umo‘¤uje assembleru rychl˜ p©evod zdrojov‚ho  programu
na strojov˜ k¢d.

   P©eklada‡ vy¨¨¡ho programovac¡ho jazyka prov d¡ ‡innost  podobnou  v tom
smyslu, ‘e ‡te zdrojov˜ program a p©ev d¡ jej na strojov˜ k¢d. Programov n¡
ve vy¨¨¡m programovac¡m jazyce poskytuje program torovi  v¡ce  prostoru pro
soust©edˆn¡ se na  probl‚m  samotn˜  a  dovoluje  mu  nezab˜vat  se detaily
le‘¡c¡mi o nˆkolik £rovn¡ n¡‘e (nap©. kter‚ registry a jak   pamˆŸov  m¡sta
m   pou‘¡t  atp.).  V˜sledkem je program,  kter˜  je  zna‡nˆ  nez visl˜  na
konkr‚tn¡m mikroprocesoru. Program ve vy¨¨¡m programovac¡m jazyce  je dob©e
‡iteln˜  a  jeho  struktura je velice podobn   obecnˆ  zapsan‚mu  algoritmu
©e¨en¡ dan‚ho probl‚mu. Mezi programem  ve  vy¨¨¡m  programovac¡m  jazyce a
jeho  p©elo‘en˜m  tvarem  v¨ak nen¡ p©¡m˜  vztah  jako  mezi  mnemonikou  a
strojovou instrukc¡ u assembleru. P©elo‘en˜ tvar programu je obvykle mnohem
vˆt¨¡ ne‘ "dob©e"  napsan˜  ekvivalentn¡ program v assembleru. Nechceme t¡m
v¨ak  ©¡ci,  ‘e  kompil tory  nejsou  schopny  generovat  kvalitn¡ k¢d.  Ve
skute‡nosti byste asi po prvn¡ch  zku¨enostech  s  assemblerem  radˆji dali
p©ednost kompil toru nˆkter‚ho vy¨¨¡ho programovac¡ho jazyka.









                                  - 35 - 




---------------------------------------------------------------------------
Strojov˜ k¢d versus jazyk symbolick˜ch instrukc¡
---------------------------------------------------------------------------


   N sleduj¡c¡ uk zka programu ilustruje  u‘ite‡nost  assembleru  a n zornˆ
ukazuje p©¡mou korespondenci mezi instrukc¡  assembleru  a  jej¡m strojov˜m
ekvivalentem. Oba fragmenty program– -  strojov˜ k¢d i program v assembleru
-  jsou  z  funk‡n¡ho  hlediska  identick‚. Oba prov dˆj¡  ur‡it‚  nezbytn‚
inicializa‡n¡ operace, pak pln¡ st©ada‡ hodnotou ulo‘enou v promˆnn‚ NUMONE
a nakonec ke st©ada‡i p©i‡¡taj¡ hodnotu 3H :

     Strojov˜ k¢d                   Ekvivalent v jazyce
                                    symbolick˜ch instrukc¡
                                    (assembleru)
     --------------------------------------------------------------
     00011110                       PUSH            DS
     00101011                       SUB             AX,AX
     11000000
     01010000                       PUSH            AX
     10111000                       MOV             AX,MYDATA
     00000001
     11101100
     10001110                       MOV             DS,AX
     11011000
     10100001                       MOV             AX,NUMONE
     0000
     00000101                       ADD             AX,3H
     0011


   V˜sledek  p©ekladu  zdrojov‚ho  programu  v  assembleru  se  tak‚ naz˜v 
relokatibiln¡ k¢d. Jakmile  m me  program ve tvaru relokatibiln¡ho k¢du, je
mo‘n‚ jej p©¡mo zav‚st do pamˆti a po nastaven¡ p©¡slu¨n˜ch vazeb spustit.

   Programov n¡  ve  strojov‚m  k¢du  je  ‡asovˆ  vysoce  n ro‡n   ‡innost,
zatˆ‘uje o‡i a vytvo©en˜ program neb˜v  snadn‚ odladit. Jak  bylo  vidˆt  v
p©edchoz¡m p©¡kladˆ,  nen¡  bezprost©ednˆ  z©ejm‚,  co  vlastnˆ  jednotliv 
bin rn¡ ‡¡sla reprezentuj¡ - jsou to data nebo instrukce ‡i adresy ?

   Na¨tˆst¡  pro n s, m me k dispozici asemblery,  kter‚  n m  p©i  procesu
vytv ©en¡  strojov‚ho  programu pom haj¡. Vidˆli  jsme,  ‘e  assemblerovsk 
verze p©edchoz¡ho fragmentu programu  je  mnohem  pochopitelnˆj¨¡  ne‘ jej¡
strojov˜ ekvivalent. Srozumiteln‚ anglick‚ zkratky nahradily nesrozumiteln 
bin rn¡ ‡¡sla.

   V¨imnˆme si  je¨tˆ filosofie v˜voje mikroprocesor– firmy INTEL. INTEL se
sna‘il   zachovat   kompatibilitu    s   ostatn¡mi   ‡leny   sv‚   "rodiny"
mikroprocesor–, po‡¡naje od prvn¡ch  procesor–  p©es 8080, 8088 a 8086 a‘ k
sou‡asn‚  generaci.  To  znamen ,  ‘e  ka‘d   nov   generace mikroprocesor–
p©ich z¡ s  rozs hlej¨¡m  instruk‡n¡m  souborem,  hardwarov˜mi vylep¨en¡mi,
zv˜¨enou rychlost¡ atp., p©i‡em‘ p©edchoz¡ aplikace jsou zachov ny. Proto‘e
ka‘d˜  nov˜   mikroprocesor   obsahuje   nadmno‘inu   (superset)  instrukc¡
p©edchoz¡ho mikroprocesoru, star‚ programy bude mo‘n‚  vykon vat  buƒ zcela
beze  zmˆn  nebo  jen   s   nepatrn˜mi   £pravami  na  nejnovˆj¨¡  generaci




                                  - 36 - 




mikroprocesor–. To je smyslem  £sil¡  o  zachov ni kompatibility - u‘ivatel
nemus¡ znovu vyv¡jet stejn˜ software.



---------------------------------------------------------------------------
Typick˜ proces p©i v˜stavbˆ program– v assembleru
---------------------------------------------------------------------------


   Vytv ©en¡ program– v assembleru p©edstavuje sekvenci  nˆkolika  krok–. V
podstatˆ m–‘eme vydˆlit t©i z kladn¡ kroky:

   1.  Textov˜m editorem vytvo©¡me zdrojov˜ program

   2.  P©elo‘¡me  assemblerem  zdrojov˜  program  a  z¡sk me  relokatibiln¡
       program

   3.  Spojov n¡m   z¡sk me   z   relokatibiln¡ho   programu   exekutabiln¡
       (provediteln˜) k¢d ve tvaru .EXE souboru


   Alternativn¡ metodou je vytvo©en¡ souboru .COM. Podrobnˆ je tato mo‘nost
diskutov na v p©¡loze ke  ka‘d‚mu  assembleru.  Kromˆ tˆchto t©¡ z kladn¡ch
krok– je do  v˜vojov‚ho  cyklu  vytv ©en¡  assemblerovsk‚ho  programu t©eba
zahrnout i dal¨¡ krok spo‡¡vaj¡c¡ v ladˆn¡ (debugging) programu, proto‘e je
t‚mˆ© nemo‘n‚, ‘e hned napoprv‚ nap¡¨ete bezchybn˜ assemblerovsk˜ program.

   KROK 1: Vytv ©en¡ zdrojov‚ho programu

   Vhodn˜m  editorem (nejl‚pe obrazovkov˜m - full-screen editor)  vytvo©¡te
zdrojov˜ program s  extenz¡  .ASM  a  ulo‘¡te  jej na disk nebo disketu pod
jm‚nem t©eba SAMPLE.ASM.  V¨imnˆme  si  nyn¡  bl¡‘e  jednotliv˜ch instrukc¡
va¨eho programu SAMPLE.ASM. Prvn¡ dva © dky programu

   1. ;PRIKLAD PROGRAMU PRO IBM 8088/80286
   2. ;PROGRAM PRO ZAPIS ZNAKU NA OBRAZOVKU


jsou pozn mkami. Ka‘d˜ ©etˆzec  znak–,  p©ed  n¡m‘  je um¡stˆn st©edn¡k, je
assemblerem ignorov n. Zde  pozn mka  vystihuje,  co  m   program prov dˆt.
N sleduj¡c¡  ‡ st  programu  obsahuje dva p©¡kazy, SEGMENT (© dek 3) a ENDS
(© dek 5), kter‚ definuj¡ po‡ tek a konec ur‡it‚ho celku v programu: zde je
to segment z sobn¡ku STACK SEGMENT :

3. STACK SEGMENT  PARA 'STACK'
4.       DB       64 DUP ('STACK')
5. STACK ENDS


   V¨echny t©i  uv dˆn‚ makroassemblery umo‘¤uj¡ udr‘ovat v pamˆti a‘ ‡ty©i
sou‡asnˆ aktivn¡ segmenty:  CODE,  DATA, STACK a EXTRA. Segmentace umo‘¤uje
dosa‘en¡ dob©e strukturovan‚ho, modul rn¡ho zdrojov‚ho programu.






                                  - 37 - 




   ž dek 3 obsahuje slovo  STACK  v poli n vˆ¨t¡ a specifikuje jm‚no, kter‚
je segmentu p©i©azeno. Operand PARA specifikuje, ‘e segment bude za‡¡nat na
16-bytov‚ hranici (standardn¡ paragraf)  v  pamˆti.  Slovo 'STACK' na konci
© dku specifikuje jm‚no, kter‚ bude spojeno s t¡mto  segmentem  v k©¡‘ov˜ch
referenc¡ch.

   ž dek  4  definuje  velikost  z sobn¡ku,  64  D(efined)  B(ytes) a  ©¡k 
assembleru, ‘e m  tato m¡sta  v pamˆti inicializovat slovem 'STACK'. P©¡kaz
ENDS na © dku 5 ukon‡uje definici segmentu.

   Dal¨¡ t©i © dky programu definuj¡ a pojmenov vaj¡ segment dat - DATA:

6. DATA     SEGMENT PARA 'DATA'
7. MESAGE   DB 'JAK SE VAM TO LIBI, VAZENI ?','$'
8. DATA     ENDS



   Tento segment tak‚ za‡¡n  na 16-bytov‚ hranici a v k©¡‘ov˜ch referenc¡ch
bude vyps n jako 'DATA' (© dek 6). V tomto velice kr tk‚m  datov‚m segmentu
je definov na jen jedna promˆnn   - MESAGE. Je specifikov na jako ©etˆzcov 
promˆnn , inicializovan  hodnotou 'JAK SE VAM TO LIBI, VAZENI ?'.

   Je t©eba zd–raznit, ‘e nˆkter‚ assemblery jsou na um¡stˆn¡ segmentu DATA
(kde  jsou  definov ny  a  referov ny  promˆnn‚)  velice  citliv‚.  V¨echny
p©¡klady v tomto textu maj¡ segment DATA um¡stˆn na za‡ tku  programu. Tyto
segmenty v¨ak mohou b˜t um¡stˆny i pod segmentem CODE. Jestli‘e je ve va¨em
programu  segment  DATA  um¡stˆn  na  za‡ tku programu a  p©esto  dost v te
chybov‚ hl ¨en¡  kv–li um¡stˆn¡ datov‚ho segmentu, p©esu¤te segment DATA na
konec va¨eho programu.

   ž dek  9  definuje  za‡ tek  segmentu  CODE, kter˜ le‘¡ opˆt na  hranici
paragrafu (16 byte) a bude ozna‡en slovem 'CODE' v k©¡‘ov˜ch referenc¡ch:

9. CODE     SEGMENT  PARA 'CODE' ;DEFINUJ SEGMENT CODE


V¨imnˆte si pozn mek na tomto a n sleduj¡c¡ch © dc¡ch.

   N sleduj¡c¡ © dek obsahuje n vˆ¨t¡ MAIN a deklaraci procedury PROC:

10.   MAIN     PROC     FAR ;PROCEDURA SE JMENUJE MAIN



   Procedury  jsou ‡ sti program–, kter‚ jsou vykon v ny  tak,  ‘e  jsou  z
jin˜ch  program–  vol ny.  P©i  ka‘d‚m  vyvol n¡  procedury   je  procedura
provedena a ©¡zen¡ je vr ceno zpˆt volaj¡c¡mu programu.

   Deklarace  procedury  za‡¡n   symbolem PROC a kon‡¡  symbolem  ENDP.  Za
symbolem PROC je uveden buƒ atribut NEAR nebo FAR. Tento  atribut informuje
assembler o tom, jak˜ typ skoku m  assembler prov‚st.  Ve  vˆt¨inˆ  p©¡pad–
atributy NEAR a FAR  ur‡uj¡,  jak˜ typ n vratov‚ instrukce m  b˜t generov n
pro  pr vˆ  p©ekl danou  proceduru.  Vol n¡  CALL  procedury  specifikovan‚
atributem  NEAR ponech v  na vrcholu z sobn¡ku  jen  hodnotu  registru  IP,




                                  - 38 - 




zat¡mco vol n¡  CALL  procedury  specifikovan‚  atributem  FAR  uchov v  do
z sobn¡ku oba registry CS a IP (v uveden‚m po©ad¡).

   V¨echny  © dky  programu  se  samoz©ejmˆ  budou  ve   va¨ich  programech
vyskytovat v tˆch ‡i onˆch modifikac¡ch. Ka‘d˜ program bude m¡t nap©. jinak
dimenzov n a inicializov n segmenty  STACK  a  DATA.  Nebudou se v¨ak mˆnit
n sleduj¡c¡  © dky  (11  a‘  17),  kter‚   p©edstavuj¡   standardn¡  prolog
assemblerovsk‚ho programu. Pro tento prolog  budeme  tak‚  pou‘¡vat ¨ir¨¡ho
n zvu nutn  programov  re‘ie .



---------------------------------------------------------------------------
Programov  re‘ie
---------------------------------------------------------------------------


   N sleduj¡c¡   instrukce  ustavuj¡  z kladn¡  vazby  na  t©i   definovan‚
programov‚ segmenty:

11.   ASSUME CS:CODE,DS:DATA,ES:DATA,SS:STACK


   P©¡kaz ASSUME ©¡k  assembleru, ‘e m  spojit registr CS (Code  Segment) s
um¡stˆn¡m segmentu CODE, registry DS a ES (Data Segment a Extra  Segment) s
um¡stˆn¡m segmentu DATA a registr SS s um¡stˆn¡m segmentu STACK. Znamen  to
tedy, ‘e nap©. instrukce mov ax,var napln¡ registr ax obsahem promˆnn‚ var,
jej¡‘ adresa bude z¡sk na jako sou‡et obsahu registru DS a posunut¡ symbolu
var vzhledem k za‡ tku segmentu DATA, na nˆho‘ ukazuje DS.

   N sleduj¡c¡ t©i instrukce slou‘¡  k  "zapamatov n¡"  um¡stˆn¡ opera‡n¡ho
syst‚mu: jakmile assemblerovsk˜ program skon‡¡ svoji ‡innost,  znovu ustav¡
v¨echna nezbytn  spojen¡.

12.      PUSH  DS    ;UCHOVEJ DS
13.      SUB   AX,AX ;NULUJ AX
14.      PUSH  AX    ;UCHOVEJ TAKE NULOVY OFFSET


   ž dek 12 ukl d  aktu ln¡ obsah registru DS na vrchol z sobn¡ku. ž dek 13
generuje nulovou hodnotu  pro  offset  a  na  © dku 14 je tato hodnota tak‚
ulo‘ena do z sobn¡ku.

   Uchov n¡  star‚  hodnoty  registru  DS  je  tak  snadn‚ jako  jeho  nov‚
naplnˆn¡. Registr DS v¨ak nem–‘e  b˜t naplnˆn hodnotou promˆnn‚. To ukazuj¡
© dky 15 a 16:

15.      MOV   AX,DATA  ;VEZMI DO A UMISTENI DATA
16.      MOV   DS,AX    ;NAPLN JIM REGISTR DS


   Naplnˆn¡ registru ES bude analogick‚:

17.      MOV   ES,AX





                                  - 39 - 




   V tomto p©¡kladˆ ukazuj¡ oba registry na stejn‚ pamˆŸov‚ m¡sto. ž dek 17
je posledn¡m © dkem programov‚ re‘ie  spojen‚  s  prologem assemblerovsk‚ho
programu.

   ž dky  18 a‘ 21 jsou vlastn¡m algoritmem  na¨eho  programu.  M¡sto  nich
byste vlo‘ili sv–j vlastn¡ k¢d:

18.   ; PROGRAM PRO VYPIS ZPRAVY NA OBRAZOVKU
19.      LEA   DX,MESAGE   ;ADRESA ULOZENI ZPRAVY
20.      MOV   AX,09       ;PARAMETR DOSu
21.      INT   21H         ;VOLEJ PRERUSENI DOSu


   V tomto p©¡padˆ bude n ¨ program vypisovat na obrazovku text JAK  SE VAM
TO LIBI, VAZENI ?. Po vyps n¡  textu  program  ukon‡¡ svoji ‡innost - to je
n pln¡ n sleduj¡c¡ch © dk–:

22.         RET         ;NAVRAT RIZENI DO DOSu
23. MAIN ENDP        ;KONEC PROCEDURY MAIN
24. CODE ENDS        ;KONEC SEGMENTU CODE
25.         END         ;KONEC ZDROJOVEHO PROGRAMU


   Instrukce  RET  (© dek  22) vyzved v  n vratovou adresu ze z sobn¡ku a v
tomto p©¡padˆ zaji¨Ÿuje n vrat do  opera‡n¡ho  syst‚mu.  ž dek  23 ukon‡uje
definici procedury. Segment  CODE  je  ukon‡en  p©¡kazem ENDS na © dku 24 a
cel˜ assemblerovsk˜ program  ukon‡uje  instrukce END (© dek 25), kter  ©¡k 
assembleru, ‘e dos hl konce zdrojov‚ho  programu.  Jestli‘e  uchov me tento
program  na  disku  jako  SAMPLE.ASM,  m–‘eme  p©ej¡t  ke druh‚mu  kroku  v
programov n¡ v assembleru.

   KROK 2: generov n¡ relokatibiln¡ho k¢du

   V n sleduj¡c¡m  v˜kladu  si  uk ‘eme,  jak  co  nejjednodu¨eji generovat
soubor .OBJ - t.j. soubor uchov vaj¡c¡ program v relokatibiln¡m tvaru.

   Jestli‘e m me v jednotce A disketu s nˆkter˜m z assembler– a  v jednotce
B disketu se zdrojov˜m programem SAMPLE.ASM, jednodu¨e nap¡¨eme

   B>A:MASM SAMPLE
   pro IBM Macro Assembler, nebo
   B>A:MASM SAMPLE
   pro Microsoft Assembler, nebo
   B>A:TASMB SAMPLE
   pro Turbo Editasm Assembler.


   V  p©¡padˆ  Turbo  Editasm (na disketˆ pod n zvem TASMB.EXE) zvol¡me F7,
abychom  dostali   soubor  .OBJ.  Stiskneme  "A"  a  za‡neme  tak  p©eklad.
Implicitn¡ jm‚no relokatibiln¡ho programu bude SAMPLE.OBJ.

   V¨echny t©i zm¡nˆn‚ assemblery  nevy‘aduj¡  p©i  zad n¡ jm‚na souboru se
zdrojov˜m programem extenzi .ASM -  ta  se  p©edpokl d   implicite. —spˆ¨n˜
p©eklad vytvo©¡ soubor SAMPLE.OBJ a um¡st¡  jej  na disketu v jednotce B. I
kdy‘ SAMPLE.OBJ obsahuje  v¨echny  instrukce v jejich strojov‚m tvaru, nen¡
to  je¨tˆ  program,  kter˜ m–‘eme prov dˆt pod  opera‡n¡m  syst‚mem.  Pr vˆ



                                  - 40 - 




SAMPLE.OBJ  je  vstupn¡m  programem  do  posledn¡ f ze p©i  programov n¡  v
assembleru.

   KROK 3: spojov n¡

   V tomto okam‘iku je nutno  pou‘¡t spojovac¡ program (linker) LINK, kter˜
transformuje  program SAMPLE.OBJ  do  provediteln‚ho  programu  SAMPLE.EXE.
Podrobnˆ  je tento proces popisov n v  p©¡slu¨n‚m  manu lu  ke  konkr‚tn¡mu
firemn¡mu assembleru.  Zde  si  uk ‘eme,  jak  jednodu¨e  vytvo©¡me program
SAMPLE.EXE.

   P©edpokl dejme  opˆt  program  SAMPLE.OBJ  na  disketˆ  v   jednotce  B,
spojovac¡ program  LINK v jednotce A. Abychom vytvo©ili program SAMPLE.EXE,
provedeme n sleduj¡c¡ akci:

   B>A:LINK SAMPLE


   Po £spˆ¨n‚m ukon‡en¡ ‡innosti spojovac¡ho programu budeme m¡t na disketˆ
v jednotce B program SAMPLE.EXE. M–‘eme vyzkou¨et jeho ‡innost

   B>SAMPLE


   Po  vyps n¡  textu  na  obrazovku  program   automaticky   vr t¡  ©¡zen¡
opera‡n¡mu syst‚mu DOS, kter˜ se ohl s¡ v˜zvou B> .

































                                  - 41 - 































































                                  - 42 - 










                            K a p i t o l a   6

               ARCHITEKTURA : REGISTRY, Pž‹ZNAKY A INSTRUKCE



---------------------------------------------------------------------------
Mikroprocesor 80286
---------------------------------------------------------------------------


   Mikroprocesor 80286 m  mnoho vyspˆl˜ch rys– navr‘en˜ch k dosa‘en¡ vysok‚
v˜konnosti   a   vych zej¡c¡ch   vst©¡c   pot©eb m   multiu‘ivatelsk˜ch   a
multiprogramov˜ch  aplikac¡.  Mikroprocesor  80286  m   vestavˆnou  ochranu
pamˆti pro opera‡n¡ syst‚m  a  podporuje  v˜lu‡nost  p©¡stupu u‘ivatelsk˜ch
program– k jejich dat–m. P©i kmito‡tu taktovac¡ch puls– 10 MHz  prov d¡ ‡ip
80286 programy a‘ 6x  rychleji  ne‘ obvod 8086 p©i taktovac¡ frekvenci 4.77
MHz.

   €ip 80286 poskytuje kompatibilitu s programov˜m vybaven¡m pro 8088/8086.
V  m¢du re ln˜ch adres (re ln˜ m¢d) je  80286  kompatibiln¡  s  existuj¡c¡m
relokatibiln¡m k¢dem pro 8088/8086.  Ve  virtu ln¡m  adresov‚m  m¢du (tak‚:
privilegovan˜ m¢d, chr nˆn˜ m¢d) je  80286  kompatibiln¡  s relokatibiln¡mi
programy  8088/8086  na  £rovni  zdrojov˜ch  program–,  ale   program  m–‘e
vy‘adovat  jist‚  £pravy,  aby  mohl  vyu‘¡vat  v¨echny  v˜hody virtu ln¡ho
adresov‚ho prostoru podporovan‚ho obvodem 80286.



---------------------------------------------------------------------------
Z kladn¡ architektura
---------------------------------------------------------------------------


   Obvod 80286 obsahuje osm 16-bitov˜ch  v¨eobecn˜ch registr– - AX, BX, CX,
DX, SP, BP, SI a DI. Registry AX, BX, CX a DX mohou b˜t pou‘ity  jako £pln‚
16-bitov‚  registry,  nebo  m–‘e  b˜t  ka‘d˜  z  registr– rozdˆlen  na  dva
osmibitov‚ registry,  co‘  poskytuje  mo‘nost  pou‘¡vat  a‘  8 osmibitov˜ch
registr–. Jm‚na registr–  zakon‡en   p¡smenem "X" (nap©. BX) ozna‡uj¡ £pln‚
registry.  Osmibitov‚  poloviny  jsou ozna‡eny p¡smenem "L"  resp.  "H"  za
jm‚nem registru (tedy AL resp. AH ozna‡uj¡ doln¡,  resp.  horn¡ osmibitovou
polovinu ¨estn ctibitov‚ho registru AX).

   ›estn ctibitov‚ registry SP (Stack  Pointer)  a  BP (Base Pointer) tvo©¡
registrov˜ p r, kter˜ je vyu‘¡v n pro manipulaci se  z sobn¡kem  a obsahuje
offset vzhledem k aktu ln¡mu z sobn¡ku.  Registrov˜ p r SI (Source Index) a
DI (Destination Index)  je  ozna‡ov n jako indexov‚ registry. Tyto registry
jsou u‘¡v ny jako hodnoty  index–,  je‘ mohou b˜t zvy¨ov ny a sni‘ov ny p©i
proch zen¡ komplexnˆj¨¡mi datov˜mi strukturami.




                                  - 43 - 




---------------------------------------------------------------------------
Segmentov‚ registry
---------------------------------------------------------------------------


   €ip  80286 podporuje ‡ty©i sou‡asnˆ p©¡stupn‚  moduly  v  hlavn¡  pamˆti
naz˜van‚ segmenty. Tyto ‡ty©i  segmenty  mohou  b˜t  adresov ny 16-bitov˜mi
registry CS, DS, SS a ES .
   K¢d  pr vˆ  vykon van‚ho  programu  p©¡tomn‚ho  v  opera‡n¡   pamˆti  je
adresov n registrem CS (Code Segment). B ze (b zov  adresa, adresa po‡ tku)
pr vˆ  aktivn¡ho  datov‚ho  segmentu  je  adresov na  registrem   DS  (Data
Segment). Z sobn¡ky pou‘¡van‚ k ulo‘en¡ meziv˜sledk– a k vol n¡ podprogram–
maj¡ tak‚ sv–j vlastn¡ segment SS (Stack Segment).  Program tor  m–‘e nav¡c
p©istupovat k druh‚mu  aktivn¡mu  datov‚mu  segmentu  naz˜van‚mu  ES (Extra
Segment), kter˜ je referov n p©es registr ES.

   Adresace  elementu  uvnit© vybran‚ho segmentu  je  zabezpe‡ena  vybr n¡m
aktivn¡ho segmentu prost©ednictv¡m jednoho ze 4 segmentov˜ch registr– - CS,
DS, SS nebo ES  a  specifikac¡ 16-bitov‚ho offsetu vzhledem k b zov‚ adrese
ulo‘en‚ ve vybran‚m segmentov‚m registru. ›estn ctibitov  adresa segmentu a
16-bitov˜ offset (posunut¡ vzhledem k po‡ tku segmentu = adrese v pat©i‡n‚m
segmentov‚m   registru)  vytv ©ej¡  vy¨¨¡  a  ni‘¨¡  polovinu   32-bitov‚ho
virtu ln¡ho adresov‚ho  ukazatele  do  pamˆti.  Jakmile  je  jednou segment
vybr n, sta‡¡ jen specifikovat offset (ni‘¨¡ch 16 bit–) v instrukci. Adresy
segment– jsou interpretov ny r–znˆ  v  z vislosti na m¢du, v nˆm‘ ‡ip 80286
pracuje. V re ln‚m m¢du segmentov‚  registry  obsahuj¡  fyzick‚  adresy. Ve
virtu ln¡m  (privilegovan‚m)  m¢du  obsahuj¡  segmentov‚ registry adresy do
virtu ln¡ pamˆti a vy‘aduj¡ translaci logick‚ virtu ln¡ adresy na adresu ve
fyzick‚ pamˆti.



---------------------------------------------------------------------------
Indexov‚ a b zov‚ registry. Registry ukazatele
---------------------------------------------------------------------------


   Jak  jsme  ji‘  uvedli,  fyzick   adresa  konkr‚tn¡ho   elementu  uvnit©
vybran‚ho segmentu se z¡sk  kombinac¡  adresy  segmentu  a  offsetu. Offset
m–‘e  b˜t  um¡stˆn  v  libovoln‚m  z  registr–  b zov˜ch  (base  register),
indexov˜ch (index register) nebo v registru ukazatele (pointer register).

   Operace  nad z sobn¡kem jsou umo‘nˆny selektorem z sobn¡kov‚ho  segmentu
(stack segment selector)  SS  a  registry  SP (Stack Pointer) nebo BP (Base
Pointer).  Offsety vzhledem k registr–m DS a ES  jsou  z¡sk ny  z  b zov‚ho
registru  BX,  komplikovanˆj¨¡  manipulace  s  daty  mohou   b˜t  provedeny
pou‘¡v n¡m registr– SI (Source Index) a DI (Destination Index) ve spojen¡ s
pr vˆ aktivn¡m datov˜m segmentem.











                                  - 44 - 




---------------------------------------------------------------------------
ž¡dic¡ registry a registry stavu (FLAGS)
---------------------------------------------------------------------------


   €ip 80286 obsahuje registr  FLAGS  s 11 p©¡znaky. ›est z tˆchto p©¡znak–
naz˜vaj¡c¡ch se p©¡znaky stavu  je  nastavov no  aritmetick˜mi  a logick˜mi
operacemi  a  pro  tyto  operace  poskytuje logick‚ ©¡dic¡  podm¡nky.  Tyto
registry jsou ozna‡eny jako p©¡znak p©enosu CF (Carry Flag), p©¡znak parity
PF  (Parity Flag), p©¡znak pomocn‚ho p©enosu  AF  (Auxiliary  Carry  Flag),
p©¡znak znam‚nka SF (Sign Flag) a p©¡znak p©ete‡en¡ OF (Overflow Flag).

   -úp©¡znak p©enosu CF  je  nastaven  na  1, kdy‘ je generov n p©enos nebo
v˜p–j‡ka p©i aritmetick‚ operaci s  8-bitov˜mi  nebo  16-bitov˜mi operandy.
Jinak je nastaven na 0. CF je u‘¡v n tak‚ p©i instrukc¡ch rotac¡ a posun– a
obsahuje  pak  hodnotu  bitu  "vypad vaj¡c¡ho"  p©i  rotaci  nebo posunu  z
p©¡slu¨n‚ho registru

   -úp©¡znak parity PF je nastavov n do 1 p©i generov n¡ lich‚ parity  a do
0 p©i generov n¡  parity  sud‚.  Je  pou‘¡v n hlavnˆ pro aplikace spojen‚ s
p©enosem dat.

   -úp©¡znak p©¡davn‚ho (pomocn‚ho) p©enosu AC je pou‘¡v n v BCD aritmetice
k indikaci, zda  byla  v˜p–j‡ka  z  / p©enos do nejni‘¨¡ ‡ty©bitov‚ ‡¡slice
‡¡sla reprezentovan‚ho v k¢du BCD

   -úp©¡znak nuly ZF indikuje nulov˜ v˜sledek operace t¡m, ‘e se nastav¡ na
hodnotu 1

   -úp©¡znak znam‚nka SF je nastaven do 1 v p©¡padˆ z porn‚ho v˜sledku a do
0 v p©¡padˆ v˜sledku kladn‚ho.

   -úp©¡znak p©ete‡en¡ OF  indikuje  nastaven¡m do 1 skute‡nost, ‘e operace
generovala  p©enos  do  nejvy¨¨¡ho bitu v˜sledku ale  nikoliv  sou‡asnˆ  ze
nejvy¨¨¡ho bitu nebo p©enos z nejvy¨¨¡ho bitu v˜sledku  ale  nikoliv p©enos
do tohoto nevy¨¨¡ho bitu (nonekvivalence).

   T©i  z  11  p©¡znak–  -  TF, IF a DF - se pou‘¡vaj¡ k  ©¡zen¡  nˆkter˜ch
operac¡  procesoru.  P©¡znak  TF  (Trap  Flag) p©i sv‚m  nastaven¡  p©ep¡n 
procesor do krokov‚ho re‘imu a umo‘¤uje odladˆn¡ programu. P©¡znak povolen¡
p©eru¨en¡  IE  (Interrupt  Enable) umo‘¤uje p©i sv‚  hodnotˆ  1  akceptovat
extern¡  p©eru¨en¡  a  p©i hodnotˆ 0 je nebere v £vahu.  Smˆr  postupu  p©i
©etˆzcov˜ch operac¡ch ur‡uje p©¡znak  DF  (Direction Flag). P©i DF = 0 jsou
registry SI a  DE  automaticky  inkrementov ny,  p©i  DF  =  1 jsou SI a DF
automaticky dekrementov ny p©i proch zen¡ polem (©etˆzcem).

   P©¡znaky IOPLF a  NTF  jsou  dva  nov‚ p©¡znaky, je‘ u p©edchoz¡ch ‡len–
rodiny INTEL neexistovaly a  u  80286  jsou  vyu‘¡v ny jen v privilegovan‚m
m¢du.  Dvoubitov˜ IOPLF (Input/Output Privilege Level  Flag)  je  pou‘it  k
tomu, aby instrukce vykonala jen ty operace, kter‚ m  povoleny. P©¡znak NTF
(Nested  Task  Flag)  je  pou‘it  k indikaci vno©en¡ pr vˆ prov dˆn‚  £lohy
(task)  do  jin‚  £lohy (p©i multiprogramov‚m provozu). P©i NT = 1 m  pr vˆ
prov dˆn˜ proces platn‚ spojen¡ (vazbu) s  p©edchoz¡m  programem (procesem,
£lohou).





                                  - 45 - 




---------------------------------------------------------------------------
Registr adresy instrukce (instruction pointer)
---------------------------------------------------------------------------


   Registr adresy instrukce IP (Instruction Pointer) obsahuje offset adresy
p©¡¨t¡ vykon van‚ instrukce (v–‡i CS) uvnit© pr vˆ aktivn¡ho segmentu CODE.
Umo‘¤uje tak vytvo©en¡ £pln‚ 32-bitov‚ adresy p©¡¨t¡ instrukce programu.



---------------------------------------------------------------------------
Stavov‚ slovo procesoru (machine status word )
---------------------------------------------------------------------------


   Prvn¡ch pˆt bit–  16-bitov‚ho  stavov‚ho  slova  procesoru  MSW (Machine
Status Word) obsahuje bit PE (Protection Enable)-nult˜ bit, bit MP (Monitor
CoProcessor)-prvn¡ bit, bit  EM  (EMulate  Coprocessor)-druh˜  bit,  bit TS
(Task Switched)-t©et¡ bit a ET (Processor Extension Type)-bit ‡tvrt˜.

 -úPE je pou‘it k aktivaci privilegovan‚ho  m¢du  ‡ipu 80286. Je-li PE = 0,
pracuje procesor v re ln‚m m¢du. P©i PE = 1 je aktivov n privilegovan˜ m¢d.
 -úMP  je  pou‘it  spolu  s  bitem  TS  ke zji¨tˆn¡, zda operace WAIT  bude
generovat chybov˜ stav "koprocesor nen¡ p©¡tomen" p©i TS = 1.
 -úEM  p©i  nastaven¡  do 1 zp–sob¡,  ‘e  v¨echny  k¢dy  koprocesoru  budou
vyvol vat chybov˜ stav "koprocesor nen¡ p©¡tomen". P©i EM = 0 budou v¨echny
opera‡n¡ k¢dy koprocesoru skute‡nˆ realizov ny koprocesorem 80287/80387.
 -úTS je nastaven do 1  automaticky, kdykoliv je provedena operace p©epnut¡
£lohy  (programu)   (task  switching).  P©i  TSú  =ú1  budou  v¨echny  k¢dy
koprocesoru vyvol vat trap "koprocesor nen¡ p©¡tomen".



---------------------------------------------------------------------------
Mikroprocesor 80386
---------------------------------------------------------------------------


   €ip 80386  je  32-bitov˜  mikroprocesor  navr‘en˜  k  podpo©e opera‡n¡ch
syst‚m– optimalizovan˜ch pro  re‘im  pr ce  v¡ce  £loh  (multitasking). €ip
80386 m  32-bitov‚ registry a datov‚  cesty  a  je tedy s to podporovat 32-
bitov‚ adresn¡ m¢dy. 80386 je schopen adresovat a‘ 4 GB fyzick‚ pamˆti a 64
TB  (terrabyte  !)  pamˆti  virtu ln¡.  Integrovan   architektura  spr vy a
ochrany  pamˆti  v  sobˆ zahrnuje registry pro  translaci  adres,  ochrann˜
mechanismus pro podporu  opera‡n¡ch  syst‚m– a vyspˆl˜ hardware pro podporu
re‘imu pr ce v¡ce £loh.

   žetˆzen‚ zpracov n¡ instrukc¡ (pipelining), velk  ¨¡©ka sbˆrnice a p©¡m 
translace adres na ‡ipu  80386  v˜raznˆ  zkracuj¡ pr–mˆrnou dobu vykon v n¡
instrukce  a  implikuj¡  tak  vysokou   pr–chodnost   syst‚mu.   Tento  rys
architektury 80386 se projevuje v  jeho rychlosti : 80386 pracuje rychlost¡
3 - 4 mili¢ny instrukc¡ za sekundu (p©i frekvenci  taktovac¡ch  impuls–  16
MHz).





                                  - 46 - 




   Dal¨¡mi rysy 80386 je p©¡m˜  p©¡stup k rychl‚ vyrovn vac¡ pamˆti (cache)
pro translaci str nek, self-test  a  4  nov‚ trasovac¡ registry (breakpoint
registers). €ip 80386 je kompatibiln¡ na £rovni relokatibiln¡ho k¢du s ‡ipy
8088/8086/80286.



---------------------------------------------------------------------------
Datov‚ typy 80386
---------------------------------------------------------------------------


   €ip 80386 podporuje nˆkolik dal¨¡ch datov˜ch  typ–.  Podporuje p©edev¨¡m
32-bitov  cel   ‡¡sla integer s/bez znam‚nka (signed and unsigned integers)
a pole bit–  v  d‚lce  1  a‘  32  bit–.  €ip tak‚ podporuje standardn¡ typy
ukazatel– jako 8086/80286 a p©id v  k nim ukazatel offsetu (32 bit–)  a 48-
bitov˜ £pln˜ ukazatel.



---------------------------------------------------------------------------
Adresov n¡ operand– u 80386
---------------------------------------------------------------------------


   Kromˆ 8-bitov˜ch a 16-bitov˜ch  bezprost©edn¡ch  operand–  podporuje ‡ip
80386 tak‚ operandy o d‚lce  32  bit–  s  t¡m,  ‘e  pole  pro bezprost©edn¡
operand je roz¨¡©eno z 16 na 32 bit–. Je-li specifikov n 32-bitov˜ operand,
instrukce  RET  a  ENTER pracuj¡ s 16-bitov˜m  bezprost©edn¡m  operandem  s
nulami doplnˆn˜mi do d‚lky 32 bit–.



---------------------------------------------------------------------------
V˜po‡et efektivn¡ adresy u 80386
---------------------------------------------------------------------------


   P©i p©¡stupu k segmentu del¨¡mu ne‘ 64 kB m–‘e b˜t efektivn¡  adresa jak
32-bitov , tak i  16-bitov .  Efektivn¡ adresa je vytvo©ena se‡ten¡m obsah–
(p©¡padnˆ pou‘it‚ho) b zov‚ho registru  a  (p©¡padnˆ  pou‘it‚ho) indexov‚ho
registru a  (tak‚ p©¡padn‚ho) p©em¡stˆn¡. Kromˆ toho byly 32-bitov‚ adresn¡
m¢dy roz¨¡©eny tak, aby umo‘nily pou‘it¡  libovoln‚ho  v¨eobecn‚ho registru
jako b zov‚ho ‡i indexov‚ho.



---------------------------------------------------------------------------
Prov dˆn¡ k¢du mikroprocesoru 8086 na 80386
---------------------------------------------------------------------------


   €ip 80386 m  2 m¢dy ‡innosti : re ln˜  a  privilegovan˜.  Re ln˜  m¢d je
stejn˜ jako u 80286  a  je m¢dem nastaven˜m po RESETu mikroprocesoru 80386.
Virtu ln¡    m¢d    napodobuj¡c¡    mikroprocesor   8086   je   podmno‘inou
privilegovan‚ho  m¢du  ‡ipu   80386   a   umo‘¤uje,   aby   instruk‡n¡  k¢d



                                  - 47 - 




mikroprocesoru 8086 mohl b˜t prov dˆn  v  r mci  privilegovan‚ho  m¢du ‡ipu
80386 p©i str nkovan‚m re‘imu pr ce procesoru.



---------------------------------------------------------------------------
Z kladn¡ architektura ‡ipu 80386
---------------------------------------------------------------------------


   Mikroprocesor  80386 poskytuje program torovi 32 registr–. Registry  lze
rozdˆlit do sedmi hlavn¡ch kategori¡:

   - v¨eobecn‚ registry
   - segmentov‚ registry
   - registry adresy instrukce a p©¡znaky
   - ©¡dic¡ registry
   - registry syst‚mov˜ch adres
   - ladic¡ a testovac¡ registry

   Uveden‚  registry  jsou  nadmno‘inou  registr–  obvod–  8086   a  80286;
mikroprocesor 80386 tedy obsahuje v¨echny registry ‡ip– 8086 a 80286.



---------------------------------------------------------------------------
Soubor v¨eobecn˜ch registr–
---------------------------------------------------------------------------


   Osm  v¨eobecn˜ch  registr–   ‡ipu   80386  m   podobn‚  pou‘it¡  jako  8
v¨eobecn˜ch registr–  u  80286  s  t¡m,  ‘e  jsou ¨irok‚ 32 bit–. V¨eobecn‚
registry jsou s to podpo©it operandy dlouh‚ 1,  8,  16  a  32 bit– a bitov 
pole  d‚lky  1  a‘ 32 bit–. Tyto registry jsou ozna‡eny jako EAX (st©ada‡),
EBX (b zov˜ registr), ECX  (‡¡ta‡),  ESP  (ukazatel z sobn¡ku), EDX (datov˜
registr),  EBP  (ukazatel  b ze),  ESI  (zdrojov˜ indexov˜ registr)  a  EDI
(c¡lov˜ indexov˜ registr).

   Abychom  z¡skali  p©¡stup  ke  v¨em  32-bitov˜m  registr–m,  je t©eba  v
referenci na nˆ pou‘¡t prefixu "E". Ka‘d˜ z 8 v¨eobecn˜ch registr– m–‘e b˜t
rozdˆlen do 16-bitov˜ch ekvivalent– ‡ip– 8086/80286 - sta‡¡ vypustit prefix
"E" v odkazu na registr.



---------------------------------------------------------------------------
Segmentov‚ registry
---------------------------------------------------------------------------


   €ip 80386 obsahuje  ¨est  16-bitov˜ch  segmentov˜ch  registr–.  Tˆchto 6
registr–  uchov v   hodnoty   selektor–  ukazuj¡c¡ch  na  pr vˆ  adresovan 
pamˆŸov  m¡sta. V  re ln‚m  adresov‚m  m¢du  m–‘e m¡t segment velikost od 1
byte po maximum 64 kB. V privilegovan‚m m¢du je mo‘n‚ pracovat  se segmenty
o velikosti 1 byte a‘ 4 GB.




                                  - 48 - 




   Soubor 6-ti 16-bitov˜ch registr– obsahuje registry CS (Code Segment), DS
(Data Segment), SS (Stack Segment), ES (Extra Segment) a registry FS  a GS.
Registry GS a FS jsou p©id ny  proto,  aby byla zm¡rnˆna "z cpa" v registru
ES  a  aby byly l‚pe z¡sk ny hodnoty  indexov‚ho  a  b zov‚ho  registru  ze
souboru v¨eobecn˜ch registr–.



---------------------------------------------------------------------------
Registr adresy instrukce a EFLAGS
---------------------------------------------------------------------------


   €ip 80386 obsahuje 32-bitov˜ registr adresy instrukce ozna‡en˜ jako EIP.
Registr EIP uchov v   hodnotu  offsetu  p©¡¨t¡  prov dˆn‚  instrukce. Tento
offset  je  v‘dy  relativn¡  vzhledem  k b zi pr vˆ aktivn¡ho segmentu  CS.
Ni‘¨¡ch 16 bit– registru EIP lze referovat samostatnˆ a  ozna‡uj¡  se  jako
registr IP. Tyto bity jsou u‘¡v ny p©i 16- bitov‚ adresaci.

   Registr EFLAGS m  u ‡ipu 80386 d‚lku 32 bit–. Registr EFLAGS je pou‘it k
©¡zen¡ jist˜ch operac¡ a  indikuje  stav ‡ipu 80386. EFLAGS obsahuje 2 nov‚
p©¡znaky  (ve  srovn n¡  s 80286): VM (Virtual 8086 Mode flag) a p©¡znak RF
(Resume Flag). EFLAGS obsahuje stejn‚ ©¡dic¡ a logick‚ p©¡znakov‚ bity jako
‡ipy 8086/80286.

   P©¡znak VM povoluje  virtu ln¡  m¢d  ‡ipu  8086.  P©i VM = 1 a nastaven¡
80386 do privilegovan‚ho m¢du bude  ‡ip 80386 "p©epnut" do virtu ln¡ho m¢du
8086 a v¨echny operace  se  segmentem  budou  prov dˆny jakoby prob¡haly na
‡ipu 8086. P©i t‚to emulaci ‡ipu 8086 bude obvod  80386  generovat  v˜padky
(faults) p©i privilegovan˜ch opera‡n¡ch k¢dech.

   P©¡znak  RF  je  vyu‘it  spolu  s  ladic¡m  registrem k  nastaven¡  bod–
zastaven¡ nebo k nastaven¡  "krokov n¡"  procesoru. P©i RF = 1 jsou v¨echny
v˜padky u p©¡¨t¡ vykon van‚ instrukce  ignorov ny.  RF  je  pak automaticky
nastavov n na 0 p©i £spˆ¨n‚m dokon‡en¡ ka‘d‚ instrukce.



---------------------------------------------------------------------------
ž¡dic¡ registry
---------------------------------------------------------------------------


   Obvod 80386 obsahuje 4 32-bitov‚ registry : CR0, CR1, CR2  a  CR2 . Tyto
registry  obsahuj¡  informace  o  stavu  procesoru.  P©¡stup  ke kontroln¡m
registr–m je umo‘nˆn instrukcemi typu load a store.

   Registr CR0 obsahuje 6  p©eddefinovan˜ch  p©¡znak–  ur‡en˜ch  pro ©¡zen¡
mikroprocesoru a pro zji¨Ÿov n¡ jeho stavu.  Bity  0 - 15 registru CR0 jsou
ozna‡ov ny tak‚ jako stavov‚ slovo  procesoru  MSW  (Machine  Status Word),
vytv ©ej¡ce tak  kompatibilitu 80386 s 80286 v privilegovan‚m m¢du. P©¡kazy
LMSW a  SMSW  pracuj¡  stejnˆ  u 80386 i 80286. P©i p©¡stupu k registru CR0
mus¡ program tor pou‘¡t p©¡kazu MOV CR0,registr.






                                  - 49 - 




   Bity ET, TS, EM, MP a PE maj¡ stejn˜ v˜znam jako  u  ‡ipu  80286. ž¡dic¡
registr CR1 je vyhra‘en  pro  p©¡¨t¡ aplikace firmy INTEL. CR2 obsahuje 32-
bitovou line rn¡ adresu pamˆti, kter  zp–sobila posledn¡ detekovan˜ v˜padek
str nky. CR3 obsahuje fyzickou adresu b ze tabulky str nek. Proto‘e tabulka
str nek je u 80386 v‘dy sv z na po jednotliv˜ch str nk ch, je nejni‘¨¡ch 12
bit– registru CR3 p©i z pisu ignorov no.



---------------------------------------------------------------------------
Registry syst‚mov˜ch adres
---------------------------------------------------------------------------


   Mikroprocesor 80386  obsahuje 4 speci ln¡ registry, kter‚ jsou pou‘ity k
odkaz–m  na  tabulky  nebo   segmenty   podporovan‚   privilegovan˜m  m¢dem
80286/80386. Tabulka GDT (Global Descriptor Table),  LDT  (Local Descriptor
Table)  a  TST  (Task Segment Table)  maj¡  sv‚  adresy  ulo‘eny  v  tˆchto
speci ln¡ch  registrech. Registry syst‚mov˜ch adres a syst‚mov˜ch  segment–
jsou ozna‡eny GPTR, IDTR, LDTR a TR.

   Registry  GPTR  a  IDTR jsou 32-bitov‚ registry,  kter‚  uchov vaj¡  32-
bitovou hodnotu line rn¡ adresy b ze  a 16- bitov˜ limit tabulky glob ln¡ch
(GTR) a lok ln¡ch (LTR)  deskriptor–.  LDTR  a  TR jsou 16-bitov‚ registry,
kter‚ uchov vaj¡ 16-bitov˜ selektor pro segmenty LDT a TST.



---------------------------------------------------------------------------
Ladic¡ a trasovac¡ registry
---------------------------------------------------------------------------


   Mikroprocesor  80386 umo‘¤uje program torovi p©¡stup k ¨esti  32-bitov˜m
ladic¡m registr–m -  DR0, DR1, DR2, DR3 DR6, DR7 . DR4 a DR5 jsou vyhrazeny
pro firmu INTEL. Registr pro ©¡zen¡  ladˆn¡  DR6 je pou‘it k nastaven¡ bod–
zastaven¡ (breakpoints). DR7 zobrazuje aktu ln¡ stav v bodech zastaven¡.

   €ip 80386 obsahuje tak‚ dva  32-bitov‚  testovac¡  registry,  kter‚ jsou
pou‘ity  k  ©¡zen¡  testov n¡  RAM  a  CAM  (Content Addressable  Memory  -
asociativn¡ pamˆŸ) v bloku p©edv˜bˆru instrukc¡. TR6 je pou‘it jako registr
testu  p©¡kaz–  a  TR7 jako datov˜  registr  uchov vaj¡c¡  data  v  bufferu
p©edv˜bˆru instrukc¡.



---------------------------------------------------------------------------
Zpracov n¡ v˜jime‡n˜ch stav– u 80286/80386
---------------------------------------------------------------------------


   V˜jime‡n˜  stav  (v˜jimka,  exception)  je  vnit©n¡  ud lost¡,   je‘  je
detekov na hardwarem bˆhem  prov dˆn¡ instrukce. V˜jimka zp–sob¡ generov n¡
p©eru¨en¡   a  proveden¡  odpov¡daj¡c¡ho  programu  zpracov vaj¡c¡ho   toto
p©eru¨en¡. Jako synonyma pro v˜jimku (exception) se u‘¡v   pojm–  trap nebo
fault  (srv.  [2]).  Zde  se  soust©ed¡me  jen  na problematiku  v˜jimek  u



                                  - 50 - 




procesoru  80286,  i  kdy‘  v˜jimky  generovan‚  procesorem  80386  jsou  v
n sleduj¡c¡ kapitole u v¨ech instrukc¡ rovnˆ‘ uvedeny.

   V privilegovan‚m m¢du procesoru  80286  jsou  v¨echny reference na pamˆŸ
provˆ©ov ny vzhledem  k opr vnˆnosti adresace pamˆŸov‚ho m¡sta a ke zp–sobu
p©¡stupu k tomuto m¡stu.  Poru¨en¡  pravidel  ochrany pamˆti vestavˆn˜ch do
procesoru 80286 zp–sob¡  p©ed n¡  ©¡zen¡  programu  pro  obsluhu p©eru¨en¡.
P©eru¨en¡ generovan  v˜jimkami maj¡ stanoven‚  pozice  v  tabulce p©eru¨en¡
(IDT, Interrupt Descriptor Table) a shrnuje je n sleduj¡c¡ tabulka.

               Tab. 6.1: V˜jimky v privilegovan‚m m¢du 80286

       -------------------------------------------------------------
       Zkratka €¡slo p©eru¨en¡ (v IDT) Popis
       -------------------------------------------------------------
       #UD               6        Nedefinovan˜ opera‡n¡ k¢d
       #NM               7        Nen¡ k dispozici matematick 
                                  jednotka
       #DF               8        Dvojit  v˜jimka/v˜padek
       #MP               9        Chyba ochrany matematick‚
                                  jednotky
       #TS               10       Neplatn˜ segment stavu £lohy
       #NP               11       Nep©¡tomen/nen¡ k dispozici
       #SS               12       Chyba z sobn¡ku
       #GP               13       V¨eobecn  v˜jimka poru¨en¡
                                  ochrany pamˆti = v¨eobecn 
                                  v˜jimka privilegovan‚ho m¢du
       #MF               16       Matematick  chyba
       -------------------------------------------------------------


   V  re ln‚m  m¢du  procesoru  80286  je  v  pr–bˆhu zpracov n¡  instrukc¡
prov dˆno mnohem m‚nˆ kontrol a  je tedy generov no podstatnˆ m‚nˆ v˜jimek.
Jedna  z  ‡asto  se  vyskytuj¡c¡ch  v˜jimek je v¨eobecn   v˜jimka  poru¨en¡
ochrany  pamˆti;  d le  se ‡asto vyskytuje v˜jimka/p©eru¨en¡ INT 13, je‘ je
generov na  v‘dy,  kdy‘  je referov n slovn¡ operand  na  adrese  (offsetu)
OFFFFH v nˆkter‚m segmentu (druh˜ byte by toti‘ mˆl vzhledem k referovan‚mu
registru offset 10000H,  co‘  p©esahuje  adresovac¡  kapacitu  segmentu (64
Kbyte).

   V popisu ka‘d‚ instrukce v  n sleduj¡c¡  kapitole  jsou  uvedeny v¨echny
v˜jimky,  kter‚  mohou  b˜t  v  pr–bˆhu jej¡ho vykon v n¡ generov ny jak  v
re ln‚m, tak i v privilegovan‚m m¢du.
















                                  - 51 - 































































                                  - 52 - 










                            K a p i t o l a   7

               Instruk‡n¡ soubor mikroprocesor– 80286/80386


   Pro stru‡nost budeme re ln˜ m¢d ozna‡ovat RM a privilegovan˜ m¢d PM

AAA (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     AAA - nastav ASCII po s‡¡t n¡ v AL

€asov n¡:                      3 (80286), 4(80386)

Popis:                         Instrukce AAA by nˆla  b˜t  vykon na  jen po
                               instrukci  ADD, kter  ponech v  v AL  bytov˜
                               v˜sledek.   AAA   konvertuje   obsah  AL  na
                               nesbalenou  dekadickou  ‡¡slici.  AAA zkoum 
                               ni‘¨¡  4  bity  registru  AL a hled  validn¡
                               ‡¡slo v k¢du BCD v  rozsahu  0  a‘  9. €ty©i
                               vy¨¨¡   bity  AL  p©itom  nastavuje  do   0.
                               Jestli‘e   do¨lo   k   dekadick‚mu  p©enosu,
                               p©¡znaky  AF  a  AC  jsou  nastaveny  na  0.
                               Jestli‘e hodnota obsa‘en   v  ni‘¨¡m p–lbytu
                               je vˆt¨¡ nˆ‘ 9 nebo je AF nastaven do 1, pak
                               AAA prov d¡ n sleduj¡c¡ akce: AL  je zvˆt¨en
                               o 6, AH je  zvˆt¨en  o  1,  p©¡znaky AF a AC
                               jsou nastaveny do 1  a  vy¨¨¡  bity  AL jsou
                               vynulov ny.

Syntaxe:                       AAA (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            AF, CF

Nedefinovan‚ p©¡znaky:         OF, ZF, SF, PF

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       ADD AL,BL    ; Se‡ti ‡¡sla BCD v AL a BL
                               AAA               ;   z¡skej    v˜sledek   v
                               nesbalen‚m tvaru

AAD (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     AAD - nastav ASCII AX p©ed dˆlen¡m



                                  - 53 - 




€asov n¡:                      3 (80286), 4 (80386)

Popis:                         Instrukce  AAD  zpracov v   ‡¡slo  vyj d©en‚
                               jako  2  nesbalen‚  dekadick‚ ‡¡slice v k¢du
                               BCD (ni‘¨¡ ‡¡slice je v AL, vy¨¨¡ je v AH) a
                               p©ipravuje je k operaci dˆlen¡,  kter‚ vrac¡
                               v˜sledek v nesbalen‚m tvaru. AL  je nastaven
                               na  AL  +  (AH  x  10)  a  AH je  vynulov n.
                               V˜sledek  je  v  AX  a  je  roven  bin rn¡mu
                               ekvivalentu       p–vodn¡ho      nesbalen‚ho
                               dvoum¡stn‚ho ‡¡sla.

Syntaxe:                       AAD (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            SF, ZF, PF

Nedefinovan‚ p©¡znaky:         OF, AF, CF

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       AAD ; pou‘ito p©ed dˆlen¡m

AAM (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     nastav ASCII AX po n soben¡

€asov n¡:                      16 (80286), 17 (80386)

Popis:                         AAM  nastav¡  v˜sledek  v  registru   AX  po
                               n soben¡ dvou nesbalen˜ch dekadick˜ch ‡¡sel.
                               Tato  instrukce by  mˆla  b˜t  provedena  po
                               instrukci MUL. Proto‘e v˜sledek je men¨¡ ne‘
                               100, je cel˜ obsa‘en  v  registru  AL  . AAM
                               rozv¡j¡  sbalen˜ tvar v˜sledku v AL tak,  ‘e
                               dˆl¡  AL deseti a ponech v  kvocient  (vy¨¨¡
                               ‡¡slici) v AL a zbytek (ni‘¨¡ ‡¡slici) v AH.

Syntaxe:                       AAM (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            SF, ZF, PF


Nedefinovan‚ p©¡znaky:         OF, AF, CF

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       AAM ; pou‘ito po n soben¡



                                  - 54 - 




AAS (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     nastav ASCII AL po ode‡¡t n¡

€asov n¡:                      3 (80286), 4 (80386)

Popis:                         —‡elem instrukce AAS je korigovat v˜sledek v
                               registru  AL  po  ode‡¡t n¡ dvou nesbalen˜ch
                               dekadick˜ch  operand–.  V˜sledek  je  rovnˆ‘
                               ulo‘en v nesbalen‚m  dekadick‚m  tvaru. Toho
                               je  dosa‘eno  aplikac¡  n sleduj¡c¡ch krok–:
                               je-li ni‘¨¡ p–lbyte v AL  vy¨¨¡  ne‘  9 nebo
                               AF=1, pak se AL zv˜¨¡ o 6 a AH o 1. P©¡znaky
                               CF a AF  jsou  nastaveny  na  1.  Jinak jsou
                               nulov ny  CF a AF. P–vodn¡ hodnota  registru
                               AL  je tedy  nahrazena  bytem,  jeho‘  vy¨¨¡
                               polovina  je  nulov   a  ni‘¨¡  polovina  je
                               ‡¡slem v rozsahu 0 - 9.

Syntaxe:                       AAS (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            AF, CF

Nedefinovan‚ p©¡znaky:         OF, SF, ZF a PF

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       AAS ; pou‘ito po ode‡¡t n¡

ADC (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     se‡¡t n¡ s p©enosem

€asov n¡:                      2 - 7 (80286), 2 - 7 (80386)

Popis:                         Se‡¡t  dva  operandy  s  p©enosem  - prov d¡
                               celo‡¡seln‚ se‡¡t n¡. Je-li nastaven p©¡znak
                               CF, je k sou‡tu dvou operand–  p©i‡tena  1 a
                               v˜sledek je vr cen na m¡sto ur‡en¡.

Syntaxe:                       ADC destination,source

Ovliv¤uje p©¡znaky:            OF, SF, ZF, AF, PF, CF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v RM:                  pro  slovn¡ operand  s  offsetem  0FFFFH  je
                               generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–



                                  - 55 - 




P©¡klad:                       Se‡tˆme bezprost©edn¡ operand s p©enosem  do
                               st©ada‡e:
                                  ADC  AL,4
                                  ADC  AX, 298
                                  ADC  EBX, 22334455H ; (jen pro 80386)

                               Se‡tˆme bezprost©edn¡ operand s p©enosem  do
                               registru nebo na pamˆŸov‚ m¡sto:
                                  ADC  CX,341
                                  ADC  BL,10
                                  ADC  TABLE[SI],2
                                  ADC  MEMORY,6293
                                  ADC  NUMBER,12345678 (jen pro 80386)

                               Se‡tˆme  data  s  p©enosem  z   registru  do
                               registru,  registru  do  pamˆti,  pamˆti  do
                               registru
                                  ADC  DL,BL
                                  ADC  MEM_WRD,AX
                                  ADC  SI,MEM_WRD

ADD (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     se‡¡t n¡

€asov n¡:                      2-7 (80286), 2-7 (80386)

Popis:                         ADD prov d¡ se‡¡t n¡ dvou operand–. V˜sledek
                               je ulo‘en v c¡lov‚m operandu.


Syntaxe:                       ADD destination, source

Ovliv¤uje p©¡znaky:            AF, CF, OF, PF, SF, ZF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Je-li  v˜sledek   v   segmentu  nep©¡stupn‚m
                               z pisu,  je  generov na   v¨eobecn   v˜jimka
                               poru¨en¡  ochrany  pamˆti.  Pro  nedovolenou
                               efektivn¡ adresu operandu  nach zej¡c¡  se v
                               registrech  CS, DS  nebo  ES  je  generov na
                               rovnˆ‘   v¨eobecn    v˜jimka.   Jestli‘e  SS
                               obsahuje nedovolenou  adresu,  je generov na
                               v˜jime‡n  situace "chyba z sobn¡ku".

V˜jimky v RM:                  pro  slovn¡ operand  s  offsetem  0FFFFH  je
                               generov no p©eru¨en¡ INT 13.


Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–


P©¡klad:                       Z registru do registru:
                                  ADD  AX,BX



                                  - 56 - 




                                  ADD  EBX,ECX        (jen pro 80386)

                               Z registru do pamˆti
                                  ADD  EXTMEM,AX

                               Z pamˆti do registru
                                  ADD  DX,BUFF

                               Bezprost©edn¡ operand do st©ada‡e
                                  ADD  AL,4
                                  ADD  EAX,98765432H (jen pro 80386)

                               Bezprost©edn¡ operand do registru
                                  ADD  CX,1985

                               Bezprost©edn¡ operand do pamˆti
                                  ADD  EXTMEM,23

AND (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     logick˜ sou‡in dvou operand–

€asov n¡:                      2-7 (80286), 2-7 (80386)

Popis:                         V˜sledek  obsahuje  jedni‡kovan‚  ty  bitov‚
                               pozice, kter‚ mˆly hodnotu 1 u c¡lov‚ho  i u
                               zdrojov‚ho  operandu;   jinak   jsou  pozice
                               nulov ny. P©¡znaky OF a CF jsou nastaveny do
                               0.

Syntaxe:                       AND destination, source

Ovliv¤uje p©¡znaky:            OF = 0, CF = 0, PF, SF, ZF

Nedefinovan‚ p©¡znaky:         AF

V˜jimky v PM:                  Je-li  v˜sledek   v   segmentu  nep©¡stupn‚m
                               z pisu,  je  generov na   v¨eobecn   v˜jimka
                               poru¨en¡  ochrany  pamˆti.  Pro  nedovolenou
                               efektivn¡ adresu operandu  nach zej¡c¡  se v
                               registrech  CS, DS  nebo  ES  je  generov na
                               rovnˆ‘   v¨eobecn    v˜jimka.   Jestli‘e  SS
                               obsahuje nedovolenou  adresu,  je generov na
                               v˜jime‡n  situace "chyba z sobn¡ku".

V˜jimky v RM:                  pro  slovn¡ operand  s  offsetem  0FFFFH  je
                               generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–

P©¡klad:                       Bezprost©edn¡ operand do registru
                                  AND  BL,11001110B
                                  AND  EAX,11101011001100110001110000111001B
                                       (jen pro 80386)




                                  - 57 - 




                               Bezprost©edn¡ operand do pamˆti
                                  AND  EXTMEM,10011100B
                                  AND  NUMBER,0F0F0F0F0H (jen pro 80386)

                               Bezprost©edn¡ operand do st©ada‡e
                                  AND  AX,1011100101011100B
                                  AND  AL,MASK_BYTE

                               Z registru do pamˆti
                                  AND  EXTMEM,SI

                               Z registru do registru
                                  AND  AX,BX
                                  AND  EAX,ECX   (jen pro 80386)

                               Z pamˆti do registru
                                  AND  DH,EXTBYTE

ARPL (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Nastav pole RPL selektoru

€asov n¡:                      10-11 (80286), 20-21 (80386)

Popis:                         Instrukce  ARPL  je  navr‘ena  k  tomu,  aby
                               zabr nila   syst‚mov˜m    program–m   z¡skat
                               p©¡stup  k  podprogram–m   s   vy¨¨¡  £rovn¡
                               priority.  Prvn¡  operand  instrukce ARPL je
                               16-bitov   pamˆŸov   promˆnn   nebo  registr
                               d‚lky  slova,   kter (˜)   obsahuje  hodnotu
                               selektoru. Druh˜ operand je registr  o d‚lce
                               slova. Je-li pole  RPL  (Requested Privilege
                               Level)  1.  operandu  men¨¡  ne‘   pole  RPL
                               druh‚ho  operandu,  je  p©¡znak  nuly   (ZF)
                               nastaven do 1.  Pole RPL prvn¡ho operandu je
                               zv˜¨eno tak, aby se  shodovalo  s  polem RPL
                               druh‚ho operandu. Jinak  je ZF nastaven do 0
                               a prvn¡ operand instrukce ARPL nen¡ nikterak
                               modifikov n.

Syntaxe:                       ARPL (selektor, CS_selektor)

Ovliv¤uje p©¡znaky:            ZF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Je-li  v˜sledek   v   segmentu  nep©¡stupn‚m
                               z pisu,  je  generov na   v¨eobecn   v˜jimka
                               poru¨en¡  ochrany  pamˆti.  Pro  nedovolenou
                               efektivn¡ adresu operandu  nach zej¡c¡  se v
                               registrech  CS, DS  nebo  ES  je  generov na
                               rovnˆ‘   v¨eobecn    v˜jimka.   Jestli‘e  SS
                               obsahuje nedovolenou  adresu,  je generov na
                               v˜jime‡n  situace "chyba z sobn¡ku".




                                  - 58 - 




V˜jimky v RM:                  Je  generov no  p©eru¨en¡ INT  6.  Instrukce
                               ARPL nen¡ v RM rozpozn na.

Pozn mka pro 80386:            -

P©¡klad:                       ARPL MEM_WRD,BX

BOUND (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Konroluj index pole vzhledem k jeho hranic¡m

€asov n¡:                      13 (80286), 10 (80386)

Popis:                         Operace BOUND je pou‘¡v na k zaji¨tˆn¡ toho,
                               ‘e  index  pole  je  v  mez¡ch  definovan˜ch
                               dvouslovn¡m blokem v  pamˆti.  Prvn¡ operand
                               (registr) mus¡ b˜t vˆt¨¡ nebo  roven prvn¡mu
                               slovu v  pamˆti,  a  men¨¡  ne‘  nebo  roven
                               druh‚mu  slovu  v  pamˆti.  Nejsou-li   tyto
                               podm¡nky splnˆny, generuje se INT 5.

Syntaxe:                       BOUND destination, source

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v RM:                  Jestli‘e test na hranice pole neuspˆje (t.j.
                               index prvku pole le‘¡  mimo  meze  pole), je
                               generov no  p©eru¨en¡  INT  5.  Je-li   dan˜
                               operand  na offsetu  0FFFDH  ‡i  vy¨¨¡m,  je
                               generov no  p©eru¨en¡  INT 13.  Je-li  druh˜
                               operand registr, je generov no p©eru¨en¡ INT
                               6.

V˜jimky v PM:                  Jestli‘e  test na hranice pole neuspˆje,  je
                               generov no  p©eru¨en¡  INT  5. Pro neplatnou
                               efektivn¡ adresu operandu  v  registrech CS,
                               DS  a ES  je  generov na  v¨eobecn   v˜jimka
                               privilegovan‚ho m¢du. P©i neplatn‚ adrese  v
                               SS je generov na v˜jimka "chyba z sobn¡ku".

Pozn mka pro 80386:            ›¡©ka slova je 32 bit–.

P©¡klad:                       BOUND AX,MEM_WRD
                               BOUND EBX,NEW_WORD ; (jen pro 80386)

CALL (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Vol n¡ procedury

€asov n¡:                      7-185 (80286), 3-275 (80386)





                                  - 59 - 




Popis:                         Instrukce CALL zp–sobuje,  ‘e  adresa p©¡¨t¡
                               vykon van‚ instrukce je uchov na v z sobn¡ku
                               a  ©¡zen¡  programu   je   p©ed no  operandu
                               instrukce CALL. Po ukon‡en¡ volan‚ procedury
                               vykon v     volaj¡c¡    program    instrukce
                               n sleduj¡c¡ bezprost©ednˆ za instrukc¡ CALL.

Syntaxe:                       CALL operand
Ovliv¤uje p©¡znaky:            ‘ dn‚  (v˜jimkou  je  p©¡padn‚ p©epnut¡ £loh
                               (task switching))

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  a)   vol n¡   "FAR   CALLS":  je  generov na
                               v¨eobecn    v˜jimka  privilegovan‚ho   m¢du,
                               v˜jimka  "deskriptor   neexistuje",  v˜jimka
                               "chyba   z sobn¡ku"   a   v˜jimka  "neplatn˜
                               segment stavu £lohy".

                               b) vol n¡ "NEAR direct CALLS": je generov na
                               v¨eobecn   v˜jimka  privilegovan‚ho  m¢du  v
                               p©¡padˆ,  ‘e  procedura  je lokalizov na vnˆ
                               segmentu CS

                               c)   vol n¡   "NEAR  indirect   CALLS":   je
                               generov na v¨eobecn  v˜jimka privilegovan‚ho
                               m¢du p©i neplatn‚ efektivn¡ adrese  operandu
                               v  segmentov˜ch registrech CS, DS nebo ES  a
                               nebo v˜jimka "chyba z sobn¡ku" p©i  neplatn‚
                               adrese  v  segmentu  SS.  V¨eobecn   v˜jimka
                               privilegovan‚ho  m¢du  je  generov na tak‚ v
                               p©¡padˆ, ‘e je z¡sk n nep©¡m˜  offset le‘¡c¡
                               mimo hranice segmentu CS.

V˜jimky v RM:                  Je generov no p©eru¨en¡ INT 13 v p©¡padˆ, ‘e
                               slovn¡ operand m  offset 0FFFFH.

Pozn mka pro 80386:            Slovn¡ operand  m   ¨¡©ku  32  bit–, operand
                               typu ukazatel m  ¨¡©ku 48 bit–.

P©¡klad:                          CALL ADDER ; procedura je uvnit© nebo vnˆ
                               segmentu

                               pro 80386:
                                  CALL IMMPTR  ;  Operand  typu ukazatel je
                               48-bitov˜

                                  CALL DISP16 ;  U‘¡v   32-bitov˜ roz¨¡©en˜
                               ukazatel instrukce

                                  CALL registr nebo pamˆŸ
                                       ; posunut¡ je 32-bitov‚.
                                       ; Slovn¡ operandy jsou 32-bitov‚






                                  - 60 - 




CBW (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Konvertuj byte na slovo

€asov n¡:                      2 (80286), 3 (80386)

Popis:                         Operace  CBW  konvertuje byte  se  znam‚nkem
                               ulo‘en˜ v registru  AL na slovo se znam‚nkem
                               v  registru  AX.  Konverze  je   zabezpe‡ena
                               roz¨¡©en¡m  nejv˜znamnˆj¨¡ho  bitu v  AL  na
                               v¨echny   (zb˜vaj¡c¡)   bity   AH.  Viz  t‚‘
                               pozn mku pro 80386.

Syntaxe:                       CBW (nem  operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            Velikost   slova  je  32  bit–.  Hodnota   s
                               roz¨¡©en˜m  znam‚nkem  je  v AX, v˜sledek je
                               ulo‘en do EAX.

P©¡klad:                       CBW

CLC (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Nuluj p©¡znak p©enosu (CF)

€asov n¡:                      2

Popis:                         Operace CLC nastavuje p©¡znak p©enosu  do 0.
                               ’ dn‚  jin‚  registry  ani  p©¡znaky  nejsou
                               ovlivnˆny.

Syntaxe:                       CLC (nem  operandy)

Ovliv¤uje p©¡znaky:            CF = 0

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       CLC





                                  - 61 - 




CLD (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Nuluj p©¡znak smˆru (DF)

€asov n¡:                      2

Popis:                         Nuluje p©¡znak DF, inkrementuje registry  SI
                               a  DI.  ’ dn‚  jin‚  registry  ani  p©¡znaky
                               nejsou    ovlivnˆny.    žetˆzcov     operace
                               inkrementuje registry SI a DI automaticky po
                               proveden¡ instrukce CLD.

Syntaxe:                       CLD (nem  operandy)

Ovliv¤uje p©¡znaky:            DF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       CLD

CLI (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Nuluj p©¡znak p©eru¨en¡ (IF)

€asov n¡:                      3

Popis:                         Operace  CLI  nuluje p©¡znak  p©eru¨en¡  IF.
                               ’ dn‚   jin‚   p©¡znaky   nejsou  ovlivnˆny.
                               Efektem proveden¡ operace CLI je  inaktivace
                               v˜skytu   v¨ech    p©eru¨en¡    s   v˜jimkou
                               nemaskovateln˜ch p©eru¨en¡, kter‚ se projev¡
                               sign lem NMI.

Syntaxe:                       CLI (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            IF = 0

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Je-li  aktu ln¡  privilegovan   £rove¤ vy¨¨¡
                               ne‘ IOPL v registru p©¡znak–,  je generov na
                               v¨eobecn  v˜jimka privilegovan‚ho m¢du. IOPL
                               indikuje nejni‘¨¡ privilegovanou  £rove¤, na
                               kter‚ lze prov‚st vstup/v˜stup.

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -



                                  - 62 - 




P©¡klad:                       CLI

CLTS (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Nuluj  p©¡znak  TS ("P©epnuta  uloha",  task
                               switched)

€asov n¡:                      2 (80286), 5 (80386)

Popis:                         Instrukce CLTS nuluje p©¡znak TS ve stavov‚m
                               slovˆ MSW. CLTS je privilegovan   instrukce,
                               kter  m–‘e b˜t prov dˆna jen na  £rovni  0 a
                               je  reservovan   pro syst‚mov‚  software  na
                               £rovni  opera‡n¡ho  syst‚mu.   CLTS  sleduje
                               ka‘d‚ vykon n¡ WAITu nebo  ESC  a  v p©¡padˆ
                               nastaven¡ p©¡znaku  MP  v  MSW  a sou‡asn‚ho
                               nastaven¡ p©¡znaku TS vyvol  instrukce  CLTS
                               v˜jimku.

Syntaxe:                       CLTS

Ovliv¤uje p©¡znaky:            TS = 0

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Je-li aktu ln¡  £rove¤  privilegovan‚ho m¢du
                               jin  ne‘ 0, je generov na  v¨eobecn  v˜jimka
                               privilegovan‚ho m¢du p©i pokusu o  proveden¡
                               CLTS.

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       CLTS

CMC (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Vytvo© doplnˆk p©¡znaku p©enosu (CF)

€asov n¡:                      2

Popis:                         Instrukce  CMC  invertuje   bitovou  hodnotu
                               p©¡znaku  p©enosu  CF.  Je-li  CF  =  1,  je
                               nastaven do  0; je-li CF = 0, je nastaven do
                               1.

Syntaxe:                       CMC

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  ‘ dn‚



                                  - 63 - 




V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       CMC

CMP (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Porovnej dva operandy

€asov n¡:                      2-7 (80286), 2-6 (80386)

Popis:                         Instrukce  CMP  ode‡te zdrojov˜  operand  od
                               c¡lov‚ho a podle vznikl‚ho v˜sledku  nastav¡
                               pat©i‡n‚  p©¡znaky.  CMP   nemˆn¡  operandy.
                               Zdrojov˜  a  c¡lov˜  operand  mus¡  b˜t  oba
                               stejn‚ho  typu, s  v˜jimkou  pou‘it¡  CMP  v
                               bezprost©edn¡m   re‘imu   -   zde  m–‘e  b˜t
                               bezprost©edn¡  operand  o velikosti  byte  s
                               roz¨¡©en˜m znam‚nkov˜m bitem  na  cel‚ slovo
                               porovn n se slovem v pamˆti.

Syntaxe:                       CMP destination,source

Ovliv¤uje p©¡znaky:            OF, SF, ZF, AF, PF, CF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e registr  CS,  DS  nebo  ES obsahuj¡
                               nepovolenou  efektivn¡  adresu  operandu, je
                               generov na v¨eobecn  v˜jimka privilegovan‚ho
                               m¢du. Jestli‘e SS obsahuje neplatnou adresu,
                               je generov na v˜jimka "chyba z sobn¡ku".

V˜jimky v RM:                  Je-li  slovn¡  operand  um¡stˆn  na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–

P©¡klad:                       Bezprost©edn¡ operand srovn n s pamˆt¡:
                               CMP EXTMEM,5CAFH
                               Bezprost©edn¡ operand srovn n s registrem:
                               CMP BL,5
                               CMP EAX, 0FFFF0000H (pro 80386)
                               Bezprost©edn¡ operand srovn n se st©ada‡em:
                               CMP AL,7
                               Registr srovn n s registrem:
                               CMP AX,BX
                               CMP EDX,EAX (jen pro 80386)
                               Registr srovn n s pamˆt¡:
                               CMP EXTMEM,DX
                               PamˆŸ srovn na s registrem:
                               CMP CH,EXTMEM
                               CMP EBX,VALUE (jen pro 80386)




                                  - 64 - 




CMPS/CMPSB/CMPSW (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Porovnej ©etˆzcov‚ operandy

€asov n¡:                      8 (80286), 10 (80386)

Popis:                         Instrukce    CMPS/SB/SW    srovn v     obsah
                               pamˆŸov‚ho   m¡sta  adresovan‚ho   registrem
                               SI(ESI)   s    obsahem    pamˆŸov‚ho   m¡sta
                               adresovan‚ho  registrem  DI(EDI).  Instrukce
                               CMPS   ode‡te    obsah    pamˆŸov‚ho   m¡sta
                               adresovan‚ho registrem DI(EDI) od pamˆŸov‚ho
                               m¡sta   adresovan‚ho    registrem   SI(ESI).
                               V˜sledkem je nastaven¡ p©¡znak–, av¨ak obsah
                               pamˆŸov˜ch m¡st nen¡ mˆnˆn. Registry SI(ESI)
                               a   DI(EDI)    jsou    inkrementov ny   nebo
                               dekrementov ny  podle  hodnoty  p©¡znaku DF.
                               Je-li p©¡znak DF nulov n (0), jsou SI(ESI) a
                               DI(EDI)  inkremetov ny,  p©i  hodnotˆ DF = 1
                               jsou  tyto   registry   dekrementov ny.  Lze
                               specifikovat bytov‚ nebo slovn¡ porovn v n¡.
                               Inkrementace indexov˜ch  registr–  SI(ESI) a
                               DI(EDI) je o 1 pro bytov‚ operandy a o 2 pro
                               operandy slovn¡.


Pozn mka:                      Prav˜  operand  instrukce  CMPS  je  operand
                               indexovan˜  registrem DI a tento operand  je
                               adresov n  registrem  ES.   Tato  implicitn¡
                               specifikace nem–‘e b˜t zmˆnˆna.


Syntaxe:                       CMPS source_string,destination_string
                               CMPSB (‘ dn‚ operandy)
                               CMPSW (‘ dn‚ operandy)


Ovliv¤uje p©¡znaky:            AF, CF, PF, OF, SF, ZF


Nedefinovan‚ p©¡znaky:         ‘ dn‚


V˜jimky v PM:                  Jestli‘e registr  CS,  DS  nebo  ES obsahuj¡
                               nepovolenou  efektivn¡  adresu  operandu, je
                               generov na v¨eobecn  v˜jimka privilegovan‚ho
                               m¢du. Jestli‘e SS obsahuje neplatnou adresu,
                               je generov na v˜jimka "chyba z sobn¡ku".


V˜jimky v RM:                  Je-li  slovn¡  operand  um¡stˆn  na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ›¡©ka   operand–   je  32   bit–.   Pou‘ijte
                               instrukci CDQ.



                                  - 65 - 




P©¡klad:                       MOV SI,OFFSET STRING1
                               MOV DI,OFFSET STRING2
                               CMPS STRING1,STRING2
                               CMPS DS:BYTE PTR[SI],ES:[DI]
                               LEA ESI,STRING1 (jen pro 80386)
                               LEA EDI,STRING2
                               CMPS STRING1,STRING2

CWD (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Konvertuj slovo do dvouslova

€asov n¡:                      2

Popis:                         Instrukce CWD konvertuje slovo se  znam‚nkem
                               um¡stˆn‚  v  registru  AX  do  dvouslova  se
                               znam‚nkem  v  registrech DX:AX.  Operace  je
                               provedena  tak,  ‘e  bit  MSB registru AX je
                               roz¨¡©en   do   v¨ech   (zb˜vaj¡c¡ch)  pozic
                               registru DX. Viz pozn mku pro 80386.

Syntaxe:                       CWD (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            ›¡©ka   slova  je  32  bit–.  Hodnota   p©ed
                               konverz¡ (s roz¨¡©en˜m znam‚nkov˜m bitem) je
                               ulo‘ena v EAX, v˜sledek konverze  je ukl d n
                               do registrov‚ho p ru EDX:EAX.

P©¡klad:                       CWD

DAA (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Dekadick‚ nastaven¡ po se‡¡t n¡

€asov n¡:                      3 (80286), 4 (80386)

Popis:                         Instrukce  DAA by mˆla b˜t pou‘¡v na jen  po
                               se‡ten¡  dvou  sbalen˜ch BCD  operand–.  DAA
                               konvertuje  v˜sledek  v   AL   do  sbalen‚ho
                               dekadick‚ho   tvaru    podle   n sleduj¡c¡ch
                               pravidel:

                               a) Je-li ni‘¨¡ ‡tve©ice byt– v AL  vˆt¨¡ ne‘
                               9 nebo je nastaven CF, je AL inkrementov n o
                               6 a nastaven AF; jinak je AF nulov n.




                                  - 66 - 




                               b)  Je-li   (n sledkem   p©edchoz¡  operace)
                               v˜sledek vˆt¨¡ ne‘ 9FH nebo je CF = 1, je AL
                               inkrementov n  o  60H a CF  je  nastaven  do
                               jedn‚; jinak je CF nulov n.

Syntaxe:                       DAA (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            AF, CF, SF, ZF, PF

Nedefinovan‚ p©¡znaky:         OF

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       MOV     AL,08
                               ADD     AL,03     ; V˜sledek v AL je OBH
                               DAA               ; V˜sledek v AL je 11H

DAS (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Dekadick‚ nastaven¡ po ode‡¡t n¡

€asov n¡:                      3 (80286), 4 (80386)

Popis:                         Instrukce DAS  by  mˆla  b˜t  u‘ita  jen  po
                               ode‡¡t n¡   dvou   sbalen˜ch    BCD   ‡¡sel.
                               Instrukce DAS vrac¡ nastaven˜ v˜sledek  v AL
                               a postupuje podle n sleduj¡c¡ch pravidel:

                               a) Je-li ni‘¨¡ ‡tve©ice byt– v AL  vˆt¨¡ ne‘
                               9 nebo je nastaven AF, je AL dekrementov n o
                               6 a nastaven AF; jinak je AF nulov n.

                               b)  Je-li   (n sledkem   p©edchoz¡  operace)
                               v˜sledek vˆt¨¡ ne‘ 9FH nebo je CF = 1, je AL
                               dekrementov n  o  60H a CF  je  nastaven  do
                               jedn‚; jinak je CF nulov n.

Syntaxe:                       DAS (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            AF, CF, SF, PF, ZF

Nedefinovan‚ p©¡znaky:         OF

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                          MOV  AL,12
                                  SUB  AL,03     ; V˜sledek v AL je 0FH



                                  - 67 - 




                                  DAS            ; V˜sledek v AL je 09H

DEC (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Dekrementace o 1

€asov n¡:                      2-7 (80286), 2-6 (80386)

Popis:                         Instrukce  DEC  ode‡te  jedni‡ku  od  obsahu
                               (slovn¡ho  nebo   bytov‚ho)  specifikovan‚ho
                               pamˆŸov‚ho  m¡sta  nebo  registru. Instrukce
                               DEC nemˆn¡ p©¡znak CF.

Syntaxe:                       DEC destination

Ovliv¤uje p©¡znaky:            OF, SF, AF, ZF, PF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Je-li  v˜sledek   v   segmentu  nep©¡stupn‚m
                               z pisu,  je   generov na   v¨obecn   v˜jimka
                               poru¨en¡  ochrany  pamˆti.  Pro  nedovolenou
                               efektivn¡ adresu operandu  nach zej¡c¡  se v
                               registrech  CS, DS  nebo  ES  je  generov na
                               v¨eobecn    v˜jimka  privilegovan‚ho   m¢du.
                               Jestli‘e SS obsahuje nedovolenou adresu,  je
                               generov na v˜jimka "chyba z sobn¡ku".

V˜jimky v RM:                  Je-li  slovn¡ operand na offsetu OFFFFH,  je
                               generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ›¡©ka slova je 32 bit–.

P©¡klad:                          DEC  AX
                                  DEC  EXTMEM
                                  DEC  TABLE[BX][SI]
                                  DEC  ECX (jen pro 80386)

DIV (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Dˆlen¡  bez  uva‘ov n¡   znam‚nka  (unsigned
                               division)

€asov n¡:                      14-25 (80286), 14-41 (80386)

Popis:                         Instrukce DIV prov d¡ dˆlen¡ operand–. Je-li
                               specifikov n  zdrojov˜  operand  o velikosti
                               byte,  je registr  AX  dˆlen  t¡mto  bytov˜m
                               operandem   a  v˜sledek  je  uchov n  v   AL
                               (kvocient)   a   v   AH   (zbytek).    Je-li
                               specifikov n  zdrojov˜  operand  o velikosti
                               slova,     je     dˆlen     DX:AX    slovem.
                               Nejv˜znamnˆj¨¡ch 16 bit–  zdrojov‚ho dˆlence




                                  - 68 - 




                               je ulo‘eno v DX,  kvocient  v  AX a zbytek v
                               DX.

Syntaxe:                       DIV source

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         SF, AF, OF, PF, CF

V˜jimky v PM:                  Je-li  dˆlitel  roven  nule nebo je v˜sledek
                               dˆlen¡  - kvocient - p©¡li¨ velk˜ a  nevejde
                               se   do  m¡sta  ur‡en¡  (AL  nebo  AX),   je
                               generov no   p©eru¨en¡   INT   0.   Jestli‘e
                               obsahuj¡ DS,  CS  ‡i  ES  neplatn‚ efektivn¡
                               adresy  operand–,  je  generov na  v¨eobecn 
                               v˜jimka  privilegovan‚ho  m¢du.  Jestli‘e SS
                               obsahuje  neplatnou  adresu,  je  generov na
                               v˜jimka "chyba z sobn¡ku".

V˜jimky v RM:                  Je-li  dˆlitel 0  nebo  je  kvocient  p©¡li¨
                               velk˜ a nevejde se do m¡sta ur‡en¡  (AL nebo
                               AX), je generov no p©eru¨en¡ INT 0. Jestli‘e
                               je  slovn¡ operand  na  offsetu  OFFFFH,  je
                               generov no  p©eru¨en¡  INT  13.  Dˆlen¡   ve
                               dvojit‚  p©esnosti  je mo‘n‚  se  64-bitov˜m
                               dˆlencem  v EDX:EAX, 32-bitov˜ dˆlitel je  v
                               pamˆti nebo v registru, 32-bitov˜ kvocient v
                               EAX a 32-bitov˜ zbytek je v EDX.

Pozn mka pro 80386:            -

P©¡klad:                       Dˆlen¡ bytu jin˜m bytem:
                                  MOV  AL,NUMER_BTE
                                  DIV  DIVSR_BTE ;Kvocient v AL,zbytek v AH

                               Dˆlen¡ slova bytem:
                                  MOV  AX,NUMER_WRD
                                  DIV  DIVSR_BTE ;Kvocient v AL,zbytek v AH

                               Dˆlen¡ dvouslova slovem:
                                  MOV  DX,NUMER_MSW
                                  MOV  AX,NUMER_LSW
                                  DIV  DIVSR_WRD ;Kvocient v AX,zbytek v DX

                               Dˆlen¡ u 80386:
                                  MOV  EDX,MSB_NUMBER
                                  MOV  EAX,LSB_NUMBER
                                  DIV  ECX  ;Kvocient v EAX, zbytek v EDX

ENTER (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Vytvo©  prostor  v z sobn¡ku  pro  parametry
                               procedury

€asov n¡:                      11-16 (80286), 10-19 (80386)



                                  - 69 - 




Popis:                         Instrukce  ENTER  se pou‘¡v   pro  vytvo©en¡
                               prototypu struktury  uchov vaj¡c¡ parametry,
                               jej¡‘ pou‘it¡ je typick‚ pro vˆt¨inu vy¨¨¡ch
                               programovac¡ch    jazyk–.   Prvn¡    operand
                               specifikuje  velikost  po‘adovan‚  alokovan‚
                               dynamick‚  pamˆti, ji‘ je t©eba vymezit  pro
                               parametry   v   z sobn¡ku  p©i   vstupu   do
                               procedury.   Druh˜   operand   ud v   £rove¤
                               vno©en¡  podprogramu  vzhledem  k zdrojov‚mu
                               programu  ve  vy¨¨¡m  programovac¡m  jazyce.
                               Instrukce   ENTER   ur‡uje,   jak‚  mno‘stv¡
                               ukazatel– (ze star‚ struktury pro vol n¡) je
                               t©eba kop¡rovat do  nov‚  struktury. BP(EBP)
                               je   pou‘it   jako  aktu ln¡   ukazatel   do
                               struktury.  Je-li  druh˜  operand  roven  0,
                               ENTER ukl d  BP (EBP), nastavuje BP (EBP) na
                               hodnotu SP (ESP)  a ode‡¡t  prvn¡ operand od
                               SP (ESP).

Syntaxe:                       ENTER immediate_word,immediate_byte
Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Pokud registr  SP  odkazuje  na  adresu mimo
                               limit  z sobn¡ku,   je   generov na  v˜jimka
                               "chyba z sobn¡ku",  a  to  v  libovoln‚ f zi
                               vykon v n¡ instrukce ENTER.

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            Jsou  pou‘ity 32-bitov‚ registry EBD a  ESP.
                               Velikost  struktury je zvˆt¨ena ze 16 na  32
                               bit–.

HLT (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Zastaven¡ prov dˆn¡ programu

€asov n¡:                      2 (80286), 5 (80386)

Popis:                         Instrukce  HLT  zp–sob¡  ukon‡en¡  prov dˆn¡
                               programu.  Opˆtovn‚  spu¨tˆn¡   programu  je
                               mo‘n‚ jen extern¡m p©eru¨en¡m nebo  RESETem.
                               Nejsou ovlivnˆny ‘ dn‚ registry ani  stavov‚
                               p©¡znaky. Jestli‘e je k opˆtovn‚mu  spu¨tˆn¡
                               programu   pou‘ito    p©eru¨en¡,   uschovan‚
                               hodnoty CS:IP budou  ukazovat  na instrukci,
                               je‘ n sleduje za HLT.

Syntaxe:                       HLT (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚



                                  - 70 - 




V˜jimky v PM:                  HLT  je  privilegovan   instrukce generuj¡c¡
                               v¨eobecnou   v˜jimku   poru¨en¡   ochrany  v
                               p©¡padˆ, ‘e aktu ln¡ privilegovan  £rove¤ je
                               jin  ne‘ 0.

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       HLT

IDIV (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Celo‡¡seln‚ dˆlen¡ (se znam‚nkem)

€asov n¡:                      17-28 (80286), 19-34 (80386)

Popis:                         Instrukce IDIV prov d¡ operaci celo‡¡seln‚ho
                               dˆlen¡    se    znam‚nkem.    Jestli‘e    je
                               specifikov n  zdrojov˜  operand  o velikosti
                               byte, je registr AX dˆlen bytov˜m operandem:
                               kvocient je  ulo‘en  v  AL  a  zbytek  v AH.
                               Zdrojov˜  operand  o  velikosti  slova  dˆl¡
                               DX:AX  slovem. Vy¨¨¡ch 16 bit– dˆlence je  v
                               registru  DX,  kvocient je um¡stˆn  v  AX  a
                               zbytek v DX.  Zbytek m  stejn‚ znam‚nko jako
                               dˆlenec a je v‘dy  men¨¡  jako  dˆlitel. Viz
                               t‚‘ pozn mku pro 80386.

Syntaxe:                       IDIV source

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         SF, AF, OF, PF, CF

V˜jimky v PM:                  Je-li  dˆlitel roven  0  nebo  je-li  zbytek
                               p©¡li¨  velk˜  pro  um¡stˆn¡ do po‘adovan‚ho
                               registru   (AX   nebo   AL),  je  generov no
                               p©eru¨en¡ INT 0. Jestli‘e obsahuj¡ DS, CS ‡i
                               ES  neplatn‚  efektivn¡  adresy operand–, je
                               generov na v¨eobecn  v˜jimka privilegovan‚ho
                               m¢du. Jestli‘e SS obsahuje neplatnou adresu,
                               je generov na v˜jimka "chyba z sobn¡ku".

V˜jimky v RM:                  Je-li  dˆlitel 0  nebo  je  kvocient  p©¡li¨
                               velk˜ a nevejde se do m¡sta ur‡en¡  (AL nebo
                               AX), je generov no p©eru¨en¡ INT 0. Jestli‘e
                               je  slovn¡ operand  na  offsetu  OFFFFH,  je
                               generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            Velikost slova je 32 bit–. Dˆlen¡ ve dvojit‚
                               p©esnosti   je   prov dˆno   s  dˆlitelem  v
                               registrov‚m  p ru  EDX:EAX. Dˆlitel  je  32-
                               bitov  hodnota  um¡stˆn   v registru/pamˆti.




                                  - 71 - 




                               32-bitov˜ pod¡l (kvocient) je  v  EAX  a 32-
                               bitov˜ zbytek v EDX.

P©¡klad:                       Dˆlen¡ slova bytem:
                                  MOV  AX,NUMER_WRD
                                  IDIV DIVSR_BTE

                               Dˆlen¡ slova slovem:
                                  MOV  AX,NUMER_WORD
                                  CWD       ;Konverze slova na dvouslovo
                                  IDIV DIVSR_WRD

                               Dˆlen¡ dvouslova slovem:
                                  MOV  DX,NUMER_MSW
                                  MOV  AX,NUMER_LSW
                                  IDIV DIVSR_WRD

                               Dˆlen¡ u 80386:
                                  MOV  EDX,MSB_NUMBER
                                  MOV  EAX,LSB_NUMBER
                                  IDIV DIVISOR

IMUL (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Celo‡¡seln‚ n soben¡

€asov n¡:                      13-24 (80286), 9-41 (80386)

Popis:                         Instrukce IMUL prov d¡  celo‡¡seln‚ n soben¡
                               se znam‚nkem. Jestli‘e  je  zdrojov˜ operand
                               jedin˜ byte, je  vyn soben  obsahem registru
                               AL  a 16-bitov˜  v˜sledek  se  znam‚nkem  je
                               ulo‘en do AX. P©¡znaky CF a OF jsou nulov ny
                               v p©¡padˆ, ‘e registr AH je extenz¡ znam‚nka
                               hodnoty ulo‘en‚ v AL;  jinak  jsou  OF  a CF
                               nastaveny na 1. Viz  t‚‘  pozn mku  k 80386.
                               Jestli‘e je zdrojov˜ operand specifikovan˜ v
                               instrukci  IMUL  slovo,  pak  je   vyn soben
                               obsahem registru AX a 32-bitov˜  v˜sledek se
                               znam‚nkem  je  ulo‘en  v  registrov‚m   p ru
                               DX:AX.  Registr DX obsahuje vy¨¨¡ch 16  bit–
                               v˜sledku. P©¡znaky OF a CF jsou nastaveny do
                               nuly v p©¡padˆ, ‘e DX je extenz¡  znam‚nka v
                               AX (viz pozn mku u 80386); jinak  jsou  OF a
                               CF  nastaveny do 1. Jestli‘e instrukce  IMUL
                               specifikuje t©i operandy,  je  druh˜ operand
                               (jen‘   je   efektivn¡    adresou   slovn¡ho
                               operandu) n soben t©et¡m operandem (jen‘  je
                               bezprost©edn¡ slovn¡ hodnotou).  V˜sledek je
                               16-bitov˜  a je um¡stˆn do prvn¡ho  operandu
                               instrukce IMUL,  kter˜  specifikuje registr.
                               CF a OF jsou nastaveny do nuly v p©¡padˆ, ‘e
                               v˜sledek  je ‡¡slo se znam‚nkem v  intervalu
                               (-32768,+32768);   jinak   jsou  CF   a   OF
                               nastaveny do 1.



                                  - 72 - 




Syntaxe:                       IMUL source

Ovliv¤uje p©¡znaky:            OF, CF

Nedefinovan‚ p©¡znaky:         ZF, SF, AF, PF

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na v¨eobecn  v˜jimka pru¨en¡ ochrany
                               pamˆti.  Jestli‘e   SS   obsahuje  neplatnou
                               adresu,   je   generov na   v˜jimka   "chyba
                               z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  le‘¡  slovn¡  operand  na  offsetu
                               OFFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            Velikost  slova je  32  bit–.  Je  prov dˆno
                               n soben¡ ve dvojit‚ p©esnosti a  v˜sledek je
                               ulo‘en  v  registrov‚m p ru  EDX:EAX.  Tento
                               v˜sledek   vznik     vyn soben¡m   32-bitov‚
                               hodnoty EAX-kr t.

P©¡klad:                          MOV AL,NUMBER
                                  IMUL NUMBER ;V˜sledek v AX
                                  MOV AX,VALUE1
                                  IMUL VALUE2 ;V˜sledek v DX:AX

                               Pro 80386:
                                  MOV EAX,FCAB1234H
                                  IMUL NUMBER ;V˜sledek v EDX:EAX

IN (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Vstup slova nebo bytu (z portu)

€asov n¡:                      5 (80286), 5-6 (80386)

Popis:                         Instrukce  IN  nahrazuje obsah  registru  AL
                               nebo  AX   obsahem   specifikovan‚ho  portu.
                               P©esouvan˜  datov˜ £daj m–‘e b˜t slovo  nebo
                               byte.    Program tor    m–‘e    specifikovat
                               libovoln˜  port ‡¡slem od 0 do 65535,  kter‚
                               ulo‘¡  do  registru  DX.  Jestli‘e  je  port
                               specifikov n  s  datov˜m  bytem "inline", je
                               nastaven p©¡stup k port–m  0  a‘  255. INTEL
                               reservoval I/O adresy 00F8H a‘ 00FFH ke sv˜m
                               intern¡m £‡el–m  (©¡zen¡  koprocesoru, resp.
                               p©¡¨t¡ extenze procesoru): tyto adresy port–
                               by tedy nemˆly b˜t u‘¡v ny.

Syntaxe:                       IN accumulator,port

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚



                                  - 73 - 




V˜jimky v PM:                  Jestli‘e IOPL (v registru p©¡znak–) obsahuje
                               hodnotu  vˆt¨¡  ne‘  aktu ln¡  privilegovan 
                               £rove¤,  je  generov na   v¨eobecn   v˜jimka
                               poru¨en¡ ochrany pamˆti.

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            ›¡©ka slova je 32 bit–.

P©¡klad:                          IN   AL,B_P_ADR     ; vstup byte do AL
                                  IN   AX,W_P_ADR     ; vstup slova do AX
                                  IN   AL,DX          ; vstup byte do AL
                                  IN   AX,DX          ; vstup slova do AX
                                  IN   EAX,PORT8      ; jen pro 80386

INC (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Zv˜¨en¡ o jedni‡ku

€asov n¡:                      2-7

Popis:                         Instrukce   INC   zv˜¨¡   obsah  operandu  o
                               jedni‡ku, ani‘
ovlivn¡ p©¡znak CF.

Syntaxe:                       INC destination

Ovliv¤uje p©¡znaky:            SF, AF, OF, ZF, PF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  V p©¡padˆ, ‘e operand  le‘¡  v  segmentu, do
                               nˆho‘ nelze zapsat, je generov na  v¨eobecn 
                               v˜jimka   privilegovan‚ho   m¢du.   Jestli‘e
                               registry  CS,  DS  nebo ES obsahuj¡ neplatn‚
                               efektivn¡  adresy  operand–,  je  generov na
                               v¨eobecn  v˜jimka  poru¨en¡  ochrany pamˆti.
                               Jestli‘e  SS  obsahuje  neplatnou adresu, je
                               generov na v˜jimka "chyba z sobn¡ku".

V˜jimky v RM:                  P©i  um¡stˆn¡  slovn¡ho  operandu na offsetu
                               0FFFFH je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ›¡©ka slova je 32 bit–.

P©¡klad:                          INC  AX
                                  INC  EBX       ; jen pro 80386
                                  INC  MEM_LOC

INS/INSB/INSW (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Vstup z portu do ©etˆzce

€asov n¡:                      5 (80286), 5-8 (80386)



                                  - 74 - 




Popis:                         Instrukce  INS  p©esouv   byte  nebo   slovo
                               ©etˆzce  na  pamˆŸov‚   m¡sto  specifikovan‚
                               ES:DI.  Registr  DX  (EDX) ukazuje p©itom na
                               vstupn¡  port.  Instrukc¡ INS  je  p©esouv n
                               byte  nebo  slovo  podle  prvn¡ho   operandu
                               instrukce INS.  Operand  v  pamˆti  mus¡ b˜t
                               adresovateln˜ z registru  ES.  Instrukce INS
                               nedovoluje,    aby    bylo    ‡¡slo    portu
                               specifikov no  jako  bezprost©edn¡  hodnota.
                               Port  m–‘e b˜t  adresov n  jen  p©i  pou‘it¡
                               registru  DS.  Po  proveden¡  instrukce   je
                               registr      DI       (EDI)      automaticky
                               inkrementov n/dekrementov n. Jestli‘e  je DF
                               = 0 (byla provedena  instrukce  CLD),  je DI
                               (EDI)  inkrementov n. Jestli‘e  je  DF  =  1
                               (byla provedena instrukce STD), je  DI (EDI)
                               dekrementov n. Inkrement/dekrement  je roven
                               1 pro bytov˜ p©esun, 2 pro slovn¡ p©esun.

Syntaxe:                       INS     destination_string,port
                               INSB    (‘ dn‚ operandy)
                               INSW    (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e je hodnota  CPL  (Current Privilege
                               Level) vˆt¨¡ ne‘ hodnota IOPL, je generov na
                               v¨eobecn  v˜jimka privilegovan‚ho m¢du. Tato
                               v˜jimka je  generov na  tak‚  v  p©¡padˆ, ‘e
                               m¡sto   ur‡en¡   (c¡lov˜   ©etˆzec)  le‘¡  v
                               segmentu,  do  nˆho‘  nelze zapsat. Jestli‘e
                               registry  CS,  DS  nebo ES obsahuj¡ neplatn‚
                               efektivn¡  adresy  operand–,  je  generov na
                               v¨eobecn  v˜jimka  poru¨en¡  ochrany pamˆti.
                               Jestli‘e  SS  obsahuje  neplatnou adresu, je
                               generov na v˜jimka "chyba z sobn¡ku".


V˜jimky v RM:                  P©i  um¡stˆn¡  slovn¡ho  operandu na offsetu
                               0FFFFH je generov no p©eru¨en¡ INT 13.


Pozn mka pro 80386:            ›¡©ka slova je 32 bit–. Adresy v pamˆti jsou
                               vytv ©eny ze 32-bitov˜ch  efektivn¡ch adres.
                               €¡slo   portu   je   vzato  z  registru  DX.
                               Efektivn¡ adresa neovlivn¡ adresu I/O portu.

P©¡klad:                          INS  BTE_STRG,DX    ; vstup bytu
                                  INS  WRD_STRG,DX    ; vstup slova
                                                      ( d‚lky ©etˆzc–
                                  INSB      ; vstup byte jsou vzaty z
                                  INSW      ; vstup slova registru ECS )





                                  - 75 - 




INT/INTO (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Generov n¡  p©eru¨en¡  -  vol n¡ p©eru¨ovac¡
                               procedury

€asov n¡:                      23-167 (80286), 33-287 (80386)

Popis:                         Instrukce  INT  generuje  vol n¡ p©eru¨ovac¡
                               procedury  pomoc¡  softwareov‚ho  p©ep¡na‡e.
                               Bezprost©edn¡   operand   instrukce,   kter˜
                               obsahuje hodnotu mezi 0 a‘ 255 v‡etnˆ, ud v 
                               "‡¡slo" p©eru¨en¡, je‘ je indexem do tabulky
                               deskriptor–  p©eru¨en¡   (IDT   -  Interrupt
                               Descriptor Table)  p©eru¨ovac¡  procedury. V
                               privilegovan‚m    m¢du    sest v     tabulka
                               deskriptor–   z  osmibytov˜ch   deskriptor–.
                               Deskriptor  pro   vyvol n¡   p©eru¨en¡  mus¡
                               specifikovat   m¡sto  p©eru¨en¡   (interrupt
                               gate),  m¡sto  pro  v˜jimku  (trap  gate)  a
                               pop©¡padˆ  m¡sto £lohy (task gate). V RM  je
                               tabulka    deskriptor–   polem    4-bytov˜ch
                               ukazatel– alokovan  na fixn¡ adrese  00000H.
                               Instrukce INTO je identick  instrukci  INT s
                               tou   v˜jimkou,   ‘e  ‡¡slo   p©eru¨en¡   je
                               implicitnˆ   4.   Toto   p©eru¨en¡  je  tedy
                               aktivovateln‚  jen v p©¡padˆ, ‘e p©¡znak  OF
                               je nastaven. V RM  instrukce  INT  ukl d  do
                               z sobn¡ku p©¡znaky a registr CS  a n vratov˜
                               IP (EIP) (  v uveden‚m po©ad¡). U‘¡v  p©itom
                               ukazatele,   kter˜   je   indexov n   ‡¡slem
                               p©eru¨en¡.

Syntaxe:                       INT interrupt_type
                               INTO (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            P©i  p©epnut¡  £lohy (task  switching)  jsou
                               ovlivnˆny v¨echny p©¡znaky;  jinak instrukce
                               INT/INTO neovliv¤uj¡ ‘ dn‚ p©¡znaky.

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Mohou   b˜t   generov ny   v˜jimky  poru¨en¡
                               ochrany    pamˆti,    v˜jimka    "deskriptor
                               nenalezen",   v˜jimka   "chyba   z sobn¡ku",
                               v˜jimka "neplatn˜ stavov˜ segment £lohy".

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            ›¡©ka  operandu  nem   ‘ dn˜ v˜znam. Hodnoty
                               registr– EIP, ESP a  FLAGS  jsou  zav dˆny z
                               m¡sta p©eru¨en¡ (gate).

P©¡klad:                       INT 21H
                               INTO




                                  - 76 - 




IRET (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     N vrat z p©eru¨en¡

€asov n¡:                      17-169 (80286), 22-275 (80386)

Popis:                         V  re ln‚m  adresn¡m  m¢du  instrukce   IRET
                               vyzved v  ze z sobn¡ku  IP (EIP), CS a FLAGS
                               a  ukon‡uje k¢d  programu  p©eru¨en¡.  V  PM
                               instrukce IRET z vis¡ na nastaven¡  p©¡znaku
                               NT (Nested Task flag):

                               1.  NT  =  1.  Instrukce "obrac¡" efekt CALL
                               nebo INT, kter‚ vyvolaly p©epnut¡  £loh. K¢d
                               prov dˆj¡c¡  instrukci  IRET  m   sv–j  stav
                               uchov n  ve sv‚m registru stavu £lohy  (TS).
                               Znamen   to, ‘e p©i opˆtovn‚ aktivaci  £lohy
                               bude   provedena   jako    prvn¡   instrukce
                               n sleduj¡c¡ instrukci IRET.

                               2. NT = 0.  Instrukce  IRET  vrac¡  ©¡zen¡ z
                               p©eru¨ovac¡ho podprogramu, ani‘  se vyskytlo
                               p©epnut¡ £loh. Privilegovan  £rove¤ k¢du, do
                               nˆho‘ se ©¡zen¡ z p©eru¨ovac¡ho  podprogramu
                               navrac¡,  mus¡ b˜t  stejn   nebo  men¨¡  ne‘
                               privilegovan       £rove¤      p©eru¨ovac¡ho
                               podprogramu.

Syntaxe:                       IRET (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            Cel˜  registr  p©¡znak–   je   vyzvednut  ze
                               z sobn¡ku.

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  M–‘e   b˜t   generov na   v¨eobecn   v˜jimka
                               poru¨en¡ ochrany pamˆti, v˜jimka "deskriptor
                               nenalezen", v˜jimka "chyba z sobn¡ku".

V˜jimky v RM:                  Je   generov no   p©eru¨en¡   INT   13   p©i
                               vyzved v n¡ obsahu z sobn¡ku maj¡c¡ho offset
                               0FFFFH.

Pozn mka pro 80386:            Je  pou‘it   32-bitov˜   roz¨¡©en˜  ukazatel
                               instrukce.  —rove¤  INTER  ukl d   48-bitov˜
                               ESP. Jsou ukl d ny 48-bitov˜ EIP a 32-bitov˜
                               FLAG.

P©¡klad:                       IRET

J(podm¡nka) (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     (Bl¡zk˜) skok p©i splnˆn¡ podm¡nky




                                  - 77 - 




                               Varian. €as. Popis:
                               JA      7    Skok p©i vˆt¨¡m
                               JAE     7    Skok p©i vˆt¨¡m nebo rovn‚m
                               JB      7    Skok p©i men¨¡m
                               JBE     7-9  Skok p©i men¨¡m nebo rovn‚m
                               JC      7-9  Skok p©i p©enosu
                               JCXZ    8    Skok p©i CX = 0
                               JE      7    Skok p©i rovnosti
                               JG      7    Skok p©i vˆt¨¡m
                               JGE     7    Skok p©i vˆt¨¡m nebo rovn‚m
                               JL      7    Skok p©i men¨¡m
                               JLE     7    Skok p©i men¨¡m nebo rovn‚m
                               JNA     7    Skok p©i ne vˆt¨¡m
                               JNAE    7    Skok p©i ne vˆt¨¡m nebo rovn‚m
                               JNB     7    Skok p©i ne men¨¡m
                               JNBE    7    Skok p©i ne men¨¡m nebo rovn‚m
                               JNC     7    Skok p©i CF = 0
                               JNE     7    Skok p©i nerovnosti
                               JNG     7    Skok p©i ne vˆt¨¡m
                               JNGE    7    Skok p©i ne vˆt¨¡m nebo rovn‚m
                               JNL     7    Skok p©i ne men¨¡m
                               JNLE    7    Skok p©i ne men¨¡m nebo rovn‚m
                               JNO     7    Skok nebylo-li p©ete‡en¡
                               JNP     7    Skok nebyla-li parita
                               JNS     7    Skok nebylo-li znam‚nko
                               JO      7    Skok p©i p©ete‡en¡
                               JP      7    Skok p©i paritˆ
                               JPE     7    Skok p©i sud‚ paritˆ
                               JPO     7    Skok p©i lich‚ paritˆ
                               JS      7    Skok p©i znam‚nku
                               JZ      7    Skok p©i nule


Popis:                         Instrukce J (n sledovan   podm¡nkou  z pr vˆ
                               uveden‚ho seznamu)  p©ed v   ©¡zen¡ operandu
                               specifikovan‚mu v instrukci. Jde o podm¡nˆn‚
                               "kr tk‚" skoky testuj¡c¡ p©¡znaky. Testovac¡
                               operand instrukce mus¡  b˜t v dosahu -128 a‘
                               +127 byte od um¡stˆn¡ instrukce J(podm¡nka).
                               Toto  omezen¡  je podstatn‚  pro  assembler,
                               kter˜ vytv ©¡  1-bytov‚  p©em¡stˆn¡ vzta‘en‚
                               ke konci instrukce J(podm¡nka).


Syntaxe:                       J(test_condition)


Ovliv¤uje p©¡znaky:            ‘ dn‚


Nedefinovan‚ p©¡znaky:         ‘ dn‚








                                  - 78 - 




V˜jimky v PM:                  Jestli‘e  je  offset m¡sta, na  nˆ‘  m   b˜t
                               p©ed no ©¡zen¡, mimo hranice segmentu CS, je
                               generov na v¨eobecn  v˜jimka privilegovan‚ho
                               m¢du.


V˜jimky v RM:                  ‘ dn‚


Pozn mka pro 80386:            U‘¡v     32-bitov˜     roz¨¡©en˜    ukazatel
                               instrukce.    P©em¡stˆn¡   je    osmibitov‚,
                               roz¨¡©en‚  do  32  bit–  znam‚nkov˜m   bitem
                               (pokud nen¡ jinak upraveno).

P©¡klad:                       JA INST_LABEL

JMP (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Nepodm¡nˆn˜ skok


€asov n¡:                      7-183 (80286), 7-268 (80386)


Popis:                         Instrukce  JMP  p©ed v  ©¡zen¡  programu  na
                               jinou  instrukci,  p©i‡em‘  nen¡  uchov v na
                               ‘ dn   informace  o  n vratu.  JMP   prov d¡
                               intrasegmentov‚  p©¡m‚  a  nep©¡m‚  skoky  a
                               mezisegmentov‚ skoky.  Intrasegmentov‚ p©¡m‚
                               skoky  pou‘¡vaj¡  offset um¡stˆn˜  ihned  za
                               instrukc¡.  Intrasegmentov‚   nep©¡m‚  skoky
                               u‘¡vaj¡ obsahu pamˆŸov‚ho m¡sta adresovan‚ho
                               byty, kter‚ n sleduj¡c¡ po instruk‡n¡m byte.
                               Kdy‘  je  instrukce  intrasegmentov˜m p©¡m˜m
                               skokem,  vzd lenost  od  konce  instrukce  k
                               c¡lov‚mu n vˆ¨t¡  je  p©i‡tena  k  IP (EIP).
                               Mezisegmentov‚    skoky   nahrazuj¡    obsah
                               registru CS. Pro p©¡m‚ skoky je to zaji¨tˆno
                               druh˜m  slovem  n sleduj¡c¡m  instrukci. Pro
                               skoky nep©¡m‚ je registr CS  nahrazen druh˜m
                               slovem n sleduj¡c¡m po nazna‡en‚ adrese  dat
                               (viz p©¡klady).


Syntaxe:                       JMP (target)


Ovliv¤uje p©¡znaky:            P©i  p©epnut¡  ulohy (task  switching)  jsou
                               ovlivnˆny v¨echny p©¡znaky;  jinak nedoch z¡
                               k ovlivnˆn¡ ‘ dn˜ch p©¡znak–.



Nedefinovan‚ p©¡znaky:         ‘ dn‚




                                  - 79 - 




V˜jimky v PM:                  Jestli‘e   je  typ  skoku  NEAR,  m–‘e   b˜t
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany  pamˆti  v  p©¡padˆ, ‘e offset m¡sta
                               ur‡en¡ je mimo  hranice  aktu ln¡ho segmentu
                               CS.  Jestli‘e  je typ skoku  FAR,  m–‘e  b˜t
                               generov na tak‚  v¨eobecn   v˜jimka ochrany.
                               Jin‚  mo‘n‚  v˜jimky  jsou: "deskriptor nen¡
                               p©¡tomen",   "chyba  z sobn¡ku",   "neplatn˜
                               stavov˜  registr  £lohy".   Jestli‘e   je  u
                               intersegmentov‚ho nep©¡m‚ho  skoku operandem
                               registr, je generov na v˜jimka "nedefinovan˜
                               opera‡n¡ k¢d".

V˜jimky v RM:                  Jakmile    je     v     p©¡padˆ    nep©¡m‚ho
                               intersegmentov‚ho  skoku operandem  registr,
                               je generov na v˜jimka "nedefinovan˜ opera‡n¡
                               k¢d".

Pozn mka pro 80386:            Je  pou‘it   32-bitov˜   roz¨¡©en˜  ukazatel
                               instrukce.  Ukazatelov‚  operandy  jsou  48-
                               bitov‚ a jejich p©em¡stˆn¡ jsou 32-bitov .

P©¡klad:                       Intersegmentov˜ p©¡m˜ skok:
                                  JMP FAR_LABEL
                                  Intersegmentov˜ nep©¡m˜ skok:
                                  JMP TABLE[BP][DI]
                                  JMP TABLE[EBP][EDI] ; jen pro 80386
                                  Intrasegmentov˜ p©¡m˜ skok:
                                  JMP NEAR_LABEL
                                  Intrasegmentov˜ nep©¡m˜ skok:
                                  JMP WORDPTR[BX][DI]

LAHF (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Napl¤ AH p©¡znakov˜mi registry

€asov n¡:                      2

Popis:                         Instrukce  LAHF  p©esouv   registry p©¡znak–
                               SF,  ZF,  AF,  PF  a  CF  do  ur‡it˜ch  bit–
                               registru AH:

                               SF ZF AF PF CF
                               BIT 7   BIT 0

Bitov‚ pozice 1, 3 a 5 jsou nedefinov ny.

Syntaxe:                       LAHF (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:

V˜jimky v PM:                  ‘ dn‚




                                  - 80 - 




V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       LAHF

LAR (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Zaveƒ  byte  p©¡stupov˜ch  opr vnˆn¡ (access
                               rights)

€asov n¡:                      14-16 (80286), 15-16(80386)

Popis:                         Druh˜   operand   instrukce   LAR   obsahuje
                               selektor. Jestli‘e  je  p©¡slu¨n˜ deskriptor
                               na aktu ln¡ privilegovan‚ £rovni viditeln˜ a
                               selektor  je  RPL,   je   byte  p©¡stupov˜ch
                               opr vnˆn¡  (access  rights  byte) zaveden do
                               horn¡ho byte prvn¡ho (registrov‚ho) operandu
                               instrukce LAR a ni‘¨¡ byte je nastaven na 0.
                               Bylo-li zaveden¡ dokon‡eno, m  ZF hodnotu 1;
                               jinak je nulov n.

Syntaxe:                       LAR access_rights_byte,selector

Ovliv¤uje p©¡znaky:            ZF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na v¨eobecn  v˜jimka ochrany pamˆti.
                               Jestli‘e  SS  obsahuje  neplatnou adresu, je
                               generov na v˜jimka "chyba z sobn¡ku".

V˜jimky v RM:                  Je  generov no  p©eru¨en¡  INT  6. V RM nen¡
                               instrukce LAR rozpozn na.

Pozn mka pro 80386:            -

P©¡klad:                       LAR ARB,SELECTR

LSS/LFS/LGS (80386), LDS/LES (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Zaveƒ dvouslovn¡ ukazatel

€asov n¡:                      7

Popis:                         Instrukce    LDS/LES    zav dˆj¡    4-bytov˜
                               ukazatel,     lokalizovan˜     na     adrese
                               specifikovan‚ druh˜m operandem instrukce, do
                               segmentov‚ho  a  slovn¡ho   registru.  Prvn¡
                               slovo  ukazatele  (offset)  je  zavedeno  do
                               registru  vystupuj¡c¡ho  jako  prvn¡ operand



                                  - 81 - 




                               instrukce.  Posledn¡   slovo   ukazatele  je
                               zavedeno  do  DS  registru (u instrukce LDS)
                               nebo ES registru (u instrukce LES).

Syntaxe:                       LDS destination,source

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Mo‘n‚   v˜jimky   jsou:   v¨eobecn   v˜jimka
                               poru¨en¡   ochrany   a   "deskriptor   nebyl
                               nalezen".  Jestli‘e  je operand  vnˆ  hranic
                               limitu  segmentu,  je  generov na  v¨eobecn 
                               v˜jimka   ochrany   nebo    v˜jimka   "chyba
                               z sobn¡ku". Jestli‘e je  zdrojov˜m operandem
                               registr, je generov na v˜jimka "nedefinovan˜
                               opera‡n¡ k¢d".

V˜jimky v RM:                  Pro  operand na offsetu 0FFFFH nebo  0FFFFDH
                               je generov no p©eru¨en¡ INT 13.  Jestli‘e je
                               zdrojov˜  operand  registr,   je  generov na
                               v˜jimka "nedefinovan˜ opera‡n¡ k¢d".

Pozn mka pro 80386:            ›¡©ka slova je 32 bit–. Ukazetel‚ maj¡
¨¡©ku 48 bit–.

P©¡klad:                          LDS  SI,DOUBLEWORD1
                                  LES  BX,DOUBLEWORD2

LEA (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Zaveƒ offset efektivn¡m adresy

€asov n¡:                      3 (80286), 2 (80386)

Popis:                         Instrukce LEA p©esouv  offset ze  zdrojov‚ho
                               do   c¡lov‚ho   operandu.    Prvn¡   operand
                               instrukce LEA je c¡lov˜ registr, do nˆho‘ se
                               p©esouv  offset druh‚ho operandu.

Syntaxe:                       LEA source,destination

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Je-li druh˜ operand  registr,  je generov na
                               v˜jimka "nedefinovan˜ opera‡n¡ k¢d".

V˜jimky v RM:                  Je-li druh˜ operand  registr,  je generov na
                               v˜jimka "nedefinovan˜ opera‡n¡ k¢d".

Pozn mka pro 80386:            ›¡©ka  slova je 32 bit–. Adresy pamˆti  jsou
                               vytv ©eny z 32-bitov˜ch efektivn¡ch adres.



                                  - 82 - 




P©¡klad:                          LEA  AX,[BP][DI]
                                  LEA  EBX,MYDATA ; jen pro 80386

LEAVE (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     V˜stup z procedury (na vy¨¨¡ £rovni)

€asov n¡:                      5 (80286), 4 (80386)

Popis:                         Instrukce  LEAVE  prov d¡ operaci  du ln¡  k
                               instrukci   ENTER.   LEAVE   uvoln¡  v¨echny
                               lok ln¡ promˆnn‚ a nastav¡ BP na hodnotu SP,
                               navrac¡ registr–m  hodnoty  bezprost©ednˆ po
                               vykon n¡   procedury.   Kdy‘   je  BP  (EBP)
                               kop¡rov n   do   SP   (ESP),  je  prostor  v
                               z sobn¡ku  pou‘it˜  pro  proceduru  uvolnˆn.
                               Star˜  ukazatel  struktury   (viz  instrukci
                               ENTER)  je nyn¡  vyzvednut  ze  z sobn¡ku  a
                               ulo‘en  do BP  (EBP);  to  obnov¡  strukturu
                               volaj¡c¡ho    (pod)programu   a    n sleduje
                               instrukce   RET   nn   odstra¤uj¡c¡  v¨echny
                               argumenty ulo‘en‚ do  z sobn¡ku  pro pot©eby
                               procedury, kter  pr vˆ kon‡¡.

Syntaxe:                       LEAVE (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Neukazuje-li  BP  (EBP)  na  pamˆŸov‚  m¡sto
                               uvnit© aktu ln¡ho z sobn¡kov‚ho segmentu, je
                               generov na v˜jimka "chyba z sobn¡ku".

V˜jimky v RM:                  Je-li   operand   na  offsetu   0FFFFH,   je
                               generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ›¡©ka   slova  je  32  bit–.  Jsou   pou‘ity
                               registry ESP a EBP.

P©¡klad:                       LEAVE

LGDT/LIDT (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Zaveƒ registr tabulky glob ln¡ch deskriptor–
                               Zaveƒ registr tabulky deskriptor– p©eru¨en¡

€asov n¡:                      11-12

Popis:                         Instrukce  LGDT  nebo  LIDT  zav d¡  6  byte
                               pamˆti referovan‚ efektivn¡ adresou operandu
                               do  tabulky  glob ln¡ch  deskriptor– nebo do
                               tabulky  deskriptor–  p©eru¨en¡.  Pole LIMIT
                               registru tabulky deskriptor–  je  zav dˆno z



                                  - 83 - 




                               prvn¡ho slova; dal¨¡ t©i byte  jsou zavedeny
                               do  pole BASE uveden‚ho registru a  posledn¡
                               byte  je  ignorov n.  Tyto  instrukce   jsou
                               ur‡eny  pro  syst‚mov‚  software  (OS)  a  v
                               aplika‡n¡ch programech nejsou pou‘¡v ny.

Syntaxe:                       LGDT memory_operand

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  V p©¡padˆ, ‘e aktu ln¡ privilegovan   £rove¤
                               nen¡ nulov , je generov na v¨eobecn  v˜jimka
                               privilegovan‚ho   m¢du.  Jestli‘e   obsahuje
                               registr SS neplatnou  adresu,  je generov na
                               v˜jimka  "chyba   z sobn¡ku".   Jestli‘e  je
                               zdrojov˜  operand  registrem,  je generov na
                               v˜jimka    "nedefinovan˜   opera‡n¡    k¢d".
                               Jestli‘e  registry  CS,DS nebo  ES  obsahuj¡
                               neplatnou  efektivn¡  adresu   operandu,  je
                               generov na v¨eobecn  v˜jimka privilegovan‚ho
                               m¢du.

V˜jimky v RM:                  Jestli‘e le‘¡ operand na offsetu  OFFFFH, je
                               generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            -

P©¡klad:                          LGDT MEM_WRD
                                  LIDT MEM_WRD

LLDT (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Zaveƒ registr tabulky lok ln¡ch deskriptor–

€asov n¡:                      17-19 (80286), 20 (80386)

Popis:                         Instrukce LLDT zav d¡  selektor  do registru
                               tabulky   lok ln¡ch   deskriptor–.   Operand
                               word_operand instrukce LLDT by mˆl obsahovat
                               selektor  ukazuj¡c¡  do  tabulky  glob ln¡ch
                               deskriptor–. Polo‘ka v t‚to tabulce  by mˆla
                               b˜t   tabulkou   lok ln¡ch   deskriptor–.  V
                               takov‚m p©¡padˆ je registr tabulky lok ln¡ch
                               deskriptor–   zaveden   z    t‚to   polo‘ky.
                               Instrukce je ur‡ena pro pou‘it¡ v syst‚mov‚m
                               (OS) software a v aplika‡n¡m software neb˜v 
                               pou‘ita.

Syntaxe:                       LLDT word_operand

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚



                                  - 84 - 




V˜jimky v PM:                  Jestli‘e aktu ln¡ privilegovan   £rove¤ nen¡
                               0, je generov na v¨oebecn  v˜jimka  poru¨en¡
                               ochrany pamˆti. Stejn  v˜jimka je generov na
                               v p©¡padˆ, ‘e selektor neukazuje  na tabulku
                               glob ln¡ch  deskriptor–  nebo  v p©¡padˆ, ‘e
                               polo‘ka  v  tabulce  glob ln¡ch  deskriptor–
                               nen¡ lok ln¡ tabulkou deskriptor–. Kdy‘ nen¡
                               lok ln¡  deskriptor  nalezen,  je generov na
                               v˜jimka  "deskriptor   nenalezen".  Jestli‘e
                               registry  CS,  DS  nebo ES obsahuj¡ neplatn‚
                               efektivn¡  adresy  operand–,  je  generov na
                               v¨eobecn  v˜jimka  poru¨en¡  ochrany pamˆti.
                               Jestli‘e  SS  obsahuje  neplatnou adresu, je
                               generov na v˜jimka "chyba z sobn¡ku".

V˜jimky v RM:                  Je  generov no  p©eru¨en¡  INT  6. V RM nen¡
                               instrukce LLDT rozpozn na.

Pozn mka pro 80386:            -

P©¡klad:                       LLDT BP

LMSW (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Nastav stavov‚ slovo procesoru (MSW)

€asov n¡:                      3-6 (80286), 10-13 (80386)

Popis:                         Instrukce  LMSW  zav d¡ do  stavov‚ho  slova
                               procesoru (MSW, Machine  Status  Word) obsah
                               zdrojov‚ho   operandu.   Je   to   instrukce
                               vyhrazen    pro    syst‚mov˜    software   a
                               nevyskytuje  se  v  aplika‡n¡ch  programech.
                               LMSW    lze    pou‘¡t    k    p©epnut¡    do
                               privilegovan‚ho  m¢du  (ale  u 80286 nikoliv
                               pro   n vrat   z   privilegovan‚ho  m¢du  do
                               re ln‚ho) . V takov‚m p©¡padˆ mus¡ b˜t dal¨¡
                               instrukce        privilegovan‚ho        m¢du
                               intrasegmentov˜  skok,  aby  se  "vy‡istila"
                               fronta instrukc¡.

Syntaxe:                       LMSW source_operand

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Nen¡-li aktu ln¡ privilegovan  £rove¤ 0,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany  pamˆti.  Jestli‘e registry  CS,  DS
                               nebo ES obsahuj¡  neplatn‚  efektivn¡ adresy
                               operand–,  je  generov na  rovnˆ‘  v¨eobecn 
                               v˜jimka poru¨en¡ ochrany pamˆti. Jestli‘e SS
                               obsahuje  neplatnou  adresu,  je  generov na
                               v˜jimka "chyba z sobn¡ku".



                                  - 85 - 




V˜jimky v RM:                  Jestli‘e le‘¡ operand na offsetu  OFFFFH, je
                               generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            -

P©¡klad:                       LMSW SP

LOCK (80386)
---------------------------------------------------------------------------

Instrukce:                     Aktivuj sign l BUS LOCK

€asov n¡:                      0

Popis:                         Prefix  LOCK  p©ed instrukc¡  vyjad©uje,  ‘e
                               oblast   pamˆti    specifikovan    operandem
                               instrukce instruction bude zablokov na. Toho
                               je  dosa‘eno  aktivac¡   sign lu   BUS  LOCK
                               procesoru  80386;  oblast  pamˆti z–st v  ve
                               skute‡nosti   zablokov na  a   protektov na,
                               dokud  procesor   nevykon    instrukci,  je‘
                               odblokuje pamˆŸovou oblast stejnou s oblast¡
                               specifikovanou  druh˜m  operandem  instrukce
                               LOCK.  Instrukce  u  80386,  je‘  mohou  m¡t
                               prefix LOCK, jsou n sleduj¡c¡:

                               BT,BTS,BTR,BTC pamˆŸ,registr/bezpr._operand

                               XCG     pamˆŸ, registr

                               XCG     registr, pamˆŸ

                               ADC,SUB,ADC,SBB pamˆŸ,registr/bezpr_operand

                               OR,XOR,AND pamˆŸ, registr/bezpr._operand

                               NEG,INC,DEC,NOT pamˆŸ

Syntaxe:                       LOCK instruction,operand_type

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Je  generov na  v¨eobecn   v˜jimka  poru¨en¡
                               ochrany   pamˆti   v    p©¡padˆ,    ‘e   I/O
                               privilegovan  £rove¤ je  ni‘¨¡  ne‘ aktu ln¡
                               privilegovan  £rove¤ .

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            Blokovac¡  funkce  u  80386 jsou podmno‘inou
                               blokovac¡ch funkc¡ u 8086 a  80286. Aplikace
                               psan‚ pro 8086  a 80286 tedy nemus¡ prob¡hat
                               korektnˆ na 80386.




                                  - 86 - 




P©¡klad:                       LOCK XCG MEM_WRD,AX

LODS/LODSW/LODSB (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Zaveƒ bytov˜ nebo slovn¡ ©etˆzec do st©ada‡e

€asov n¡:                      5

Popis:                         Instrukce LODS p©esouv   slovn¡  nebo bytov˜
                               operand   z   m¡sta    zdrojov‚ho   operandu
                               referovan‚ho registrem SI (ESI) do  st©ada‡e
                               AX   nebo   AL.   SI  (ESI)  je  automaticky
                               aktualizov n.  Jestli‘e  je  DF  =  0  (bylo
                               provedeno CLD), je  SI  (ESI) inkrementov n;
                               jestli‘e je DF = 1 (bylo provedeno  STD), je
                               SI  (ESI)  dekrementov n.   Inkrement  resp.
                               dekrement je roven 1 pro bytov‚ operandy a 2
                               pro slovn¡ operandy.

Syntaxe:                       LODS source_string
                               LODSB (‘ dn‚ operandy)
                               LODSW (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  le‘¡  slovn¡  operand  na  offsetu
                               OFFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ›¡©ka slova je 32 bit–.

P©¡klad:                       LEA     SLDATA    ; jsou-li data 16-bitov ,
                               LODS              ; je v˜sledek v AX

LOOP (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Cyklus ©¡zen˜ registrem CX

€asov n¡:                      8 (80286), 11 (80386)

Popis:                         Instrukce LOOP dekrementuje registr CX  o 1.
                               ’ dn‚   p©¡znaky   nejsou    ovlivnˆny.   Po
                               dekrementov n¡ jsou  testov ny  podm¡nky pro
                               instrukci  LOOPx (viz syntaxe) a pokud  jsou
                               splnˆny, je proveden skok uvnit© segmentu na
                               m¡sto   specifikovan‚  operandem   instrukce



                                  - 87 - 




                               LOOPx.  Tento  operand  mus¡  le‘et  (jde  o
                               n vˆ¨t¡ !) v rozsahu 128 byte p©ed instrukc¡
                               LOOPx a‘ 127 byte za instrukc¡ LOOPx.

Syntaxe:                       LOOP short_target
                               LOOPE short_target
                               LOOPZ short_target
                               LOOPNZ short_target
                               LOOPNE short_target

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Je generov na v¨eobecn  v˜jimka ochrany  p©i
                               pokusu  o  skok na adresu  s  offsetem  mimo
                               hranice aktu ln¡ho k¢dov‚ho segmentu CS.

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                               MOV CL,04H
                               AGAIN:  ADD BX,01H
                                       ADD AL,INFO[BX]
                                       DAA
                                       LOOP AGAIN
                                       MOV CX,12H
                               NEXT:   INC BX
                                       CMP TABLE[BX],0
                                       LOOPE NEXT
                                            ; jen pro 80386
                                       MOV ECX,0ABCDEH
                               REPEAT: INC BX
                                       MOV AL,TABLE_A[BX]
                                       ADD AL,TABLE_B[BX]
                                       MOV TOTAL[BX],AL
                                       LOOPNZ REPEAT

LSL (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Z¡skej limit segmentu

€asov n¡:                      14-16 (80286), 20-26 (80386)

Popis:                         Pokud  je selektor (druh˜ operand -  registr
                               nebo  pamˆŸ)  viditeln˜  p©i  CPL   (Current
                               Privilege  Level),  je  do c¡lov‚ho operandu
                               instrukce p©esunuto  slovo  z  pole  LIMIT v
                               deskriptoru.   C¡lov˜   operand   mus¡   b˜t
                               registr. Jeho hodnota ud v  velikost  limitu
                               pro  tento  segment.  Jestli‘e  byl   p©esun
                               uskute‡nˆn, je  p©¡znak  ZF  nastaven  na 1;
                               jinak je ZF nulov n.




                                  - 88 - 




Syntaxe:                       LSL seg_limit,selector

Ovliv¤uje p©¡znaky:            ZF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Je generov no p©eru¨en¡ INT 6. Instrukce LSL
                               nen¡ v RM rozpozn na.

Pozn mka pro 80386:            -

P©¡klad:                       LSL AX,SELECTR

LTR (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Napl¤ registr £lohy

€asov n¡:                      17-19 (80286),23-27 (80386)

Popis:                         Instrukce  LTR  napln¡ registr  £lohy  (task
                               register) obsahem  zdrojov‚ho  registru nebo
                               pamˆŸov‚ lokace stoj¡c¡ na m¡stˆ  zdrojov‚ho
                               operandu. Jde o instrukci opera‡n¡ho syst‚mu
                               nevyskytuj¡c¡ se v aplika‡n¡ch programech.

Syntaxe:                       LTR source_operand

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Je generov no p©eru¨en¡ INT 6. Instrukce LTR
                               nen¡ v RM rozpozn na.

Pozn mka pro 80386:            -

P©¡klad:                       LTR MEM_WRD







                                  - 89 - 




MOV (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     P©esun dat

€asov n¡:                      2-19 (80286), 2-22 (80386)

Popis:                         Instrukce  MOV  kop¡ruje   obsah  zdrojov‚ho
                               operandu do operandu  c¡lov‚ho.  K dispozici
                               je nˆkolik instrukc¡ MOV, kter‚ maj¡ v¨echny
                               stejnou funkci: kop¡ruj¡ zdrojov˜ operand do
                               c¡lov‚ho beze zmˆny zdrojov‚ho operandu.

Syntaxe:                       MOV destination,source

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  je  napl¤ov n  segmentov˜ registr,
                               mohou  b˜t  generov ny   v˜jimky:  v¨eobecn 
                               v˜jimka  poru¨en¡  ochrany  pamˆti,  v˜jimka
                               "chyba z sobn¡ku"  nebo  v˜jimka "deskriptor
                               nenalezen".   V¨eobecn    v˜jimka   poru¨en¡
                               ochrany  pamˆti  m–‘e  b˜t generov na tak‚ v
                               p©¡padˆ,  ‘e c¡lov˜ operand le‘¡ v  segmentu
                               nep©¡stupn‚m z pisu.  Jestli‘e  registry CS,
                               DS  nebo  ES  obsahuj¡  neplatn‚   efektivn¡
                               adresy  operand–,  je  generov na  v¨eobecn 
                               v˜jimka ochrany pamˆti. Jestli‘e SS obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e le‘¡ operand na offsetu  OFFFFH, je
                               generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ›¡©ka   slova   je   32  bit–.  Adresy  jsou
                               vytvo©eny  pomoc¡   32-bitov˜ch  efektivn¡ch
                               adres nebo 32- bitov˜ch offset–.

P©¡klad:                       Do st©ada‡e z pamˆti
                               MOV AX,MEM_WRD
                               MOV ECX,MYWORD ; jen pro 80386

                               Do pamˆti ze st©ada‡e
                               MOV MEM_BYTE,AL

                               Do pamˆti/registru ze segmentov‚ho registru
                               MOV BX,ES
                               MOV TABLE[BX],SS

                               Do segmentov‚ho registru z pamˆti/registru
                               MOV ES,NEXT_WRD[SI]
                               MOV DS,AX

                               Do registru z registru



                                  - 90 - 




                               MOV CX,DI
                               MOV EAX,ECX ; jen pro 80386

                               Do registru z pamˆti/registru
                               MOV AX,MEM_VAL
                               MOV CX,[BP][SI]

                               Do registru z bezprost©edn¡ho operandu
                               MOV DI,513
                               MOV EAX,12345678H ;jen pro 80386

                               Do pamˆti/registru z bezpr. operandu
                               MOV TABLE[BP][SI],25
                               MOV BX,77

MOVS/MOVSB/MOVSW (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     P©esu¤ bytov˜ nebo slovn¡ ©ˆtˆzec

€asov n¡:                      5 (80286), 7 (80386)

Popis:                         Instrukce MOV p©esouvaj¡ obsah slova  (bytu)
                               referovan‚ho  [SI]  ([ESI])  do slova (byte)
                               adresovan‚ho   ES:[DI]  (ES:[EDI]).   C¡lov˜
                               operand  mus¡  b˜t  adresovateln˜ z registru
                               ES. Po vykon n¡  instrukce jsou DI(EDI) i SI
                               (ESI)  automaticky  aktualizov ny.  P©i DF=0
                               (byla vykon na instrukce CLD) jsou  registry
                               inkrementov ny,   jinak   (p©i   DF=1  (byla
                               vykon na  instrukce   STD))   jsou  registry
                               automaticky                  dekrementov ny.
                               Dekrement/inkrement je 1  pro bytov‚ a 2 pro
                               slovn¡ operace.

Syntaxe:                       MOVS destination_string,source_string
                               MOVSB (‘ dn‚ operandy)
                               MOVSW (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku". Jestli‘e je m¡sto  ur‡en¡
                               v   segmentu    nep©¡stupn‚m    z pisu,   je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany pamˆti.

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.




                                  - 91 - 




Pozn mka pro 80386:            Adresy  v  pamˆti  jsou vytv ©eny pomoc¡ 32-
                               bitov‚  efektivn¡  adresy.  D‚lka ©etˆzce je
                               odvozena od registru ECX.

P©¡klad:                       LEA SI,MYSOURCE
                               LEA DI,ES:HERDESTINATION
                               MOV CX,50
                               REP MOVS HERDESTINATION

MOVZX/MOVSX (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     P©esun s extenz¡ znam‚nkov‚ho bitu

€asov n¡:                      3 - 6

Popis:                         Instrukce  MOVZX a  MOVSX  jsou  doplnˆny  k
                               instrukc¡m p©esunu  MOVx  k  tomu,  aby bylo
                               mo‘n‚  p©esunout  8-mi   nebo   16-  bitovou
                               hodnotu do  registru  s  extenz¡  (nuly nebo
                               znam‚nka) do 16-ti nebo 32 bit–.

Syntaxe:                       MOVZX register,register/memory
                               MOVSX register,register/memory

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  V  p©¡padˆ,  ‘e  adresa  operandu  v  pamˆti
                               poru¨uje  p©¡stupov   pr va  nebo  le‘¡  vnˆ
                               hranic  segmentu,  je  generov na  v¨eobecn 
                               v˜jimka   poru¨en¡   ochrany   pamˆti.   P©i
                               neplatn‚ adrese v segmentu SS  je generov na
                               v˜jimka "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            -

P©¡klad:                       MOVZX EAX,BX
                               MOVZX CX,AL
                               MOVSX AX,BX ; norm ln¡ p©esun
                               MOVSX ECX,CL
                               MOVSX EAX,MYMEMORY

MUL (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     N soben¡ bez znam‚nka (unsigned)

€asov n¡:                      13-21 (80286), 9-41 (80386)






                                  - 92 - 




Popis:                         Operace MUL prov d¡  n soben¡  bez znam‚nka.
                               Bytov˜ operand instrukce MUL vyn sob¡  obsah
                               registru AL a  v˜sledek ulo‘¡ v registru AX.
                               P©¡znaky CF  a OF jsou nastaveny do 0 p©i AH
                               nulov‚m; jinak jsou nastavov ny do 1. Slovn¡
                               operand instrukce MUL vyn sob¡ registr  AX a
                               v˜sledek ponech  v  registrov‚m  p ru DX:AX.
                               DX obsahuje 16 vy¨¨¡ch bit– v˜sledku, AX pak
                               16 ni‘¨¡ch bit–. CF a OF jsou nastaveny do 0
                               p©i  DX nulov‚m; jinak jsou nastaveny do  1.
                               Viz pozn mku pro 80386.

Syntaxe:                       MUL source

Ovliv¤uje p©¡znaky:            OF, CF

Nedefinovan‚ p©¡znaky:         SF, ZF, CF, AF

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ›¡©ka slova je  32 bit–. N soben¡ ve dvojit‚
                               p©esnosti  je  zaji¨tˆno n soben¡m  EAX  32-
                               bitov˜m pamˆŸov˜m m¡stem/registrem. V˜sledek
                               je 64-bitov˜ a je um¡stˆn v registrov‚m p ru
                               EDX:EAX.

P©¡klad:                       n soben¡ bytu slovem
                               MOV AL,MULT_BTE
                               CBW ; konverze byte v AL do slova v AX
                               MUL VAL_BTE
                               n soben¡ bytu bytem
                               MOV AL,MULTP_BTE
                               MUL VAL_BTE
                               n soben¡ slova slovem
                               MOV AX,MULT_PWRD
                               MUL VAL_WRD ; vy¨¨¡ bity v DX, ni‘¨¡ v AX
                               80386
                               MOV EAX,0FCAB1234H
                               MUL EBX

NEG (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Negace ve dvojkov‚m dopl¤kov‚m k¢du

€asov n¡:                      2-7 (80286),2-6 (80386)





                                  - 93 - 




Popis:                         Instrukce NEG ode‡¡t  operand od  0, p©i‡¡t 
                               k  takto vznikl‚ hodnotˆ 1 a vrac¡  v˜sledek
                               na m¡sto p–vodn¡ho operandu, vytv ©ej¡c  tak
                               dvojkov˜ doplnˆk. P©¡znak CF je  nastaven na
                               1  (s  v˜jimkou  nulov‚ho  operandu,   kter˜
                               zp–sob¡ nastaven¡ CF na 0).

Syntaxe:                       NEG destination

Ovliv¤uje p©¡znaky:            OF, SF, CF, ZF, AF, PF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  V   p©¡padˆ,  ‘e  v˜sledek  je  v   segmentu
                               chr nˆn‚m   proti   z pisu,   je  generov na
                               v¨eobecn  v˜jimka  poru¨en¡  ochrany pamˆti.
                               Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ›¡©ka slova je 32 bit–.

P©¡klad:                       NEG AL
                               NEG EBX (jen pro 80386)

NOP (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Pr zdn  operace

€asov n¡:                      3

Popis:                         Instrukce  nevyvol   ‘ dnou operaci.  Je  to
                               jednobytov    instrukce   modifikuj¡c¡   jen
                               registr IP (EIP).

Syntaxe:                       NOP (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       NOP




                                  - 94 - 




NOT (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Logick  negace

€asov n¡:                      2-7 (80286), 2-6 (80386)

Popis:                         Instrukce  NOT  neguje  ka‘d˜  bit  ve  sv‚m
                               operandu a vrac¡ v˜sledek na  p–vodn¡ m¡sto.
                               ’ dn‚ p©¡znaky nejsou ovlivnˆny.

Syntaxe:                       NOT destination

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  V   p©¡padˆ,  ‘e  v˜sledek  je  v   segmentu
                               chr nˆn‚m   proti   z pisu,   je  generov na
                               v¨eobecn  v˜jimka ochrany. Jestli‘e registry
                               CS,  DS nebo ES obsahuj¡ neplatn‚  efektivn¡
                               adresy  operand–,  je  generov na  v¨eobecn 
                               v˜jimka ochrany pamˆti. Jestli‘e SS obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–

P©¡klad:                       NOT AX
                               NOT EBX ;(jen pro 80386)

OR (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Logick  disjunkce

€asov n¡:                      2-7 (80286), 2-7 (80386)

Popis:                         Instrukce  OR  prov d¡   inkluz¡vn¡  logick˜
                               sou‡et  nad  dvˆma  operandy. Koresponduj¡c¡
                               bitov‚  dvojice  obsahuj¡c¡  oba bity nulov‚
                               vrac¡  hodnotu 0, jinak hodnotu 1.  V˜sledek
                               je ulo‘en v c¡lov‚m operandu.

Syntaxe:                       OR destination,source

Ovliv¤uje p©¡znaky:            CF = 0, OF = 0, SF, ZF, PF

Nedefinovan‚ p©¡znaky:         AF

V˜jimky v PM:                  V   p©¡padˆ,  ‘e  v˜sledek  je  v   segmentu
                               chr nˆn‚m   proti   z pisu,   je  generov na
                               v¨eobecn  v˜jimka  poru¨en¡  ochrany pamˆti.



                                  - 95 - 




                               Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–.

P©¡klad:                       OR CX,DI
                               OR EAX,0FFFF0000H ;(jen pro 80386)
                               OR EBX,ECX ;(jen pro 80386)

OUT (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     V˜stup slova nebo byte

€asov n¡:                      3 (80286), 3-4 (80386)

Popis:                         Obsah st©ada‡e ( AX nebo  AL)  je  vysl n na
                               v˜stupn¡  port.  Jako   v˜stup   lze  pou‘¡t
                               jak˜koliv port 0 a‘ 65535.

Syntaxe:                       OUT port, accumulator

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  je   hodnota   IOPL  (Input/Output
                               Privilege Level-v  registru  p©¡znak–) vy¨¨¡
                               ne‘   aktu ln¡   privilegovan    £rove¤,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany pamˆti.

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–.

P©¡klad:                       OUT WRD_PORT,AX
                               OUT BYT_PORT,AL
                               OUT EDX,EAX ; (jen pro 80386)

OUTS/OUTSB/OUTSW (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     V˜stup bytov‚ho/slovn¡ho ©etˆzce na port

€asov n¡:                      5 (80286), 7 (80386)






                                  - 96 - 




Popis:                         Instrukce  OUT  p©esouv   bytov˜ nebo slovn¡
                               ©etˆzec  adresovan˜  v  pamˆti DS:SI na port
                               specifikovan˜  adresou  v  DX. Druh˜ operand
                               instrukce  OUT  ur‡uje  typ p©esouvan˜ch dat
                               (slova   nebo   byty).   SI  je  automaticky
                               inkrementov n o 1 p©i DF=0; p©i DF = 1 je SI
                               dekrementov n o 1. P©¡r–stek je 1 pro bytov‚
                               a 2 pro slovn¡ operandy.

Syntaxe:                       OUTS port,source_string
                               OUTSB (‘ dn‚ operandy)
                               OUTSW (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e je hodnota  CPL  (Current Privilege
                               Level)   vˆt¨¡   nebo   rovn   hodnotˆ  IOPL
                               (Input/Output    Privilege     Level),    je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany  pamˆti.  Tato   v˜jimka   m–‘e  b˜t
                               generov na tak‚ v p©¡padˆ, ‘e CS, DS nebo ES
                               obsahuje    neplatnou    efektivn¡    adresu
                               operandu.  Jestli‘e   segment   CS  obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32  bit–.  Adresy  operand– v
                               pamˆti jsou vytv ©eny ze 32-bitov‚ efektivn¡
                               adresy. ›estn ctibitov  ‡ st adresy je br na
                               z  registru  DX.   32-   bitov   specifikace
                               neovlivn¡ adresu I/O portu. D‚lka ©etˆzce je
                               br na z registru ECX.

P©¡klad:                       OUTS DX,BYT_WRD
                               OUTS DX,WRD_STRNG
                               OUTSB
                               OUTSW

POP (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Vyzvedni operand ze z sobn¡ku

€asov n¡:                      5 (80286), 5-7 (80386)

Popis:                         Instrukce   POP   vyzved v    obsah  vrcholu
                               z sobn¡ku a ukl d  jej do DS, ES, SS, pamˆti
                               nebo  registru.  Instrukce POP  vezme  slovo
                               adresovan‚   registrem   SP    (=   ukazatel
                               z sobn¡ku)    a    ulo‘¡    jej   na   m¡sto




                                  - 97 - 




                               specifikovan‚  c¡lov˜m operandem  instrukce.
                               Ukazatel z sobn¡ku je pak zv˜¨en o 2.

Syntaxe:                       POP destination

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Je-li  ze  z sobn¡ku  zav dˆna  hodnota   do
                               segmentov‚ho    registru,   je    generov na
                               v¨eobecn  v˜jimka  poru¨en¡  ochrany pamˆti,
                               v˜jimka  "chyba   z sobn¡ku"   nebo  v˜jimka
                               "deskriptor   nenalezen".   V˜jimka   "chyba
                               z sobn¡ku" je generov na tak‚ v  p©¡padˆ, ‘e
                               aktu ln¡  vrchol  z sobn¡ku nen¡  um¡stˆn  v
                               rozsahu  pr vˆ  adresovan‚ho   segmentu  SS.
                               Stejnou v˜jimku bude generovat tak‚ um¡stˆn¡
                               operandu  instrukce  v   segmentu  chr nˆn‚m
                               proti z pisu. Jestli‘e registry CS,  DS nebo
                               ES   obsahuj¡   neplatn‚   efektivn¡  adresy
                               operand–,  je  generov na  v¨eobecn  v˜jimka
                               poru¨en¡   ochrany   pamˆti.   Jestli‘e   SS
                               obsahuje  neplatnou  adresu,  je  generov na
                               v˜jimka "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32  bit–.  Adresy  operand– v
                               pamˆti   jsou   vytv ©eny    z   32-bitov˜ch
                               efektivn¡ch adres.

P©¡klad:                       Registrov˜ operand
                               POP CX
                               POP EAX (jen pro 80386)
                               Segmentov˜ registr
                               POP SS

POPA (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Vyzvedni v¨echny v¨eobecn‚ registry

€asov n¡:                      19 (80286), 24 (80386)

Popis:                         Instrukce  POPA  vyzved v   obsah v¨ech osmi
                               ¨estn ctibitov˜ch registr– (DI, SI, BP,  SP,
                               BX, DX, CX,  AX)  (resp. dvaat©icetibitov˜ch
                               EDI,  ESI,  EBP, ESP, EBX,  EDX,  ECX,  EAX)
                               kromˆ SP (resp.  ESP). Hodnota SP (ESP) nen¡
                               obnovov na.  Instrukce  POPA  je  du ln¡   k
                               instrukci  PUSHA,  kter   v¨echny  v¨eobecn‚
                               registry   ukl d    na    z sobn¡k.   Prvn¡m
                               registrem, kter˜ instrukce POPA vyzved v  ze
                               z sobn¡ku, je DI (EDI).



                                  - 98 - 




Syntaxe:                       POPA (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e nen¡ vrchol z sobn¡ku uvnit© hranic
                               segmentu  SS,  je  generov na v˜jimka "chyba
                               z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–.

P©¡klad:                       POPA

POPF (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Vyzvednut¡ obsahy p©¡znakov˜ch registr–

€asov n¡:                      5

Popis:                         Instrukce  POPF  pou‘¡v   regitrovou dvojici
                               SS:SP   k   referenci   vrcholu   z sobn¡ku.
                               Instrukce POPF pak kop¡ruje vrchol z sobn¡ku
                               do   registru   p©¡znak–.   SP   (ESP)    je
                               automaticky inkrementov n o 2. P©¡znaky jsou
                               v   takto    z¡skan‚m    registru   p©¡znak–
                               definov ny n sledovnˆ (od bitu 15 k bitu 0):
                               Nedefinov no,  Nested  Task,  I/O  Privilege
                               Level  (dva   bity),   Overflow,  Direction,
                               Interrupt   Enabled,   Trap,   Sign,   Zero,
                               Nedefinov no, Auxiliary Carry, Nedefinov no,
                               Parity, Nedefinov no a Carry.

Syntaxe:                       POPF (‘ dn‚ operandy)
Ovliv¤uje p©¡znaky:            Cel˜  registr  p©¡znak–   je   vyzvednut  ze
                               z sobn¡ku.

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  je  vrchol  z sobn¡ku mimo hranice
                               segmentu  SS,  je  generov na v˜jimka "chyba
                               z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–.

P©¡klad:                       POPF






                                  - 99 - 




PUSH (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Ulo‘ slovo na vrchol z sobn¡ku

€asov n¡:                      3-5 (80286), 2-5 (80386)

Popis:                         Instrukce  PUSH  sni‘uje  hodnotu  ukazatele
                               z sobn¡ku SP (ESP) o  2  a  jej¡  operand je
                               um¡stˆn  na  nov˜  vrchol  z sobn¡ku.  Je-li
                               ukl d na  hodnota registru SP (ESP), pak  ji
                               instrukce  PUSH   u   procesoru  80286/80386
                               ukl d   takovou,  jak   byla p©ed proveden¡m
                               instrukce PUSH (na rozd¡l  od  PUSH  u 8086,
                               kde    byla     uchov v na     hodnota    SP
                               dekrementovan     o    2).    Ukl dat    lze
                               ES,CS,SS,DS,  pamˆŸov‚ m¡sto,  bezprost©edn¡
                               operand ‡i registr.

Syntaxe:                       PUSH source

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  je  nov   hodnota  SP  vnˆ  limitu
                               segmentu  SS,  je  generov na v˜jimka "chyba
                               z sobn¡ku". Jestli‘e registry CS,DS nebo  ES
                               obsahuj¡ neplatn‚ efektivn¡ adresy operand–,
                               je  generov na  v¨eobecn   v˜jimka  poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–. PamˆŸov‚ adresy jsou
                               vytv ©eny z 32-bitov˜ch efektivn¡ch adres.

P©¡klad:                       PUSH AX
                               PUSH EBX ;(jen pro 80386)
                               PUSH CS

PUSHA (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Ulo‘ do z sobn¡ku v¨echny v¨eobecn‚ registry

€asov n¡:                      17 (80286), 18 (80386)

Popis:                         Ukl d    registry   AX,CX,DX,BX   a  p–vodn¡
                               SP,BP,SI,DI (resp. EAX,ECX,EDX,EBX a p–vodn¡
                               ESP,EBP,ESI,EDI)  do  z sobn¡ku,  v uveden‚m
                               po©ad¡. Ukazatel z sobn¡ku  je dekrementov n
                               o 16 (je ukl d no 8 dvoubytov˜ch hodnot).



                                  - 100 - 




Syntaxe:                       PUSHA (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Je  generov na  v˜jimka  "chyba z sobn¡ku" v
                               p©¡padˆ,  ‘e po‡ te‡n¡ ‡i kone‡n  adresa  je
                               vnˆ rozsahu segmentu SS.

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–.

P©¡klad:                       PUSHA

PUSHF (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Ulo‘ registr p©¡znak– na z sobn¡k

€asov n¡:                      3 (80286), 4 (80386)

Popis:                         Instrukce  PUSHF  dekrementuje   registr  SP
                               (ESP)  o  2  a  kop¡ruje registr p©¡znak– (=
                               v¨echny p©¡znakov‚ registry) do specifick˜ch
                               bit–    slovn¡ho    operandu    adresovan‚ho
                               registrem  SP   (ESP).   N sleduj¡c¡  seznam
                               definuje po©ad¡ p©¡znak–  po‡¡naje nejvy¨¨¡m
                               (15.) bitem  a  kon‡e  nejni‘¨¡m  (0.) bitem
                               onoho   slovn¡ho   operandu:   Nedefinov no,
                               Nested Task,I/O Privilege Level (dva  bity),
                               Overflow,   Direction,  Interrupt   Enabled,
                               Trap,  Sign,  Zero,  Nedefinov no, Auxiliary
                               Carry, Nedefinov no, Parity,  Nedefinov no a
                               Carry.

Syntaxe:                       PUSHF (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Je  generov na  v˜jimka  "chyba z sobn¡ku" v
                               p©¡padˆ,  ‘e po‡ te‡n¡ ‡i kone‡n  adresa  je
                               vnˆ rozsahu segmentu SS.

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            Instrukce ukl d  32-bitov˜ roz¨¡©en˜ registr
                               p©¡znak–.

P©¡klad:                       PUSHF




                                  - 101 - 




RCL/RCR/ROL/ROR (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Instrukce rotac¡

€asov n¡:                      2-5 (80286), 3-10 (80386)

Popis:                         Ka‘d  z uveden˜ch  instrukc¡  rotac¡ posouv 
                               specifick‚ bity registrov‚ho nebo pamˆŸov‚ho
                               operandu.  Instrukce  ROL  posunuje (rotuje)
                               v¨echny  bity  operandu  doleva  o   1  bit,
                               p©i‡em‘  bit  MSB  (nejvy¨¨¡) se p©esouv  na
                               m¡sto LSB (nejni‘¨¡). Instrukce ROR  prov d¡
                               posuv (rotaci) p©esnˆ opa‡nˆ -  v¨echny bity
                               se posunou  o 1 m¡sto doprava a na m¡sto MSB
                               se  p©esune  bit LSB. Instrukce  RCL  a  RCR
                               u‘¡vaj¡  hodnotu  p©¡znaku   CF   jako  ‡ st
                               p©esouvan‚ veli‡iny. Instrukce  RCL p©esouv 
                               CF do LSB a MSB do CF. Instrukce RCR prov d¡
                               p©esnˆ opa‡n˜ p©esun: CF do MSB a LSB do CF.
                               Druh˜ operand  instrukc¡  rotac¡ specifikuje
                               po‡et pozic, o  kter‚ se m  zdrojov˜ operand
                               posunout. P©¡znak p©ete‡en¡  OF  je nastaven
                               jen  v  p©¡padˆ, ‘e u  instrukc¡  rotac¡  je
                               druh˜ operand roven  1.  U  RCR  je  test na
                               p©ete‡en¡ prov dˆn p©ed rotac¡, pro RCL, ROL
                               a ROR po rotaci. P©¡znak OF je  nastavov n v
                               tˆchto situac¡ch:  pokud  CF  =  MSB, nastav
                               OF:=0; pokud CF<>MSB, nastav OF := 1.

Pozn mka:                      Obvod 80286/80386 neumo‘¤uje prov dˆt rotace
                               o v¡ce ne‘ 31 bit–. Je pou‘ito jen ni‘¨¡ch 5
                               bit– ‡¡ta‡e po‡tu rotac¡ i v p©¡padˆ,  ‘e je
                               snaha o proveden¡ rotace o v¡ce ne‘ 31 bit–.

Syntaxe:                       RCL destination
                               RCL destination,CL
                               RCL destination,count
                               RCR destination
                               RCR destination,CL
                               RCR destination,count
                               ROL destination
                               ROL destination,CL
                               ROL destination,count
                               ROR destination
                               ROR destination,CL
                               ROR destination,count

Ovliv¤uje p©¡znaky:            OF (jen pro rotaci o 1 bit),CF

Nedefinovan‚ p©¡znaky:         OF pro v¡cebitov‚ rotace

V˜jimky v PM:                  Jestli‘e  registry  CS,DS nebo  ES  obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje



                                  - 102 - 




                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku". Jestli‘e je m¡sto  ur‡en¡
                               v   segmentu    nep©¡stupn‚m    z pisu,   je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany pamˆti.

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ›¡©ka slova je 32 bit–.

P©¡klad:                       RCL AH,1
                               RCL MEMRY_BTE,REP_VAL
                               RCL DH,CL
                               RCR BL,1
                               RCR TABLE[BX][DI],CL
                               ROL CX,1
                               ROL AX,CL
                               ROR BL,1
                               ROR MEMRY_BTE,REP_VAL
                               ROR TABLE[DX][DI],CL

REP/REPZ/REPE/PEPNE/REPNZ (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Opakuj ©etˆzcovou operaci

€asov n¡:                      5+9xN, kde N je po‡et iterac¡

Popis:                         REP, REPE  a  REPNE  jsou  prefixov‚ operace
                               kter‚  zp–sobuj¡,  ‘e primitivn¡  operace  s
                               ©etˆzci zapsan  jako operand tˆchto  operac¡
                               bude prov dˆna opakovanˆ  tak  dlouho, dokud
                               nebude registr CX roven nule.  Pro instrukce
                               SCAS a CMPS repetice kon‡¡ v p©¡padˆ,  ‘e po
                               opakov n¡ instrukce za  prefixem  se p©¡znak
                               ZF li¨¡ od "z"-bitu prefixu.

Syntaxe:                       REP
                               REPE
                               REPNE

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–

P©¡klad:                       LEA DI,VALUE1 ; p©iprav c¡lov˜ ©etˆzec
                               LEA SI,VALUE2 ; p©prav zdrojov˜ ©etˆzec
                               REPE CMPSB ; opakuj, pokud jsou si ve
                               ; srovn n¡ byte-po-byte rovny



                                  - 103 - 




RET (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     N vrat z procedury

€asov n¡:                      15-55 (80286), 10-68 (80386)

Popis:                         Instrukce  zabezpe‡uje pokra‡ov n¡  programu
                               t¡m, ‘e  p©enese  ©¡zen¡  progamu  na adresu
                               n vratu, kter  byla  (p©i  vol n¡ procedury)
                               ulo‘ena do z sobn¡ku. Tato adresa je obvykle
                               um¡stˆna   do   z sobn¡ku   instrukc¡  CALL.
                               Intrasegmentov‚  (NEAR)  n vraty   RET  pln¡
                               registr   instrukce  (instruction   pointer)
                               dvˆma  nejhornˆj¨¡mi   byty   um¡stˆn˜mi  na
                               vrcholu  z sobn¡ku.  Tyto dva  byty  ud vaj¡
                               offset  instrukce,  kter   m  b˜t vykon v na
                               jako  dal¨¡.  Intersegmentov‚  (FAR) n vraty
                               RET  za‡¡naj¡  stejnˆ  jako  intrasegmentov‚
                               p©enesen¡m  horn¡ch  dvou  byte ze z sobn¡ku
                               (t.j. offset  p©¡¨t¡  vykon van‚ instrukce).
                               Jako  dal¨¡ akce je v¨ak provedeno  naplnˆn¡
                               registru CS dal¨¡mi dvˆma byte ze z sobn¡ku.
                               Tyto   dal¨¡   dva  byte   obsahuj¡   adresu
                               segmentu,  v  nˆm‘  le‘¡  p©¡¨t¡  vykon van 
                               instrukce.

                               Abychom provedli intrasegmentov˜  n vrat RET
                               a zmˆnili ukazatele z sobn¡ku, je tedy t©eba
                               zav‚st  horn¡  dva  byte  ze   z sobn¡ku  do
                               registru  instrukce.  Pak  je  t©eba  zav‚st
                               dal¨¡ dva  byte  ze  z sobn¡ku  do ukazatele
                               z sobn¡ku (stack pointer). Tyto posledn¡ dva
                               byte znovu nastav¡ posledn¡ obsah  ukazatele
                               z sobn¡ku, jen‘ mohl p©¡padnˆ b˜t  ulo‘en na
                               vrchol z sobn¡ku p©ed instrukc¡ CALL.
                               Abychom provedli intersegmentov˜  n vrat RET
                               a zmˆnili ukazatele z sobn¡ku, je t©eba opˆt
                               zav‚st  horn¡  dva  byte  ze   z sobn¡ku  do
                               registru.  To  je offset  p©¡¨t¡  vykon van‚
                               instrukce. Dal¨¡ dva byte jsou  ze z sobn¡ku
                               zavedeny   do  registr  CS.  To  je   adresa
                               segmentu,  v  nˆm‘  le‘¡  p©¡¨t¡  vykon van 
                               instrukce.  Dal¨¡  dva  byte ze z sobn¡ku se
                               mus¡  ulo‘it  do   ukazatele   z sobn¡ku  ze
                               stejn˜ch pohnutek jako  p©i intrasegmentov‚m
                               n vratu.

Syntaxe:                       RET (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚






                                  - 104 - 




V˜jimky v PM:                  V   nˆkter˜ch   p©¡padech    je   generov na
                               v¨eobecn  v˜jimka  poru¨en¡  ochrany pamˆti,
                               v˜jimka  "deskriptor  nen¡   p©¡tomen"  nebo
                               v˜jimka "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            Je  pou‘¡v n  32-bitov˜  roz¨¡©en˜  ukazatel
                               instrukce.  Ze  z sobn¡ku  je vyzved v n 32-
                               bitov˜ EIP.

P©¡klad:                       RET

SAHF (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Ulo‘ registr AH do p©¡znak–

€asov n¡:                      2 (80286), 3 (80386)

Popis:                         Instrukce      SAHF       pln¡      p©¡znaky
                               SF,ZF,xx,AF,xx,PF,xx,CF            hodnotami
                               odpov¡daj¡c¡ch bit– registru  AH  (tedy bity
                               7,6,4,2
a 0).

Syntaxe:                       SAHF (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            SF, ZF, AF, PF, CF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       SAHF

SAL/SAR/SHL/SHR (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Skupina     instrukc¡      posun–     (shift
                               instructions)

€asov n¡:                      2-5 (80286), 3-7 (80386)

Popis:                         Instrukce SAL nebo SHL posouv  bity operandu
                               specifikovan‚ho  v   instrukci   doleva.  To
                               zp–sobuje, ‘e MSB je p©esunut do CF a LSB je
                               nulov n. Instrukce SAR nebo SHR posouv  bity
                               sv‚ho operandu doprava. Pak je  LSB p©esunut
                               do  CF.  Instrukce  SAR  prov d¡   dˆlen¡  s
                               uva‘ov n¡m   znam‚nka:   MSB    se   nemˆn¡.



                                  - 105 - 




                               Instrukce  SHR prov d¡ dˆlen¡ bez ohledu  na
                               znam‚nko: MSB je nulov n. Posuv  je opakov n
                               tolikr t,   kolik   ‡in¡   hodnota   druh‚ho
                               operandu instrukc¡  posuvu.  T¡mto operandem
                               m–‘e b˜t jak p©¡m˜  operand,  tak  i registr
                               CL.  Mikroprocesory  80286/80386  nepovoluj¡
                               posuny del¨¡ ne‘ 31. Je-li  p©esto po‘adov n
                               posuv del¨¡ ne‘ 31  bit–,  je  uva‘ov no jen
                               doln¡ch  pˆt  bit–  operandu specifikuj¡c¡ho
                               d‚lku posunu. P©¡znak OF  je  nastaven  do 1
                               jen p©i  posunu o 1 bit. Pro posun doleva je
                               nulov n v p©¡padˆ, ‘e  bit  MSB  v˜sledku je
                               stejn˜   jako  v˜sledn˜  CF:  jinak  je   OF
                               nastaven na 1. U instrukce SAR je p©i posuvu
                               o 1 bit  OF  nastaven  do  0.  Instrukce SHR
                               nastavuje  p©¡znak  OF  na hodnotu stejnou s
                               hodnotou MSB p–vodn¡ho  operandu  (t.j. p©ed
                               proveden¡m posuvu).

Syntaxe:                       SAL destination,count
                               SAL destination,1
                               SAL destination,CL
                               SHL destination,count
                               SHL destination,1
                               SHL destination,CL

Ovliv¤uje p©¡znaky:            OF (jen p©i posuvu o 1 bit),CF, AF, OF, PF a
                               SF.

Nedefinovan‚ p©¡znaky:         AF

V˜jimky v PM:                  Jestli‘e  registry  CS,DS nebo  ES  obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku". Jestli‘e je m¡sto  ur‡en¡
                               v   segmentu    nep©¡stupn‚m    z pisu,   je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany pamˆti.

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ›¡©ka slova je 32 bit–.

P©¡klad:                       SHL MEMRY_BTE,1
                               SHL AX,CL
                               SHL TABLE[BX][DI],CL
                               SAR BL,1
                               SAR MEMRY_BTE,REP_VAL
                               SAR DH,CL
                               SAR CX,1
                               SAR MEMRY_BTE,1
                               SAR AX,CL




                                  - 106 - 




SBB (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Ode‡¡t n¡ s v˜p–j‡kou

€asov n¡:                      2-3 (80286), 2-7 (80386)

Popis:                         Instrukce  SBB  p©i‡¡t    druh˜   operand  k
                               p©¡znaku  CF a tento v˜sledek je ode‡ten  od
                               prvn¡ho  operandu.  V˜sledek  je  uchov n  v
                               prvn¡m operandu.

Syntaxe:                       SBB destination,source

Ovliv¤uje p©¡znaky:            OF, SF, ZF, PF, CF, AF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku". Jestli‘e je m¡sto  ur‡en¡
                               v   segmentu    nep©¡stupn‚m    z pisu,   je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany pamˆti.

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ›¡©ka slova je 32 bit–.

P©¡klad:                       SBB AX,BX
                               SBB DX,MEMRY_WRD
                               SBB TABLE[BX][DI],SI
                               SBB AL,3
                               SBB EAX,EBX ; jen pro 80386
                               SBB ECX,0ABCD1234H ; jen pro 80386

SCAS/SCASB/SCASW (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Porovn n¡ ©etˆzcov˜ch dat

€asov n¡:                      7

Popis:                         Srovn v  byte(AL), slovo(AX) s ES:[DI]  nebo
                               s ES:[EDI]. Instrukce SCAS ode‡¡t   pamˆŸov˜
                               byte nebo slovn¡ operand adresovan˜  ES:[DI]
                               (ES:[EDI])  buƒ  od  registru  AL  nebo  AX.
                               V˜sledek je ignorov n a jsou nastavov ny jen
                               p©¡slu¨n‚  p©¡znaky.  Operand  v pamˆti mus¡
                               b˜t  adresov n registrem ES. Po srovn n¡  je
                               DI (EDI) inkrementov n p©i DF=0; jinak je DI




                                  - 107 - 




                               (EDI) dekrementov n.  Inkrement/dekrement je
                               1 pro bytov˜ a 2 pro slovn¡ operand.

Syntaxe:                       SCAS destination,source
                               SCASB (‘ dn‚ operandy)
                               SCASW (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            OF, SF, ZF, PF, CF, AF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ›¡©ka slova je 32 bit–.

P©¡klad:                       MOV CL,10H   ; srovn n¡ 16 byte
                               LEA DI,VALUE1; um¡stˆn¡ ©etˆzce
                               MOV AL,'S'   ; hledan˜ znak
                               REPNE SCASB  ; dokud nen¡ nalezen,
                                            ; prohl¡‘ej dal¨¡ byty

SGDT/SIDT (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Uschovej registr GDT/IDT do pamˆti

€asov n¡:                      11 (80286), 9 (80386)

Popis:                         Instrukce SGDT i SIDT zav d¡  obsah registru
                               tabulky  deskriptor–  do   ¨esti  pamˆŸov˜ch
                               byt–,  na  nˆ‘  ukazuje c¡lov˜ operand. Pole
                               LIMIT  tohoto registru je um¡stˆno v  prvn¡m
                               slovˆ;  dal¨¡  t©i  byte jsou naplnˆny polem
                               BASE  a   posledn¡   ze   ¨estice   byt–  je
                               nedefinov n.

Syntaxe:                       SGDT destination
                               SIDT destination

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Je-li   c¡lov˜    operand    registrem,   je
                               generov na  v˜jimka  "nedefinovan˜  opera‡n¡
                               k¢d".  Jestli‘e  registry  CS,  DS  nebo  ES
                               obsahuj¡ neplatn‚ efektivn¡ adresy operand–,
                               je  generov na  v¨eobecn   v˜jimka  poru¨en¡



                                  - 108 - 




                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Je-li   c¡lov˜    operand    registrem,   je
                               generov na  v˜jimka  "nedefinovan˜  opera‡n¡
                               k¢d". Jestli‘e je slovn¡ operand  na offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            -

P©¡klad:                       SGDT MEM_WRD
                               SIDT MEM_WRD

SLDT (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Uchovej     registr    tabulky     lok ln¡ch
                               deskriptor–

€asov n¡:                      2

Popis:                         Instrukce  SLDT  m  jako  operand  efektivn¡
                               adresu  ukazuj¡c¡  buƒ na  2-bytov˜  registr
                               nebo  pamˆŸov‚  m¡sto  a  uchov  v nˆm obsah
                               tabulky lok ln¡ch deskriptor–.

Syntaxe:                       SLDT destination

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku". Jestli‘e je m¡sto  ur‡en¡
                               v   segmentu    nep©¡stupn‚m    z pisu,   je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany pamˆti.

V˜jimky v RM:                  Je generov no INT 6 - instrukce SLDT  nen¡ v
                               RM rozpozn na.

Pozn mka pro 80386:            -

P©¡klad:                       SLDT BP

SMSW (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Uchovej stavov‚ slovo procesoru (MSW)

€asov n¡:                      2



                                  - 109 - 




Popis:                         C¡lov˜ operand  (efektivn¡  adresa, 2-bytov˜
                               registr  nebo  pamˆŸov‚  m¡sto) obdr‘¡ kopii
                               stavov‚ho slova procesoru MSW.

Syntaxe:                       SMSW destination

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku". Jestli‘e je m¡sto  ur‡en¡
                               v   segmentu    nep©¡stupn‚m    z pisu,   je
                               generov na rovnˆ‘ v¨eobecn   v˜jimka ochrany
                               pamˆti.

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            -

P©¡klad:                       SMSW BP

STC (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Nastav p©¡znak p©enosu (CF)

€asov n¡:                      2

Popis:                         Instrukce  STC  nastavuje   p©¡znak   CF  do
                               hodnoty 1.

Syntaxe:                       STC (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            CF = 1

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       STC


STD (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Nastav p©¡znak DF



                                  - 110 - 




€asov n¡:                      2

Popis:                         Instrukce  STD  nastavuje   p©¡znak   DF  do
                               hodnoty  1.  To m  za  n sledek,  ‘e  p©¡¨t¡
                               instrukce pracuj¡c¡ s ©etˆzci bude  sni‘ovat
                               obsah registru SI a/nebo DI.

Syntaxe:                       STD (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            DF = 1

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       STD

STI (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Nastav p©¡znak p©eru¨en¡ (IF)

€asov n¡:                      2 (80286), 3 (80386)

Popis:                         Instrukce STI nastavuje  IF = 1. To umo‘¤uje
                               zpracovat maskovateln  extern¡  p©eru¨en¡ po
                               vykon n¡ p©¡¨t¡ instrukce.

Syntaxe:                       STI (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            IF = 1

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  je  aktu ln¡  privilegovan  £rove¤
                               ni‘¨¡  ne‘  I/O  privilegovan   £rove¤,   je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany pamˆti.

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       STI

STOS/STOSB/STOSW (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Uschovej ©etˆzcov  data

€asov n¡:                      3 (80286), 4 (80386)




                                  - 111 - 




Popis:                         Instrukce STOS p©esouv  obsah buƒ AL nebo AX
                               na byte nebo slovo v pamˆti. Tato  lokace je
                               adresov na  ES:DI  (resp.   ES:EDI).  C¡lov˜
                               operand  mus¡  b˜t  adresovateln˜ z registru
                               ES.   Registr   DI  (EDI)   je   automaticky
                               inkrementov n/dekrementov n p©i DF = 0/DF  =
                               1.  Inkrement/dekrement  je  1  pro   bytov‚
                               p©esuny a 2 pro slovn¡ p©esuny.

Syntaxe:                       STOS destination_string
                               STOSB (‘ dn‚ operandy)
                               STOSW (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na v¨eobecn  v˜jimka ochrany pamˆti.
                               Jestli‘e  SS  obsahuje  neplatnou adresu, je
                               generov na   v˜jimka    "chyba   z sobn¡ku".
                               Jestli‘e   je   m¡sto  ur‡en¡   v   segmentu
                               nep©¡stupn‚m z pisu, je generov na v¨eobecn 
                               v˜jimka ochrany.

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–

P©¡klad:                       MOV ECX, 0FFCCAAH ; jen pro 80386
                               LEA EDI, VARIABLE
                               MOV AX,'-'
                               REP STOSB

STR (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Uschovej registr £lohy (task register)

€asov n¡:                      2 (80286), 23-27 (80386)

Popis:                         Instrukce  STR  zp–sob¡, ‘e  obsah  registru
                               £lohy  je  kop¡rov n  do 2-bytov‚ho registru
                               nebo pamˆŸov‚ho m¡sta,  kter‚  je adresov no
                               c¡lov˜m operandem.

Syntaxe:                       STR destination

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚






                                  - 112 - 




V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku". Jestli‘e je m¡sto  ur‡en¡
                               v   segmentu    nep©¡stupn‚m    z pisu,   je
                               generov na rovnˆ‘ v¨eobecn  v˜jimka poru¨en¡
                               ochrany pamˆti.

V˜jimky v RM:                  Je generov no INT 6 - instrukce SLDT  nen¡ v
                               RM rozpozn na.

Pozn mka pro 80386:            -

P©¡klad:                       STR BP

SUB (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Celo‡¡seln‚ ode‡¡t n¡

€asov n¡:                      2-7

Popis:                         Instrukce  SUB  ode‡te zdrojov˜  operand  od
                               c¡lov‚ho.  V˜sledek  je  ulo‘en  v   c¡lov‚m
                               operandu.

Syntaxe:                       SUB destination,source

Ovliv¤uje p©¡znaky:            OF, SF, ZF, PF, AF, CF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku". Jestli‘e je m¡sto  ur‡en¡
                               v   segmentu    nep©¡stupn‚m    z pisu,   je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany pamˆti.

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–

P©¡klad:                       SUB AX, BX
                               SUB EAX,EDX ; jen pro 80386
                               SUB DX, MEMRY_WRD
                               SUB MEMRY_WRD,AX
                               SUB MEM_BTE,7
                               SUB NUMBER,0FC991576H ; jen pro 80386




                                  - 113 - 




TEST (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Test - logick‚ srovn n¡

€asov n¡:                      2-6 (80386), 2-5 (80386)

Popis:                         Instrukce TEST prov d¡  logick‚  AND bit-po-
                               bitu nad dvˆma operandy. Ka‘d˜  bit v˜sledku
                               je nastaven  do  1  p©i  jedni‡kov˜ch bitech
                               obou  srovn van˜ch  operand–; jinak  je  bit
                               v˜sledku nastaven do  0.  V˜sledek instrukce
                               nen¡ pou‘it, jsou jen nastaveny odpov¡daj¡c¡
                               p©¡znaky.

Syntaxe:                       TEST destination, source

Ovliv¤uje p©¡znaky:            OF = 0, CF = 0, SF, ZF, PF

Nedefinovan‚ p©¡znaky:         AF

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   na  offsetu
                               0FFFFH, je generov no p©eru¨en¡ INT 13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–

P©¡klad:                       TEST AX,BX
                               TEST EAX,EBX ; jen pro 80386
                               TEST MEM_BTE,6
                               TEST TABLE[BX][DI],CX
                               TEST TABLE[BX][DI],ECX ; jen pro 80386

VERR/VERW (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Verifikuj segment pro ‡ten¡ nebo z pis

€asov n¡:                      14-16 (80286), 10-16 (80386)

Popis:                         Instrukce VERR a VERW zji¨Ÿuj¡,  zda segment
                               adresovan˜    2-bytov˜m    registrem    nebo
                               pamˆŸov˜m selektorem m–‘e b˜t dosa‘iteln˜  z
                               aktu ln¡  privilegovan‚   £rovnˆ.  Instrukce
                               tak‚ zji¨Ÿuje,  zda  segment  m–‘e  b˜t ‡ten
                               nebo zda je do  nˆj  mo‘n‚  zapisovat. Je-li
                               segment  p©¡stupn˜, je  ZF  nastaven  na  1;
                               jinak je ZF nulov n.

Syntaxe:                       VERR destination_readable_selector



                                  - 114 - 




                               VERW destination_writable_selector

Ovliv¤uje p©¡znaky:            ZF

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Je  generov no  p©eru¨en¡  INT 6 - instrukce
                               VERR/VERW nen¡ v RM rozpozn na.

Pozn mka pro 80386:            -

P©¡klad:                       VERR BP
                               VERW SELECTR

WAIT (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     €ek n¡ na v˜skyt extern¡ho p©eru¨en¡

€asov n¡:                      3 (80286), 6 (80386) - minim lnˆ

Popis:                         Instrukce WAIT zp–sob¡, ‘e 80286/80386 ‡ek ,
                               dokud  se   nevyskytne   extern¡  p©eru¨en¡.
                               Procesor  z–st v    inaktivn¡,   dokud  nen¡
                               aktivov n vstup TEST. Instrukci lze pou‘¡t k
                               synchronizaci   extern¡ch  za©¡zen¡   (nap©.
                               koprocesoru).

Syntaxe:                       WAIT (‘ dn‚ operandy)

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

Pozn mka pro 80386:            -

P©¡klad:                       WAIT

XCHG (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Z mˆna byt– nebo slov

€asov n¡:                      3-5




                                  - 115 - 




Popis:                         Instrukce XCHG zamˆ¤uje  bytov˜  nebo slovn¡
                               zdrojov˜  operand  s  odpov¡daj¡c¡m  c¡lov˜m
                               operandem.

Syntaxe:                       XCHG destination,source

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e    operand    le‘¡    v    segmentu
                               nep©¡stupn‚m z pisu, je generov na v¨eobecn 
                               v˜jimka  poru¨en¡  ochrany  pamˆti. Jestli‘e
                               registry  CS,  DS  nebo ES obsahuj¡ neplatn‚
                               efektivn¡  adresy  operand–,  je  generov na
                               v¨eobecn  v˜jimka  poru¨en¡  ochrany pamˆti.
                               Jestli‘e  SS  obsahuje  neplatnou adresu, je
                               generov na v˜jimka "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   um¡stˆn  na
                               offsetu 0FFFFH, je generov no p©eru¨en¡  INT
                               13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–

P©¡klad:                       XCHG AX,BX
                               XCHG DH,DATA_BTE
                               XCHG AL,DL
                               XCHG EAX,EBX ; jen pro 80386

Pozn mka:                      P©i u‘it¡ instrukce XCHG s prefixem LOCK lze
                               efektnˆ implementovat  semafory  pro obsluhu
                               sd¡len˜ch zdroj– v opera‡n¡m syst‚mu.

XLAT (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     P©evod podle p©evodn¡ tabulky

€asov n¡:                      5

Popis:                         Instrukce  XLAT prov d¡ translaci byte v  AL
                               pomoc¡  p©evodn¡  tabulky   (lookup  table).
                               Ukazatel na 256 bytovou p©evodn¡  tabulku je
                               zaveden do BX.  Byte, kter˜ m  b˜t p©eveden,
                               je  um¡stˆn  v  AL:  slou‘¡  jako  index  do
                               p©evodn¡  tabulky.  Po  proveden¡  instrukce
                               XLAT  je  byte v AL  nahrazen  bytem,  kter˜
                               odpov¡d  bytu vzd len‚mu AL-byt– od  za‡ tku
                               p©evodn¡ tabulky.

Syntaxe:                       XLAT translation_table

Ovliv¤uje p©¡znaky:            ‘ dn‚

Nedefinovan‚ p©¡znaky:         ‘ dn‚



                                  - 116 - 




V˜jimky v PM:                  Jestli‘e  registry  CS,  DS nebo ES obsahuj¡
                               neplatn‚  efektivn¡   adresy   operand–,  je
                               generov na   v¨eobecn     v˜jimka   poru¨en¡
                               ochrany   pamˆti.   Jestli‘e   SS   obsahuje
                               neplatnou  adresu,  je   generov na  v˜jimka
                               "chyba z sobn¡ku".

V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   um¡stˆn  na
                               offsetu 0FFFFH, je generov no p©eru¨en¡  INT
                               13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–

P©¡klad:                       LEA BX,MYTABLE ; um¡stˆn¡ tabulky
                               MOV AL,INDEX ; offset do tabulky
                               XLAT  MYTABLE ; hodnota z tabulky vr cena  v
                               AL

Pozn mka:                      D‚lka  transla‡n¡  tabulky  m–‘e b˜t i men¨¡
                               ne‘ 256 byt–.  Operand  translation_table je
                               nepovinn˜, proto‘e registr BX mus¡  b˜t p©ed
                               proveden¡m  instrukce  XLAT  stejnˆ  naplnˆn
                               ukazatelem na tabulku.

XOR (80286/80386)
---------------------------------------------------------------------------

Instrukce:                     Logick˜ exkluz¡vn¡ sou‡et XOR

€asov n¡:                      2-3 (80286), 2-7 (80386)

Popis:                         Instrukce XOR srovn v  ka‘d˜ bit  zdrojov‚ho
                               operandu  s  c¡lov˜m  a prov d¡ "bitov˜" XOR
                               (nonekvivalence). V˜sledek obsahuje  nuly na
                               tˆch  bitov˜ch  pozic¡ch,  kde m  zdrojov˜ i
                               c¡lov˜ operand  buƒ  obˆ  jedni‡ky  nebo obˆ
                               nuly.  Jinak  je  na p©¡slu¨n‚ bitov‚ pozici
                               jedni‡ka.

Syntaxe:                       XOR destination,source

Ovliv¤uje p©¡znaky:            OF = 0, CF = 0,SF, ZF, PF

Nedefinovan‚ p©¡znaky:         AF

V˜jimky v PM:                  Jestli‘e    operand    le‘¡    v    segmentu
                               nep©¡stupn‚m z pisu, je generov na v¨eobecn 
                               v˜jimka  poru¨en¡  ochrany  pamˆti. Jestli‘e
                               registry  CS,  DS  nebo ES obsahuj¡ neplatn‚
                               efektivn¡  adresy  operand–,  je  generov na
                               v¨eobecn  v˜jimka  ochrany  pamˆti. Jestli‘e
                               SS obsahuje neplatnou adresu, je  generov na
                               v˜jimka "chyba z sobn¡ku".






                                  - 117 - 




V˜jimky v RM:                  Jestli‘e  je  slovn¡   operand   um¡stˆn  na
                               offsetu 0FFFFH, je generov no p©eru¨en¡  INT
                               13.

Pozn mka pro 80386:            ¨¡©ka slova je 32 bit–

P©¡klad:                       XOR AX,MEMRY_WRD
                               XOR AH,BL
                               XOR OP1,OP1 ; efektn¡ nulov n¡ operand OP1
                               XOR TABLE[BX][DI],AX
                               XOR EAX,ECX ; jen pro 80386
                               XOR EDX,0CFAD1579H ; jen pro 80386















































                                  - 118 - 










                            K a p i t o l a   8

                         Speci ln¡ instrukce 80386


IBTS
---------------------------------------------------------------------------

Instrukce:                     Vlo‘ bity do registru nebo pamˆŸov‚ lokace

€asov n¡:                      2-4

Popis:                         Instrukce IBTS vkl d  ni‘¨¡ bity registru do
                               jin‚ho  registru  nebo pamˆŸov‚  lokace  bez
                               poru¨en¡   soused¡c¡ch   bit–.   IBTS  m   4
                               operandy:  b zov   adresa  bitov‚ho ©etˆzce,
                               bitov˜ offset za‡ tku  pod©etˆzce,  kter˜ m 
                               b˜t ulo‘en, jeho d‚lku  a  registr,  jen‘ m 
                               obdr‘et  vkl danou  hodnotu.  B zov   adresa
                               m–‘e  b˜t  registrem  nebo adresou v pamˆti.
                               Offset je ulo‘en˜ v registru EAX  (v  AX p©i
                               16-tibitov˜ch  operandech).  D‚lka  pole  je
                               d na   registrem   CL   a  posledn¡  operand
                               instrukce  specifikuje   v¨eobecn˜  registr,
                               kter˜ m  obdr‘et hodnotu.

Syntaxe:                       IBTS base,offset,length,source
                               IBTS reg/mem,(E)AX,CL,reg

Ovliv¤uje p©¡znaky:            OF,SF,ZF,AF,PF


Nedefinovan‚ p©¡znaky:         CF

V˜jimky v PM:                  V¨eobecn   v˜jimka  privilegovan‚ho  m¢du je
                               generov na v p©¡padˆ, ‘e operand  nem–‘e b˜t
                               pou‘it kv–li poru¨en¡  limitu  segmentu nebo
                               p©¡stupov˜ch pr v.

V˜jimky v RM:                  V¨eobecn   v˜jimka  privilegovan‚ho  m¢du je
                               generov na v p©¡padˆ, ‘e operand  nem–‘e b˜t
                               pou‘it  kv–li  um¡stˆn¡  mimo limit segmentu
                               (offset 0FFFFH).

P©¡klad:                       IBTS BX,AX,CL,DX

MOV CRn
---------------------------------------------------------------------------

Instrukce:                     Napl¤ a ulo‘ ©¡dic¡ registry



                                  - 119 - 




                               MOV CRn,reg
                               MOV reg,CRn

€asov n¡:                      2-4

Popis:                         Instrukce  pln¡  nebo  ukl daj¡ hodnoty z/do
                               ©¡dic¡ch   registr–   CRn.   Instrukce  v‘dy
                               pou‘¡vaj¡  32-bitov‚  operandy a  pro  80386
                               jsou definov ny jen ©¡dic¡ registry CR0, CR2
                               a CR3.

Syntaxe:                       MOV CRn,source_operand
                               MOV destination,CRn

Ovliv¤uje p©¡znaky:            OF, ZF, SF, PF, AF


Nedefinovan‚ p©¡znaky:         CF

V˜jimky v PM:                  Jde  o   privilegovan‚   instrukce.  Jsou-li
                               vykon v ny na privilegovan‚ £rovni jin‚  ne‘
                               0,  vedou  k  v˜padku  ochrany   (protection
                               fault).

V˜jimky v RM:                  ‘ dn‚

P©¡klad:                       MOV CR2,EAX
                               MOV EBX,CR3

MOV DRn
---------------------------------------------------------------------------

Instrukce:                     Napl¤ a uschovej ladic¡ registry
                               MOV Dreg,reg
                               MOV reg,Dreg

€asov n¡:                      2-4

Popis:                         Instrukce zav dˆj¡ a  uchov vaj¡  obsahy 32-
                               bitov˜ch hodnot ladic¡ch registr–.

Syntaxe:                       MOV Dreg,reg
                               MOV reg,Dreg

Ovliv¤uje p©¡znaky:            OF, ZF, SF, AF, PF


Nedefinovan‚ p©¡znaky:         CF

V˜jimky v PM:                  Jde  o   privilegovan‚   instrukce.  Jsou-li
                               vykon v ny na privilegovan‚ £rovni jin‚  ne‘
                               0, vedou k v˜padku ochrany.

V˜jimky v RM:                  ‘ dn‚

P©¡klad:                       MOV DR4,EAX



                                  - 120 - 




                               MOV EBX,DR5

MOV TRn
---------------------------------------------------------------------------

Instrukce:                     Napl¤ a uschovej testovac¡ registry
                               MOV Treg,reg
                               MOV reg,Treg

€asov n¡:                      2-4

Popis:                         Instrukce  pln¡  nebo  ukl daj¡ hodnoty z/do
                               testovac¡ch  registr–  TRn. Pro  80386  jsou
                               definov ny jen ©¡dic¡ registry TR6 a TR7.

Syntaxe:                       MOV Treg,reg
                               MOV reg,Treg

Ovliv¤uje p©¡znaky:            ‘ dn‚


Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jde  o   privilegovan‚   instrukce.  Jsou-li
                               vykon v ny na privilegovan‚ £rovni jin‚  ne‘
                               0, vedou k v˜padku ochrany.

V˜jimky v RM:                  ‘ dn‚

P©¡klad:                       MOV TR6,EAX

SETcond.
---------------------------------------------------------------------------

Instrukce:                     Nastav byte podle podm¡nky
























                                  - 121 - 




                               --------------------------------------------
                               Instrukce    €asov n¡: Popis:
                               --------------------------------------------
                               SET     cond.Jedni‡kuje-nuluje
                                            byte podle v˜sledku
                                            testu podm¡nky
                               SETO    -    P©ete‡en¡
                               SETNO   -    Nen¡ p©ete‡en¡
                               SETB    -    Men¨¡
                               SETNAE  -    Ne vˆt¨¡ nebo rovno
                               SETNB   -    Ne men¨¡
                               SETAE   -    Vˆt¨¡ nebo rovno
                               SETE    -    Rovno
                               SETZ    -    Nula
                               SETNE   -    Ne rovno
                               SETNZ   -    Ne nula
                               SETBE   -    Men¨¡ nebo rovno
                               SETNA   -    Ne vˆt¨¡
                               SETNBE  -    Ne men¨¡ nebo rovno
                               SETA    -    Vˆt¨¡
                               SETS    -    Znam‚nko
                               SETNS   -    Ne znam‚nko
                               SETP    -    Parita
                               SETPE   -    Sud  parita
                               SETNP   -    Ne parita
                               SETPO   -    Lich  parita
                               SETL    -    Men¨¡ ne‘ (se signem)
                               SETNGE  -    Ne vˆt¨¡ ne‘ nebo =
                               SETNL   -    Ne men¨¡ ne‘
                               SETGE   -    Vˆt¨¡ nebo rovno
                               SETLE   -    Men¨¡ nebo rovno
                               SETNG   -    Ne vˆt¨¡ ne‘
                               SETNLE  -    Ne men¨¡ ne‘ nebo =
                               SETG    -    Vˆt¨¡ ne‘ (se signem)
                               --------------------------------------------


Efekt instrukce:               Instrukce SET nastavuje vybran˜ byte do nuly
                               nebo   do   jedni‡ky   podle   16   podm¡nek
                               definovan˜ch pro 80386. Jedin˜m operandem je
                               jednobytov˜ registr  nebo  pamˆŸov˜ operand.
                               Jsou provedena n sleduj¡c¡  p©i©azen¡: pokud
                               SETcond, pak reg/mem = 1; jinak reg/mem = 0.

Syntaxe:                       SETcond reg/mem

Ovliv¤uje p©¡znaky:            ‘ dn‚


Nedefinovan‚ p©¡znaky:         ‘ dn‚

V˜jimky v PM:                  Jestli‘e   operand   nem–‘e   b˜t  pou‘it  v
                               instrukci  kv–li  poru¨en¡  limitu  segmentu
                               nebo  poru¨en¡  p©¡stupov˜ch  pr v,  pak  je
                               generov na v˜jimka 13.




                                  - 122 - 




V˜jimky v RM:                  ‘ dn‚

P©¡klad:                       SETNO

SHLD/SHRD
---------------------------------------------------------------------------

Instrukce:                     Instrukce dvojit‚ho posuvu

€asov n¡:                      3-7

Popis:                         Instrukce   SHLD/SHRD    posouvaj¡   operand
                               reprezentuj¡c¡  ‡¡slo  v  dvojit‚  p©esnosti
                               doleva nebo doprava tak, aby vzniklo ‡¡slo v
                               jednoduch‚ p©esnosti.  Registr  nebo hodnota
                               pamˆŸov‚ho m¡sta je posunuta v z vislosti na
                               hodnotˆ v t©et¡m  operandu  instrukce, kter˜
                               je ‡¡ta‡em. Tento posuv se li¨¡ od  posuv– u
                               ‡¡sel  v  jednoduch‚  p©esnosti  v  tom,  ‘e
                               dvojit˜ posuv pou‘¡v  registrov˜ operand pro
                               specifikaci  bit–,  kter‚  se maj¡ posouvat,
                               zat¡mco jednoduch˜ posuv  p©esouv   jen nuly
                               nebo jedni‡ky. Registr  nebo  pamˆŸov‚ m¡sto
                               (reg/mem)   specifikuje   vstupn¡   operand.
                               Registr (reg) specifikuje  bity,  kter‚ maj¡
                               b˜t vsunuty, a t©et¡ operand  (immediate/CL)
                               obsahuje po‡et posuv–.

                               Pro  SHLD  obsahuje  registr  nebo  pamˆŸov˜
                               operand   vy¨¨¡   bity   ‡¡sla   v   dvojit‚
                               p©esnosti,   a   registr   (druh˜   operand)
                               obsahuje ni‘¨¡ bity ‡¡sla. Prvn¡  operand je
                               posunut doleva, p©i‡em‘  vy¨¨¡  bity druh‚ho
                               operandu  jsou  vsunuty  doprava  (na  m¡sto
                               ni‘¨¡ho  © du). V˜sledek je ulo‘en v  prvn¡m
                               operandu.

                               Pro  SHRD  obsahuje  registr  nebo  pamˆŸov˜
                               operand   ni‘¨¡   bity  ‡¡sla   ve   dvojit‚
                               p©esnosti  a   registrov˜   (druh˜)  operand
                               obsahuje  vy¨¨¡  bity.   Prvn¡   operand  je
                               posunut  doprava  a  ni‘¨¡ bity registrov‚ho
                               operandu  jsou  vsunuty  doleva  (na   m¡sto
                               vy¨¨¡ho  © du). V˜sledek je ulo‘en v  prvn¡m
                               operandu.

Syntaxe:                       SHLD reg/mem,reg,immediate_operand
                               SHLD reg/mem,reg,CL

Ovliv¤uje p©¡znaky:            CF   je   nastaven   na  hodnotu  posledn¡ho
                               vysouvan‚ho  bitu  OF je  nastaven  jestli‘e
                               posunut¡ posledn¡ho bitu zp–sobilo p©ete‡en¡
                               SF,ZF  a PF  jsou  nastaveny  podle  hodnoty
                               v˜sledku





                                  - 123 - 




Nedefinovan‚ p©¡znaky:         AF

V˜jimky v PM:                  ‘ dn‚

V˜jimky v RM:                  ‘ dn‚

P©¡klad:                       SHLD AX,BL,0AH ; 0AH = bezprost©edn¡ operand
                               SHRD AL,BL,CL ; CL = po‡et posuv–

XBTS
---------------------------------------------------------------------------

Instrukce:                     Extrahuj bitov˜ ©etˆzec

€asov n¡:                      6-13

Popis:                         Instrukce XBTS extrahuje  bitov˜  ©etˆzec, a
                               tento ©etˆzec je ulo‘en zarovnan˜  doprava a
                               roz¨¡©en˜ (t.j. s  horn¡mi  bity nastaven˜mi
                               do nuly) ve specifikovan‚m registru.
                               Instrukce XBTS m  4 operandy; b zovou adresu
                               bitov‚ho  ©etˆzce,  bitov˜   offset  za‡ tku
                               pod©etˆzce,  jen‘  m   b˜t extrahov n, d‚lku
                               extrahovan‚ho pod©etˆzce a  registr,  kam m 
                               b˜t extrahovan˜  pod©etˆzec  um¡stˆn. B zov 
                               adresa  m–‘e b˜t um¡stˆna v registru nebo  v
                               pamˆŸov‚m  operandu.  Offset  je  ulo‘en   v
                               registru   EAX   (resp.   AX  u  16-bitov˜ch
                               operand–).  D‚lka  pole  je  d na   hodnotou
                               registru   CL.   Posledn¡   pole   instrukce
                               specifikuje    v¨eobecn˜   registr,    kter˜
                               obsahuje extrahovanou hodnotu.

Syntaxe:                       XBTS dest,base,offset,length
                               XBTS reg,reg/mem,(E)AX,CL

Ovliv¤uje p©¡znaky:            OF, SF, AF, ZF, PF


Nedefinovan‚ p©¡znaky:         CF

V˜jimky v PM:                  Jestli‘e   operand   nem–‘e   b˜t  pou‘it  v
                               instrukci  kv–li  poru¨en¡  limitu  segmentu
                               nebo  poru¨en¡  p©¡stupov˜ch  pr v,  pak  je
                               generov na v˜jimka 13.

V˜jimky v RM:                  Jestli‘e  operand  le‘¡  mimo limit segmentu
                               (0FFFFH),  je  generov na  v¨eobecn  v˜jimka
                               poru¨en¡ ochrany pamˆti.

P©¡klad:                       XBTS AX,BX,AX,CL








                                  - 124 - 










                            K a p i t o l a   9

                      P©¡klady program– v assembleru


1. Se‡¡t n¡ - pou‘it¡ bezprost©edn¡ho adresov n¡

               ; Pro 80286/80386
               ; Ilustrace jednoduch‚ho hexadecim ln¡ho se‡¡t n¡
               ; BEZPROSTžEDN‹ ADRESOVN‹

stack          segment para stack
               db 64 dup ("MYSTACK") ; z sobn¡k o 100h slovech
stack          ends

mycode         segment para "code"      ; definuj segment k¢du
myproc         proc far                 ; procedura jm‚nem MYPROC
               assume cs:mycode,ss:stack

               push  ds                 ; uschovej datov˜ segment
               sub   ax,ax              ; nula do ax
               push  ax                 ; uschovej do z sobn¡ku

               ; nasleduje k¢d vlastniho programu -
               mov   al,12h             ; prvn¡ operand = NUM1
               add   al,18h             ; p©i‡ti druh˜ operand
               add   al,30h             ; p©i‡ti t©et¡ operand

               ; konec se‡¡t n¡ - v˜sledek je v AL
               mov   ah,4Ch             ; n vrat do DOSu
               int   21h                ; s ERRORLEVEL 0
               ret
myproc         endp                     ; konec procedury MYPROC
mycode         ends                     ; konec segmentu k¢du


   Jako prvn¡ je v na¨em p©¡kladˆ definov n z sobn¡k:  je  inicializov n 64
slovy  "MYSTACK",  co‘  m–‘e  usnadnit  ladˆn¡  na¨eho  programu. N sleduj¡
segment je k¢dov˜ -  je  nazv n "mycode" a v¨eobecnˆ mus¡ obsahovat alespo¤
jednu  proceduru - tou je u n s procedura  "MYPROC".  Procedura  se‡te  t©i
hexadecim ln¡ ‡¡sla a pomoc¡ int 21 p©ed  ©¡zen¡ DOSu. V  na¨em jednoduch‚m
p©¡kladˆ  nen¡  v–bec  pou‘it  datov˜  segment  -  program s  ‘ dn˜mi  daty
ulo‘en˜mi v datov‚m segmentu nepracuje.

2. Se‡¡t n¡ - pou‘it¡ p©¡m‚ho adresov n¡

               ; Pro 80286/80386
               ; Ilustrace jednoduch‚ho hexadecim ln¡ho se‡¡t n¡
               ; Pž‹M ADRESOVN‹




                                  - 125 - 




stack          segment para stack
               db 64 dup ("MYSTACK")    ; z sobn¡k o 100h slovech
stack          ends

mydata         segment para "data"      ; datov˜ segment MYDATA
               NUM1  dw 1234h           ; prvn¡ slovn¡ operand
               NUM2  dw 24h             ; druh˜ slovn¡ operand
               NUM3  dw 0ABCh           ; t©et¡ slovn¡ operand
               ANS   dw ?               ; slovo pro v˜sledek
mydata         ends                     ; konec segmentu dat

mycode         segment para "code"      ; definuj segment k¢du
myproc         proc far                 ; procedura jm‚nem MYPROC
               assume cs:mycode,ss:stack
               push  ds                 ; uschovej datov˜ segment
               sub   ax,ax              ; nula do ax
               push  ax                 ; uschovej ax
               mov   ax,mydata          ; datov˜ segment do AX
               mov   ds,ax              ; nastav hodnotu DS

               ; nasleduje k¢d vlastniho programu -
               mov   ax,NUM1            ; prvn¡ operand = NUM1
               add   ax,NUM2            ; p©i‡ti NUM2
               add   ax,NUM3            ; p©i‡ti NUM3
               mov   ANS,ax             ; ulo‘ v˜sledek do ANS

               ; konec se‡¡t n¡ - v˜sledek je v promˆnn‚ ANS
               mov   ah,4Ch             ; n vrat do DOSu
               int   21h                ; s ERRORLEVEL 0
               ret
myproc         endp                     ; konec procedury myproc
mycode         ends                     ; konec segmentu k¢du


 V  tomto  p©¡kladˆ  je pou‘it pro um¡stˆn¡ operand– datov˜ segment MYDATA,
za‡¡naj¡c¡ v pamˆti na hranici  paragrafu (t.j. na adrese dˆliteln‚ 16-ti).
Kromˆ  operand–  se‡¡t n¡  je v segmentu  MYDATA  definov no  i  slovo  pro
v˜sledek (ANS, symbol "?" znamen , ‘e slovo nen¡ inicializov no).

3. Se‡¡t n¡ ve dvojit‚ p©esnosti - indexov‚ adresov n¡

               ; Pro 80286/80386
               ; Ilustrace hexadecim ln¡ho se‡¡t n¡ ve dvojit‚ p©esnosti
               ; INDEXOV ADRESOVN‹

stack          segment para stack
               db 64 dup ("MYSTACK")    ; z sobn¡k o 100h slovech
stack          ends

mydata         segment para "data"      ; datov˜ segment MYDATA
TABLE          dw 1234h,5678h,9ABCh,0DEF0h,1111h,2222h,3333h
               dw 4444h,5555h,6666h,7777h,8888h,9999h,0AAAAh
               dw 0BBBBh,0CCCCh,0DDDDh,0EEEEh,0FFFFh
LSBANS         dw ?                     ; ni‘¨¡ byty v˜sledku
MSBANS         dw ?                     ; vy¨¨¡ byty v˜sledku
mydata         ends



                                  - 126 - 




; ----------- konec segmentu dat mydata ------------

segment        para "code"              ; definuj segment k¢du
myproc         proc far                 ; procedura jm‚nem MYPROC
               assume cs:mycode,ss:stack
               push  ds                 ; uschovej datov˜ segment
               sub   ax,ax              ; nula do ax
               push  ax                 ; uschovej ax
               mov   ax,mydata          ; datov˜ segment do ax
               mov   ds,ax              ; nastav hodnotu ds
;----------- nasleduje k¢d vlastniho programu -------
               mov   si,0h              ; index=0 (1.prvek tabulky)
               mov   ax,TABLE[si]       ; vezmi prvn¡ ‡¡slo
               mov   cx,09h             ; devˆt se‡¡t n¡
again:         add   si,02h             ; dal¨¡ slovo v TABLE
               add   ax,TABLE[si]       ; p©i‡ti jej
               adc   dx,0h              ; p©i‡ti p©¡p. p©enos k dx
               loop again               ; dal¨¡ p©i‡ten¡ p©i cx<>0
               mov LSBANS,ax            ; hotovo-p©esun v˜sledku
               mov MSBANS,dx            ; i ‡ sti MSB
; ---- konec se‡¡t n¡ - v˜sledek je v MSBANS a LSBANS -----
               mov ah,4Ch               ; n vrat do DOSu
               int 21h                  ; s ERRORLEVEL 0
               ret
myproc         endp                     ; konec procedury myproc
mycode         ends                     ; konec segmentu k¢du


4. Pou‘it¡ p©¡kazu DAA p©i se‡¡t n¡ - registrov‚ nep©¡m‚
               adresov n¡

               ; Pro 80286/80386
               ; Ilustrace pou‘it¡ DAA p©i se‡¡t n¡
               ; REGISTROV NEPž‹M ADRESOVN‹

stack          segment para stack
               db 64 dup ("MYSTACK")    ; z sobn¡k o 100h slovech
stack          ends

mydata s       egment para "data" ; datov˜ segment MYDATA
INFO           db 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
ANS            db ?                     ; v˜sledek
mydata         ends                     ; konec segmentu dat mydata

segment        para "code"              ; definuj segment k¢du
myproc         proc  far                ; procedura jm‚nem MYPROC
               assume cs:mycode,ss:stack
               push  ds                 ; uschovej datov˜ segment
               sub   ax,ax              ; nula do ax
               push  ax                 ; uschovej ax
               mov   ax,mydata          ; datov˜ segment do ax
               mov   ds,ax              ; nastav hodnotu ds
; nasleduje k¢d vlastniho programu -
               lea   bx,info            ; z¡skej adresu (offset)
               mov   cx,10              ; 10 se‡¡t n¡
               mov   al,INFO            ; 1. ‡¡slo z INFO do AL



                                  - 127 - 




again:         add   bx,01h             ; dal¨¡ ‡¡slo z INFO
               add   al,info[bx]        ; p©i‡ti jej k al
               daa                      ; p©ichystej AL
               loop  again              ; dal¨¡ se‡¡t n¡
               mov   ANS,al             ; v˜sledek do ANS
; konec se‡¡t n¡ - v˜sledek je v ANS
               mov   ah,4Ch             ; n vrat do DOSu
               int   21h                ; s ERRORLEVEL 0
               ret
myproc         endp                     ; konec procedury myproc
mycode         ends                     ; konec segmentu k¢du


5. P©¡klad 32-bitov‚ho se‡¡t n¡ u 80386

stack          segment para "stack"
               db 64 dup("MYSTACK")
stack          ends

mydata         segment para "data"
NUMS           DD 12345678h,9ABCDEF0h,23h,10000000h,0CADh
ANSWER         DD ?
mydata         ends

mycode         segment para "code"
myproc         proc far
               assume cs:mycode,ds:mydata,ss:stack
               push  ds
               sub   ax,ax
               push  ax
               mov   ax,mydata
               mov   ds,ax
; k¢d pro 32-bitov‚ se‡¡t n¡
               lea   bx,NUMS            ; offset NUMS do BX
               mov   eax,[bx]           ; prvn¡ 32-bitov‚ ‡¡slo do EAX
               add   eax,[bx]+4         ; p©i‡ti druh‚
               add   eax,[bx]+8         ; a t©et¡
               mov   ANSWER,eax         ; v˜sledek bude v ANSWER
               mov   ah,4Ch             ; n vrat do DOSu
               int   21h                ; s ERRORLEVEL 0
               ret
myproc endp
mycode ends
               end


6.P©¡klad jednoduch‚ho 32-bitov‚ho n soben¡


stack          segment para "stack"
               db 64 dup("MYSTACK")
stack          ends

mydata         segment para "data"
NUM1           DD 12345678h
NUM2           DD 9ABCDEF0h



                                  - 128 - 




               ANSWER DD ?
mydata ends

mycode         segment para "code"
myproc         proc  far
               assume cs:mycode,ds:mydata,ss:stack
               push ds
               sub   ax,ax
               push  ax
               mov   ax,mydata
               mov   ds,ax
; k¢d pro 32-bitov‚ n soben¡
               mov   eax,NUM1           ; prvn¡ 32-bitov‚ ‡¡slo do EAX
               mul   eax,NUM2           ; vyn sob druh˜m ‡¡slem
               mov   dword ptr ANSWER,eax ;ni‘¨¡ch 32 bit– v˜sledku
               mov   dword ptr ANSWER,edx ;vy¨¨¡ch 32 bit– v˜sledku
               mov   ah,4Ch             ; n vrat do DOSu
               int   21h                ; s ERRORLEVEL 0
               ret
myproc endp
mycode ends
               end

   V˜sledek  n soben¡  je  v registrech EAX a EDX. Pou‘it¡m oper toru DWORD
PTR je 32-bitov˜ obsah ka‘d‚ho registru spr vnˆ um¡stˆn do ‡ty©slova ANSWER
v datov‚m segmentu.

































                                  - 129 - 































































                                  - 130 - 










                                 Dodatek A

                  Re ln˜ a privilegovan˜ m¢d 80286(80386)


   Jak ji‘ bylo nazna‡eno v  kapitole 6., jsou obsahy segmentov˜ch registr–
interpretov ny r–znˆ v z vislosti na tom, zda 80286/80386 pracuje v re ln‚m
nebo v privilegovan‚m m¢du. Speci lnˆ u obvodu 80286

 - v re ln‚m m¢du  (real  address mode) generuje 80286 20-ti bitovou adresu
pamˆŸov‚ lokace podle n sleduj¡cho vztahu
   ADRESA=(16xSELEKTOR) + OFFSET
kde  SELEKTOR  je  obsah  p©¡slu¨n‚ho  segmentov‚ho  registru  a OFFSET  je
posunut¡ referovan‚ho pamˆŸov‚ho m¡sta vzhledem k za‡ tku segmentu.

 - ve  virtu ln¡m  (privilegovan‚m)  m¢du  (virtual  address  mode) pracuje
procesor s virtu ln¡ adresou,  kterou  mapuje  do 24-bitov‚ fyzick‚ adresy,
vys¡lan‚ na adresovou sbˆrnici. V tomto m¢du jsou v¨echny p©¡stupy k pamˆti
kontrolov ny na opr vnˆnost.  P©¡stup  k pamˆŸov‚ lokaci je tedy provˆ©ov n
vzhledem  k  tzv.  privilegovan‚   £rovni,   co‘   je   dvoubitov   hodnota
reprezentuj¡c¡ relativn¡ £rove¤ p©¡stupov‚ho  opr vnˆn¡  k  pamˆti  (00b je
maxim ln¡, 11b je minim ln¡ £rove¤)
   Obsahem segmentov‚ho registru je tedy v‘dy selektor; struktura selektoru
je n sleduj¡c¡:


         (MSB)                       (LSB)
 ÚÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÚÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄÂÄÄ¿
 ³                I  N D E X            ³TI³ RPL ³
 ÀÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÙÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÁÄÄÙ
 15                                              0



RPL =             po‘adovan   privilegovan   £rove¤  (1  a‘  3)  (requested
                  privilege level)

TI =              indikace tabulky deskriptor–

0 =               tabulka GDT (Global Descriptor Table)

1 =               tabulka LDT (Local Descriptor Table )

INDEX =           ukazatel do tabulky deskriptor–

Tabulka deskriptor–

   Tabulka deskriptor– (LDT nebo GDT ve virtu ln¡ pamˆti,  resp.  fyzick  v
pamˆti  na  ‡ipu  80286) je slo‘ena ze 48- bitov˜ch polo‘ek. Na £rovni ‡ipu
80286 je programovˆ nep©¡stupn . Jej¡ struktura je n sleduj¡c¡



                                  - 131 - 




 47    40 39                   16 15             0
 ÚÂÂÂÂÂÂÂÚÂÂÂÂÂÂÂ¿ÂÂÂÂÂÂÂÚÂÂÂÂÂÂÂ¿ÂÂÂÂÂÂÂÚÂÂÂÂÂÂÂ¿
 ³  ARB  ³      BASE ADDRESS     ³     LIMIT     ³  CS
 ÀÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙ
 ÚÂÂÂÂÂÂÂÚÂÂÂÂÂÂÂ¿ÂÂÂÂÂÂÂÚÂÂÂÂÂÂÂ¿ÂÂÂÂÂÂÂÚÂÂÂÂÂÂÂ¿
 ³  ARB  ³      BASE ADDRESS     ³     LIMIT     ³  DS
 ÀÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙ
 ÚÂÂÂÂÂÂÂÚÂÂÂÂÂÂÂ¿ÂÂÂÂÂÂÂÚÂÂÂÂÂÂÂ¿ÂÂÂÂÂÂÂÚÂÂÂÂÂÂÂ¿
 ³  ARB  ³      BASE ADDRESS     ³     LIMIT     ³  SS
 ÀÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙ
 ÚÂÂÂÂÂÂÂÚÂÂÂÂÂÂÂ¿ÂÂÂÂÂÂÂÚÂÂÂÂÂÂÂ¿ÂÂÂÂÂÂÂÚÂÂÂÂÂÂÂ¿
 ³  ARB  ³      BASE ADDRESS     ³     LIMIT     ³  ES
 ÀÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙÁÁÁÁÁÁÁÙ

nn Ka‘d   adresa b ze segmentu je 24-bitov  (t.j. pro adresaci 0 - 16 MB ).
Hovo©¡me-li tedy o segmentov‚m registru, je pod t¡mto  pojmem  t©eba ch pat
jak jeho programovˆ  p©¡stupnou  ‡ st  -  selektor -, tak i ‡ st programovˆ
nep©¡stupnou -  deskriptor. €ip 80286 tedy z dvojice SEGMENT:OFFSET vytvo©¡
fyzickou adresu ve dvou kroc¡ch:
1.  selektor  ur‡¡  index do tabulky  deskriptor–  a  je  z¡sk n  p©¡slu¨n˜
deskriptor, t.j. adresa za‡ tku segmentu ve fyzick‚ pamˆti
2.  tato  adresa  je se‡tena s 16-bitov˜m offsetem, co‘ poskytne 24-bitovou
adresu jednozna‡nˆ ur‡uj¡c¡ pamˆŸov‚ m¡sto ve fyzick‚m pamˆŸov‚m prostoru
   Popsan˜ v˜po‡et fyzick‚  adresy  je automatickou z le‘itost¡ CPU 80286 -
program tor na £rovni  assembleru  je jen povinen naplnit © dn˜mi hodnotami
segmentov‚ registry a ur‡it offset v segmentu.



Literatura

   [1] Murray W.H.,Pappas C.H. : 80286/80386 Assembly
   Language Programming, Osborne McGraw-Hill, 1986
   [2] 80286 Assembly Language Reference Manual, Operating
   Systems and Languages Library,Olivetti, 1986



                                  - 132 - 


                                                             konec ASM.HLP
**************************************************************************
